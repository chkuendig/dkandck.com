(()=>{var ka=Object.create;var Os=Object.defineProperty;var Fa=Object.getOwnPropertyDescriptor;var Va=Object.getOwnPropertyNames;var Ga=Object.getPrototypeOf,Wa=Object.prototype.hasOwnProperty;var Ei=(rt,vt)=>()=>(rt&&(vt=rt(rt=0)),vt);var Ii=(rt,vt)=>()=>(vt||rt((vt={exports:{}}).exports,vt),vt.exports);var Ba=(rt,vt,B,D)=>{if(vt&&typeof vt=="object"||typeof vt=="function")for(let p of Va(vt))!Wa.call(rt,p)&&p!==B&&Os(rt,p,{get:()=>vt[p],enumerable:!(D=Fa(vt,p))||D.enumerable});return rt};var Ua=(rt,vt,B)=>(B=rt!=null?ka(Ga(rt)):{},Ba(vt||!rt||!rt.__esModule?Os(B,"default",{value:rt,enumerable:!0}):B,rt));var Ke,Ce,Xe,ds,Pi,fi,oi,ps,ms,gs,_s,ys,Hi,ho,wi=Ei(()=>{Ke=typeof window<"u"?window:typeof module<"u"&&module.exports&&typeof global<"u"?global:{},Ce=function(rt,vt){"use strict";var B={},D=rt.document,p=rt.GreenSockGlobals=rt.GreenSockGlobals||rt;if(p.TweenLite)return p.TweenLite;var l=function($){var N=$.split("."),K=p,k;for(k=0;k<N.length;k++)K[N[k]]=K=K[N[k]]||{};return K},n=l("com.greensock"),e=1e-10,i=function($){var N=[],K=$.length,k;for(k=0;k!==K;N.push($[k++]));return N},t=function(){},r=function(){var $=Object.prototype.toString,N=$.call([]);return function(K){return K!=null&&(K instanceof Array||typeof K=="object"&&!!K.push&&$.call(K)===N)}}(),s,a,f,o,c,d={},h=function($,N,K,k){this.sc=d[$]?d[$].sc:[],d[$]=this,this.gsClass=null,this.func=K;var Y=[];this.check=function(ht){for(var wt=N.length,Et=wt,Mt,Dt,At,Xt;--wt>-1;)(Mt=d[N[wt]]||new h(N[wt],[])).gsClass?(Y[wt]=Mt.gsClass,Et--):ht&&Mt.sc.push(this);if(Et===0&&K)for(Dt=("com.greensock."+$).split("."),At=Dt.pop(),Xt=l(Dt.join("."))[At]=this.gsClass=K.apply(K,Y),k&&(p[At]=B[At]=Xt),wt=0;wt<this.sc.length;wt++)this.sc[wt].check()},this.check(!0)},u=rt._gsDefine=function($,N,K,k){return new h($,N,K,k)},m=n._class=function($,N,K){return N=N||function(){},u($,[],function(){return N},K),N};u.globals=p;var g=[0,0,1,1],_=m("easing.Ease",function($,N,K,k){this._func=$,this._type=K||0,this._power=k||0,this._params=N?g.concat(N):g},!0),y=_.map={},v=_.register=function($,N,K,k){for(var Y=N.split(","),ht=Y.length,wt=(K||"easeIn,easeOut,easeInOut").split(","),Et,Mt,Dt,At;--ht>-1;)for(Mt=Y[ht],Et=k?m("easing."+Mt,null,!0):n.easing[Mt]||{},Dt=wt.length;--Dt>-1;)At=wt[Dt],y[Mt+"."+At]=y[At+Mt]=Et[At]=$.getRatio?$:$[At]||new $};for(f=_.prototype,f._calcEnd=!1,f.getRatio=function($){if(this._func)return this._params[0]=$,this._func.apply(null,this._params);var N=this._type,K=this._power,k=N===1?1-$:N===2?$:$<.5?$*2:(1-$)*2;return K===1?k*=k:K===2?k*=k*k:K===3?k*=k*k*k:K===4&&(k*=k*k*k*k),N===1?1-k:N===2?k:$<.5?k/2:1-k/2},s=["Linear","Quad","Cubic","Quart","Quint,Strong"],a=s.length;--a>-1;)f=s[a]+",Power"+a,v(new _(null,null,1,a),f,"easeOut",!0),v(new _(null,null,2,a),f,"easeIn"+(a===0?",easeNone":"")),v(new _(null,null,3,a),f,"easeInOut");y.linear=n.easing.Linear.easeIn,y.swing=n.easing.Quad.easeInOut;var b=m("events.EventDispatcher",function($){this._listeners={},this._eventTarget=$||this});f=b.prototype,f.addEventListener=function($,N,K,k,Y){Y=Y||0;var ht=this._listeners[$],wt=0,Et,Mt;for(this===o&&!c&&o.wake(),ht==null&&(this._listeners[$]=ht=[]),Mt=ht.length;--Mt>-1;)Et=ht[Mt],Et.c===N&&Et.s===K?ht.splice(Mt,1):wt===0&&Et.pr<Y&&(wt=Mt+1);ht.splice(wt,0,{c:N,s:K,up:k,pr:Y})},f.removeEventListener=function($,N){var K=this._listeners[$],k;if(K){for(k=K.length;--k>-1;)if(K[k].c===N){K.splice(k,1);return}}},f.dispatchEvent=function($){var N=this._listeners[$],K,k,Y;if(N)for(K=N.length,K>1&&(N=N.slice(0)),k=this._eventTarget;--K>-1;)Y=N[K],Y&&(Y.up?Y.c.call(Y.s||k,{type:$,target:k}):Y.c.call(Y.s||k))};var R=rt.requestAnimationFrame,M=rt.cancelAnimationFrame,P=Date.now||function(){return new Date().getTime()},T=P();for(s=["ms","moz","webkit","o"],a=s.length;--a>-1&&!R;)R=rt[s[a]+"RequestAnimationFrame"],M=rt[s[a]+"CancelAnimationFrame"]||rt[s[a]+"CancelRequestAnimationFrame"];m("Ticker",function($,N){var K=this,k=P(),Y=N!==!1&&R?"auto":!1,ht=500,wt=33,Et="tick",Mt,Dt,At,Xt,ie,le=function(W){var ct=P()-T,z,nt;ct>ht&&(k+=ct-wt),T+=ct,K.time=(T-k)/1e3,z=K.time-ie,(!Mt||z>0||W===!0)&&(K.frame++,ie+=z+(z>=Xt?.004:Xt-z),nt=!0),W!==!0&&(At=Dt(le)),nt&&K.dispatchEvent(Et)};b.call(K),K.time=K.frame=0,K.tick=function(){le(!0)},K.lagSmoothing=function(W,ct){if(!arguments.length)return ht<1/e;ht=W||1/e,wt=Math.min(ct,ht,0)},K.sleep=function(){At!=null&&(!Y||!M?clearTimeout(At):M(At),Dt=t,At=null,K===o&&(c=!1))},K.wake=function(W){At!==null?K.sleep():W?k+=-T+(T=P()):K.frame>10&&(T=P()-ht+5),Dt=Mt===0?t:!Y||!R?function(ct){return setTimeout(ct,(ie-K.time)*1e3+1|0)}:R,K===o&&(c=!0),le(2)},K.fps=function(W){if(!arguments.length)return Mt;Mt=W,Xt=1/(Mt||60),ie=this.time+Xt,K.wake()},K.useRAF=function(W){if(!arguments.length)return Y;K.sleep(),Y=W,K.fps(Mt)},K.fps($),setTimeout(function(){Y==="auto"&&K.frame<5&&(D||{}).visibilityState!=="hidden"&&K.useRAF(!1)},1500)}),f=n.Ticker.prototype=new n.events.EventDispatcher,f.constructor=n.Ticker;var E=m("core.Animation",function($,N){if(this.vars=N=N||{},this._duration=this._totalDuration=$||0,this._delay=Number(N.delay)||0,this._timeScale=1,this._active=N.immediateRender===!0,this.data=N.data,this._reversed=N.reversed===!0,!!J){c||o.wake();var K=this.vars.useFrames?j:J;K.add(this,K._time),this.vars.paused&&this.paused(!0)}});o=E.ticker=new n.Ticker,f=E.prototype,f._dirty=f._gc=f._initted=f._paused=!1,f._totalTime=f._time=0,f._rawPrevTime=-1,f._next=f._last=f._onUpdate=f._timeline=f.timeline=null,f._paused=!1;var x=function(){c&&P()-T>2e3&&((D||{}).visibilityState!=="hidden"||!o.lagSmoothing())&&o.wake();var $=setTimeout(x,2e3);$.unref&&$.unref()};x(),f.play=function($,N){return $!=null&&this.seek($,N),this.reversed(!1).paused(!1)},f.pause=function($,N){return $!=null&&this.seek($,N),this.paused(!0)},f.resume=function($,N){return $!=null&&this.seek($,N),this.paused(!1)},f.seek=function($,N){return this.totalTime(Number($),N!==!1)},f.restart=function($,N){return this.reversed(!1).paused(!1).totalTime($?-this._delay:0,N!==!1,!0)},f.reverse=function($,N){return $!=null&&this.seek($||this.totalDuration(),N),this.reversed(!0).paused(!1)},f.render=function($,N,K){},f.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},f.isActive=function(){var $=this._timeline,N=this._startTime,K;return!$||!this._gc&&!this._paused&&$.isActive()&&(K=$.rawTime(!0))>=N&&K<N+this.totalDuration()/this._timeScale-1e-7},f._enabled=function($,N){return c||o.wake(),this._gc=!$,this._active=this.isActive(),N!==!0&&($&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!$&&this.timeline&&this._timeline._remove(this,!0)),!1},f._kill=function($,N){return this._enabled(!1,!1)},f.kill=function($,N){return this._kill($,N),this},f._uncache=function($){for(var N=$?this:this.timeline;N;)N._dirty=!0,N=N.timeline;return this},f._swapSelfInParams=function($){for(var N=$.length,K=$.concat();--N>-1;)$[N]==="{self}"&&(K[N]=this);return K},f._callback=function($){var N=this.vars,K=N[$],k=N[$+"Params"],Y=N[$+"Scope"]||N.callbackScope||this,ht=k?k.length:0;switch(ht){case 0:K.call(Y);break;case 1:K.call(Y,k[0]);break;case 2:K.call(Y,k[0],k[1]);break;default:K.apply(Y,k)}},f.eventCallback=function($,N,K,k){if(($||"").substr(0,2)==="on"){var Y=this.vars;if(arguments.length===1)return Y[$];N==null?delete Y[$]:(Y[$]=N,Y[$+"Params"]=r(K)&&K.join("").indexOf("{self}")!==-1?this._swapSelfInParams(K):K,Y[$+"Scope"]=k),$==="onUpdate"&&(this._onUpdate=N)}return this},f.delay=function($){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+$-this._delay),this._delay=$,this):this._delay},f.duration=function($){return arguments.length?(this._duration=this._totalDuration=$,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&$!==0&&this.totalTime(this._totalTime*($/this._duration),!0),this):(this._dirty=!1,this._duration)},f.totalDuration=function($){return this._dirty=!1,arguments.length?this.duration($):this._totalDuration},f.time=function($,N){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime($>this._duration?this._duration:$,N)):this._time},f.totalTime=function($,N,K){if(c||o.wake(),!arguments.length)return this._totalTime;if(this._timeline){if($<0&&!K&&($+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var k=this._totalDuration,Y=this._timeline;if($>k&&!K&&($=k),this._startTime=(this._paused?this._pauseTime:Y._time)-(this._reversed?k-$:$)/this._timeScale,Y._dirty||this._uncache(!1),Y._timeline)for(;Y._timeline;)Y._timeline._time!==(Y._startTime+Y._totalTime)/Y._timeScale&&Y.totalTime(Y._totalTime,!0),Y=Y._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==$||this._duration===0)&&(q.length&&xt(),this.render($,N,!1),q.length&&xt())}return this},f.progress=f.totalProgress=function($,N){var K=this.duration();return arguments.length?this.totalTime(K*$,N):K?this._time/K:this.ratio},f.startTime=function($){return arguments.length?($!==this._startTime&&(this._startTime=$,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,$-this._delay)),this):this._startTime},f.endTime=function($){return this._startTime+($!=!1?this.totalDuration():this.duration())/this._timeScale},f.timeScale=function($){if(!arguments.length)return this._timeScale;var N,K;for($=$||e,this._timeline&&this._timeline.smoothChildTiming&&(N=this._pauseTime,K=N||N===0?N:this._timeline.totalTime(),this._startTime=K-(K-this._startTime)*this._timeScale/$),this._timeScale=$,K=this.timeline;K&&K.timeline;)K._dirty=!0,K.totalDuration(),K=K.timeline;return this},f.reversed=function($){return arguments.length?($!=this._reversed&&(this._reversed=$,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},f.paused=function($){if(!arguments.length)return this._paused;var N=this._timeline,K,k;return $!=this._paused&&N&&(!c&&!$&&o.wake(),K=N.rawTime(),k=K-this._pauseTime,!$&&N.smoothChildTiming&&(this._startTime+=k,this._uncache(!1)),this._pauseTime=$?K:null,this._paused=$,this._active=this.isActive(),!$&&k!==0&&this._initted&&this.duration()&&(K=N.smoothChildTiming?this._totalTime:(K-this._startTime)/this._timeScale,this.render(K,K===this._totalTime,!0))),this._gc&&!$&&this._enabled(!0,!1),this};var S=m("core.SimpleTimeline",function($){E.call(this,0,$),this.autoRemoveChildren=this.smoothChildTiming=!0});f=S.prototype=new E,f.constructor=S,f.kill()._gc=!1,f._first=f._last=f._recent=null,f._sortChildren=!1,f.add=f.insert=function($,N,K,k){var Y,ht;if($._startTime=Number(N||0)+$._delay,$._paused&&this!==$._timeline&&($._pauseTime=this.rawTime()-($._timeline.rawTime()-$._pauseTime)),$.timeline&&$.timeline._remove($,!0),$.timeline=$._timeline=this,$._gc&&$._enabled(!0,!0),Y=this._last,this._sortChildren)for(ht=$._startTime;Y&&Y._startTime>ht;)Y=Y._prev;return Y?($._next=Y._next,Y._next=$):($._next=this._first,this._first=$),$._next?$._next._prev=$:this._last=$,$._prev=Y,this._recent=$,this._timeline&&this._uncache(!0),this},f._remove=function($,N){return $.timeline===this&&(N||$._enabled(!1,!0),$._prev?$._prev._next=$._next:this._first===$&&(this._first=$._next),$._next?$._next._prev=$._prev:this._last===$&&(this._last=$._prev),$._next=$._prev=$.timeline=null,$===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},f.render=function($,N,K){var k=this._first,Y;for(this._totalTime=this._time=this._rawPrevTime=$;k;)Y=k._next,(k._active||$>=k._startTime&&!k._paused&&!k._gc)&&(k._reversed?k.render((k._dirty?k.totalDuration():k._totalDuration)-($-k._startTime)*k._timeScale,N,K):k.render(($-k._startTime)*k._timeScale,N,K)),k=Y},f.rawTime=function(){return c||o.wake(),this._totalTime};var L=m("TweenLite",function($,N,K){if(E.call(this,N,K),this.render=L.prototype.render,$==null)throw"Cannot tween a null target.";this.target=$=typeof $!="string"?$:L.selector($)||$;var k=$.jquery||$.length&&$!==rt&&$[0]&&($[0]===rt||$[0].nodeType&&$[0].style&&!$.nodeType),Y=this.vars.overwrite,ht,wt,Et;if(this._overwrite=Y=Y==null?ne[L.defaultOverwrite]:typeof Y=="number"?Y>>0:ne[Y],(k||$ instanceof Array||$.push&&r($))&&typeof $[0]!="number")for(this._targets=Et=i($),this._propLookup=[],this._siblings=[],ht=0;ht<Et.length;ht++){if(wt=Et[ht],wt){if(typeof wt=="string"){wt=Et[ht--]=L.selector(wt),typeof wt=="string"&&Et.splice(ht+1,1);continue}else if(wt.length&&wt!==rt&&wt[0]&&(wt[0]===rt||wt[0].nodeType&&wt[0].style&&!wt.nodeType)){Et.splice(ht--,1),this._targets=Et=Et.concat(i(wt));continue}}else{Et.splice(ht--,1);continue}this._siblings[ht]=Rt(wt,this,!1),Y===1&&this._siblings[ht].length>1&&te(wt,this,null,1,this._siblings[ht])}else this._propLookup={},this._siblings=Rt($,this,!1),Y===1&&this._siblings.length>1&&te($,this,null,1,this._siblings);(this.vars.immediateRender||N===0&&this._delay===0&&this.vars.immediateRender!==!1)&&(this._time=-e,this.render(Math.min(0,-this._delay)))},!0),C=function($){return $&&$.length&&$!==rt&&$[0]&&($[0]===rt||$[0].nodeType&&$[0].style&&!$.nodeType)},F=function($,N){var K={},k;for(k in $)!Qt[k]&&(!(k in N)||k==="transform"||k==="x"||k==="y"||k==="width"||k==="height"||k==="className"||k==="border")&&(!Vt[k]||Vt[k]&&Vt[k]._autoCSS)&&(K[k]=$[k],delete $[k]);$.css=K};f=L.prototype=new E,f.constructor=L,f.kill()._gc=!1,f.ratio=0,f._firstPT=f._targets=f._overwrittenProps=f._startAt=null,f._notifyPluginsOfEnabled=f._lazy=!1,L.version="2.0.2",L.defaultEase=f._ease=new _(null,null,1,1),L.defaultOverwrite="auto",L.ticker=o,L.autoSleep=120,L.lagSmoothing=function($,N){o.lagSmoothing($,N)},L.selector=rt.$||rt.jQuery||function($){var N=rt.$||rt.jQuery;return N?(L.selector=N,N($)):(D||(D=rt.document),D?D.querySelectorAll?D.querySelectorAll($):D.getElementById($.charAt(0)==="#"?$.substr(1):$):$)};var q=[],it={},st=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/ig,pt=/[\+-]=-?[\.\d]/,_t=function($){for(var N=this._firstPT,K=1e-6,k;N;)k=N.blob?$===1&&this.end!=null?this.end:$?this.join(""):this.start:N.c*$+N.s,N.m?k=N.m.call(this._tween,k,this._target||N.t,this._tween):k<K&&k>-K&&!N.blob&&(k=0),N.f?N.fp?N.t[N.p](N.fp,k):N.t[N.p](k):N.t[N.p]=k,N=N._next},X=function($,N,K,k){var Y=[],ht=0,wt="",Et=0,Mt,Dt,At,Xt,ie,le,W;for(Y.start=$,Y.end=N,$=Y[0]=$+"",N=Y[1]=N+"",K&&(K(Y),$=Y[0],N=Y[1]),Y.length=0,Mt=$.match(st)||[],Dt=N.match(st)||[],k&&(k._next=null,k.blob=1,Y._firstPT=Y._applyPT=k),ie=Dt.length,Xt=0;Xt<ie;Xt++)W=Dt[Xt],le=N.substr(ht,N.indexOf(W,ht)-ht),wt+=le||!Xt?le:",",ht+=le.length,Et?Et=(Et+1)%5:le.substr(-5)==="rgba("&&(Et=1),W===Mt[Xt]||Mt.length<=Xt?wt+=W:(wt&&(Y.push(wt),wt=""),At=parseFloat(Mt[Xt]),Y.push(At),Y._firstPT={_next:Y._firstPT,t:Y,p:Y.length-1,s:At,c:(W.charAt(1)==="="?parseInt(W.charAt(0)+"1",10)*parseFloat(W.substr(2)):parseFloat(W)-At)||0,f:0,m:Et&&Et<4?Math.round:0}),ht+=W.length;return wt+=N.substr(ht),wt&&Y.push(wt),Y.setRatio=_t,pt.test(N)&&(Y.end=null),Y},ot=function($,N,K,k,Y,ht,wt,Et,Mt){typeof k=="function"&&(k=k(Mt||0,$));var Dt=typeof $[N],At=Dt!=="function"?"":N.indexOf("set")||typeof $["get"+N.substr(3)]!="function"?N:"get"+N.substr(3),Xt=K!=="get"?K:At?wt?$[At](wt):$[At]():$[N],ie=typeof k=="string"&&k.charAt(1)==="=",le={t:$,p:N,s:Xt,f:Dt==="function",pg:0,n:Y||N,m:ht?typeof ht=="function"?ht:Math.round:0,pr:0,c:ie?parseInt(k.charAt(0)+"1",10)*parseFloat(k.substr(2)):parseFloat(k)-Xt||0},W;if((typeof Xt!="number"||typeof k!="number"&&!ie)&&(wt||isNaN(Xt)||!ie&&isNaN(k)||typeof Xt=="boolean"||typeof k=="boolean"?(le.fp=wt,W=X(Xt,ie?parseFloat(le.s)+le.c+(le.s+"").replace(/[0-9\-\.]/g,""):k,Et||L.defaultStringFilter,le),le={t:W,p:"setRatio",s:0,c:1,f:2,pg:0,n:Y||N,pr:0,m:0}):(le.s=parseFloat(Xt),ie||(le.c=parseFloat(k)-le.s||0))),le.c)return(le._next=this._firstPT)&&(le._next._prev=le),this._firstPT=le,le},Tt=L._internals={isArray:r,isSelector:C,lazyTweens:q,blobDif:X},Vt=L._plugins={},Gt=Tt.tweenLookup={},qt=0,Qt=Tt.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1,yoyoEase:1},ne={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,true:1,false:0},j=E._rootFramesTimeline=new S,J=E._rootTimeline=new S,at=30,xt=Tt.lazyRender=function(){var $=q.length,N;for(it={};--$>-1;)N=q[$],N&&N._lazy!==!1&&(N.render(N._lazy[0],N._lazy[1],!0),N._lazy=!1);q.length=0};J._startTime=o.time,j._startTime=o.frame,J._active=j._active=!0,setTimeout(xt,1),E._updateRoot=L.render=function(){var $,N,K;if(q.length&&xt(),J.render((o.time-J._startTime)*J._timeScale,!1,!1),j.render((o.frame-j._startTime)*j._timeScale,!1,!1),q.length&&xt(),o.frame>=at){at=o.frame+(parseInt(L.autoSleep,10)||120);for(K in Gt){for(N=Gt[K].tweens,$=N.length;--$>-1;)N[$]._gc&&N.splice($,1);N.length===0&&delete Gt[K]}if(K=J._first,(!K||K._paused)&&L.autoSleep&&!j._first&&o._listeners.tick.length===1){for(;K&&K._paused;)K=K._next;K||o.sleep()}}},o.addEventListener("tick",E._updateRoot);var Rt=function($,N,K){var k=$._gsTweenID,Y,ht;if(Gt[k||($._gsTweenID=k="t"+qt++)]||(Gt[k]={target:$,tweens:[]}),N&&(Y=Gt[k].tweens,Y[ht=Y.length]=N,K))for(;--ht>-1;)Y[ht]===N&&Y.splice(ht,1);return Gt[k].tweens},Lt=function($,N,K,k){var Y=$.vars.onOverwrite,ht,wt;return Y&&(ht=Y($,N,K,k)),Y=L.onOverwrite,Y&&(wt=Y($,N,K,k)),ht!==!1&&wt!==!1},te=function($,N,K,k,Y){var ht,wt,Et,Mt;if(k===1||k>=4){for(Mt=Y.length,ht=0;ht<Mt;ht++)if((Et=Y[ht])!==N)Et._gc||Et._kill(null,$,N)&&(wt=!0);else if(k===5)break;return wt}var Dt=N._startTime+e,At=[],Xt=0,ie=N._duration===0,le;for(ht=Y.length;--ht>-1;)(Et=Y[ht])===N||Et._gc||Et._paused||(Et._timeline!==N._timeline?(le=le||zt(N,0,ie),zt(Et,le,ie)===0&&(At[Xt++]=Et)):Et._startTime<=Dt&&Et._startTime+Et.totalDuration()/Et._timeScale>Dt&&((ie||!Et._initted)&&Dt-Et._startTime<=2e-10||(At[Xt++]=Et)));for(ht=Xt;--ht>-1;)if(Et=At[ht],Mt=Et._firstPT,k===2&&Et._kill(K,$,N)&&(wt=!0),k!==2||!Et._firstPT&&Et._initted&&Mt){if(k!==2&&!Lt(Et,N))continue;Et._enabled(!1,!1)&&(wt=!0)}return wt},zt=function($,N,K){for(var k=$._timeline,Y=k._timeScale,ht=$._startTime;k._timeline;){if(ht+=k._startTime,Y*=k._timeScale,k._paused)return-100;k=k._timeline}return ht/=Y,ht>N?ht-N:K&&ht===N||!$._initted&&ht-N<2*e?e:(ht+=$.totalDuration()/$._timeScale/Y)>N+e?0:ht-N-e};f._init=function(){var $=this.vars,N=this._overwrittenProps,K=this._duration,k=!!$.immediateRender,Y=$.ease,ht,wt,Et,Mt,Dt,At;if($.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),Dt={};for(Mt in $.startAt)Dt[Mt]=$.startAt[Mt];if(Dt.data="isStart",Dt.overwrite=!1,Dt.immediateRender=!0,Dt.lazy=k&&$.lazy!==!1,Dt.startAt=Dt.delay=null,Dt.onUpdate=$.onUpdate,Dt.onUpdateParams=$.onUpdateParams,Dt.onUpdateScope=$.onUpdateScope||$.callbackScope||this,this._startAt=L.to(this.target||{},0,Dt),k){if(this._time>0)this._startAt=null;else if(K!==0)return}}else if($.runBackwards&&K!==0)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{this._time!==0&&(k=!1),Et={};for(Mt in $)(!Qt[Mt]||Mt==="autoCSS")&&(Et[Mt]=$[Mt]);if(Et.overwrite=0,Et.data="isFromStart",Et.lazy=k&&$.lazy!==!1,Et.immediateRender=k,this._startAt=L.to(this.target,0,Et),!k)this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null);else if(this._time===0)return}if(this._ease=Y=Y?Y instanceof _?Y:typeof Y=="function"?new _(Y,$.easeParams):y[Y]||L.defaultEase:L.defaultEase,$.easeParams instanceof Array&&Y.config&&(this._ease=Y.config.apply(Y,$.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(At=this._targets.length,ht=0;ht<At;ht++)this._initProps(this._targets[ht],this._propLookup[ht]={},this._siblings[ht],N?N[ht]:null,ht)&&(wt=!0);else wt=this._initProps(this.target,this._propLookup,this._siblings,N,0);if(wt&&L._onPluginEvent("_onInitAllProps",this),N&&(this._firstPT||typeof this.target!="function"&&this._enabled(!1,!1)),$.runBackwards)for(Et=this._firstPT;Et;)Et.s+=Et.c,Et.c=-Et.c,Et=Et._next;this._onUpdate=$.onUpdate,this._initted=!0},f._initProps=function($,N,K,k,Y){var ht,wt,Et,Mt,Dt,At;if($==null)return!1;it[$._gsTweenID]&&xt(),this.vars.css||$.style&&$!==rt&&$.nodeType&&Vt.css&&this.vars.autoCSS!==!1&&F(this.vars,$);for(ht in this.vars)if(At=this.vars[ht],Qt[ht])At&&(At instanceof Array||At.push&&r(At))&&At.join("").indexOf("{self}")!==-1&&(this.vars[ht]=At=this._swapSelfInParams(At,this));else if(Vt[ht]&&(Mt=new Vt[ht])._onInitTween($,this.vars[ht],this,Y)){for(this._firstPT=Dt={_next:this._firstPT,t:Mt,p:"setRatio",s:0,c:1,f:1,n:ht,pg:1,pr:Mt._priority,m:0},wt=Mt._overwriteProps.length;--wt>-1;)N[Mt._overwriteProps[wt]]=this._firstPT;(Mt._priority||Mt._onInitAllProps)&&(Et=!0),(Mt._onDisable||Mt._onEnable)&&(this._notifyPluginsOfEnabled=!0),Dt._next&&(Dt._next._prev=Dt)}else N[ht]=ot.call(this,$,ht,"get",At,ht,0,null,this.vars.stringFilter,Y);return k&&this._kill(k,$)?this._initProps($,N,K,k,Y):this._overwrite>1&&this._firstPT&&K.length>1&&te($,this,N,this._overwrite,K)?(this._kill(N,$),this._initProps($,N,K,k,Y)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(it[$._gsTweenID]=!0),Et)},f.render=function($,N,K){var k=this._time,Y=this._duration,ht=this._rawPrevTime,wt,Et,Mt,Dt;if($>=Y-1e-7&&$>=0)this._totalTime=this._time=Y,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(wt=!0,Et="onComplete",K=K||this._timeline.autoRemoveChildren),Y===0&&(this._initted||!this.vars.lazy||K)&&(this._startTime===this._timeline._duration&&($=0),(ht<0||$<=0&&$>=-1e-7||ht===e&&this.data!=="isPause")&&ht!==$&&(K=!0,ht>e&&(Et="onReverseComplete")),this._rawPrevTime=Dt=!N||$||ht===$?$:e);else if($<1e-7)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(k!==0||Y===0&&ht>0)&&(Et="onReverseComplete",wt=this._reversed),$<0&&(this._active=!1,Y===0&&(this._initted||!this.vars.lazy||K)&&(ht>=0&&!(ht===e&&this.data==="isPause")&&(K=!0),this._rawPrevTime=Dt=!N||$||ht===$?$:e)),(!this._initted||this._startAt&&this._startAt.progress())&&(K=!0);else if(this._totalTime=this._time=$,this._easeType){var At=$/Y,Xt=this._easeType,ie=this._easePower;(Xt===1||Xt===3&&At>=.5)&&(At=1-At),Xt===3&&(At*=2),ie===1?At*=At:ie===2?At*=At*At:ie===3?At*=At*At*At:ie===4&&(At*=At*At*At*At),Xt===1?this.ratio=1-At:Xt===2?this.ratio=At:$/Y<.5?this.ratio=At/2:this.ratio=1-At/2}else this.ratio=this._ease.getRatio($/Y);if(!(this._time===k&&!K)){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!K&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)){this._time=this._totalTime=k,this._rawPrevTime=ht,q.push(this),this._lazy=[$,N];return}this._time&&!wt?this.ratio=this._ease.getRatio(this._time/Y):wt&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(this._time===0?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==k&&$>=0&&(this._active=!0),k===0&&(this._startAt&&($>=0?this._startAt.render($,!0,K):Et||(Et="_dummyGS")),this.vars.onStart&&(this._time!==0||Y===0)&&(N||this._callback("onStart"))),Mt=this._firstPT;Mt;)Mt.f?Mt.t[Mt.p](Mt.c*this.ratio+Mt.s):Mt.t[Mt.p]=Mt.c*this.ratio+Mt.s,Mt=Mt._next;this._onUpdate&&($<0&&this._startAt&&$!==-1e-4&&this._startAt.render($,!0,K),N||(this._time!==k||wt||K)&&this._callback("onUpdate")),Et&&(!this._gc||K)&&($<0&&this._startAt&&!this._onUpdate&&$!==-1e-4&&this._startAt.render($,!0,K),wt&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!N&&this.vars[Et]&&this._callback(Et),Y===0&&this._rawPrevTime===e&&Dt!==e&&(this._rawPrevTime=0))}},f._kill=function($,N,K){if($==="all"&&($=null),$==null&&(N==null||N===this.target))return this._lazy=!1,this._enabled(!1,!1);N=typeof N!="string"?N||this._targets||this.target:L.selector(N)||N;var k=K&&this._time&&K._startTime===this._startTime&&this._timeline===K._timeline,Y=this._firstPT,ht,wt,Et,Mt,Dt,At,Xt,ie,le;if((r(N)||C(N))&&typeof N[0]!="number")for(ht=N.length;--ht>-1;)this._kill($,N[ht],K)&&(At=!0);else{if(this._targets){for(ht=this._targets.length;--ht>-1;)if(N===this._targets[ht]){Dt=this._propLookup[ht]||{},this._overwrittenProps=this._overwrittenProps||[],wt=this._overwrittenProps[ht]=$?this._overwrittenProps[ht]||{}:"all";break}}else{if(N!==this.target)return!1;Dt=this._propLookup,wt=this._overwrittenProps=$?this._overwrittenProps||{}:"all"}if(Dt){if(Xt=$||Dt,ie=$!==wt&&wt!=="all"&&$!==Dt&&(typeof $!="object"||!$._tempKill),K&&(L.onOverwrite||this.vars.onOverwrite)){for(Et in Xt)Dt[Et]&&(le||(le=[]),le.push(Et));if((le||!$)&&!Lt(this,K,N,le))return!1}for(Et in Xt)(Mt=Dt[Et])&&(k&&(Mt.f?Mt.t[Mt.p](Mt.s):Mt.t[Mt.p]=Mt.s,At=!0),Mt.pg&&Mt.t._kill(Xt)&&(At=!0),(!Mt.pg||Mt.t._overwriteProps.length===0)&&(Mt._prev?Mt._prev._next=Mt._next:Mt===this._firstPT&&(this._firstPT=Mt._next),Mt._next&&(Mt._next._prev=Mt._prev),Mt._next=Mt._prev=null),delete Dt[Et]),ie&&(wt[Et]=1);!this._firstPT&&this._initted&&Y&&this._enabled(!1,!1)}}return At},f.invalidate=function(){return this._notifyPluginsOfEnabled&&L._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],E.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-e,this.render(Math.min(0,-this._delay))),this},f._enabled=function($,N){if(c||o.wake(),$&&this._gc){var K=this._targets,k;if(K)for(k=K.length;--k>-1;)this._siblings[k]=Rt(K[k],this,!0);else this._siblings=Rt(this.target,this,!0)}return E.prototype._enabled.call(this,$,N),this._notifyPluginsOfEnabled&&this._firstPT?L._onPluginEvent($?"_onEnable":"_onDisable",this):!1},L.to=function($,N,K){return new L($,N,K)},L.from=function($,N,K){return K.runBackwards=!0,K.immediateRender=K.immediateRender!=!1,new L($,N,K)},L.fromTo=function($,N,K,k){return k.startAt=K,k.immediateRender=k.immediateRender!=!1&&K.immediateRender!=!1,new L($,N,k)},L.delayedCall=function($,N,K,k,Y){return new L(N,0,{delay:$,onComplete:N,onCompleteParams:K,callbackScope:k,onReverseComplete:N,onReverseCompleteParams:K,immediateRender:!1,lazy:!1,useFrames:Y,overwrite:0})},L.set=function($,N){return new L($,0,N)},L.getTweensOf=function($,N){if($==null)return[];$=typeof $!="string"?$:L.selector($)||$;var K,k,Y,ht;if((r($)||C($))&&typeof $[0]!="number"){for(K=$.length,k=[];--K>-1;)k=k.concat(L.getTweensOf($[K],N));for(K=k.length;--K>-1;)for(ht=k[K],Y=K;--Y>-1;)ht===k[Y]&&k.splice(K,1)}else if($._gsTweenID)for(k=Rt($).concat(),K=k.length;--K>-1;)(k[K]._gc||N&&!k[K].isActive())&&k.splice(K,1);return k||[]},L.killTweensOf=L.killDelayedCallsTo=function($,N,K){typeof N=="object"&&(K=N,N=!1);for(var k=L.getTweensOf($,N),Y=k.length;--Y>-1;)k[Y]._kill(K,$)};var ee=m("plugins.TweenPlugin",function($,N){this._overwriteProps=($||"").split(","),this._propName=this._overwriteProps[0],this._priority=N||0,this._super=ee.prototype},!0);if(f=ee.prototype,ee.version="1.19.0",ee.API=2,f._firstPT=null,f._addTween=ot,f.setRatio=_t,f._kill=function($){var N=this._overwriteProps,K=this._firstPT,k;if($[this._propName]!=null)this._overwriteProps=[];else for(k=N.length;--k>-1;)$[N[k]]!=null&&N.splice(k,1);for(;K;)$[K.n]!=null&&(K._next&&(K._next._prev=K._prev),K._prev?(K._prev._next=K._next,K._prev=null):this._firstPT===K&&(this._firstPT=K._next)),K=K._next;return!1},f._mod=f._roundProps=function($){for(var N=this._firstPT,K;N;)K=$[this._propName]||N.n!=null&&$[N.n.split(this._propName+"_").join("")],K&&typeof K=="function"&&(N.f===2?N.t._applyPT.m=K:N.m=K),N=N._next},L._onPluginEvent=function($,N){var K=N._firstPT,k,Y,ht,wt,Et;if($==="_onInitAllProps"){for(;K;){for(Et=K._next,Y=ht;Y&&Y.pr>K.pr;)Y=Y._next;(K._prev=Y?Y._prev:wt)?K._prev._next=K:ht=K,(K._next=Y)?Y._prev=K:wt=K,K=Et}K=N._firstPT=ht}for(;K;)K.pg&&typeof K.t[$]=="function"&&K.t[$]()&&(k=!0),K=K._next;return k},ee.activate=function($){for(var N=$.length;--N>-1;)$[N].API===ee.API&&(Vt[new $[N]()._propName]=$[N]);return!0},u.plugin=function($){if(!$||!$.propName||!$.init||!$.API)throw"illegal plugin definition.";var N=$.propName,K=$.priority||0,k=$.overwriteProps,Y={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},ht=m("plugins."+N.charAt(0).toUpperCase()+N.substr(1)+"Plugin",function(){ee.call(this,N,K),this._overwriteProps=k||[]},$.global===!0),wt=ht.prototype=new ee(N),Et;wt.constructor=ht,ht.API=$.API;for(Et in Y)typeof $[Et]=="function"&&(wt[Y[Et]]=$[Et]);return ht.version=$.version,ee.activate([ht]),ht},s=rt._gsQueue,s){for(a=0;a<s.length;a++)s[a]();for(f in d)d[f].func||rt.console.log("GSAP encountered missing dependency: "+f)}return c=!1,L}(Ke,"TweenLite"),Xe=Ke.GreenSockGlobals,ds=Xe.com.greensock,Pi=ds.core.SimpleTimeline,fi=ds.core.Animation,oi=Xe.Ease,ps=Xe.Linear,ms=Xe.Power1,gs=Xe.Power2,_s=Xe.Power3,ys=Xe.Power4,Hi=Xe.TweenPlugin,ho=ds.events.EventDispatcher});var Ns,Ds=Ei(()=>{wi();Ke._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(){var rt=function(a){var f=[],o=a.length,c;for(c=0;c!==o;f.push(a[c++]));return f},vt=function(a,f,o){var c=a.cycle,d,h;for(d in c)h=c[d],a[d]=typeof h=="function"?h(o,f[o]):h[o%h.length];delete a.cycle},B=function(a,f,o){Ce.call(this,a,f,o),this._cycle=0,this._yoyo=this.vars.yoyo===!0||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._repeat&&this._uncache(!0),this.render=B.prototype.render},D=1e-10,p=Ce._internals,l=p.isSelector,n=p.isArray,e=B.prototype=Ce.to({},.1,{}),i=[];B.version="2.0.2",e.constructor=B,e.kill()._gc=!1,B.killTweensOf=B.killDelayedCallsTo=Ce.killTweensOf,B.getTweensOf=Ce.getTweensOf,B.lagSmoothing=Ce.lagSmoothing,B.ticker=Ce.ticker,B.render=Ce.render,e.invalidate=function(){return this._yoyo=this.vars.yoyo===!0||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._yoyoEase=null,this._uncache(!0),Ce.prototype.invalidate.call(this)},e.updateTo=function(a,f){var o=this.ratio,c=this.vars.immediateRender||a.immediateRender,d;f&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(d in a)this.vars[d]=a[d];if(this._initted||c){if(f)this._initted=!1,c&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&Ce._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var h=this._totalTime;this.render(0,!0,!1),this._initted=!1,this.render(h,!0,!1)}else if(this._initted=!1,this._init(),this._time>0||c)for(var u=1/(1-o),m=this._firstPT,g;m;)g=m.s+m.c,m.c*=u,m.s=g-m.c,m=m._next}return this},e.render=function(a,f,o){this._initted||this._duration===0&&this.vars.repeat&&this.invalidate();var c=this._dirty?this.totalDuration():this._totalDuration,d=this._time,h=this._totalTime,u=this._cycle,m=this._duration,g=this._rawPrevTime,_,y,v,b,R,M,P,T,E;if(a>=c-1e-7&&a>=0?(this._totalTime=c,this._cycle=this._repeat,this._yoyo&&this._cycle&1?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=m,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(_=!0,y="onComplete",o=o||this._timeline.autoRemoveChildren),m===0&&(this._initted||!this.vars.lazy||o)&&(this._startTime===this._timeline._duration&&(a=0),(g<0||a<=0&&a>=-1e-7||g===D&&this.data!=="isPause")&&g!==a&&(o=!0,g>D&&(y="onReverseComplete")),this._rawPrevTime=T=!f||a||g===a?a:D)):a<1e-7?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(h!==0||m===0&&g>0)&&(y="onReverseComplete",_=this._reversed),a<0&&(this._active=!1,m===0&&(this._initted||!this.vars.lazy||o)&&(g>=0&&(o=!0),this._rawPrevTime=T=!f||a||g===a?a:D)),this._initted||(o=!0)):(this._totalTime=this._time=a,this._repeat!==0&&(b=m+this._repeatDelay,this._cycle=this._totalTime/b>>0,this._cycle!==0&&this._cycle===this._totalTime/b&&h<=a&&this._cycle--,this._time=this._totalTime-this._cycle*b,this._yoyo&&this._cycle&1&&(this._time=m-this._time,E=this._yoyoEase||this.vars.yoyoEase,E&&(this._yoyoEase||(E===!0&&!this._initted?(E=this.vars.ease,this._yoyoEase=E=E?E instanceof oi?E:typeof E=="function"?new oi(E,this.vars.easeParams):oi.map[E]||Ce.defaultEase:Ce.defaultEase):this._yoyoEase=E=E===!0?this._ease:E instanceof oi?E:oi.map[E]),this.ratio=E?1-E.getRatio((m-this._time)/m):0)),this._time>m?this._time=m:this._time<0&&(this._time=0)),this._easeType&&!E?(R=this._time/m,M=this._easeType,P=this._easePower,(M===1||M===3&&R>=.5)&&(R=1-R),M===3&&(R*=2),P===1?R*=R:P===2?R*=R*R:P===3?R*=R*R*R:P===4&&(R*=R*R*R*R),M===1?this.ratio=1-R:M===2?this.ratio=R:this._time/m<.5?this.ratio=R/2:this.ratio=1-R/2):E||(this.ratio=this._ease.getRatio(this._time/m))),d===this._time&&!o&&u===this._cycle){h!==this._totalTime&&this._onUpdate&&(f||this._callback("onUpdate"));return}else if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!o&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)){this._time=d,this._totalTime=h,this._rawPrevTime=g,this._cycle=u,p.lazyTweens.push(this),this._lazy=[a,f];return}this._time&&!_&&!E?this.ratio=this._ease.getRatio(this._time/m):_&&this._ease._calcEnd&&!E&&(this.ratio=this._ease.getRatio(this._time===0?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==d&&a>=0&&(this._active=!0),h===0&&(this._initted===2&&a>0&&this._init(),this._startAt&&(a>=0?this._startAt.render(a,!0,o):y||(y="_dummyGS")),this.vars.onStart&&(this._totalTime!==0||m===0)&&(f||this._callback("onStart"))),v=this._firstPT;v;)v.f?v.t[v.p](v.c*this.ratio+v.s):v.t[v.p]=v.c*this.ratio+v.s,v=v._next;this._onUpdate&&(a<0&&this._startAt&&this._startTime&&this._startAt.render(a,!0,o),f||(this._totalTime!==h||y)&&this._callback("onUpdate")),this._cycle!==u&&(f||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),y&&(!this._gc||o)&&(a<0&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(a,!0,o),_&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!f&&this.vars[y]&&this._callback(y),m===0&&this._rawPrevTime===D&&T!==D&&(this._rawPrevTime=0))},B.to=function(a,f,o){return new B(a,f,o)},B.from=function(a,f,o){return o.runBackwards=!0,o.immediateRender=o.immediateRender!=!1,new B(a,f,o)},B.fromTo=function(a,f,o,c){return c.startAt=o,c.immediateRender=c.immediateRender!=!1&&o.immediateRender!=!1,new B(a,f,c)},B.staggerTo=B.allTo=function(a,f,o,c,d,h,u){c=c||0;var m=0,g=[],_=function(){o.onComplete&&o.onComplete.apply(o.onCompleteScope||this,arguments),d.apply(u||o.callbackScope||this,h||i)},y=o.cycle,v=o.startAt&&o.startAt.cycle,b,R,M,P;for(n(a)||(typeof a=="string"&&(a=Ce.selector(a)||a),l(a)&&(a=rt(a))),a=a||[],c<0&&(a=rt(a),a.reverse(),c*=-1),b=a.length-1,M=0;M<=b;M++){R={};for(P in o)R[P]=o[P];if(y&&(vt(R,a,M),R.duration!=null&&(f=R.duration,delete R.duration)),v){v=R.startAt={};for(P in o.startAt)v[P]=o.startAt[P];vt(R.startAt,a,M)}R.delay=m+(R.delay||0),M===b&&d&&(R.onComplete=_),g[M]=new B(a[M],f,R),m+=c}return g},B.staggerFrom=B.allFrom=function(a,f,o,c,d,h,u){return o.runBackwards=!0,o.immediateRender=o.immediateRender!=!1,B.staggerTo(a,f,o,c,d,h,u)},B.staggerFromTo=B.allFromTo=function(a,f,o,c,d,h,u,m){return c.startAt=o,c.immediateRender=c.immediateRender!=!1&&o.immediateRender!=!1,B.staggerTo(a,f,c,d,h,u,m)},B.delayedCall=function(a,f,o,c,d){return new B(f,0,{delay:a,onComplete:f,onCompleteParams:o,callbackScope:c,onReverseComplete:f,onReverseCompleteParams:o,immediateRender:!1,useFrames:d,overwrite:0})},B.set=function(a,f){return new B(a,0,f)},B.isTweening=function(a){return Ce.getTweensOf(a,!0).length>0};var t=function(a,f){for(var o=[],c=0,d=a._first;d;)d instanceof Ce?o[c++]=d:(f&&(o[c++]=d),o=o.concat(t(d,f)),c=o.length),d=d._next;return o},r=B.getAllTweens=function(a){return t(fi._rootTimeline,a).concat(t(fi._rootFramesTimeline,a))};B.killAll=function(a,f,o,c){f==null&&(f=!0),o==null&&(o=!0);var d=r(c!=!1),h=d.length,u=f&&o&&c,m,g,_;for(_=0;_<h;_++)g=d[_],(u||g instanceof Pi||(m=g.target===g.vars.onComplete)&&o||f&&!m)&&(a?g.totalTime(g._reversed?0:g.totalDuration()):g._enabled(!1,!1))},B.killChildTweensOf=function(a,f){if(a!=null){var o=p.tweenLookup,c,d,h,u,m;if(typeof a=="string"&&(a=Ce.selector(a)||a),l(a)&&(a=rt(a)),n(a)){for(u=a.length;--u>-1;)B.killChildTweensOf(a[u],f);return}c=[];for(h in o)for(d=o[h].target.parentNode;d;)d===a&&(c=c.concat(o[h].tweens)),d=d.parentNode;for(m=c.length,u=0;u<m;u++)f&&c[u].totalTime(c[u].totalDuration()),c[u]._enabled(!1,!1)}};var s=function(a,f,o,c){f=f!==!1,o=o!==!1,c=c!==!1;for(var d=r(c),h=f&&o&&c,u=d.length,m,g;--u>-1;)g=d[u],(h||g instanceof Pi||(m=g.target===g.vars.onComplete)&&o||f&&!m)&&g.paused(a)};return B.pauseAll=function(a,f,o){s(!0,a,f,o)},B.resumeAll=function(a,f,o){s(!1,a,f,o)},B.globalTimeScale=function(a){var f=fi._rootTimeline,o=Ce.ticker.time;return arguments.length?(a=a||D,f._startTime=o-(o-f._startTime)*f._timeScale/a,f=fi._rootFramesTimeline,o=Ce.ticker.frame,f._startTime=o-(o-f._startTime)*f._timeScale/a,f._timeScale=fi._rootTimeline._timeScale=a,a):f._timeScale},e.progress=function(a,f){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&this._cycle&1?1-a:a)+this._cycle*(this._duration+this._repeatDelay),f):this._time/this.duration()},e.totalProgress=function(a,f){return arguments.length?this.totalTime(this.totalDuration()*a,f):this._totalTime/this.totalDuration()},e.time=function(a,f){return arguments.length?(this._dirty&&this.totalDuration(),a>this._duration&&(a=this._duration),this._yoyo&&this._cycle&1?a=this._duration-a+this._cycle*(this._duration+this._repeatDelay):this._repeat!==0&&(a+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(a,f)):this._time},e.duration=function(a){return arguments.length?fi.prototype.duration.call(this,a):this._duration},e.totalDuration=function(a){return arguments.length?this._repeat===-1?this:this.duration((a-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},e.repeat=function(a){return arguments.length?(this._repeat=a,this._uncache(!0)):this._repeat},e.repeatDelay=function(a){return arguments.length?(this._repeatDelay=a,this._uncache(!0)):this._repeatDelay},e.yoyo=function(a){return arguments.length?(this._yoyo=a,this):this._yoyo},B},!0);Ns=Xe.TweenMax});var ks,Fs=Ei(()=>{wi();Ke._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(){var rt=function(){Hi.call(this,"css"),this._overwriteProps.length=0,this.setRatio=rt.prototype.setRatio},vt=Ke._gsDefine.globals,B,D,p,l,n={},e=rt.prototype=new Hi("css");e.constructor=rt,rt.version="2.0.2",rt.API=2,rt.defaultTransformPerspective=0,rt.defaultSkewType="compensated",rt.defaultSmoothOrigin=!0,e="px",rt.suffixMap={top:e,right:e,bottom:e,left:e,width:e,height:e,fontSize:e,padding:e,margin:e,perspective:e,lineHeight:""};var i=/(?:\-|\.|\b)(\d|\.|e\-)+/g,t=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,r=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,s=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,a=/(?:\d|\-|\+|=|#|\.)*/g,f=/opacity *= *([^)]*)/i,o=/opacity:([^;]*)/i,c=/alpha\(opacity *=.+?\)/i,d=/^(rgb|hsl)/,h=/([A-Z])/g,u=/-([a-z])/gi,m=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,g=function(et,Z){return Z.toUpperCase()},_=/(?:Left|Right|Width)/i,y=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,v=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,b=/,(?=[^\)]*(?:\(|$))/gi,R=/[\s,\(]/i,M=Math.PI/180,P=180/Math.PI,T={},E={style:{}},x=Ke.document||{createElement:function(){return E}},S=function(et,Z){return x.createElementNS?x.createElementNS(Z||"http://www.w3.org/1999/xhtml",et):x.createElement(et)},L=S("div"),C=S("img"),F=rt._internals={_specialProps:n},q=(Ke.navigator||{}).userAgent||"",it,st,pt,_t,X,ot,Tt=function(){var et=q.indexOf("Android"),Z=S("a");return pt=q.indexOf("Safari")!==-1&&q.indexOf("Chrome")===-1&&(et===-1||parseFloat(q.substr(et+8,2))>3),X=pt&&parseFloat(q.substr(q.indexOf("Version/")+8,2))<6,_t=q.indexOf("Firefox")!==-1,(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(q)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(q))&&(ot=parseFloat(RegExp.$1)),Z?(Z.style.cssText="top:1px;opacity:.55;",/^0.55/.test(Z.style.opacity)):!1}(),Vt=function(et){return f.test(typeof et=="string"?et:(et.currentStyle?et.currentStyle.filter:et.style.filter)||"")?parseFloat(RegExp.$1)/100:1},Gt=function(et){Ke.console&&console.log(et)},qt,Qt,ne="",j="",J=function(et,Z){Z=Z||L;var O=Z.style,I,V;if(O[et]!==void 0)return et;for(et=et.charAt(0).toUpperCase()+et.substr(1),I=["O","Moz","ms","Ms","Webkit"],V=5;--V>-1&&O[I[V]+et]===void 0;);return V>=0?(j=V===3?"ms":I[V],ne="-"+j.toLowerCase()+"-",j+et):null},at=(typeof window<"u"?window:x.defaultView||{getComputedStyle:function(){}}).getComputedStyle,xt=rt.getStyle=function(et,Z,O,I,V){var H;return!Tt&&Z==="opacity"?Vt(et):(!I&&et.style[Z]?H=et.style[Z]:(O=O||at(et))?H=O[Z]||O.getPropertyValue(Z)||O.getPropertyValue(Z.replace(h,"-$1").toLowerCase()):et.currentStyle&&(H=et.currentStyle[Z]),V!=null&&(!H||H==="none"||H==="auto"||H==="auto auto")?V:H)},Rt=F.convertToPixels=function(et,Z,O,I,V){if(I==="px"||!I&&Z!=="lineHeight")return O;if(I==="auto"||!O)return 0;var H=_.test(Z),G=et,Q=L.style,tt=O<0,ut=O===1,dt,Pt,bt;if(tt&&(O=-O),ut&&(O*=100),Z==="lineHeight"&&!I)Pt=at(et).lineHeight,et.style.lineHeight=O,dt=parseFloat(at(et).lineHeight),et.style.lineHeight=Pt;else if(I==="%"&&Z.indexOf("border")!==-1)dt=O/100*(H?et.clientWidth:et.clientHeight);else{if(Q.cssText="border:0 solid red;position:"+xt(et,"position")+";line-height:0;",I==="%"||!G.appendChild||I.charAt(0)==="v"||I==="rem"){if(G=et.parentNode||x.body,xt(G,"display").indexOf("flex")!==-1&&(Q.position="absolute"),Pt=G._gsCache,bt=Ce.ticker.frame,Pt&&H&&Pt.time===bt)return Pt.width*O/100;Q[H?"width":"height"]=O+I}else Q[H?"borderLeftWidth":"borderTopWidth"]=O+I;G.appendChild(L),dt=parseFloat(L[H?"offsetWidth":"offsetHeight"]),G.removeChild(L),H&&I==="%"&&rt.cacheWidths!==!1&&(Pt=G._gsCache=G._gsCache||{},Pt.time=bt,Pt.width=dt/O*100),dt===0&&!V&&(dt=Rt(et,Z,O,I,!0))}return ut&&(dt/=100),tt?-dt:dt},Lt=F.calculateOffset=function(et,Z,O){if(xt(et,"position",O)!=="absolute")return 0;var I=Z==="left"?"Left":"Top",V=xt(et,"margin"+I,O);return et["offset"+I]-(Rt(et,Z,parseFloat(V),V.replace(a,""))||0)},te=function(et,Z){var O={},I,V,H;if(Z=Z||at(et,null))if(I=Z.length)for(;--I>-1;)H=Z[I],(H.indexOf("-transform")===-1||Ue===H)&&(O[H.replace(u,g)]=Z.getPropertyValue(H));else for(I in Z)(I.indexOf("Transform")===-1||$t===I)&&(O[I]=Z[I]);else if(Z=et.currentStyle||et.style)for(I in Z)typeof I=="string"&&O[I]===void 0&&(O[I.replace(u,g)]=Z[I]);return Tt||(O.opacity=Vt(et)),V=je(et,Z,!1),O.rotation=V.rotation,O.skewX=V.skewX,O.scaleX=V.scaleX,O.scaleY=V.scaleY,O.x=V.x,O.y=V.y,pe&&(O.z=V.z,O.rotationX=V.rotationX,O.rotationY=V.rotationY,O.scaleZ=V.scaleZ),O.filters&&delete O.filters,O},zt=function(et,Z,O,I,V){var H={},G=et.style,Q,tt,ut;for(tt in O)tt!=="cssText"&&tt!=="length"&&isNaN(tt)&&(Z[tt]!==(Q=O[tt])||V&&V[tt])&&tt.indexOf("Origin")===-1&&(typeof Q=="number"||typeof Q=="string")&&(H[tt]=Q==="auto"&&(tt==="left"||tt==="top")?Lt(et,tt):(Q===""||Q==="auto"||Q==="none")&&typeof Z[tt]=="string"&&Z[tt].replace(s,"")!==""?0:Q,G[tt]!==void 0&&(ut=new W(G,tt,G[tt],ut)));if(I)for(tt in I)tt!=="className"&&(H[tt]=I[tt]);return{difs:H,firstMPT:ut}},ee={width:["Left","Right"],height:["Top","Bottom"]},$=["marginLeft","marginRight","marginTop","marginBottom"],N=function(et,Z,O){if((et.nodeName+"").toLowerCase()==="svg")return(O||at(et))[Z]||0;if(et.getCTM&&Je(et))return et.getBBox()[Z]||0;var I=parseFloat(Z==="width"?et.offsetWidth:et.offsetHeight),V=ee[Z],H=V.length;for(O=O||at(et,null);--H>-1;)I-=parseFloat(xt(et,"padding"+V[H],O,!0))||0,I-=parseFloat(xt(et,"border"+V[H]+"Width",O,!0))||0;return I},K=function(et,Z){if(et==="contain"||et==="auto"||et==="auto auto")return et+" ";(et==null||et==="")&&(et="0 0");var O=et.split(" "),I=et.indexOf("left")!==-1?"0%":et.indexOf("right")!==-1?"100%":O[0],V=et.indexOf("top")!==-1?"0%":et.indexOf("bottom")!==-1?"100%":O[1],H;if(O.length>3&&!Z){for(O=et.split(", ").join(",").split(","),et=[],H=0;H<O.length;H++)et.push(K(O[H]));return et.join(",")}return V==null?V=I==="center"?"50%":"0":V==="center"&&(V="50%"),(I==="center"||isNaN(parseFloat(I))&&(I+"").indexOf("=")===-1)&&(I="50%"),et=I+" "+V+(O.length>2?" "+O[2]:""),Z&&(Z.oxp=I.indexOf("%")!==-1,Z.oyp=V.indexOf("%")!==-1,Z.oxr=I.charAt(1)==="=",Z.oyr=V.charAt(1)==="=",Z.ox=parseFloat(I.replace(s,"")),Z.oy=parseFloat(V.replace(s,"")),Z.v=et),Z||et},k=function(et,Z){return typeof et=="function"&&(et=et(Qt,qt)),typeof et=="string"&&et.charAt(1)==="="?parseInt(et.charAt(0)+"1",10)*parseFloat(et.substr(2)):parseFloat(et)-parseFloat(Z)||0},Y=function(et,Z){typeof et=="function"&&(et=et(Qt,qt));var O=typeof et=="string"&&et.charAt(1)==="=";return typeof et=="string"&&et.charAt(et.length-2)==="v"&&(et=(O?et.substr(0,2):0)+window["inner"+(et.substr(-2)==="vh"?"Height":"Width")]*(parseFloat(O?et.substr(2):et)/100)),et==null?Z:O?parseInt(et.charAt(0)+"1",10)*parseFloat(et.substr(2))+Z:parseFloat(et)||0},ht=function(et,Z,O,I){var V=1e-6,H,G,Q,tt,ut;return typeof et=="function"&&(et=et(Qt,qt)),et==null?tt=Z:typeof et=="number"?tt=et:(H=360,G=et.split("_"),ut=et.charAt(1)==="=",Q=(ut?parseInt(et.charAt(0)+"1",10)*parseFloat(G[0].substr(2)):parseFloat(G[0]))*(et.indexOf("rad")===-1?1:P)-(ut?0:Z),G.length&&(I&&(I[O]=Z+Q),et.indexOf("short")!==-1&&(Q=Q%H,Q!==Q%(H/2)&&(Q=Q<0?Q+H:Q-H)),et.indexOf("_cw")!==-1&&Q<0?Q=(Q+H*9999999999)%H-(Q/H|0)*H:et.indexOf("ccw")!==-1&&Q>0&&(Q=(Q-H*9999999999)%H-(Q/H|0)*H)),tt=Z+Q),tt<V&&tt>-V&&(tt=0),tt},wt={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},Et=function(et,Z,O){return et=et<0?et+1:et>1?et-1:et,(et*6<1?Z+(O-Z)*et*6:et<.5?O:et*3<2?Z+(O-Z)*(2/3-et)*6:Z)*255+.5|0},Mt=rt.parseColor=function(et,Z){var O,I,V,H,G,Q,tt,ut,dt,Pt,bt;if(!et)O=wt.black;else if(typeof et=="number")O=[et>>16,et>>8&255,et&255];else{if(et.charAt(et.length-1)===","&&(et=et.substr(0,et.length-1)),wt[et])O=wt[et];else if(et.charAt(0)==="#")et.length===4&&(I=et.charAt(1),V=et.charAt(2),H=et.charAt(3),et="#"+I+I+V+V+H+H),et=parseInt(et.substr(1),16),O=[et>>16,et>>8&255,et&255];else if(et.substr(0,3)==="hsl"){if(O=bt=et.match(i),!Z)G=Number(O[0])%360/360,Q=Number(O[1])/100,tt=Number(O[2])/100,V=tt<=.5?tt*(Q+1):tt+Q-tt*Q,I=tt*2-V,O.length>3&&(O[3]=Number(O[3])),O[0]=Et(G+1/3,I,V),O[1]=Et(G,I,V),O[2]=Et(G-1/3,I,V);else if(et.indexOf("=")!==-1)return et.match(t)}else O=et.match(i)||wt.transparent;O[0]=Number(O[0]),O[1]=Number(O[1]),O[2]=Number(O[2]),O.length>3&&(O[3]=Number(O[3]))}return Z&&!bt&&(I=O[0]/255,V=O[1]/255,H=O[2]/255,ut=Math.max(I,V,H),dt=Math.min(I,V,H),tt=(ut+dt)/2,ut===dt?G=Q=0:(Pt=ut-dt,Q=tt>.5?Pt/(2-ut-dt):Pt/(ut+dt),G=ut===I?(V-H)/Pt+(V<H?6:0):ut===V?(H-I)/Pt+2:(I-V)/Pt+4,G*=60),O[0]=G+.5|0,O[1]=Q*100+.5|0,O[2]=tt*100+.5|0),O},Dt=function(et,Z){var O=et.match(At)||[],I=0,V="",H,G,Q;if(!O.length)return et;for(H=0;H<O.length;H++)G=O[H],Q=et.substr(I,et.indexOf(G,I)-I),I+=Q.length+G.length,G=Mt(G,Z),G.length===3&&G.push(1),V+=Q+(Z?"hsla("+G[0]+","+G[1]+"%,"+G[2]+"%,"+G[3]:"rgba("+G.join(","))+")";return V+et.substr(I)},At="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(e in wt)At+="|"+e+"\\b";At=new RegExp(At+")","gi"),rt.colorStringFilter=function(et){var Z=et[0]+" "+et[1],O;At.test(Z)&&(O=Z.indexOf("hsl(")!==-1||Z.indexOf("hsla(")!==-1,et[0]=Dt(et[0],O),et[1]=Dt(et[1],O)),At.lastIndex=0},Ce.defaultStringFilter||(Ce.defaultStringFilter=rt.colorStringFilter);var Xt=function(et,Z,O,I){if(et==null)return function(bt){return bt};var V=Z?(et.match(At)||[""])[0]:"",H=et.split(V).join("").match(r)||[],G=et.substr(0,et.indexOf(H[0])),Q=et.charAt(et.length-1)===")"?")":"",tt=et.indexOf(" ")!==-1?" ":",",ut=H.length,dt=ut>0?H[0].replace(i,""):"",Pt;return ut?Z?(Pt=function(bt){var Ct,kt,Ot,Wt;if(typeof bt=="number")bt+=dt;else if(I&&b.test(bt)){for(Wt=bt.replace(b,"|").split("|"),Ot=0;Ot<Wt.length;Ot++)Wt[Ot]=Pt(Wt[Ot]);return Wt.join(",")}if(Ct=(bt.match(At)||[V])[0],kt=bt.split(Ct).join("").match(r)||[],Ot=kt.length,ut>Ot--)for(;++Ot<ut;)kt[Ot]=O?kt[(Ot-1)/2|0]:H[Ot];return G+kt.join(tt)+tt+Ct+Q+(bt.indexOf("inset")!==-1?" inset":"")},Pt):(Pt=function(bt){var Ct,kt,Ot;if(typeof bt=="number")bt+=dt;else if(I&&b.test(bt)){for(kt=bt.replace(b,"|").split("|"),Ot=0;Ot<kt.length;Ot++)kt[Ot]=Pt(kt[Ot]);return kt.join(",")}if(Ct=bt.match(r)||[],Ot=Ct.length,ut>Ot--)for(;++Ot<ut;)Ct[Ot]=O?Ct[(Ot-1)/2|0]:H[Ot];return G+Ct.join(tt)+Q},Pt):function(bt){return bt}},ie=function(et){return et=et.split(","),function(Z,O,I,V,H,G,Q){var tt=(O+"").split(" "),ut;for(Q={},ut=0;ut<4;ut++)Q[et[ut]]=tt[ut]=tt[ut]||tt[(ut-1)/2>>0];return V.parse(Z,Q,H,G)}},le=F._setPluginRatio=function(et){this.plugin.setRatio(et);for(var Z=this.data,O=Z.proxy,I=Z.firstMPT,V=1e-6,H,G,Q,tt,ut;I;)H=O[I.v],I.r?H=I.r(H):H<V&&H>-V&&(H=0),I.t[I.p]=H,I=I._next;if(Z.autoRotate&&(Z.autoRotate.rotation=Z.mod?Z.mod.call(this._tween,O.rotation,this.t,this._tween):O.rotation),et===1||et===0)for(I=Z.firstMPT,ut=et===1?"e":"b";I;){if(G=I.t,!G.type)G[ut]=G.s+G.xs0;else if(G.type===1){for(tt=G.xs0+G.s+G.xs1,Q=1;Q<G.l;Q++)tt+=G["xn"+Q]+G["xs"+(Q+1)];G[ut]=tt}I=I._next}},W=function(et,Z,O,I,V){this.t=et,this.p=Z,this.v=O,this.r=V,I&&(I._prev=this,this._next=I)},ct=F._parseToProxy=function(et,Z,O,I,V,H){var G=I,Q={},tt={},ut=O._transform,dt=T,Pt,bt,Ct,kt,Ot;for(O._transform=null,T=Z,I=Ot=O.parse(et,Z,I,V),T=dt,H&&(O._transform=ut,G&&(G._prev=null,G._prev&&(G._prev._next=null)));I&&I!==G;){if(I.type<=1&&(bt=I.p,tt[bt]=I.s+I.c,Q[bt]=I.s,H||(kt=new W(I,"s",bt,kt,I.r),I.c=0),I.type===1))for(Pt=I.l;--Pt>0;)Ct="xn"+Pt,bt=I.p+"_"+Ct,tt[bt]=I.data[Ct],Q[bt]=I[Ct],H||(kt=new W(I,Ct,bt,kt,I.rxp[Ct]));I=I._next}return{proxy:Q,end:tt,firstMPT:kt,pt:Ot}},z=F.CSSPropTween=function(et,Z,O,I,V,H,G,Q,tt,ut,dt){this.t=et,this.p=Z,this.s=O,this.c=I,this.n=G||Z,et instanceof z||l.push(this.n),this.r=Q&&(typeof Q=="function"?Q:Math.round),this.type=H||0,tt&&(this.pr=tt,B=!0),this.b=ut===void 0?O:ut,this.e=dt===void 0?O+I:dt,V&&(this._next=V,V._prev=this)},nt=function(et,Z,O,I,V,H){var G=new z(et,Z,O,I-O,V,-1,H);return G.b=O,G.e=G.xs0=I,G},Ht=rt.parseComplex=function(et,Z,O,I,V,H,G,Q,tt,ut){O=O||H||"",typeof I=="function"&&(I=I(Qt,qt)),G=new z(et,Z,0,0,G,ut?2:1,null,!1,Q,O,I),I+="",V&&At.test(I+O)&&(I=[O,I],rt.colorStringFilter(I),O=I[0],I=I[1]);var dt=O.split(", ").join(",").split(" "),Pt=I.split(", ").join(",").split(" "),bt=dt.length,Ct=it!==!1,kt,Ot,Wt,Ut,Nt,Yt,Zt,se,oe,ue,ce,ge,_e;for((I.indexOf(",")!==-1||O.indexOf(",")!==-1)&&((I+O).indexOf("rgb")!==-1||(I+O).indexOf("hsl")!==-1?(dt=dt.join(" ").replace(b,", ").split(" "),Pt=Pt.join(" ").replace(b,", ").split(" ")):(dt=dt.join(" ").split(",").join(", ").split(" "),Pt=Pt.join(" ").split(",").join(", ").split(" ")),bt=dt.length),bt!==Pt.length&&(dt=(H||"").split(" "),bt=dt.length),G.plugin=tt,G.setRatio=ut,At.lastIndex=0,kt=0;kt<bt;kt++)if(Ut=dt[kt],Nt=Pt[kt]+"",se=parseFloat(Ut),se||se===0)G.appendXtra("",se,k(Nt,se),Nt.replace(t,""),Ct&&Nt.indexOf("px")!==-1?Math.round:!1,!0);else if(V&&At.test(Ut))ge=Nt.indexOf(")")+1,ge=")"+(ge?Nt.substr(ge):""),_e=Nt.indexOf("hsl")!==-1&&Tt,ue=Nt,Ut=Mt(Ut,_e),Nt=Mt(Nt,_e),oe=Ut.length+Nt.length>6,oe&&!Tt&&Nt[3]===0?(G["xs"+G.l]+=G.l?" transparent":"transparent",G.e=G.e.split(Pt[kt]).join("transparent")):(Tt||(oe=!1),_e?G.appendXtra(ue.substr(0,ue.indexOf("hsl"))+(oe?"hsla(":"hsl("),Ut[0],k(Nt[0],Ut[0]),",",!1,!0).appendXtra("",Ut[1],k(Nt[1],Ut[1]),"%,",!1).appendXtra("",Ut[2],k(Nt[2],Ut[2]),oe?"%,":"%"+ge,!1):G.appendXtra(ue.substr(0,ue.indexOf("rgb"))+(oe?"rgba(":"rgb("),Ut[0],Nt[0]-Ut[0],",",Math.round,!0).appendXtra("",Ut[1],Nt[1]-Ut[1],",",Math.round).appendXtra("",Ut[2],Nt[2]-Ut[2],oe?",":ge,Math.round),oe&&(Ut=Ut.length<4?1:Ut[3],G.appendXtra("",Ut,(Nt.length<4?1:Nt[3])-Ut,ge,!1))),At.lastIndex=0;else if(Yt=Ut.match(i),!Yt)G["xs"+G.l]+=G.l||G["xs"+G.l]?" "+Nt:Nt;else{if(Zt=Nt.match(t),!Zt||Zt.length!==Yt.length)return G;for(Wt=0,Ot=0;Ot<Yt.length;Ot++)ce=Yt[Ot],ue=Ut.indexOf(ce,Wt),G.appendXtra(Ut.substr(Wt,ue-Wt),Number(ce),k(Zt[Ot],ce),"",Ct&&Ut.substr(ue+ce.length,2)==="px"?Math.round:!1,Ot===0),Wt=ue+ce.length;G["xs"+G.l]+=Ut.substr(Wt)}if(I.indexOf("=")!==-1&&G.data){for(ge=G.xs0+G.data.s,kt=1;kt<G.l;kt++)ge+=G["xs"+kt]+G.data["xn"+kt];G.e=ge+G["xs"+kt]}return G.l||(G.type=-1,G.xs0=G.e),G.xfirst||G},Kt=9;for(e=z.prototype,e.l=e.pr=0;--Kt>0;)e["xn"+Kt]=0,e["xs"+Kt]="";e.xs0="",e._next=e._prev=e.xfirst=e.data=e.plugin=e.setRatio=e.rxp=null,e.appendXtra=function(et,Z,O,I,V,H){var G=this,Q=G.l;return G["xs"+Q]+=H&&(Q||G["xs"+Q])?" "+et:et||"",!O&&Q!==0&&!G.plugin?(G["xs"+Q]+=Z+(I||""),G):(G.l++,G.type=G.setRatio?2:1,G["xs"+G.l]=I||"",Q>0?(G.data["xn"+Q]=Z+O,G.rxp["xn"+Q]=V,G["xn"+Q]=Z,G.plugin||(G.xfirst=new z(G,"xn"+Q,Z,O,G.xfirst||G,0,G.n,V,G.pr),G.xfirst.xs0=0),G):(G.data={s:Z+O},G.rxp={},G.s=Z,G.c=O,G.r=V,G))};var fe=function(et,Z){Z=Z||{},this.p=Z.prefix&&J(et)||et,n[et]=n[this.p]=this,this.format=Z.formatter||Xt(Z.defaultValue,Z.color,Z.collapsible,Z.multi),Z.parser&&(this.parse=Z.parser),this.clrs=Z.color,this.multi=Z.multi,this.keyword=Z.keyword,this.dflt=Z.defaultValue,this.pr=Z.priority||0},Ft=F._registerComplexSpecialProp=function(et,Z,O){typeof Z!="object"&&(Z={parser:O});var I=et.split(","),V=Z.defaultValue,H,G;for(O=O||[V],H=0;H<I.length;H++)Z.prefix=H===0&&Z.prefix,Z.defaultValue=O[H]||V,G=new fe(I[H],Z)},he=F._registerPluginProp=function(et){if(!n[et]){var Z=et.charAt(0).toUpperCase()+et.substr(1)+"Plugin";Ft(et,{parser:function(O,I,V,H,G,Q,tt){var ut=vt.com.greensock.plugins[Z];return ut?(ut._cssRegister(),n[V].parse(O,I,V,H,G,Q,tt)):(Gt("Error: "+Z+" js file not loaded."),G)}})}};e=fe.prototype,e.parseComplex=function(et,Z,O,I,V,H){var G=this.keyword,Q,tt,ut,dt,Pt,bt;if(this.multi&&(b.test(O)||b.test(Z)?(tt=Z.replace(b,"|").split("|"),ut=O.replace(b,"|").split("|")):G&&(tt=[Z],ut=[O])),ut){for(dt=ut.length>tt.length?ut.length:tt.length,Q=0;Q<dt;Q++)Z=tt[Q]=tt[Q]||this.dflt,O=ut[Q]=ut[Q]||this.dflt,G&&(Pt=Z.indexOf(G),bt=O.indexOf(G),Pt!==bt&&(bt===-1?tt[Q]=tt[Q].split(G).join(""):Pt===-1&&(tt[Q]+=" "+G)));Z=tt.join(", "),O=ut.join(", ")}return Ht(et,this.p,Z,O,this.clrs,this.dflt,I,this.pr,V,H)},e.parse=function(et,Z,O,I,V,H,G){return this.parseComplex(et.style,this.format(xt(et,this.p,p,!1,this.dflt)),this.format(Z),V,H)},rt.registerSpecialProp=function(et,Z,O){Ft(et,{parser:function(I,V,H,G,Q,tt,ut){var dt=new z(I,H,0,0,Q,2,H,!1,O);return dt.plugin=tt,dt.setRatio=Z(I,V,G._tween,H),dt},priority:O})},rt.useSVGTransformAttr=!0;var Bt="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),$t=J("transform"),Ue=ne+"transform",Ee=J("transformOrigin"),pe=J("perspective")!==null,Ie=F.Transform=function(){this.perspective=parseFloat(rt.defaultTransformPerspective)||0,this.force3D=rt.defaultForce3D===!1||!pe?!1:rt.defaultForce3D||"auto"},Qe=Ke.SVGElement,Oe,$e=function(et,Z,O){var I=x.createElementNS("http://www.w3.org/2000/svg",et),V=/([a-z])([A-Z])/g,H;for(H in O)I.setAttributeNS(null,H.replace(V,"$1-$2").toLowerCase(),O[H]);return Z.appendChild(I),I},Fe=x.documentElement||{},ii=function(){var et=ot||/Android/i.test(q)&&!Ke.chrome,Z,O,I;return x.createElementNS&&!et&&(Z=$e("svg",Fe),O=$e("rect",Z,{width:100,height:50,x:100}),I=O.getBoundingClientRect().width,O.style[Ee]="50% 50%",O.style[$t]="scaleX(0.5)",et=I===O.getBoundingClientRect().width&&!(_t&&pe),Fe.removeChild(Z)),et}(),ni=function(et,Z,O,I,V,H){var G=et._gsTransform,Q=ri(et,!0),tt,ut,dt,Pt,bt,Ct,kt,Ot,Wt,Ut,Nt,Yt,Zt,se;G&&(Zt=G.xOrigin,se=G.yOrigin),(!I||(tt=I.split(" ")).length<2)&&(kt=et.getBBox(),kt.x===0&&kt.y===0&&kt.width+kt.height===0&&(kt={x:parseFloat(et.hasAttribute("x")?et.getAttribute("x"):et.hasAttribute("cx")?et.getAttribute("cx"):0)||0,y:parseFloat(et.hasAttribute("y")?et.getAttribute("y"):et.hasAttribute("cy")?et.getAttribute("cy"):0)||0,width:0,height:0}),Z=K(Z).split(" "),tt=[(Z[0].indexOf("%")!==-1?parseFloat(Z[0])/100*kt.width:parseFloat(Z[0]))+kt.x,(Z[1].indexOf("%")!==-1?parseFloat(Z[1])/100*kt.height:parseFloat(Z[1]))+kt.y]),O.xOrigin=Pt=parseFloat(tt[0]),O.yOrigin=bt=parseFloat(tt[1]),I&&Q!==ze&&(Ct=Q[0],kt=Q[1],Ot=Q[2],Wt=Q[3],Ut=Q[4],Nt=Q[5],Yt=Ct*Wt-kt*Ot,Yt&&(ut=Pt*(Wt/Yt)+bt*(-Ot/Yt)+(Ot*Nt-Wt*Ut)/Yt,dt=Pt*(-kt/Yt)+bt*(Ct/Yt)-(Ct*Nt-kt*Ut)/Yt,Pt=O.xOrigin=tt[0]=ut,bt=O.yOrigin=tt[1]=dt)),G&&(H&&(O.xOffset=G.xOffset,O.yOffset=G.yOffset,G=O),V||V!==!1&&rt.defaultSmoothOrigin!==!1?(ut=Pt-Zt,dt=bt-se,G.xOffset+=ut*Q[0]+dt*Q[2]-ut,G.yOffset+=ut*Q[1]+dt*Q[3]-dt):G.xOffset=G.yOffset=0),H||et.setAttribute("data-svg-origin",tt.join(" "))},_i=function(et){var Z=S("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),O=this.parentNode,I=this.nextSibling,V=this.style.cssText,H;if(Fe.appendChild(Z),Z.appendChild(this),this.style.display="block",et)try{H=this.getBBox(),this._originalGetBBox=this.getBBox,this.getBBox=_i}catch(G){}else this._originalGetBBox&&(H=this._originalGetBBox());return I?O.insertBefore(this,I):O.appendChild(this),Fe.removeChild(Z),this.style.cssText=V,H},Ge=function(et){try{return et.getBBox()}catch(Z){return _i.call(et,!0)}},Je=function(et){return!!(Qe&&et.getCTM&&(!et.parentNode||et.ownerSVGElement)&&Ge(et))},ze=[1,0,0,1,0,0],ri=function(et,Z){var O=et._gsTransform||new Ie,I=1e5,V=et.style,H,G,Q,tt,ut,dt;if($t?G=xt(et,Ue,null,!0):et.currentStyle&&(G=et.currentStyle.filter.match(y),G=G&&G.length===4?[G[0].substr(4),Number(G[2].substr(4)),Number(G[1].substr(4)),G[3].substr(4),O.x||0,O.y||0].join(","):""),H=!G||G==="none"||G==="matrix(1, 0, 0, 1, 0, 0)",$t&&((dt=!at(et)||at(et).display==="none")||!et.parentNode)&&(dt&&(tt=V.display,V.display="block"),et.parentNode||(ut=1,Fe.appendChild(et)),G=xt(et,Ue,null,!0),H=!G||G==="none"||G==="matrix(1, 0, 0, 1, 0, 0)",tt?V.display=tt:dt&&si(V,"display"),ut&&Fe.removeChild(et)),(O.svg||et.getCTM&&Je(et))&&(H&&(V[$t]+"").indexOf("matrix")!==-1&&(G=V[$t],H=0),Q=et.getAttribute("transform"),H&&Q&&(Q=et.transform.baseVal.consolidate().matrix,G="matrix("+Q.a+","+Q.b+","+Q.c+","+Q.d+","+Q.e+","+Q.f+")",H=0)),H)return ze;for(Q=(G||"").match(i)||[],Kt=Q.length;--Kt>-1;)tt=Number(Q[Kt]),Q[Kt]=(ut=tt-(tt|=0))?(ut*I+(ut<0?-.5:.5)|0)/I+tt:tt;return Z&&Q.length>6?[Q[0],Q[1],Q[4],Q[5],Q[12],Q[13]]:Q},je=F.getTransform=function(et,Z,O,I){if(et._gsTransform&&O&&!I)return et._gsTransform;var V=O?et._gsTransform||new Ie:new Ie,H=V.scaleX<0,G=2e-5,Q=1e5,tt=pe&&(parseFloat(xt(et,Ee,Z,!1,"0 0 0").split(" ")[2])||V.zOrigin)||0,ut=parseFloat(rt.defaultTransformPerspective)||0,dt,Pt,bt,Ct,kt,Ot;if(V.svg=!!(et.getCTM&&Je(et)),V.svg&&(ni(et,xt(et,Ee,Z,!1,"50% 50%")+"",V,et.getAttribute("data-svg-origin")),Oe=rt.useSVGTransformAttr||ii),dt=ri(et),dt!==ze){if(dt.length===16){var Wt=dt[0],Ut=dt[1],Nt=dt[2],Yt=dt[3],Zt=dt[4],se=dt[5],oe=dt[6],ue=dt[7],ce=dt[8],ge=dt[9],_e=dt[10],Pe=dt[12],Se=dt[13],We=dt[14],Ve=dt[11],me=Math.atan2(oe,_e),Le,de,ke,Ne,Re,xe;V.zOrigin&&(We=-V.zOrigin,Pe=ce*We-dt[12],Se=ge*We-dt[13],We=_e*We+V.zOrigin-dt[14]),V.rotationX=me*P,me&&(Re=Math.cos(-me),xe=Math.sin(-me),Le=Zt*Re+ce*xe,de=se*Re+ge*xe,ke=oe*Re+_e*xe,ce=Zt*-xe+ce*Re,ge=se*-xe+ge*Re,_e=oe*-xe+_e*Re,Ve=ue*-xe+Ve*Re,Zt=Le,se=de,oe=ke),me=Math.atan2(-Nt,_e),V.rotationY=me*P,me&&(Re=Math.cos(-me),xe=Math.sin(-me),Le=Wt*Re-ce*xe,de=Ut*Re-ge*xe,ke=Nt*Re-_e*xe,ge=Ut*xe+ge*Re,_e=Nt*xe+_e*Re,Ve=Yt*xe+Ve*Re,Wt=Le,Ut=de,Nt=ke),me=Math.atan2(Ut,Wt),V.rotation=me*P,me&&(Re=Math.cos(me),xe=Math.sin(me),Le=Wt*Re+Ut*xe,de=Zt*Re+se*xe,ke=ce*Re+ge*xe,Ut=Ut*Re-Wt*xe,se=se*Re-Zt*xe,ge=ge*Re-ce*xe,Wt=Le,Zt=de,ce=ke),V.rotationX&&Math.abs(V.rotationX)+Math.abs(V.rotation)>359.9&&(V.rotationX=V.rotation=0,V.rotationY=180-V.rotationY),me=Math.atan2(Zt,se),V.scaleX=(Math.sqrt(Wt*Wt+Ut*Ut+Nt*Nt)*Q+.5|0)/Q,V.scaleY=(Math.sqrt(se*se+oe*oe)*Q+.5|0)/Q,V.scaleZ=(Math.sqrt(ce*ce+ge*ge+_e*_e)*Q+.5|0)/Q,Wt/=V.scaleX,Zt/=V.scaleY,Ut/=V.scaleX,se/=V.scaleY,Math.abs(me)>G?(V.skewX=me*P,Zt=0,V.skewType!=="simple"&&(V.scaleY*=1/Math.cos(me))):V.skewX=0,V.perspective=Ve?1/(Ve<0?-Ve:Ve):0,V.x=Pe,V.y=Se,V.z=We,V.svg&&(V.x-=V.xOrigin-(V.xOrigin*Wt-V.yOrigin*Zt),V.y-=V.yOrigin-(V.yOrigin*Ut-V.xOrigin*se))}else if(!pe||I||!dt.length||V.x!==dt[4]||V.y!==dt[5]||!V.rotationX&&!V.rotationY){var Me=dt.length>=6,Te=Me?dt[0]:1,hi=dt[1]||0,Ze=dt[2]||0,ci=Me?dt[3]:1;V.x=dt[4]||0,V.y=dt[5]||0,bt=Math.sqrt(Te*Te+hi*hi),Ct=Math.sqrt(ci*ci+Ze*Ze),kt=Te||hi?Math.atan2(hi,Te)*P:V.rotation||0,Ot=Ze||ci?Math.atan2(Ze,ci)*P+kt:V.skewX||0,V.scaleX=bt,V.scaleY=Ct,V.rotation=kt,V.skewX=Ot,pe&&(V.rotationX=V.rotationY=V.z=0,V.perspective=ut,V.scaleZ=1),V.svg&&(V.x-=V.xOrigin-(V.xOrigin*Te+V.yOrigin*Ze),V.y-=V.yOrigin-(V.xOrigin*hi+V.yOrigin*ci))}Math.abs(V.skewX)>90&&Math.abs(V.skewX)<270&&(H?(V.scaleX*=-1,V.skewX+=V.rotation<=0?180:-180,V.rotation+=V.rotation<=0?180:-180):(V.scaleY*=-1,V.skewX+=V.skewX<=0?180:-180)),V.zOrigin=tt;for(Pt in V)V[Pt]<G&&V[Pt]>-G&&(V[Pt]=0)}return O&&(et._gsTransform=V,V.svg&&(Oe&&et.style[$t]?Ce.delayedCall(.001,function(){si(et.style,$t)}):!Oe&&et.getAttribute("transform")&&Ce.delayedCall(.001,function(){et.removeAttribute("transform")}))),V},He=function(et){var Z=this.data,O=-Z.rotation*M,I=O+Z.skewX*M,V=1e5,H=(Math.cos(O)*Z.scaleX*V|0)/V,G=(Math.sin(O)*Z.scaleX*V|0)/V,Q=(Math.sin(I)*-Z.scaleY*V|0)/V,tt=(Math.cos(I)*Z.scaleY*V|0)/V,ut=this.t.style,dt=this.t.currentStyle,Pt,bt;if(dt){bt=G,G=-Q,Q=-bt,Pt=dt.filter,ut.filter="";var Ct=this.t.offsetWidth,kt=this.t.offsetHeight,Ot=dt.position!=="absolute",Wt="progid:DXImageTransform.Microsoft.Matrix(M11="+H+", M12="+G+", M21="+Q+", M22="+tt,Ut=Z.x+Ct*Z.xPercent/100,Nt=Z.y+kt*Z.yPercent/100,Yt,Zt;if(Z.ox!=null&&(Yt=(Z.oxp?Ct*Z.ox*.01:Z.ox)-Ct/2,Zt=(Z.oyp?kt*Z.oy*.01:Z.oy)-kt/2,Ut+=Yt-(Yt*H+Zt*G),Nt+=Zt-(Yt*Q+Zt*tt)),Ot?(Yt=Ct/2,Zt=kt/2,Wt+=", Dx="+(Yt-(Yt*H+Zt*G)+Ut)+", Dy="+(Zt-(Yt*Q+Zt*tt)+Nt)+")"):Wt+=", sizingMethod='auto expand')",Pt.indexOf("DXImageTransform.Microsoft.Matrix(")!==-1?ut.filter=Pt.replace(v,Wt):ut.filter=Wt+" "+Pt,(et===0||et===1)&&H===1&&G===0&&Q===0&&tt===1&&(!Ot||Wt.indexOf("Dx=0, Dy=0")!==-1)&&(!f.test(Pt)||parseFloat(RegExp.$1)===100)&&Pt.indexOf(Pt.indexOf("Alpha"))===-1&&ut.removeAttribute("filter"),!Ot){var se=ot<8?1:-1,oe,ue,ce;for(Yt=Z.ieOffsetX||0,Zt=Z.ieOffsetY||0,Z.ieOffsetX=Math.round((Ct-((H<0?-H:H)*Ct+(G<0?-G:G)*kt))/2+Ut),Z.ieOffsetY=Math.round((kt-((tt<0?-tt:tt)*kt+(Q<0?-Q:Q)*Ct))/2+Nt),Kt=0;Kt<4;Kt++)ue=$[Kt],oe=dt[ue],bt=oe.indexOf("px")!==-1?parseFloat(oe):Rt(this.t,ue,parseFloat(oe),oe.replace(a,""))||0,bt!==Z[ue]?ce=Kt<2?-Z.ieOffsetX:-Z.ieOffsetY:ce=Kt<2?Yt-Z.ieOffsetX:Zt-Z.ieOffsetY,ut[ue]=(Z[ue]=Math.round(bt-ce*(Kt===0||Kt===2?1:se)))+"px"}}},li=F.set3DTransformRatio=F.setTransformRatio=function(et){var Z=this.data,O=this.t.style,I=Z.rotation,V=Z.rotationX,H=Z.rotationY,G=Z.scaleX,Q=Z.scaleY,tt=Z.scaleZ,ut=Z.x,dt=Z.y,Pt=Z.z,bt=Z.svg,Ct=Z.perspective,kt=Z.force3D,Ot=Z.skewY,Wt=Z.skewX,Ut,Nt,Yt,Zt,se,oe,ue,ce,ge,_e,Pe,Se,We,Ve,me,Le,de,ke,Ne,Re,xe,Me,Te;if(Ot&&(Wt+=Ot,I+=Ot),((et===1||et===0)&&kt==="auto"&&(this.tween._totalTime===this.tween._totalDuration||!this.tween._totalTime)||!kt)&&!Pt&&!Ct&&!H&&!V&&tt===1||Oe&&bt||!pe){I||Wt||bt?(I*=M,Me=Wt*M,Te=1e5,Nt=Math.cos(I)*G,se=Math.sin(I)*G,Yt=Math.sin(I-Me)*-Q,oe=Math.cos(I-Me)*Q,Me&&Z.skewType==="simple"&&(Ut=Math.tan(Me-Ot*M),Ut=Math.sqrt(1+Ut*Ut),Yt*=Ut,oe*=Ut,Ot&&(Ut=Math.tan(Ot*M),Ut=Math.sqrt(1+Ut*Ut),Nt*=Ut,se*=Ut)),bt&&(ut+=Z.xOrigin-(Z.xOrigin*Nt+Z.yOrigin*Yt)+Z.xOffset,dt+=Z.yOrigin-(Z.xOrigin*se+Z.yOrigin*oe)+Z.yOffset,Oe&&(Z.xPercent||Z.yPercent)&&(me=this.t.getBBox(),ut+=Z.xPercent*.01*me.width,dt+=Z.yPercent*.01*me.height),me=1e-6,ut<me&&ut>-me&&(ut=0),dt<me&&dt>-me&&(dt=0)),Ne=(Nt*Te|0)/Te+","+(se*Te|0)/Te+","+(Yt*Te|0)/Te+","+(oe*Te|0)/Te+","+ut+","+dt+")",bt&&Oe?this.t.setAttribute("transform","matrix("+Ne):O[$t]=(Z.xPercent||Z.yPercent?"translate("+Z.xPercent+"%,"+Z.yPercent+"%) matrix(":"matrix(")+Ne):O[$t]=(Z.xPercent||Z.yPercent?"translate("+Z.xPercent+"%,"+Z.yPercent+"%) matrix(":"matrix(")+G+",0,0,"+Q+","+ut+","+dt+")";return}if(_t&&(me=1e-4,G<me&&G>-me&&(G=tt=2e-5),Q<me&&Q>-me&&(Q=tt=2e-5),Ct&&!Z.z&&!Z.rotationX&&!Z.rotationY&&(Ct=0)),I||Wt)I*=M,Le=Nt=Math.cos(I),de=se=Math.sin(I),Wt&&(I-=Wt*M,Le=Math.cos(I),de=Math.sin(I),Z.skewType==="simple"&&(Ut=Math.tan((Wt-Ot)*M),Ut=Math.sqrt(1+Ut*Ut),Le*=Ut,de*=Ut,Z.skewY&&(Ut=Math.tan(Ot*M),Ut=Math.sqrt(1+Ut*Ut),Nt*=Ut,se*=Ut))),Yt=-de,oe=Le;else if(!H&&!V&&tt===1&&!Ct&&!bt){O[$t]=(Z.xPercent||Z.yPercent?"translate("+Z.xPercent+"%,"+Z.yPercent+"%) translate3d(":"translate3d(")+ut+"px,"+dt+"px,"+Pt+"px)"+(G!==1||Q!==1?" scale("+G+","+Q+")":"");return}else Nt=oe=1,Yt=se=0;_e=1,Zt=ue=ce=ge=Pe=Se=0,We=Ct?-1/Ct:0,Ve=Z.zOrigin,me=1e-6,Re=",",xe="0",I=H*M,I&&(Le=Math.cos(I),de=Math.sin(I),ce=-de,Pe=We*-de,Zt=Nt*de,ue=se*de,_e=Le,We*=Le,Nt*=Le,se*=Le),I=V*M,I&&(Le=Math.cos(I),de=Math.sin(I),Ut=Yt*Le+Zt*de,ke=oe*Le+ue*de,ge=_e*de,Se=We*de,Zt=Yt*-de+Zt*Le,ue=oe*-de+ue*Le,_e=_e*Le,We=We*Le,Yt=Ut,oe=ke),tt!==1&&(Zt*=tt,ue*=tt,_e*=tt,We*=tt),Q!==1&&(Yt*=Q,oe*=Q,ge*=Q,Se*=Q),G!==1&&(Nt*=G,se*=G,ce*=G,Pe*=G),(Ve||bt)&&(Ve&&(ut+=Zt*-Ve,dt+=ue*-Ve,Pt+=_e*-Ve+Ve),bt&&(ut+=Z.xOrigin-(Z.xOrigin*Nt+Z.yOrigin*Yt)+Z.xOffset,dt+=Z.yOrigin-(Z.xOrigin*se+Z.yOrigin*oe)+Z.yOffset),ut<me&&ut>-me&&(ut=xe),dt<me&&dt>-me&&(dt=xe),Pt<me&&Pt>-me&&(Pt=0)),Ne=Z.xPercent||Z.yPercent?"translate("+Z.xPercent+"%,"+Z.yPercent+"%) matrix3d(":"matrix3d(",Ne+=(Nt<me&&Nt>-me?xe:Nt)+Re+(se<me&&se>-me?xe:se)+Re+(ce<me&&ce>-me?xe:ce),Ne+=Re+(Pe<me&&Pe>-me?xe:Pe)+Re+(Yt<me&&Yt>-me?xe:Yt)+Re+(oe<me&&oe>-me?xe:oe),V||H||tt!==1?(Ne+=Re+(ge<me&&ge>-me?xe:ge)+Re+(Se<me&&Se>-me?xe:Se)+Re+(Zt<me&&Zt>-me?xe:Zt),Ne+=Re+(ue<me&&ue>-me?xe:ue)+Re+(_e<me&&_e>-me?xe:_e)+Re+(We<me&&We>-me?xe:We)+Re):Ne+=",0,0,0,0,1,0,",Ne+=ut+Re+dt+Re+Pt+Re+(Ct?1+-Pt/Ct:1)+")",O[$t]=Ne};e=Ie.prototype,e.x=e.y=e.z=e.skewX=e.skewY=e.rotation=e.rotationX=e.rotationY=e.zOrigin=e.xPercent=e.yPercent=e.xOffset=e.yOffset=0,e.scaleX=e.scaleY=e.scaleZ=1,Ft("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(et,Z,O,I,V,H,G){if(I._lastParsedTransform===G)return V;I._lastParsedTransform=G;var Q=G.scale&&typeof G.scale=="function"?G.scale:0,tt;typeof G[O]=="function"&&(tt=G[O],G[O]=Z),Q&&(G.scale=Q(Qt,et));var ut=et._gsTransform,dt=et.style,Pt=1e-6,bt=Bt.length,Ct=G,kt={},Ot="transformOrigin",Wt=je(et,p,!0,Ct.parseTransform),Ut=Ct.transform&&(typeof Ct.transform=="function"?Ct.transform(Qt,qt):Ct.transform),Nt,Yt,Zt,se,oe,ue,ce,ge,_e;if(Wt.skewType=Ct.skewType||Wt.skewType||rt.defaultSkewType,I._transform=Wt,"rotationZ"in Ct&&(Ct.rotation=Ct.rotationZ),Ut&&typeof Ut=="string"&&$t)Yt=L.style,Yt[$t]=Ut,Yt.display="block",Yt.position="absolute",Ut.indexOf("%")!==-1&&(Yt.width=xt(et,"width"),Yt.height=xt(et,"height")),x.body.appendChild(L),Nt=je(L,null,!1),Wt.skewType==="simple"&&(Nt.scaleY*=Math.cos(Nt.skewX*M)),Wt.svg&&(ue=Wt.xOrigin,ce=Wt.yOrigin,Nt.x-=Wt.xOffset,Nt.y-=Wt.yOffset,(Ct.transformOrigin||Ct.svgOrigin)&&(Ut={},ni(et,K(Ct.transformOrigin),Ut,Ct.svgOrigin,Ct.smoothOrigin,!0),ue=Ut.xOrigin,ce=Ut.yOrigin,Nt.x-=Ut.xOffset-Wt.xOffset,Nt.y-=Ut.yOffset-Wt.yOffset),(ue||ce)&&(ge=ri(L,!0),Nt.x-=ue-(ue*ge[0]+ce*ge[2]),Nt.y-=ce-(ue*ge[1]+ce*ge[3]))),x.body.removeChild(L),Nt.perspective||(Nt.perspective=Wt.perspective),Ct.xPercent!=null&&(Nt.xPercent=Y(Ct.xPercent,Wt.xPercent)),Ct.yPercent!=null&&(Nt.yPercent=Y(Ct.yPercent,Wt.yPercent));else if(typeof Ct=="object"){if(Nt={scaleX:Y(Ct.scaleX!=null?Ct.scaleX:Ct.scale,Wt.scaleX),scaleY:Y(Ct.scaleY!=null?Ct.scaleY:Ct.scale,Wt.scaleY),scaleZ:Y(Ct.scaleZ,Wt.scaleZ),x:Y(Ct.x,Wt.x),y:Y(Ct.y,Wt.y),z:Y(Ct.z,Wt.z),xPercent:Y(Ct.xPercent,Wt.xPercent),yPercent:Y(Ct.yPercent,Wt.yPercent),perspective:Y(Ct.transformPerspective,Wt.perspective)},oe=Ct.directionalRotation,oe!=null)if(typeof oe=="object")for(Yt in oe)Ct[Yt]=oe[Yt];else Ct.rotation=oe;typeof Ct.x=="string"&&Ct.x.indexOf("%")!==-1&&(Nt.x=0,Nt.xPercent=Y(Ct.x,Wt.xPercent)),typeof Ct.y=="string"&&Ct.y.indexOf("%")!==-1&&(Nt.y=0,Nt.yPercent=Y(Ct.y,Wt.yPercent)),Nt.rotation=ht("rotation"in Ct?Ct.rotation:"shortRotation"in Ct?Ct.shortRotation+"_short":Wt.rotation,Wt.rotation,"rotation",kt),pe&&(Nt.rotationX=ht("rotationX"in Ct?Ct.rotationX:"shortRotationX"in Ct?Ct.shortRotationX+"_short":Wt.rotationX||0,Wt.rotationX,"rotationX",kt),Nt.rotationY=ht("rotationY"in Ct?Ct.rotationY:"shortRotationY"in Ct?Ct.shortRotationY+"_short":Wt.rotationY||0,Wt.rotationY,"rotationY",kt)),Nt.skewX=ht(Ct.skewX,Wt.skewX),Nt.skewY=ht(Ct.skewY,Wt.skewY)}for(pe&&Ct.force3D!=null&&(Wt.force3D=Ct.force3D,se=!0),Zt=Wt.force3D||Wt.z||Wt.rotationX||Wt.rotationY||Nt.z||Nt.rotationX||Nt.rotationY||Nt.perspective,!Zt&&Ct.scale!=null&&(Nt.scaleZ=1);--bt>-1;)_e=Bt[bt],Ut=Nt[_e]-Wt[_e],(Ut>Pt||Ut<-Pt||Ct[_e]!=null||T[_e]!=null)&&(se=!0,V=new z(Wt,_e,Wt[_e],Ut,V),_e in kt&&(V.e=kt[_e]),V.xs0=0,V.plugin=H,I._overwriteProps.push(V.n));return Ut=Ct.transformOrigin,Wt.svg&&(Ut||Ct.svgOrigin)&&(ue=Wt.xOffset,ce=Wt.yOffset,ni(et,K(Ut),Nt,Ct.svgOrigin,Ct.smoothOrigin),V=nt(Wt,"xOrigin",(ut?Wt:Nt).xOrigin,Nt.xOrigin,V,Ot),V=nt(Wt,"yOrigin",(ut?Wt:Nt).yOrigin,Nt.yOrigin,V,Ot),(ue!==Wt.xOffset||ce!==Wt.yOffset)&&(V=nt(Wt,"xOffset",ut?ue:Wt.xOffset,Wt.xOffset,V,Ot),V=nt(Wt,"yOffset",ut?ce:Wt.yOffset,Wt.yOffset,V,Ot)),Ut="0px 0px"),(Ut||pe&&Zt&&Wt.zOrigin)&&($t?(se=!0,_e=Ee,Ut=(Ut||xt(et,_e,p,!1,"50% 50%"))+"",V=new z(dt,_e,0,0,V,-1,Ot),V.b=dt[_e],V.plugin=H,pe?(Yt=Wt.zOrigin,Ut=Ut.split(" "),Wt.zOrigin=(Ut.length>2&&!(Yt!==0&&Ut[2]==="0px")?parseFloat(Ut[2]):Yt)||0,V.xs0=V.e=Ut[0]+" "+(Ut[1]||"50%")+" 0px",V=new z(Wt,"zOrigin",0,0,V,-1,V.n),V.b=Yt,V.xs0=V.e=Wt.zOrigin):V.xs0=V.e=Ut):K(Ut+"",Wt)),se&&(I._transformType=!(Wt.svg&&Oe)&&(Zt||this._transformType===3)?3:2),tt&&(G[O]=tt),Q&&(G.scale=Q),V},prefix:!0}),Ft("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),Ft("borderRadius",{defaultValue:"0px",parser:function(et,Z,O,I,V,H){Z=this.format(Z);var G=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],Q=et.style,tt,ut,dt,Pt,bt,Ct,kt,Ot,Wt,Ut,Nt,Yt,Zt,se,oe,ue;for(Wt=parseFloat(et.offsetWidth),Ut=parseFloat(et.offsetHeight),tt=Z.split(" "),ut=0;ut<G.length;ut++)this.p.indexOf("border")&&(G[ut]=J(G[ut])),bt=Pt=xt(et,G[ut],p,!1,"0px"),bt.indexOf(" ")!==-1&&(Pt=bt.split(" "),bt=Pt[0],Pt=Pt[1]),Ct=dt=tt[ut],kt=parseFloat(bt),Yt=bt.substr((kt+"").length),Zt=Ct.charAt(1)==="=",Zt?(Ot=parseInt(Ct.charAt(0)+"1",10),Ct=Ct.substr(2),Ot*=parseFloat(Ct),Nt=Ct.substr((Ot+"").length-(Ot<0?1:0))||""):(Ot=parseFloat(Ct),Nt=Ct.substr((Ot+"").length)),Nt===""&&(Nt=D[O]||Yt),Nt!==Yt&&(se=Rt(et,"borderLeft",kt,Yt),oe=Rt(et,"borderTop",kt,Yt),Nt==="%"?(bt=se/Wt*100+"%",Pt=oe/Ut*100+"%"):Nt==="em"?(ue=Rt(et,"borderLeft",1,"em"),bt=se/ue+"em",Pt=oe/ue+"em"):(bt=se+"px",Pt=oe+"px"),Zt&&(Ct=parseFloat(bt)+Ot+Nt,dt=parseFloat(Pt)+Ot+Nt)),V=Ht(Q,G[ut],bt+" "+Pt,Ct+" "+dt,!1,"0px",V);return V},prefix:!0,formatter:Xt("0px 0px 0px 0px",!1,!0)}),Ft("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius",{defaultValue:"0px",parser:function(et,Z,O,I,V,H){return Ht(et.style,O,this.format(xt(et,O,p,!1,"0px 0px")),this.format(Z),!1,"0px",V)},prefix:!0,formatter:Xt("0px 0px",!1,!0)}),Ft("backgroundPosition",{defaultValue:"0 0",parser:function(et,Z,O,I,V,H){var G="background-position",Q=p||at(et,null),tt=this.format((Q?ot?Q.getPropertyValue(G+"-x")+" "+Q.getPropertyValue(G+"-y"):Q.getPropertyValue(G):et.currentStyle.backgroundPositionX+" "+et.currentStyle.backgroundPositionY)||"0 0"),ut=this.format(Z),dt,Pt,bt,Ct,kt,Ot;if(tt.indexOf("%")!==-1!=(ut.indexOf("%")!==-1)&&ut.split(",").length<2&&(Ot=xt(et,"backgroundImage").replace(m,""),Ot&&Ot!=="none")){for(dt=tt.split(" "),Pt=ut.split(" "),C.setAttribute("src",Ot),bt=2;--bt>-1;)tt=dt[bt],Ct=tt.indexOf("%")!==-1,Ct!==(Pt[bt].indexOf("%")!==-1)&&(kt=bt===0?et.offsetWidth-C.width:et.offsetHeight-C.height,dt[bt]=Ct?parseFloat(tt)/100*kt+"px":parseFloat(tt)/kt*100+"%");tt=dt.join(" ")}return this.parseComplex(et.style,tt,ut,V,H)},formatter:K}),Ft("backgroundSize",{defaultValue:"0 0",formatter:function(et){return et+="",et.substr(0,2)==="co"?et:K(et.indexOf(" ")===-1?et+" "+et:et)}}),Ft("perspective",{defaultValue:"0px",prefix:!0}),Ft("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),Ft("transformStyle",{prefix:!0}),Ft("backfaceVisibility",{prefix:!0}),Ft("userSelect",{prefix:!0}),Ft("margin",{parser:ie("marginTop,marginRight,marginBottom,marginLeft")}),Ft("padding",{parser:ie("paddingTop,paddingRight,paddingBottom,paddingLeft")}),Ft("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(et,Z,O,I,V,H){var G,Q,tt;return ot<9?(Q=et.currentStyle,tt=ot<8?" ":",",G="rect("+Q.clipTop+tt+Q.clipRight+tt+Q.clipBottom+tt+Q.clipLeft+")",Z=this.format(Z).split(",").join(tt)):(G=this.format(xt(et,this.p,p,!1,this.dflt)),Z=this.format(Z)),this.parseComplex(et.style,G,Z,V,H)}}),Ft("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),Ft("autoRound,strictUnits",{parser:function(et,Z,O,I,V){return V}}),Ft("border",{defaultValue:"0px solid #000",parser:function(et,Z,O,I,V,H){var G=xt(et,"borderTopWidth",p,!1,"0px"),Q=this.format(Z).split(" "),tt=Q[0].replace(a,"");return tt!=="px"&&(G=parseFloat(G)/Rt(et,"borderTopWidth",1,tt)+tt),this.parseComplex(et.style,this.format(G+" "+xt(et,"borderTopStyle",p,!1,"solid")+" "+xt(et,"borderTopColor",p,!1,"#000")),Q.join(" "),V,H)},color:!0,formatter:function(et){var Z=et.split(" ");return Z[0]+" "+(Z[1]||"solid")+" "+(et.match(At)||["#000"])[0]}}),Ft("borderWidth",{parser:ie("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),Ft("float,cssFloat,styleFloat",{parser:function(et,Z,O,I,V,H){var G=et.style,Q="cssFloat"in G?"cssFloat":"styleFloat";return new z(G,Q,0,0,V,-1,O,!1,0,G[Q],Z)}});var ai=function(et){var Z=this.t,O=Z.filter||xt(this.data,"filter")||"",I=this.s+this.c*et|0,V;I===100&&(O.indexOf("atrix(")===-1&&O.indexOf("radient(")===-1&&O.indexOf("oader(")===-1?(Z.removeAttribute("filter"),V=!xt(this.data,"filter")):(Z.filter=O.replace(c,""),V=!0)),V||(this.xn1&&(Z.filter=O=O||"alpha(opacity="+I+")"),O.indexOf("pacity")===-1?(I!==0||!this.xn1)&&(Z.filter=O+" alpha(opacity="+I+")"):Z.filter=O.replace(f,"opacity="+I))};Ft("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(et,Z,O,I,V,H){var G=parseFloat(xt(et,"opacity",p,!1,"1")),Q=et.style,tt=O==="autoAlpha";return typeof Z=="string"&&Z.charAt(1)==="="&&(Z=(Z.charAt(0)==="-"?-1:1)*parseFloat(Z.substr(2))+G),tt&&G===1&&xt(et,"visibility",p)==="hidden"&&Z!==0&&(G=0),Tt?V=new z(Q,"opacity",G,Z-G,V):(V=new z(Q,"opacity",G*100,(Z-G)*100,V),V.xn1=tt?1:0,Q.zoom=1,V.type=2,V.b="alpha(opacity="+V.s+")",V.e="alpha(opacity="+(V.s+V.c)+")",V.data=et,V.plugin=H,V.setRatio=ai),tt&&(V=new z(Q,"visibility",0,0,V,-1,null,!1,0,G!==0?"inherit":"hidden",Z===0?"hidden":"inherit"),V.xs0="inherit",I._overwriteProps.push(V.n),I._overwriteProps.push(O)),V}});var si=function(et,Z){Z&&(et.removeProperty?((Z.substr(0,2)==="ms"||Z.substr(0,6)==="webkit")&&(Z="-"+Z),et.removeProperty(Z.replace(h,"-$1").toLowerCase())):et.removeAttribute(Z))},yi=function(et){if(this.t._gsClassPT=this,et===1||et===0){this.t.setAttribute("class",et===0?this.b:this.e);for(var Z=this.data,O=this.t.style;Z;)Z.v?O[Z.p]=Z.v:si(O,Z.p),Z=Z._next;et===1&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};Ft("className",{parser:function(et,Z,O,I,V,H,G){var Q=et.getAttribute("class")||"",tt=et.style.cssText,ut,dt,Pt,bt,Ct;if(V=I._classNamePT=new z(et,O,0,0,V,2),V.setRatio=yi,V.pr=-11,B=!0,V.b=Q,dt=te(et,p),Pt=et._gsClassPT,Pt){for(bt={},Ct=Pt.data;Ct;)bt[Ct.p]=1,Ct=Ct._next;Pt.setRatio(1)}return et._gsClassPT=V,V.e=Z.charAt(1)!=="="?Z:Q.replace(new RegExp("(?:\\s|^)"+Z.substr(2)+"(?![\\w-])"),"")+(Z.charAt(0)==="+"?" "+Z.substr(2):""),et.setAttribute("class",V.e),ut=zt(et,dt,te(et),G,bt),et.setAttribute("class",Q),V.data=ut.firstMPT,et.style.cssText=tt,V=V.xfirst=I.parse(et,ut.difs,V,H),V}});var gi=function(et){if((et===1||et===0)&&this.data._totalTime===this.data._totalDuration&&this.data.data!=="isFromStart"){var Z=this.t.style,O=n.transform.parse,I,V,H,G,Q;if(this.e==="all")Z.cssText="",G=!0;else for(I=this.e.split(" ").join("").split(","),H=I.length;--H>-1;)V=I[H],n[V]&&(n[V].parse===O?G=!0:V=V==="transformOrigin"?Ee:n[V].p),si(Z,V);G&&(si(Z,$t),Q=this.t._gsTransform,Q&&(Q.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(Ft("clearProps",{parser:function(et,Z,O,I,V){return V=new z(et,O,0,0,V,2),V.setRatio=gi,V.e=Z,V.pr=-10,V.data=I._tween,B=!0,V}}),e="bezier,throwProps,physicsProps,physics2D".split(","),Kt=e.length;Kt--;)he(e[Kt]);e=rt.prototype,e._firstPT=e._lastParsedTransform=e._transform=null,e._onInitTween=function(et,Z,O,I){if(!et.nodeType)return!1;this._target=qt=et,this._tween=O,this._vars=Z,Qt=I,it=Z.autoRound,B=!1,D=Z.suffixMap||rt.suffixMap,p=at(et,""),l=this._overwriteProps;var V=et.style,H,G,Q,tt,ut,dt,Pt,bt,Ct;if(st&&V.zIndex===""&&(H=xt(et,"zIndex",p),(H==="auto"||H==="")&&this._addLazySet(V,"zIndex",0)),typeof Z=="string"&&(tt=V.cssText,H=te(et,p),V.cssText=tt+";"+Z,H=zt(et,H,te(et)).difs,!Tt&&o.test(Z)&&(H.opacity=parseFloat(RegExp.$1)),Z=H,V.cssText=tt),Z.className?this._firstPT=G=n.className.parse(et,Z.className,"className",this,null,null,Z):this._firstPT=G=this.parse(et,Z,null),this._transformType){for(Ct=this._transformType===3,$t?pt&&(st=!0,V.zIndex===""&&(Pt=xt(et,"zIndex",p),(Pt==="auto"||Pt==="")&&this._addLazySet(V,"zIndex",0)),X&&this._addLazySet(V,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(Ct?"visible":"hidden"))):V.zoom=1,Q=G;Q&&Q._next;)Q=Q._next;bt=new z(et,"transform",0,0,null,2),this._linkCSSP(bt,null,Q),bt.setRatio=$t?li:He,bt.data=this._transform||je(et,p,!0),bt.tween=O,bt.pr=-1,l.pop()}if(B){for(;G;){for(dt=G._next,Q=tt;Q&&Q.pr>G.pr;)Q=Q._next;(G._prev=Q?Q._prev:ut)?G._prev._next=G:tt=G,(G._next=Q)?Q._prev=G:ut=G,G=dt}this._firstPT=tt}return!0},e.parse=function(et,Z,O,I){var V=et.style,H,G,Q,tt,ut,dt,Pt,bt,Ct,kt;for(H in Z){if(dt=Z[H],typeof dt=="function"&&(dt=dt(Qt,qt)),G=n[H],G)O=G.parse(et,dt,H,this,O,I,Z);else if(H.substr(0,2)==="--"){this._tween._propLookup[H]=this._addTween.call(this._tween,et.style,"setProperty",at(et).getPropertyValue(H)+"",dt+"",H,!1,H);continue}else ut=xt(et,H,p)+"",Ct=typeof dt=="string",H==="color"||H==="fill"||H==="stroke"||H.indexOf("Color")!==-1||Ct&&d.test(dt)?(Ct||(dt=Mt(dt),dt=(dt.length>3?"rgba(":"rgb(")+dt.join(",")+")"),O=Ht(V,H,ut,dt,!0,"transparent",O,0,I)):Ct&&R.test(dt)?O=Ht(V,H,ut,dt,!0,null,O,0,I):(Q=parseFloat(ut),Pt=Q||Q===0?ut.substr((Q+"").length):"",(ut===""||ut==="auto")&&(H==="width"||H==="height"?(Q=N(et,H,p),Pt="px"):H==="left"||H==="top"?(Q=Lt(et,H,p),Pt="px"):(Q=H!=="opacity"?0:1,Pt="")),kt=Ct&&dt.charAt(1)==="=",kt?(tt=parseInt(dt.charAt(0)+"1",10),dt=dt.substr(2),tt*=parseFloat(dt),bt=dt.replace(a,"")):(tt=parseFloat(dt),bt=Ct?dt.replace(a,""):""),bt===""&&(bt=H in D?D[H]:Pt),dt=tt||tt===0?(kt?tt+Q:tt)+bt:Z[H],Pt!==bt&&(bt!==""||H==="lineHeight")&&(tt||tt===0)&&Q&&(Q=Rt(et,H,Q,Pt),bt==="%"?(Q/=Rt(et,H,100,"%")/100,Z.strictUnits!==!0&&(ut=Q+"%")):bt==="em"||bt==="rem"||bt==="vw"||bt==="vh"?Q/=Rt(et,H,1,bt):bt!=="px"&&(tt=Rt(et,H,tt,bt),bt="px"),kt&&(tt||tt===0)&&(dt=tt+Q+bt)),kt&&(tt+=Q),(Q||Q===0)&&(tt||tt===0)?(O=new z(V,H,Q,tt-Q,O,0,H,it!==!1&&(bt==="px"||H==="zIndex"),0,ut,dt),O.xs0=bt):V[H]===void 0||!dt&&(dt+""=="NaN"||dt==null)?Gt("invalid "+H+" tween value: "+Z[H]):(O=new z(V,H,tt||Q||0,0,O,-1,H,!1,0,ut,dt),O.xs0=dt==="none"&&(H==="display"||H.indexOf("Style")!==-1)?ut:dt));I&&O&&!O.plugin&&(O.plugin=I)}return O},e.setRatio=function(et){var Z=this._firstPT,O=1e-6,I,V,H;if(et===1&&(this._tween._time===this._tween._duration||this._tween._time===0))for(;Z;){if(Z.type!==2)if(Z.r&&Z.type!==-1){if(I=Z.r(Z.s+Z.c),!Z.type)Z.t[Z.p]=I+Z.xs0;else if(Z.type===1){for(H=Z.l,V=Z.xs0+I+Z.xs1,H=1;H<Z.l;H++)V+=Z["xn"+H]+Z["xs"+(H+1)];Z.t[Z.p]=V}}else Z.t[Z.p]=Z.e;else Z.setRatio(et);Z=Z._next}else if(et||!(this._tween._time===this._tween._duration||this._tween._time===0)||this._tween._rawPrevTime===-1e-6)for(;Z;){if(I=Z.c*et+Z.s,Z.r?I=Z.r(I):I<O&&I>-O&&(I=0),!Z.type)Z.t[Z.p]=I+Z.xs0;else if(Z.type===1)if(H=Z.l,H===2)Z.t[Z.p]=Z.xs0+I+Z.xs1+Z.xn1+Z.xs2;else if(H===3)Z.t[Z.p]=Z.xs0+I+Z.xs1+Z.xn1+Z.xs2+Z.xn2+Z.xs3;else if(H===4)Z.t[Z.p]=Z.xs0+I+Z.xs1+Z.xn1+Z.xs2+Z.xn2+Z.xs3+Z.xn3+Z.xs4;else if(H===5)Z.t[Z.p]=Z.xs0+I+Z.xs1+Z.xn1+Z.xs2+Z.xn2+Z.xs3+Z.xn3+Z.xs4+Z.xn4+Z.xs5;else{for(V=Z.xs0+I+Z.xs1,H=1;H<Z.l;H++)V+=Z["xn"+H]+Z["xs"+(H+1)];Z.t[Z.p]=V}else Z.type===-1?Z.t[Z.p]=Z.xs0:Z.setRatio&&Z.setRatio(et);Z=Z._next}else for(;Z;)Z.type!==2?Z.t[Z.p]=Z.b:Z.setRatio(et),Z=Z._next},e._enableTransforms=function(et){this._transform=this._transform||je(this._target,p,!0),this._transformType=!(this._transform.svg&&Oe)&&(et||this._transformType===3)?3:2};var ki=function(et){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};e._addLazySet=function(et,Z,O){var I=this._firstPT=new z(et,Z,0,0,this._firstPT,2);I.e=O,I.setRatio=ki,I.data=this},e._linkCSSP=function(et,Z,O,I){return et&&(Z&&(Z._prev=et),et._next&&(et._next._prev=et._prev),et._prev?et._prev._next=et._next:this._firstPT===et&&(this._firstPT=et._next,I=!0),O?O._next=et:!I&&this._firstPT===null&&(this._firstPT=et),et._next=Z,et._prev=O),et},e._mod=function(et){for(var Z=this._firstPT;Z;)typeof et[Z.p]=="function"&&(Z.r=et[Z.p]),Z=Z._next},e._kill=function(et){var Z=et,O,I,V;if(et.autoAlpha||et.alpha){Z={};for(I in et)Z[I]=et[I];Z.opacity=1,Z.autoAlpha&&(Z.visibility=1)}for(et.className&&(O=this._classNamePT)&&(V=O.xfirst,V&&V._prev?this._linkCSSP(V._prev,O._next,V._prev._prev):V===this._firstPT&&(this._firstPT=O._next),O._next&&this._linkCSSP(O._next,O._next._next,V._prev),this._classNamePT=null),O=this._firstPT;O;)O.plugin&&O.plugin!==I&&O.plugin._kill&&(O.plugin._kill(et),I=O.plugin),O=O._next;return Hi.prototype._kill.call(this,Z)};var vi=function(et,Z,O){var I,V,H,G;if(et.slice){for(V=et.length;--V>-1;)vi(et[V],Z,O);return}for(I=et.childNodes,V=I.length;--V>-1;)H=I[V],G=H.type,H.style&&(Z.push(te(H)),O&&O.push(H)),(G===1||G===9||G===11)&&H.childNodes.length&&vi(H,Z,O)};return rt.cascadeTo=function(et,Z,O){var I=Ce.to(et,Z,O),V=[I],H=[],G=[],Q=[],tt=Ce._internals.reservedProps,ut,dt,Pt,bt;for(et=I._targets||I.target,vi(et,H,Q),I.render(Z,!0,!0),vi(et,G),I.render(0,!0,!0),I._enabled(!0),ut=Q.length;--ut>-1;)if(dt=zt(Q[ut],H[ut],G[ut]),dt.firstMPT){dt=dt.difs;for(Pt in O)tt[Pt]&&(dt[Pt]=O[Pt]);bt={};for(Pt in dt)bt[Pt]=H[ut][Pt];V.push(Ce.fromTo(Q[ut],Z,bt,dt))}return V},Hi.activate([rt]),rt},!0);ks=Xe.CSSPlugin});var Vs,Gs=Ei(()=>{wi();Vs=Ke._gsDefine.plugin({propName:"attr",API:2,version:"0.6.1",init:function(rt,vt,B,D){var p,l;if(typeof rt.setAttribute!="function")return!1;for(p in vt)l=vt[p],typeof l=="function"&&(l=l(D,rt)),this._addTween(rt,"setAttribute",rt.getAttribute(p)+"",l+"",p,!1,p),this._overwriteProps.push(p);return!0}})});var vs,Ka,za,Ws,Bs=Ei(()=>{wi();vs=Ke._gsDefine.plugin({propName:"roundProps",version:"1.7.0",priority:-1,API:2,init:function(rt,vt,B){return this._tween=B,!0}}),Ka=function(rt){var vt=rt<1?Math.pow(10,(rt+"").length-2):1;return function(B){return(Math.round(B/rt)*rt*vt|0)/vt}},za=function(rt,vt){for(;rt;)!rt.f&&!rt.blob&&(rt.m=vt||Math.round),rt=rt._next},Ws=vs.prototype;Ws._onInitAllProps=function(){var rt=this._tween,vt=rt.vars.roundProps,B={},D=rt._propLookup.roundProps,p,l,n,e;if(typeof vt=="object"&&!vt.push)for(e in vt)B[e]=Ka(vt[e]);else for(typeof vt=="string"&&(vt=vt.split(",")),n=vt.length;--n>-1;)B[vt[n]]=Math.round;for(e in B)for(p=rt._firstPT;p;)l=p._next,p.pg?p.t._mod(B):p.n===e&&(p.f===2&&p.t?za(p.t._firstPT,B[e]):(this._add(p.t,e,p.s,p.c,B[e]),l&&(l._prev=p._prev),p._prev?p._prev._next=l:rt._firstPT===p&&(rt._firstPT=l),p._next=p._prev=null,rt._propLookup[e]=D)),p=l;return!1};Ws._add=function(rt,vt,B,D,p){this._addTween(rt,vt,B,B+D,vt,p||Math.round),this._overwriteProps.push(vt)}});var Es,Us=Ei(()=>{wi();Es=Ke._gsDefine.plugin({propName:"directionalRotation",version:"0.3.1",API:2,init:function(rt,vt,B,D){typeof vt!="object"&&(vt={rotation:vt}),this.finals={};var p=vt.useRadians===!0?Math.PI*2:360,l=1e-6,n,e,i,t,r,s;for(n in vt)n!=="useRadians"&&(t=vt[n],typeof t=="function"&&(t=t(D,rt)),s=(t+"").split("_"),e=s[0],i=parseFloat(typeof rt[n]!="function"?rt[n]:rt[n.indexOf("set")||typeof rt["get"+n.substr(3)]!="function"?n:"get"+n.substr(3)]()),t=this.finals[n]=typeof e=="string"&&e.charAt(1)==="="?i+parseInt(e.charAt(0)+"1",10)*Number(e.substr(2)):Number(e)||0,r=t-i,s.length&&(e=s.join("_"),e.indexOf("short")!==-1&&(r=r%p,r!==r%(p/2)&&(r=r<0?r+p:r-p)),e.indexOf("_cw")!==-1&&r<0?r=(r+p*9999999999)%p-(r/p|0)*p:e.indexOf("ccw")!==-1&&r>0&&(r=(r-p*9999999999)%p-(r/p|0)*p)),(r>l||r<-l)&&(this._addTween(rt,n,i,i+r,n),this._overwriteProps.push(n)));return!0},set:function(rt){var vt;if(rt!==1)this._super.setRatio.call(this,rt);else for(vt=this._firstPT;vt;)vt.f?vt.t[vt.p](this.finals[vt.p]):vt.t[vt.p]=this.finals[vt.p],vt=vt._next}});Es._autoCSS=!0});var Ci,ws=Ei(()=>{wi();Ke._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(){var rt=function(o){Pi.call(this,o),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var c=this.vars,d,h;for(h in c)d=c[h],l(d)&&d.join("").indexOf("{self}")!==-1&&(c[h]=this._swapSelfInParams(d));l(c.tweens)&&this.add(c.tweens,0,c.align,c.stagger)},vt=1e-10,B=Ce._internals,D=rt._internals={},p=B.isSelector,l=B.isArray,n=B.lazyTweens,e=B.lazyRender,i=Ke._gsDefine.globals,t=function(o){var c={},d;for(d in o)c[d]=o[d];return c},r=function(o,c,d){var h=o.cycle,u,m;for(u in h)m=h[u],o[u]=typeof m=="function"?m(d,c[d]):m[d%m.length];delete o.cycle},s=D.pauseCallback=function(){},a=function(o){var c=[],d=o.length,h;for(h=0;h!==d;c.push(o[h++]));return c},f=rt.prototype=new Pi;return rt.version="2.0.2",f.constructor=rt,f.kill()._gc=f._forcingPlayhead=f._hasPause=!1,f.to=function(o,c,d,h){var u=d.repeat&&i.TweenMax||Ce;return c?this.add(new u(o,c,d),h):this.set(o,d,h)},f.from=function(o,c,d,h){return this.add((d.repeat&&i.TweenMax||Ce).from(o,c,d),h)},f.fromTo=function(o,c,d,h,u){var m=h.repeat&&i.TweenMax||Ce;return c?this.add(m.fromTo(o,c,d,h),u):this.set(o,h,u)},f.staggerTo=function(o,c,d,h,u,m,g,_){var y=new rt({onComplete:m,onCompleteParams:g,callbackScope:_,smoothChildTiming:this.smoothChildTiming}),v=d.cycle,b,R;for(typeof o=="string"&&(o=Ce.selector(o)||o),o=o||[],p(o)&&(o=a(o)),h=h||0,h<0&&(o=a(o),o.reverse(),h*=-1),R=0;R<o.length;R++)b=t(d),b.startAt&&(b.startAt=t(b.startAt),b.startAt.cycle&&r(b.startAt,o,R)),v&&(r(b,o,R),b.duration!=null&&(c=b.duration,delete b.duration)),y.to(o[R],c,b,R*h);return this.add(y,u)},f.staggerFrom=function(o,c,d,h,u,m,g,_){return d.immediateRender=d.immediateRender!=!1,d.runBackwards=!0,this.staggerTo(o,c,d,h,u,m,g,_)},f.staggerFromTo=function(o,c,d,h,u,m,g,_,y){return h.startAt=d,h.immediateRender=h.immediateRender!=!1&&d.immediateRender!=!1,this.staggerTo(o,c,h,u,m,g,_,y)},f.call=function(o,c,d,h){return this.add(Ce.delayedCall(0,o,c,d),h)},f.set=function(o,c,d){return d=this._parseTimeOrLabel(d,0,!0),c.immediateRender==null&&(c.immediateRender=d===this._time&&!this._paused),this.add(new Ce(o,0,c),d)},rt.exportRoot=function(o,c){o=o||{},o.smoothChildTiming==null&&(o.smoothChildTiming=!0);var d=new rt(o),h=d._timeline,u,m,g,_;for(c==null&&(c=!0),h._remove(d,!0),d._startTime=0,d._rawPrevTime=d._time=d._totalTime=h._time,g=h._first;g;)_=g._next,(!c||!(g instanceof Ce&&g.target===g.vars.onComplete))&&(m=g._startTime-g._delay,m<0&&(u=1),d.add(g,m)),g=_;return h.add(d,0),u&&d.totalDuration(),d},f.add=function(o,c,d,h){var u,m,g,_,y,v;if(typeof c!="number"&&(c=this._parseTimeOrLabel(c,0,!0,o)),!(o instanceof fi))if(o instanceof Array||o&&o.push&&l(o)){for(d=d||"normal",h=h||0,u=c,m=o.length,g=0;g<m;g++)l(_=o[g])&&(_=new rt({tweens:_})),this.add(_,u),typeof _!="string"&&typeof _!="function"&&(d==="sequence"?u=_._startTime+_.totalDuration()/_._timeScale:d==="start"&&(_._startTime-=_.delay())),u+=h;return this._uncache(!0)}else{if(typeof o=="string")return this.addLabel(o,c);if(typeof o=="function")o=Ce.delayedCall(0,o);else throw"Cannot add "+o+" into the timeline; it is not a tween, timeline, function, or string."}if(Pi.prototype.add.call(this,o,c),o._time&&(u=Math.max(0,Math.min(o.totalDuration(),(this.rawTime()-o._startTime)*o._timeScale)),Math.abs(u-o._totalTime)>1e-5&&o.render(u,!1,!1)),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(y=this,v=y.rawTime()>o._startTime;y._timeline;)v&&y._timeline.smoothChildTiming?y.totalTime(y._totalTime,!0):y._gc&&y._enabled(!0,!1),y=y._timeline;return this},f.remove=function(o){if(o instanceof fi){this._remove(o,!1);var c=o._timeline=o.vars.useFrames?fi._rootFramesTimeline:fi._rootTimeline;return o._startTime=(o._paused?o._pauseTime:c._time)-(o._reversed?o.totalDuration()-o._totalTime:o._totalTime)/o._timeScale,this}else if(o instanceof Array||o&&o.push&&l(o)){for(var d=o.length;--d>-1;)this.remove(o[d]);return this}else if(typeof o=="string")return this.removeLabel(o);return this.kill(null,o)},f._remove=function(o,c){Pi.prototype._remove.call(this,o,c);var d=this._last;return d?this._time>this.duration()&&(this._time=this._duration,this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},f.append=function(o,c){return this.add(o,this._parseTimeOrLabel(null,c,!0,o))},f.insert=f.insertMultiple=function(o,c,d,h){return this.add(o,c||0,d,h)},f.appendMultiple=function(o,c,d,h){return this.add(o,this._parseTimeOrLabel(null,c,!0,o),d,h)},f.addLabel=function(o,c){return this._labels[o]=this._parseTimeOrLabel(c),this},f.addPause=function(o,c,d,h){var u=Ce.delayedCall(0,s,d,h||this);return u.vars.onComplete=u.vars.onReverseComplete=c,u.data="isPause",this._hasPause=!0,this.add(u,o)},f.removeLabel=function(o){return delete this._labels[o],this},f.getLabelTime=function(o){return this._labels[o]!=null?this._labels[o]:-1},f._parseTimeOrLabel=function(o,c,d,h){var u,m;if(h instanceof fi&&h.timeline===this)this.remove(h);else if(h&&(h instanceof Array||h.push&&l(h)))for(m=h.length;--m>-1;)h[m]instanceof fi&&h[m].timeline===this&&this.remove(h[m]);if(u=typeof o=="number"&&!c?0:this.duration()>99999999999?this.recent().endTime(!1):this._duration,typeof c=="string")return this._parseTimeOrLabel(c,d&&typeof o=="number"&&this._labels[c]==null?o-u:0,d);if(c=c||0,typeof o=="string"&&(isNaN(o)||this._labels[o]!=null)){if(m=o.indexOf("="),m===-1)return this._labels[o]==null?d?this._labels[o]=u+c:c:this._labels[o]+c;c=parseInt(o.charAt(m-1)+"1",10)*Number(o.substr(m+1)),o=m>1?this._parseTimeOrLabel(o.substr(0,m-1),0,d):u}else o==null&&(o=u);return Number(o)+c},f.seek=function(o,c){return this.totalTime(typeof o=="number"?o:this._parseTimeOrLabel(o),c!==!1)},f.stop=function(){return this.paused(!0)},f.gotoAndPlay=function(o,c){return this.play(o,c)},f.gotoAndStop=function(o,c){return this.pause(o,c)},f.render=function(o,c,d){this._gc&&this._enabled(!0,!1);var h=this._time,u=this._dirty?this.totalDuration():this._totalDuration,m=this._startTime,g=this._timeScale,_=this._paused,y,v,b,R,M,P,T;if(h!==this._time&&(o+=this._time-h),o>=u-1e-7&&o>=0)this._totalTime=this._time=u,this._reversed||this._hasPausedChild()||(v=!0,R="onComplete",M=!!this._timeline.autoRemoveChildren,this._duration===0&&(o<=0&&o>=-1e-7||this._rawPrevTime<0||this._rawPrevTime===vt)&&this._rawPrevTime!==o&&this._first&&(M=!0,this._rawPrevTime>vt&&(R="onReverseComplete"))),this._rawPrevTime=this._duration||!c||o||this._rawPrevTime===o?o:vt,o=u+1e-4;else if(o<1e-7)if(this._totalTime=this._time=0,(h!==0||this._duration===0&&this._rawPrevTime!==vt&&(this._rawPrevTime>0||o<0&&this._rawPrevTime>=0))&&(R="onReverseComplete",v=this._reversed),o<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(M=v=!0,R="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(M=!0),this._rawPrevTime=o;else{if(this._rawPrevTime=this._duration||!c||o||this._rawPrevTime===o?o:vt,o===0&&v)for(y=this._first;y&&y._startTime===0;)y._duration||(v=!1),y=y._next;o=0,this._initted||(M=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!c){if(o>=h)for(y=this._first;y&&y._startTime<=o&&!P;)y._duration||y.data==="isPause"&&!y.ratio&&!(y._startTime===0&&this._rawPrevTime===0)&&(P=y),y=y._next;else for(y=this._last;y&&y._startTime>=o&&!P;)y._duration||y.data==="isPause"&&y._rawPrevTime>0&&(P=y),y=y._prev;P&&(this._time=o=P._startTime,this._totalTime=o+this._cycle*(this._totalDuration+this._repeatDelay))}this._totalTime=this._time=this._rawPrevTime=o}if(!((this._time===h||!this._first)&&!d&&!M&&!P)){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==h&&o>0&&(this._active=!0),h===0&&this.vars.onStart&&(this._time!==0||!this._duration)&&(c||this._callback("onStart")),T=this._time,T>=h)for(y=this._first;y&&(b=y._next,!(T!==this._time||this._paused&&!_));)(y._active||y._startTime<=T&&!y._paused&&!y._gc)&&(P===y&&this.pause(),y._reversed?y.render((y._dirty?y.totalDuration():y._totalDuration)-(o-y._startTime)*y._timeScale,c,d):y.render((o-y._startTime)*y._timeScale,c,d)),y=b;else for(y=this._last;y&&(b=y._prev,!(T!==this._time||this._paused&&!_));){if(y._active||y._startTime<=h&&!y._paused&&!y._gc){if(P===y){for(P=y._prev;P&&P.endTime()>this._time;)P.render(P._reversed?P.totalDuration()-(o-P._startTime)*P._timeScale:(o-P._startTime)*P._timeScale,c,d),P=P._prev;P=null,this.pause()}y._reversed?y.render((y._dirty?y.totalDuration():y._totalDuration)-(o-y._startTime)*y._timeScale,c,d):y.render((o-y._startTime)*y._timeScale,c,d)}y=b}this._onUpdate&&(c||(n.length&&e(),this._callback("onUpdate"))),R&&(this._gc||(m===this._startTime||g!==this._timeScale)&&(this._time===0||u>=this.totalDuration())&&(v&&(n.length&&e(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!c&&this.vars[R]&&this._callback(R)))}},f._hasPausedChild=function(){for(var o=this._first;o;){if(o._paused||o instanceof rt&&o._hasPausedChild())return!0;o=o._next}return!1},f.getChildren=function(o,c,d,h){h=h||-9999999999;for(var u=[],m=this._first,g=0;m;)m._startTime<h||(m instanceof Ce?c!==!1&&(u[g++]=m):(d!==!1&&(u[g++]=m),o!==!1&&(u=u.concat(m.getChildren(!0,c,d)),g=u.length))),m=m._next;return u},f.getTweensOf=function(o,c){var d=this._gc,h=[],u=0,m,g;for(d&&this._enabled(!0,!0),m=Ce.getTweensOf(o),g=m.length;--g>-1;)(m[g].timeline===this||c&&this._contains(m[g]))&&(h[u++]=m[g]);return d&&this._enabled(!1,!0),h},f.recent=function(){return this._recent},f._contains=function(o){for(var c=o.timeline;c;){if(c===this)return!0;c=c.timeline}return!1},f.shiftChildren=function(o,c,d){d=d||0;for(var h=this._first,u=this._labels,m;h;)h._startTime>=d&&(h._startTime+=o),h=h._next;if(c)for(m in u)u[m]>=d&&(u[m]+=o);return this._uncache(!0)},f._kill=function(o,c){if(!o&&!c)return this._enabled(!1,!1);for(var d=c?this.getTweensOf(c):this.getChildren(!0,!0,!1),h=d.length,u=!1;--h>-1;)d[h]._kill(o,c)&&(u=!0);return u},f.clear=function(o){var c=this.getChildren(!1,!0,!0),d=c.length;for(this._time=this._totalTime=0;--d>-1;)c[d]._enabled(!1,!1);return o!==!1&&(this._labels={}),this._uncache(!0)},f.invalidate=function(){for(var o=this._first;o;)o.invalidate(),o=o._next;return fi.prototype.invalidate.call(this)},f._enabled=function(o,c){if(o===this._gc)for(var d=this._first;d;)d._enabled(o,!0),d=d._next;return Pi.prototype._enabled.call(this,o,c)},f.totalTime=function(o,c,d){this._forcingPlayhead=!0;var h=fi.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,h},f.duration=function(o){return arguments.length?(this.duration()!==0&&o!==0&&this.timeScale(this._duration/o),this):(this._dirty&&this.totalDuration(),this._duration)},f.totalDuration=function(o){if(!arguments.length){if(this._dirty){for(var c=0,d=this._last,h=999999999999,u,m;d;)u=d._prev,d._dirty&&d.totalDuration(),d._startTime>h&&this._sortChildren&&!d._paused&&!this._calculatingDuration?(this._calculatingDuration=1,this.add(d,d._startTime-d._delay),this._calculatingDuration=0):h=d._startTime,d._startTime<0&&!d._paused&&(c-=d._startTime,this._timeline.smoothChildTiming&&(this._startTime+=d._startTime/this._timeScale,this._time-=d._startTime,this._totalTime-=d._startTime,this._rawPrevTime-=d._startTime),this.shiftChildren(-d._startTime,!1,-9999999999),h=0),m=d._startTime+d._totalDuration/d._timeScale,m>c&&(c=m),d=u;this._duration=this._totalDuration=c,this._dirty=!1}return this._totalDuration}return o&&this.totalDuration()?this.timeScale(this._totalDuration/o):this},f.paused=function(o){if(!o)for(var c=this._first,d=this._time;c;)c._startTime===d&&c.data==="isPause"&&(c._rawPrevTime=0),c=c._next;return fi.prototype.paused.apply(this,arguments)},f.usesFrames=function(){for(var o=this._timeline;o._timeline;)o=o._timeline;return o===fi._rootFramesTimeline},f.rawTime=function(o){return o&&(this._paused||this._repeat&&this.time()>0&&this.totalProgress()<1)?this._totalTime%(this._duration+this._repeatDelay):this._paused?this._totalTime:(this._timeline.rawTime(o)-this._startTime)*this._timeScale},rt},!0);Ci=Xe.TimelineLite});var Ks,zs=Ei(()=>{wi();ws();Ke._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(){var rt=function(i){Ci.call(this,i),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},vt=1e-10,B=Ce._internals,D=B.lazyTweens,p=B.lazyRender,l=Ke._gsDefine.globals,n=new oi(null,null,1,0),e=rt.prototype=new Ci;return e.constructor=rt,e.kill()._gc=!1,rt.version="2.0.2",e.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),Ci.prototype.invalidate.call(this)},e.addCallback=function(i,t,r,s){return this.add(Ce.delayedCall(0,i,r,s),t)},e.removeCallback=function(i,t){if(i)if(t==null)this._kill(null,i);else for(var r=this.getTweensOf(i,!1),s=r.length,a=this._parseTimeOrLabel(t);--s>-1;)r[s]._startTime===a&&r[s]._enabled(!1,!1);return this},e.removePause=function(i){return this.removeCallback(Ci._internals.pauseCallback,i)},e.tweenTo=function(i,t){t=t||{};var r={ease:n,useFrames:this.usesFrames(),immediateRender:!1,lazy:!1},s=t.repeat&&l.TweenMax||Ce,a,f,o;for(f in t)r[f]=t[f];return r.time=this._parseTimeOrLabel(i),a=Math.abs(Number(r.time)-this._time)/this._timeScale||.001,o=new s(this,a,r),r.onStart=function(){o.target.paused(!0),o.vars.time!==o.target.time()&&a===o.duration()&&!o.isFromTo&&o.duration(Math.abs(o.vars.time-o.target.time())/o.target._timeScale).render(o.time(),!0,!0),t.onStart&&t.onStart.apply(t.onStartScope||t.callbackScope||o,t.onStartParams||[])},o},e.tweenFromTo=function(i,t,r){r=r||{},i=this._parseTimeOrLabel(i),r.startAt={onComplete:this.seek,onCompleteParams:[i],callbackScope:this},r.immediateRender=r.immediateRender!==!1;var s=this.tweenTo(t,r);return s.isFromTo=1,s.duration(Math.abs(s.vars.time-i)/this._timeScale||.001)},e.render=function(i,t,r){this._gc&&this._enabled(!0,!1);var s=this._time,a=this._dirty?this.totalDuration():this._totalDuration,f=this._duration,o=this._totalTime,c=this._startTime,d=this._timeScale,h=this._rawPrevTime,u=this._paused,m=this._cycle,g,_,y,v,b,R,M,P;if(s!==this._time&&(i+=this._time-s),i>=a-1e-7&&i>=0)this._locked||(this._totalTime=a,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(_=!0,v="onComplete",b=!!this._timeline.autoRemoveChildren,this._duration===0&&(i<=0&&i>=-1e-7||h<0||h===vt)&&h!==i&&this._first&&(b=!0,h>vt&&(v="onReverseComplete"))),this._rawPrevTime=this._duration||!t||i||this._rawPrevTime===i?i:vt,this._yoyo&&this._cycle&1?this._time=i=0:(this._time=f,i=f+1e-4);else if(i<1e-7)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(s!==0||f===0&&h!==vt&&(h>0||i<0&&h>=0)&&!this._locked)&&(v="onReverseComplete",_=this._reversed),i<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(b=_=!0,v="onReverseComplete"):h>=0&&this._first&&(b=!0),this._rawPrevTime=i;else{if(this._rawPrevTime=f||!t||i||this._rawPrevTime===i?i:vt,i===0&&_)for(g=this._first;g&&g._startTime===0;)g._duration||(_=!1),g=g._next;i=0,this._initted||(b=!0)}else if(f===0&&h<0&&(b=!0),this._time=this._rawPrevTime=i,this._locked||(this._totalTime=i,this._repeat!==0&&(R=f+this._repeatDelay,this._cycle=this._totalTime/R>>0,this._cycle!==0&&this._cycle===this._totalTime/R&&o<=i&&this._cycle--,this._time=this._totalTime-this._cycle*R,this._yoyo&&this._cycle&1&&(this._time=f-this._time),this._time>f?(this._time=f,i=f+1e-4):this._time<0?this._time=i=0:i=this._time)),this._hasPause&&!this._forcingPlayhead&&!t){if(i=this._time,i>=s||this._repeat&&m!==this._cycle)for(g=this._first;g&&g._startTime<=i&&!M;)g._duration||g.data==="isPause"&&!g.ratio&&!(g._startTime===0&&this._rawPrevTime===0)&&(M=g),g=g._next;else for(g=this._last;g&&g._startTime>=i&&!M;)g._duration||g.data==="isPause"&&g._rawPrevTime>0&&(M=g),g=g._prev;M&&M._startTime<f&&(this._time=i=M._startTime,this._totalTime=i+this._cycle*(this._totalDuration+this._repeatDelay))}if(this._cycle!==m&&!this._locked){var T=this._yoyo&&(m&1)!==0,E=T===(this._yoyo&&(this._cycle&1)!==0),x=this._totalTime,S=this._cycle,L=this._rawPrevTime,C=this._time;if(this._totalTime=m*f,this._cycle<m?T=!T:this._totalTime+=f,this._time=s,this._rawPrevTime=f===0?h-1e-4:h,this._cycle=m,this._locked=!0,s=T?0:f,this.render(s,t,f===0),t||this._gc||this.vars.onRepeat&&(this._cycle=S,this._locked=!1,this._callback("onRepeat")),s!==this._time||(E&&(this._cycle=m,this._locked=!0,s=T?f+1e-4:-1e-4,this.render(s,!0,!1)),this._locked=!1,this._paused&&!u))return;this._time=C,this._totalTime=x,this._cycle=S,this._rawPrevTime=L}if((this._time===s||!this._first)&&!r&&!b&&!M){o!==this._totalTime&&this._onUpdate&&(t||this._callback("onUpdate"));return}else this._initted||(this._initted=!0);if(this._active||!this._paused&&this._totalTime!==o&&i>0&&(this._active=!0),o===0&&this.vars.onStart&&(this._totalTime!==0||!this._totalDuration)&&(t||this._callback("onStart")),P=this._time,P>=s)for(g=this._first;g&&(y=g._next,!(P!==this._time||this._paused&&!u));)(g._active||g._startTime<=this._time&&!g._paused&&!g._gc)&&(M===g&&this.pause(),g._reversed?g.render((g._dirty?g.totalDuration():g._totalDuration)-(i-g._startTime)*g._timeScale,t,r):g.render((i-g._startTime)*g._timeScale,t,r)),g=y;else for(g=this._last;g&&(y=g._prev,!(P!==this._time||this._paused&&!u));){if(g._active||g._startTime<=s&&!g._paused&&!g._gc){if(M===g){for(M=g._prev;M&&M.endTime()>this._time;)M.render(M._reversed?M.totalDuration()-(i-M._startTime)*M._timeScale:(i-M._startTime)*M._timeScale,t,r),M=M._prev;M=null,this.pause()}g._reversed?g.render((g._dirty?g.totalDuration():g._totalDuration)-(i-g._startTime)*g._timeScale,t,r):g.render((i-g._startTime)*g._timeScale,t,r)}g=y}this._onUpdate&&(t||(D.length&&p(),this._callback("onUpdate"))),v&&(this._locked||this._gc||(c===this._startTime||d!==this._timeScale)&&(this._time===0||a>=this.totalDuration())&&(_&&(D.length&&p(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!t&&this.vars[v]&&this._callback(v)))},e.getActive=function(i,t,r){i==null&&(i=!0),t==null&&(t=!0),r==null&&(r=!1);var s=[],a=this.getChildren(i,t,r),f=0,o=a.length,c,d;for(c=0;c<o;c++)d=a[c],d.isActive()&&(s[f++]=d);return s},e.getLabelAfter=function(i){i||i!==0&&(i=this._time);var t=this.getLabelsArray(),r=t.length,s;for(s=0;s<r;s++)if(t[s].time>i)return t[s].name;return null},e.getLabelBefore=function(i){i==null&&(i=this._time);for(var t=this.getLabelsArray(),r=t.length;--r>-1;)if(t[r].time<i)return t[r].name;return null},e.getLabelsArray=function(){var i=[],t=0,r;for(r in this._labels)i[t++]={time:this._labels[r],name:r};return i.sort(function(s,a){return s.time-a.time}),i},e.invalidate=function(){return this._locked=!1,Ci.prototype.invalidate.call(this)},e.progress=function(i,t){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&this._cycle&1?1-i:i)+this._cycle*(this._duration+this._repeatDelay),t):this._time/this.duration()||0},e.totalProgress=function(i,t){return arguments.length?this.totalTime(this.totalDuration()*i,t):this._totalTime/this.totalDuration()||0},e.totalDuration=function(i){return arguments.length?this._repeat===-1||!i?this:this.timeScale(this.totalDuration()/i):(this._dirty&&(Ci.prototype.totalDuration.call(this),this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},e.time=function(i,t){return arguments.length?(this._dirty&&this.totalDuration(),i>this._duration&&(i=this._duration),this._yoyo&&this._cycle&1?i=this._duration-i+this._cycle*(this._duration+this._repeatDelay):this._repeat!==0&&(i+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(i,t)):this._time},e.repeat=function(i){return arguments.length?(this._repeat=i,this._uncache(!0)):this._repeat},e.repeatDelay=function(i){return arguments.length?(this._repeatDelay=i,this._uncache(!0)):this._repeatDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.getLabelBefore(this._time+1e-8)},rt},!0);Ks=Xe.TimelineMax});var ja,Ni,zi,Ki,sr,qa,Xi,Ya,bs,Ha,Xa,js,$a,Za,Qa,Li,qs,Ys=Ei(()=>{wi();ja=180/Math.PI,Ni=[],zi=[],Ki=[],sr={},qa=Ke._gsDefine.globals,Xi=function(rt,vt,B,D){B===D&&(B=D-(D-vt)/1e6),rt===vt&&(vt=rt+(B-rt)/1e6),this.a=rt,this.b=vt,this.c=B,this.d=D,this.da=D-rt,this.ca=B-rt,this.ba=vt-rt},Ya=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",bs=function(rt,vt,B,D){var p={a:rt},l={},n={},e={c:D},i=(rt+vt)/2,t=(vt+B)/2,r=(B+D)/2,s=(i+t)/2,a=(t+r)/2,f=(a-s)/8;return p.b=i+(rt-i)/4,l.b=s+f,p.c=l.a=(p.b+l.b)/2,l.c=n.a=(s+a)/2,n.b=a-f,e.b=r+(D-r)/4,n.c=e.a=(n.b+e.b)/2,[p,l,n,e]},Ha=function(rt,vt,B,D,p){var l=rt.length-1,n=0,e=rt[0].a,i,t,r,s,a,f,o,c,d,h,u,m,g;for(i=0;i<l;i++)a=rt[n],t=a.a,r=a.d,s=rt[n+1].d,p?(u=Ni[i],m=zi[i],g=(m+u)*vt*.25/(D?.5:Ki[i]||.5),f=r-(r-t)*(D?vt*.5:u!==0?g/u:0),o=r+(s-r)*(D?vt*.5:m!==0?g/m:0),c=r-(f+((o-f)*(u*3/(u+m)+.5)/4||0))):(f=r-(r-t)*vt*.5,o=r+(s-r)*vt*.5,c=r-(f+o)/2),f+=c,o+=c,a.c=d=f,i!==0?a.b=e:a.b=e=a.a+(a.c-a.a)*.6,a.da=r-t,a.ca=d-t,a.ba=e-t,B?(h=bs(t,e,d,r),rt.splice(n,1,h[0],h[1],h[2],h[3]),n+=4):n++,e=o;a=rt[n],a.b=e,a.c=e+(a.d-e)*.4,a.da=a.d-a.a,a.ca=a.c-a.a,a.ba=e-a.a,B&&(h=bs(a.a,e,a.c,a.d),rt.splice(n,1,h[0],h[1],h[2],h[3]))},Xa=function(rt,vt,B,D){var p=[],l,n,e,i,t,r;if(D)for(rt=[D].concat(rt),n=rt.length;--n>-1;)typeof(r=rt[n][vt])=="string"&&r.charAt(1)==="="&&(rt[n][vt]=D[vt]+Number(r.charAt(0)+r.substr(2)));if(l=rt.length-2,l<0)return p[0]=new Xi(rt[0][vt],0,0,rt[0][vt]),p;for(n=0;n<l;n++)e=rt[n][vt],i=rt[n+1][vt],p[n]=new Xi(e,0,0,i),B&&(t=rt[n+2][vt],Ni[n]=(Ni[n]||0)+(i-e)*(i-e),zi[n]=(zi[n]||0)+(t-i)*(t-i));return p[n]=new Xi(rt[n][vt],0,0,rt[n+1][vt]),p},js=function(rt,vt,B,D,p,l){var n={},e=[],i=l||rt[0],t,r,s,a,f,o,c,d;p=typeof p=="string"?","+p+",":Ya,vt==null&&(vt=1);for(r in rt[0])e.push(r);if(rt.length>1){for(d=rt[rt.length-1],c=!0,t=e.length;--t>-1;)if(r=e[t],Math.abs(i[r]-d[r])>.05){c=!1;break}c&&(rt=rt.concat(),l&&rt.unshift(l),rt.push(rt[1]),l=rt[rt.length-3])}for(Ni.length=zi.length=Ki.length=0,t=e.length;--t>-1;)r=e[t],sr[r]=p.indexOf(","+r+",")!==-1,n[r]=Xa(rt,r,sr[r],l);for(t=Ni.length;--t>-1;)Ni[t]=Math.sqrt(Ni[t]),zi[t]=Math.sqrt(zi[t]);if(!D){for(t=e.length;--t>-1;)if(sr[r])for(s=n[e[t]],o=s.length-1,a=0;a<o;a++)f=s[a+1].da/zi[a]+s[a].da/Ni[a]||0,Ki[a]=(Ki[a]||0)+f*f;for(t=Ki.length;--t>-1;)Ki[t]=Math.sqrt(Ki[t])}for(t=e.length,a=B?4:1;--t>-1;)r=e[t],s=n[r],Ha(s,vt,B,D,sr[r]),c&&(s.splice(0,a),s.splice(s.length-a,a));return n},$a=function(rt,vt,B){vt=vt||"soft";var D={},p=vt==="cubic"?3:2,l=vt==="soft",n=[],e,i,t,r,s,a,f,o,c,d,h;if(l&&B&&(rt=[B].concat(rt)),rt==null||rt.length<p+1)throw"invalid Bezier data";for(c in rt[0])n.push(c);for(a=n.length;--a>-1;){for(c=n[a],D[c]=s=[],d=0,o=rt.length,f=0;f<o;f++)e=B==null?rt[f][c]:typeof(h=rt[f][c])=="string"&&h.charAt(1)==="="?B[c]+Number(h.charAt(0)+h.substr(2)):Number(h),l&&f>1&&f<o-1&&(s[d++]=(e+s[d-2])/2),s[d++]=e;for(o=d-p+1,d=0,f=0;f<o;f+=p)e=s[f],i=s[f+1],t=s[f+2],r=p===2?0:s[f+3],s[d++]=h=p===3?new Xi(e,i,t,r):new Xi(e,(2*i+e)/3,(2*i+t)/3,t);s.length=d}return D},Za=function(rt,vt,B){for(var D=1/B,p=rt.length,l,n,e,i,t,r,s,a,f,o,c;--p>-1;)for(o=rt[p],e=o.a,i=o.d-e,t=o.c-e,r=o.b-e,l=n=0,a=1;a<=B;a++)s=D*a,f=1-s,l=n-(n=(s*s*i+3*f*(s*t+f*r))*s),c=p*B+a-1,vt[c]=(vt[c]||0)+l*l},Qa=function(rt,vt){vt=vt>>0||6;var B=[],D=[],p=0,l=0,n=vt-1,e=[],i=[],t,r,s,a;for(t in rt)Za(rt[t],B,vt);for(s=B.length,r=0;r<s;r++)p+=Math.sqrt(B[r]),a=r%vt,i[a]=p,a===n&&(l+=p,a=r/vt>>0,e[a]=i,D[a]=l,p=0,i=[]);return{length:l,lengths:D,segments:e}},Li=Ke._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.8",API:2,global:!0,init:function(rt,vt,B){this._target=rt,vt instanceof Array&&(vt={values:vt}),this._func={},this._mod={},this._props=[],this._timeRes=vt.timeResolution==null?6:parseInt(vt.timeResolution,10);var D=vt.values||[],p={},l=D[0],n=vt.autoRotate||B.vars.orientToBezier,e,i,t,r,s;this._autoRotate=n?n instanceof Array?n:[["x","y","rotation",n===!0?0:Number(n)||0]]:null;for(e in l)this._props.push(e);for(t=this._props.length;--t>-1;)e=this._props[t],this._overwriteProps.push(e),i=this._func[e]=typeof rt[e]=="function",p[e]=i?rt[e.indexOf("set")||typeof rt["get"+e.substr(3)]!="function"?e:"get"+e.substr(3)]():parseFloat(rt[e]),s||p[e]!==D[0][e]&&(s=p);if(this._beziers=vt.type!=="cubic"&&vt.type!=="quadratic"&&vt.type!=="soft"?js(D,isNaN(vt.curviness)?1:vt.curviness,!1,vt.type==="thruBasic",vt.correlate,s):$a(D,vt.type,p),this._segCount=this._beziers[e].length,this._timeRes){var a=Qa(this._beziers,this._timeRes);this._length=a.length,this._lengths=a.lengths,this._segments=a.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(n=this._autoRotate)for(this._initialRotations=[],n[0]instanceof Array||(this._autoRotate=n=[n]),t=n.length;--t>-1;){for(r=0;r<3;r++)e=n[t][r],this._func[e]=typeof rt[e]=="function"?rt[e.indexOf("set")||typeof rt["get"+e.substr(3)]!="function"?e:"get"+e.substr(3)]:!1;e=n[t][2],this._initialRotations[t]=(this._func[e]?this._func[e].call(this._target):this._target[e])||0,this._overwriteProps.push(e)}return this._startRatio=B.vars.runBackwards?1:0,!0},set:function(rt){var vt=this._segCount,B=this._func,D=this._target,p=rt!==this._startRatio,l,n,e,i,t,r,s,a,f,o;if(!this._timeRes)l=rt<0?0:rt>=1?vt-1:vt*rt>>0,r=(rt-l*(1/vt))*vt;else{if(f=this._lengths,o=this._curSeg,rt*=this._length,e=this._li,rt>this._l2&&e<vt-1){for(a=vt-1;e<a&&(this._l2=f[++e])<=rt;);this._l1=f[e-1],this._li=e,this._curSeg=o=this._segments[e],this._s2=o[this._s1=this._si=0]}else if(rt<this._l1&&e>0){for(;e>0&&(this._l1=f[--e])>=rt;);e===0&&rt<this._l1?this._l1=0:e++,this._l2=f[e],this._li=e,this._curSeg=o=this._segments[e],this._s1=o[(this._si=o.length-1)-1]||0,this._s2=o[this._si]}if(l=e,rt-=this._l1,e=this._si,rt>this._s2&&e<o.length-1){for(a=o.length-1;e<a&&(this._s2=o[++e])<=rt;);this._s1=o[e-1],this._si=e}else if(rt<this._s1&&e>0){for(;e>0&&(this._s1=o[--e])>=rt;);e===0&&rt<this._s1?this._s1=0:e++,this._s2=o[e],this._si=e}r=(e+(rt-this._s1)/(this._s2-this._s1))*this._prec||0}for(n=1-r,e=this._props.length;--e>-1;)i=this._props[e],t=this._beziers[i][l],s=(r*r*t.da+3*n*(r*t.ca+n*t.ba))*r+t.a,this._mod[i]&&(s=this._mod[i](s,D)),B[i]?D[i](s):D[i]=s;if(this._autoRotate){var c=this._autoRotate,d,h,u,m,g,_,y;for(e=c.length;--e>-1;)i=c[e][2],_=c[e][3]||0,y=c[e][4]===!0?1:ja,t=this._beziers[c[e][0]],d=this._beziers[c[e][1]],t&&d&&(t=t[l],d=d[l],h=t.a+(t.b-t.a)*r,m=t.b+(t.c-t.b)*r,h+=(m-h)*r,m+=(t.c+(t.d-t.c)*r-m)*r,u=d.a+(d.b-d.a)*r,g=d.b+(d.c-d.b)*r,u+=(g-u)*r,g+=(d.c+(d.d-d.c)*r-g)*r,s=p?Math.atan2(g-u,m-h)*y+_:this._initialRotations[e],this._mod[i]&&(s=this._mod[i](s,D)),B[i]?D[i](s):D[i]=s)}}}),qs=Li.prototype;Li.bezierThrough=js;Li.cubicToQuadratic=bs;Li._autoCSS=!0;Li.quadraticToCubic=function(rt,vt,B){return new Xi(rt,(2*vt+rt)/3,(2*vt+B)/3,B)};Li._cssRegister=function(){var rt=qa.CSSPlugin;if(rt){var vt=rt._internals,B=vt._parseToProxy,D=vt._setPluginRatio,p=vt.CSSPropTween;vt._registerComplexSpecialProp("bezier",{parser:function(l,n,e,i,t,r){n instanceof Array&&(n={values:n}),r=new Li;var s=n.values,a=s.length-1,f=[],o={},c,d,h;if(a<0)return t;for(c=0;c<=a;c++)h=B(l,s[c],i,t,r,a!==c),f[c]=h.end;for(d in n)o[d]=n[d];return o.values=f,t=new p(l,"bezier",0,0,h.pt,2),t.data=h,t.plugin=r,t.setRatio=D,o.autoRotate===0&&(o.autoRotate=!0),o.autoRotate&&!(o.autoRotate instanceof Array)&&(c=o.autoRotate===!0?0:Number(o.autoRotate),o.autoRotate=h.end.left!=null?[["left","top","rotation",c,!1]]:h.end.x!=null?[["x","y","rotation",c,!1]]:!1),o.autoRotate&&(i._transform||i._enableTransforms(!1),h.autoRotate=i._target._gsTransform,h.proxy.rotation=h.autoRotate.rotation||0,i._overwriteProps.push("rotation")),r._onInitTween(h.proxy,o,i._tween),t}})}};qs._mod=function(rt){for(var vt=this._overwriteProps,B=vt.length,D;--B>-1;)D=rt[vt[B]],D&&typeof D=="function"&&(this._mod[vt[B]]=D)};qs._kill=function(rt){var vt=this._props,B,D;for(B in this._beziers)if(B in rt)for(delete this._beziers[B],delete this._func[B],D=vt.length;--D>-1;)vt[D]===B&&vt.splice(D,1);if(vt=this._autoRotate,vt)for(D=vt.length;--D>-1;)rt[vt[D][2]]&&vt.splice(D,1);return this._super._kill.call(this,rt)}});var Hs,Xs,$s,Zs,Qs,Js,ta,ea,ia,ra,na=Ei(()=>{wi();Ke._gsDefine("easing.Back",["easing.Ease"],function(){var rt=Ke.GreenSockGlobals||Ke,vt=rt.com.greensock,B=Math.PI*2,D=Math.PI/2,p=vt._class,l=function(h,u){var m=p("easing."+h,function(){},!0),g=m.prototype=new oi;return g.constructor=m,g.getRatio=u,m},n=oi.register||function(){},e=function(h,u,m,g,_){var y=p("easing."+h,{easeOut:new u,easeIn:new m,easeInOut:new g},!0);return n(y,h),y},i=function(h,u,m){this.t=h,this.v=u,m&&(this.next=m,m.prev=this,this.c=m.v-u,this.gap=m.t-h)},t=function(h,u){var m=p("easing."+h,function(_){this._p1=_||_===0?_:1.70158,this._p2=this._p1*1.525},!0),g=m.prototype=new oi;return g.constructor=m,g.getRatio=u,g.config=function(_){return new m(_)},m},r=e("Back",t("BackOut",function(h){return(h=h-1)*h*((this._p1+1)*h+this._p1)+1}),t("BackIn",function(h){return h*h*((this._p1+1)*h-this._p1)}),t("BackInOut",function(h){return(h*=2)<1?.5*h*h*((this._p2+1)*h-this._p2):.5*((h-=2)*h*((this._p2+1)*h+this._p2)+2)})),s=p("easing.SlowMo",function(h,u,m){u=u||u===0?u:.7,h==null?h=.7:h>1&&(h=1),this._p=h!==1?u:0,this._p1=(1-h)/2,this._p2=h,this._p3=this._p1+this._p2,this._calcEnd=m===!0},!0),a=s.prototype=new oi,f,o,c,d;return a.constructor=s,a.getRatio=function(h){var u=h+(.5-h)*this._p;return h<this._p1?this._calcEnd?1-(h=1-h/this._p1)*h:u-(h=1-h/this._p1)*h*h*h*u:h>this._p3?this._calcEnd?h===1?0:1-(h=(h-this._p3)/this._p1)*h:u+(h-u)*(h=(h-this._p3)/this._p1)*h*h*h:this._calcEnd?1:u},s.ease=new s(.7,.7),a.config=s.config=function(h,u,m){return new s(h,u,m)},f=p("easing.SteppedEase",function(h,u){h=h||1,this._p1=1/h,this._p2=h+(u?0:1),this._p3=u?1:0},!0),a=f.prototype=new oi,a.constructor=f,a.getRatio=function(h){return h<0?h=0:h>=1&&(h=.999999999),((this._p2*h|0)+this._p3)*this._p1},a.config=f.config=function(h,u){return new f(h,u)},o=p("easing.ExpoScaleEase",function(h,u,m){this._p1=Math.log(u/h),this._p2=u-h,this._p3=h,this._ease=m},!0),a=o.prototype=new oi,a.constructor=o,a.getRatio=function(h){return this._ease&&(h=this._ease.getRatio(h)),(this._p3*Math.exp(this._p1*h)-this._p3)/this._p2},a.config=o.config=function(h,u,m){return new o(h,u,m)},c=p("easing.RoughEase",function(h){h=h||{};for(var u=h.taper||"none",m=[],g=0,_=(h.points||20)|0,y=_,v=h.randomize!==!1,b=h.clamp===!0,R=h.template instanceof oi?h.template:null,M=typeof h.strength=="number"?h.strength*.4:.4,P,T,E,x,S,L;--y>-1;)P=v?Math.random():1/_*y,T=R?R.getRatio(P):P,u==="none"?E=M:u==="out"?(x=1-P,E=x*x*M):u==="in"?E=P*P*M:P<.5?(x=P*2,E=x*x*.5*M):(x=(1-P)*2,E=x*x*.5*M),v?T+=Math.random()*E-E*.5:y%2?T+=E*.5:T-=E*.5,b&&(T>1?T=1:T<0&&(T=0)),m[g++]={x:P,y:T};for(m.sort(function(C,F){return C.x-F.x}),L=new i(1,1,null),y=_;--y>-1;)S=m[y],L=new i(S.x,S.y,L);this._prev=new i(0,0,L.t!==0?L:L.next)},!0),a=c.prototype=new oi,a.constructor=c,a.getRatio=function(h){var u=this._prev;if(h>u.t){for(;u.next&&h>=u.t;)u=u.next;u=u.prev}else for(;u.prev&&h<=u.t;)u=u.prev;return this._prev=u,u.v+(h-u.t)/u.gap*u.c},a.config=function(h){return new c(h)},c.ease=new c,e("Bounce",l("BounceOut",function(h){return h<1/2.75?7.5625*h*h:h<2/2.75?7.5625*(h-=1.5/2.75)*h+.75:h<2.5/2.75?7.5625*(h-=2.25/2.75)*h+.9375:7.5625*(h-=2.625/2.75)*h+.984375}),l("BounceIn",function(h){return(h=1-h)<1/2.75?1-7.5625*h*h:h<2/2.75?1-(7.5625*(h-=1.5/2.75)*h+.75):h<2.5/2.75?1-(7.5625*(h-=2.25/2.75)*h+.9375):1-(7.5625*(h-=2.625/2.75)*h+.984375)}),l("BounceInOut",function(h){var u=h<.5;return u?h=1-h*2:h=h*2-1,h<1/2.75?h=7.5625*h*h:h<2/2.75?h=7.5625*(h-=1.5/2.75)*h+.75:h<2.5/2.75?h=7.5625*(h-=2.25/2.75)*h+.9375:h=7.5625*(h-=2.625/2.75)*h+.984375,u?(1-h)*.5:h*.5+.5})),e("Circ",l("CircOut",function(h){return Math.sqrt(1-(h=h-1)*h)}),l("CircIn",function(h){return-(Math.sqrt(1-h*h)-1)}),l("CircInOut",function(h){return(h*=2)<1?-.5*(Math.sqrt(1-h*h)-1):.5*(Math.sqrt(1-(h-=2)*h)+1)})),d=function(h,u,m){var g=p("easing."+h,function(y,v){this._p1=y>=1?y:1,this._p2=(v||m)/(y<1?y:1),this._p3=this._p2/B*(Math.asin(1/this._p1)||0),this._p2=B/this._p2},!0),_=g.prototype=new oi;return _.constructor=g,_.getRatio=u,_.config=function(y,v){return new g(y,v)},g},e("Elastic",d("ElasticOut",function(h){return this._p1*Math.pow(2,-10*h)*Math.sin((h-this._p3)*this._p2)+1},.3),d("ElasticIn",function(h){return-(this._p1*Math.pow(2,10*(h-=1))*Math.sin((h-this._p3)*this._p2))},.3),d("ElasticInOut",function(h){return(h*=2)<1?-.5*(this._p1*Math.pow(2,10*(h-=1))*Math.sin((h-this._p3)*this._p2)):this._p1*Math.pow(2,-10*(h-=1))*Math.sin((h-this._p3)*this._p2)*.5+1},.45)),e("Expo",l("ExpoOut",function(h){return 1-Math.pow(2,-10*h)}),l("ExpoIn",function(h){return Math.pow(2,10*(h-1))-.001}),l("ExpoInOut",function(h){return(h*=2)<1?.5*Math.pow(2,10*(h-1)):.5*(2-Math.pow(2,-10*(h-1)))})),e("Sine",l("SineOut",function(h){return Math.sin(h*D)}),l("SineIn",function(h){return-Math.cos(h*D)+1}),l("SineInOut",function(h){return-.5*(Math.cos(Math.PI*h)-1)})),p("easing.EaseLookup",{find:function(h){return oi.map[h]}},!0),n(rt.SlowMo,"SlowMo","ease,"),n(c,"RoughEase","ease,"),n(f,"SteppedEase","ease,"),r},!0);Hs=Xe.Back,Xs=Xe.Elastic,$s=Xe.Bounce,Zs=Xe.RoughEase,Qs=Xe.SlowMo,Js=Xe.SteppedEase,ta=Xe.Circ,ea=Xe.Expo,ia=Xe.Sine,ra=Xe.ExpoScaleEase});var Ja,sa=Ei(()=>{wi();Ds();Fs();Gs();Bs();Us();ws();zs();Ys();na();Ja=Ns;Ja._autoActivated=[Ci,Ks,ks,Vs,Li,vs,Es,Hs,Xs,$s,Zs,Qs,Js,ta,ea,ia,ra]});var aa=Ii((Ts,ji)=>{(function(rt,vt){typeof Ts=="object"?ji.exports=vt():typeof define=="function"&&define.amd?define([],vt):rt.WorldWind=vt()})(Ts,function(){var rt,vt,B;(function(p){var l,n,e,i,t={},r={},s={},a={},f=Object.prototype.hasOwnProperty,o=[].slice,c=/\.js$/;function d(b,R){return f.call(b,R)}function h(b,R){var M,P,T,E,x,S,L,C,F,q,it,st=R&&R.split("/"),pt=s.map,_t=pt&&pt["*"]||{};if(b&&b.charAt(0)===".")if(R){for(st=st.slice(0,st.length-1),b=b.split("/"),x=b.length-1,s.nodeIdCompat&&c.test(b[x])&&(b[x]=b[x].replace(c,"")),b=st.concat(b),F=0;F<b.length;F+=1)if(it=b[F],it===".")b.splice(F,1),F-=1;else if(it===".."){if(F===1&&(b[2]===".."||b[0]===".."))break;F>0&&(b.splice(F-1,2),F-=2)}b=b.join("/")}else b.indexOf("./")===0&&(b=b.substring(2));if((st||_t)&&pt){for(M=b.split("/"),F=M.length;F>0;F-=1){if(P=M.slice(0,F).join("/"),st){for(q=st.length;q>0;q-=1)if(T=pt[st.slice(0,q).join("/")],T&&(T=T[P],T)){E=T,S=F;break}}if(E)break;!L&&_t&&_t[P]&&(L=_t[P],C=F)}!E&&L&&(E=L,S=C),E&&(M.splice(0,S,E),b=M.join("/"))}return b}function u(b,R){return function(){var M=o.call(arguments,0);return typeof M[0]!="string"&&M.length===1&&M.push(null),n.apply(p,M.concat([b,R]))}}function m(b){return function(R){return h(R,b)}}function g(b){return function(R){t[b]=R}}function _(b){if(d(r,b)){var R=r[b];delete r[b],a[b]=!0,l.apply(p,R)}if(!d(t,b)&&!d(a,b))throw new Error("No "+b);return t[b]}function y(b){var R,M=b?b.indexOf("!"):-1;return M>-1&&(R=b.substring(0,M),b=b.substring(M+1,b.length)),[R,b]}e=function(b,R){var M,P=y(b),T=P[0];return b=P[1],T&&(T=h(T,R),M=_(T)),T?M&&M.normalize?b=M.normalize(b,m(R)):b=h(b,R):(b=h(b,R),P=y(b),T=P[0],b=P[1],T&&(M=_(T))),{f:T?T+"!"+b:b,n:b,pr:T,p:M}};function v(b){return function(){return s&&s.config&&s.config[b]||{}}}i={require:function(b){return u(b)},exports:function(b){var R=t[b];return typeof R<"u"?R:t[b]={}},module:function(b){return{id:b,uri:"",exports:t[b],config:v(b)}}},l=function(b,R,M,P){var T,E,x,S,L,C=[],F=typeof M,q;if(P=P||b,F==="undefined"||F==="function"){for(R=!R.length&&M.length?["require","exports","module"]:R,L=0;L<R.length;L+=1)if(S=e(R[L],P),E=S.f,E==="require")C[L]=i.require(b);else if(E==="exports")C[L]=i.exports(b),q=!0;else if(E==="module")T=C[L]=i.module(b);else if(d(t,E)||d(r,E)||d(a,E))C[L]=_(E);else if(S.p)S.p.load(S.n,u(P,!0),g(E),{}),C[L]=t[E];else throw new Error(b+" missing "+E);x=M?M.apply(t[b],C):void 0,b&&(T&&T.exports!==p&&T.exports!==t[b]?t[b]=T.exports:(x!==p||!q)&&(t[b]=x))}else b&&(t[b]=M)},rt=vt=n=function(b,R,M,P,T){if(typeof b=="string")return i[b]?i[b](R):_(e(b,R).f);if(!b.splice){if(s=b,s.deps&&n(s.deps,s.callback),!R)return;R.splice?(b=R,R=M,M=null):b=p}return R=R||function(){},typeof M=="function"&&(M=P,P=T),P?l(p,b,R,M):setTimeout(function(){l(p,b,R,M)},4),n},n.config=function(b){return n(b)},rt._defined=t,B=function(b,R,M){R.splice||(M=R,R=[]),!d(t,b)&&!d(r,b)&&(r[b]=[b,R,M])},B.amd={jQuery:!0}})(),B("../tools/almond",function(){}),B("formats/aaigrid/AAIGridConstants",[],function(){"use strict";var p={N_COLS:"ncols",N_ROWS:"nrows",X_LL_CORNER:"xllcorner",Y_LL_CORNER:"yllcorner",CELL_SIZE:"cellsize",NO_DATA_VALUE:"NODATA_value"};return p}),B("formats/aaigrid/AAIGridMetadata",[],function(){"use strict";var p=function(){this._ncols=null,this._nrows=null,this._xllcorner=null,this._yllcorner=null,this._cellsize=null,this._NODATA_value=void 0};return Object.defineProperties(p.prototype,{ncols:{get:function(){return this._ncols},set:function(l){this._ncols=l}},nrows:{get:function(){return this._nrows},set:function(l){this._nrows=l}},xllcorner:{get:function(){return this._xllcorner},set:function(l){this._xllcorner=l}},yllcorner:{get:function(){return this._yllcorner},set:function(l){this._yllcorner=l}},cellsize:{get:function(){return this._cellsize},set:function(l){this._cellsize=l}},NODATA_value:{get:function(){return this._NODATA_value},set:function(l){this._NODATA_value=l}}}),p}),B("error/AbstractError",[],function(){"use strict";var p=function(l,n){this.name=l,this.message=n};return p.prototype.toString=function(){var l=this.name+": "+this.message;return this.stack&&(l+="\n"+this.stack.toString()),l},p}),B("error/ArgumentError",["../error/AbstractError"],function(p){"use strict";var l=function(n){p.call(this,"ArgumentError",n);var e;try{throw new Error}catch(i){e=i.stack}this.stack=e};return l.prototype=Object.create(p.prototype),l}),B("util/Logger",[],function(){"use strict";var p={LEVEL_NONE:0,LEVEL_SEVERE:1,LEVEL_WARNING:2,LEVEL_INFO:3,setLoggingLevel:function(n){l=n},getLoggingLevel:function(){return l},log:function(n,e){e&&n>0&&n<=l&&(n===p.LEVEL_SEVERE?console.error(e):n===p.LEVEL_WARNING?console.warn(e):n===p.LEVEL_INFO?console.info(e):console.log(e))},makeMessage:function(n,e,i){var t=this.messageTable[i]?this.messageTable[i]:i;return n+"."+e+": "+t},logMessage:function(n,e,i,t){var r=this.makeMessage(e,i,t);return this.log(n,r),r},messageTable:{abstractInvocation:"The function called is abstract and must be overridden in a subclass.",indexOutOfRange:"The specified index is out of range.",invalidColumn:"The specified column is out of range.",invalidHeight:"The specified height is zero or negative.",invalidWidth:"The specified width is zero or negative.",invalidRow:"The specified row is out of range.",invalidSize:"The specified size is zero or negative.",missingAltitudeMode:"The specified altitude mode is null or undefined.",missingArrayBuffer:"The specified array buffer is null or undefined",missingAttributeName:"The specified DBase attribute file name is null or undefined.",missingArray:"The specified array is null, undefined or of insufficient length.",missingBoundaries:"The specified boundaries array is null or undefined.",missingBuffer:"The specified buffer descriptor is null or undefined.",missingColor:"The specified color is null or undefined.",missingConfig:"The specified config is null or undefined.",missingDc:"The specified draw context is null or undefined.",missingDomElement:"The specified DOM element is null or undefined.",missingEntry:"The specified entry is null or undefined.",missingFont:"The specified font is null or undefined.",missingFrustum:"The specified frustum is null or undefined.",missingFunction:"The specified function is null or undefined.",missingGlContext:"The specified WebGL rendering context is null or undefined.",missingGlobe:"The specified globe is null or undefined.",missingId:"The specified id is null or undefined.",missingImage:"The specified image is null or undefined.",missingImageFormat:"The specified image format is null or undefined.",missingIndices:"The specified indices array is null or undefined.",missingKey:"The specified key is null or undefined.",missingLevel:"The specified level is null or undefined.",missingLine:"The specified line is null or undefined.",missingList:"The specified list is null or undefined.",missingListener:"The specified listener is null or undefined",missingLocation:"The specified location is null or undefined.",missingMatrix:"The specified matrix is null or undefined.",missingOffset:"The specified offset is null or undefined.",missingPath:"The specified path is null or undefined.",missingPlacename:"The specified place name is null or undefined.",missingPlane:"The specified plane is null or undefined.",missingPoint:"The specified point is null or undefined.",missingPoints:"The specified points array is null or undefined.",missingPosition:"The specified position is null or undefined.",missingPositions:"The specified positions array is null or undefined.",missingProgram:"The specified program is null or undefined.",missingProjection:"The specified projection is null or undefined.",missingRectangle:"The specified rectangle is null or undefined.",missingRenderable:"The specified renderable is null or undefined.",missingResolution:"The specified resolution is null, undefined, or zero.",missingResource:"The specified resource is null or undefined.",missingResult:"The specified result variable is null or undefined.",missingResults:"The specified results array is null or undefined.",missingSector:"The specified sector is null or undefined.",missingShapeType:"The specified shape type is null or undefined.",missingSize:"The specified size is null or undefined.",missingText:"The specified text is null or undefined.",missingTexture:"The specified texture is null or undefined.",missingTile:"The specified tile is null or undefined.",missingType:"The specified type is null or undefined.",missingUrl:"The specified URL is null or undefined",missingVector:"The specified vector is null or undefined.",missingVertex:"The specified vertex is null or undefined.",missingViewport:"The specified viewport is null or undefined.",missingWebCoverageService:"The specified WebCoverageService is null or undefined.",missingWorldWindow:"The specified WorldWindow is null or undefined.",notYetImplemented:"This function is not yet implemented",unsupportedVersion:"The specified version is not supported.",webglNotSupported:"The browser does not support WebGL, or WebGL is disabled."}},l=1;return p}),B("formats/aaigrid/AAIGridReader",["./AAIGridConstants","./AAIGridMetadata","../../error/ArgumentError","../../util/Logger"],function(p,l,n,e){"use strict";var i=function(t){if(!t)throw new n(e.logMessage(e.LEVEL_SEVERE,"AAIGridReader","constructor","missingDataSource"));if(typeof t!="string"&&!(t instanceof ArrayBuffer))throw new n(e.logMessage(e.LEVEL_SEVERE,"AAIGridReader","constructor","invalidDataSource"));this._values=null,this._metadata=new l;var r=this.decodeData(t);this.parse(r)};return Object.defineProperties(i.prototype,{metadata:{get:function(){return this._metadata}}}),i.prototype.getImageData=function(){return this._values},i.prototype.decodeData=function(t){if(typeof t!="string"&&!(t instanceof ArrayBuffer))throw new n(e.logMessage(e.LEVEL_SEVERE,"AAIGridReader","decodeData","invalidDataSource"));if(typeof t=="string")return t;if(typeof window.TextDecoder=="function"){var r=new TextDecoder("utf-8");return r.decode(t)}for(var s="",a=new Uint8Array(t),f=65535,o=0,c=a.length;o<c;o+=f)o+f>c&&(f=c-o),s+=String.fromCharCode.apply(null,a.subarray(o,o+f));return s},i.prototype.parse=function(t){if(typeof t!="string")throw new n(e.logMessage(e.LEVEL_SEVERE,"AAIGridReader","parse","invalidDataString"));for(var r=t.replace(/\r?\n|\r/g,"\n").split("\n"),s=[],a=!0,f=0,o=r.length;f<o;f++){var c=r[f];if(c){var d=c.trim().split(" ").map(function(u){return u.trim()}).filter(function(u){return u!==""});if(d[0]===p.N_COLS)this.metadata.ncols=+d[1];else if(d[0]===p.N_ROWS)this.metadata.nrows=+d[1];else if(d[0]===p.X_LL_CORNER)this.metadata.xllcorner=+d[1];else if(d[0]===p.Y_LL_CORNER)this.metadata.yllcorner=+d[1];else if(d[0]===p.CELL_SIZE)this.metadata.cellsize=+d[1];else if(d[0]===p.NO_DATA_VALUE)this.metadata.NODATA_value=+d[1];else if(isFinite(+d[0])){var h=d.map(function(u){var m=+u;return Math.floor(m)!==m&&(a=!1),m});s=s.concat(h)}}}this._values=a?new Int16Array(s):new Float32Array(s)},i.retrieveFromUrl=function(t,r){if(!t)throw new n(e.logMessage(e.LEVEL_SEVERE,"AAIGridReader","retrieveFromUrl","missingUrl"));if(!r)throw new n(e.logMessage(e.LEVEL_SEVERE,"AAIGridReader","retrieveFromUrl","The specified callback is null or undefined."));var s=new XMLHttpRequest;s.onload=function(){this.status>=200&&this.status<300?r(new i(this.response),s):(e.log(e.LEVEL_WARNING,"AAIGrid retrieval failed ("+s.statusText+"): "+t),r(null,s))},s.onerror=function(){e.log(e.LEVEL_WARNING,"AAIGrid retrieval failed: "+t),r(null,s)},s.ontimeout=function(){e.log(e.LEVEL_WARNING,"AAIGrid retrieval timed out: "+t),r(null,s)},s.open("GET",t,!0),s.responseType="arraybuffer",s.send(null)},i}),B("geom/Angle",[],function(){"use strict";var p={DEGREES_TO_RADIANS:Math.PI/180,RADIANS_TO_DEGREES:180/Math.PI,TWO_PI:2*Math.PI,HALF_PI:Math.PI/2,normalizedDegrees:function(l){var n=l%360;return n>180?n-360:n<-180?360+n:n},normalizedDegreesLatitude:function(l){var n=l%180;return n>90?180-n:n<-90?-180-n:n},normalizedDegreesLongitude:function(l){var n=l%360;return n>180?n-360:n<-180?360+n:n},normalizedRadians:function(l){var n=l%this.TWO_PI;return n>Math.PI?n-this.TWO_PI:n<-Math.PI?this.TWO_PI+n:n},normalizedRadiansLatitude:function(l){var n=l%Math.PI;return n>this.HALF_PI?Math.PI-n:n<-this.HALF_PI?-Math.PI-n:n},normalizedRadiansLongitude:function(l){var n=l%this.TWO_PI;return n>Math.PI?n-this.TWO_PI:n<-Math.PI?this.TWO_PI+n:n},isValidLatitude:function(l){return l>=-90&&l<=90},isValidLongitude:function(l){return l>=-180&&l<=180},toString:function(l){return l.toString()+"\xB0"},toDecimalDegreesString:function(l){return l.toString()+"\xB0"},toDMSString:function(l){var n,e,i,t,r;return n=l<0?-1:1,e=n*l,i=Math.floor(e),e=(e-i)*60,t=Math.floor(e),e=(e-t)*60,r=Math.round(e),r==60&&(t++,r=0),t==60&&(i++,t=0),(n==-1?"-":"")+i+"\xB0 "+t+"\u2019 "+r+"\u201D"},toDMString:function(l){var n,e,i,t,r,s;return n=l<0?-1:1,e=n*l,i=Math.floor(e),e=(e-i)*60,t=Math.floor(e),e=(e-t)*60,r=Math.round(e),r==60&&(t++,r=0),t==60&&(i++,t=0),s=r==0?t:t+r/60,(n==-1?"-":"")+i+"\xB0 "+s+"\u2019"}};return p}),B("util/Color",["../util/Logger"],function(p){"use strict";var l=function(n,e,i,t){this.red=n,this.green=e,this.blue=i,this.alpha=t};return l.WHITE=new l(1,1,1,1),l.BLACK=new l(0,0,0,1),l.RED=new l(1,0,0,1),l.GREEN=new l(0,1,0,1),l.BLUE=new l(0,0,1,1),l.CYAN=new l(0,1,1,1),l.YELLOW=new l(1,1,0,1),l.MAGENTA=new l(1,0,1,1),l.LIGHT_GRAY=new l(.75,.75,.75,1),l.MEDIUM_GRAY=new l(.5,.5,.5,1),l.DARK_GRAY=new l(.25,.25,.25,1),l.TRANSPARENT=new l(0,0,0,0),l.prototype.set=function(n,e,i,t){return this.red=n,this.green=e,this.blue=i,this.alpha=t,this},l.prototype.copy=function(n){if(!n)throw new ArgumentError(p.logMessage(p.LEVEL_SEVERE,"Color","copy","missingColor"));return this.red=n.red,this.green=n.green,this.blue=n.blue,this.alpha=n.alpha,this},l.prototype.clone=function(){return new l(this.red,this.green,this.blue,this.alpha)},l.prototype.premultipliedComponents=function(n){var e=this.alpha;return n[0]=this.red*e,n[1]=this.green*e,n[2]=this.blue*e,n[3]=e,n},l.colorFromByteArray=function(n){return new l(n[0]/255,n[1]/255,n[2]/255,n[3]/255)},l.colorFromBytes=function(n,e,i,t){return new l(n/255,e/255,i/255,t/255)},l.colorFromHex=function(n){var e=parseInt(n.substring(0,2),16),i=parseInt(n.substring(2,4),16),t=parseInt(n.substring(4,6),16),r=parseInt(n.substring(6,8),16);return l.colorFromBytes(e,i,t,r)},l.colorFromKmlHex=function(n){var e=parseInt(n.substring(0,2),16),i=parseInt(n.substring(2,4),16),t=parseInt(n.substring(4,6),16),r=parseInt(n.substring(6,8),16);return l.colorFromBytes(r,t,i,e)},l.prototype.nextColor=function(){var n=Math.round(this.red*255),e=Math.round(this.green*255),i=Math.round(this.blue*255);return n<255?this.red=(n+1)/255:e<255?(this.red=0,this.green=(e+1)/255):i<255?(this.red=0,this.green=0,this.blue=(i+1)/255):(this.red=1/255,this.green=0,this.blue=0),this},l.prototype.equals=function(n){var e=Math.round(this.red*255),i=Math.round(this.green*255),t=Math.round(this.blue*255),r=Math.round(this.alpha*255),s=Math.round(n.red*255),a=Math.round(n.green*255),f=Math.round(n.blue*255),o=Math.round(n.alpha*255);return e===s&&i===a&&t===f&&r===o},l.prototype.equalsBytes=function(n){var e=Math.round(this.red*255),i=Math.round(this.green*255),t=Math.round(this.blue*255),r=Math.round(this.alpha*255);return e===n[0]&&i===n[1]&&t===n[2]&&r===n[3]},l.prototype.toByteString=function(){var n=Math.round(this.red*255),e=Math.round(this.green*255),i=Math.round(this.blue*255),t=Math.round(this.alpha*255);return"("+n+","+e+","+i+","+t+")"},l.prototype.toHexString=function(n){var e=Math.ceil(this.red*255).toString(16),i=Math.ceil(this.green*255).toString(16),t=Math.ceil(this.blue*255).toString(16),r=Math.ceil(this.alpha*255).toString(16),s="#";return s+=e.length<2?"0"+e:e,s+=i.length<2?"0"+i:i,s+=t.length<2?"0"+t:t,n&&(s+=r.length<2?"0"+r:r),s},l.prototype.toCssColorString=function(){var n=Math.round(this.red*255),e=Math.round(this.green*255),i=Math.round(this.blue*255);return"rgba("+n+", "+e+", "+i+", "+this.alpha+")"},l}),B("util/Font",["../error/ArgumentError","../util/Color","../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r,s,a,f){if(i){if(i<=0)throw new p(n.logMessage(n.LEVEL_SEVERE,"Font","constructor","invalidSize"));this._size=i}else throw new p(n.logMessage(n.LEVEL_SEVERE,"Font","constructor","missingSize"));this.style=t||"normal",this.variant=r||"normal",this.weight=s||"normal",this.family=a||"sans-serif",this.horizontalAlignment=f||"center"};return Object.defineProperties(e.prototype,{size:{get:function(){return this._size},set:function(i){this._fontString=null,this._size=i}},style:{get:function(){return this._style},set:function(i){this._fontString=null,this._style=i}},variant:{get:function(){return this._variant},set:function(i){this._fontString=null,this._variant=i}},weight:{get:function(){return this._weight},set:function(i){this._fontString=null,this._weight=i}},family:{get:function(){return this._family},set:function(i){this._fontString=null,this._family=i}},horizontalAlignment:{get:function(){return this._horizontalAlignment},set:function(i){this._toString=null,this._horizontalAlignment=i}},fontString:{get:function(){return this._fontString||(this._fontString=this._style+" "+this.variant+" "+this._weight+" "+this._size.toString()+"px "+this._family),this._fontString}}}),e.prototype.toString=function(){return(!this._toString||!this._fontString)&&(this._toString=this.fontString+" "+this.horizontalAlignment),this._toString},e}),B("util/Insets",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e,i,t,r){if(arguments.length!==4)throw new p(l.logMessage(l.LEVEL_SEVERE,"Insets","constructor","invalidArgumentCount"));this._top=e,this._left=i,this._bottom=t,this._right=r};return n.prototype.set=function(e,i,t,r){this._top=e,this._left=i,this._bottom=t,this._right=r},n.prototype.clone=function(){return new n(this._top,this._left,this._bottom,this._right)},n.prototype.toString=function(){return this._top+" "+this._left+" "+this._bottom+" "+this._right},Object.defineProperties(n.prototype,{top:{get:function(){return this._top},set:function(e){this._top=e}},left:{get:function(){return this._left},set:function(e){this._left=e}},bottom:{get:function(){return this._bottom},set:function(e){this._bottom=e}},right:{get:function(){return this._right},set:function(e){this._right=e}}}),n}),B("geom/Vec3",["../util/Logger","../error/ArgumentError"],function(p,l){"use strict";var n=function(i,t,r){this[0]=i,this[1]=t,this[2]=r};return n.prototype=new Float64Array(3),n.ZERO=new n(0,0,0),n.average=function(e,i){if(!e||e.length<1)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","average","missingArray"));if(!i)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","average","missingResult"));var t=e.length,r;i[0]=0,i[1]=0,i[2]=0;for(var s=0,a=e.length;s<a;s++)r=e[s],i[0]+=r[0]/t,i[1]+=r[1]/t,i[2]+=r[2]/t;return i},n.averageOfBuffer=function(e,i){if(!e||e.length<1)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","averageBuffer","missingArray"));if(!i)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","averageBuffer","missingResult"));var t=e.length/3;i[0]=0,i[1]=0,i[2]=0;for(var r=0;r<t;r++)i[0]+=e[r*3]/t,i[1]+=e[r*3+1]/t,i[2]+=e[r*3+2]/t;return i},n.areColinear=function(e,i,t){if(!e||!i||!t)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","areColinear","missingVector"));var r=new n(e[0]-i[0],e[1]-i[1],e[2]-i[2]).normalize(),s=new n(t[0]-i[0],t[1]-i[1],t[2]-i[2]).normalize();return Math.abs(r.dot(s))>.999},n.computeTriangleNormal=function(e,i,t){if(!e||!i||!t)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","areColinear","missingVector"));var r=(i[1]-e[1])*(t[2]-e[2])-(i[2]-e[2])*(t[1]-e[1]),s=(i[2]-e[2])*(t[0]-e[0])-(i[0]-e[0])*(t[2]-e[2]),a=(i[0]-e[0])*(t[1]-e[1])-(i[1]-e[1])*(t[0]-e[0]),f=r*r+s*s+a*a;return f===0?new n(r,s,a):(f=Math.sqrt(f),new n(r/f,s/f,a/f))},n.findThreeIndependentVertices=function(e,i){var t=i&&i>0?i:3;if(!e||e.length<3*t)return null;for(var r=new n(e[0],e[1],e[2]),s=null,a=null,f=t;f<e.length&&(s=new n(e[f],e[f+1],e[f+2]),s[0]===r[0]&&s[1]===r[1]&&s[2]===r[2]);f+=t)s=null;if(!s)return null;for(f+=t;f<e.length&&(a=new n(e[f],e[f+1],e[f+2]),!(!(a[0]===r[0]&&a[1]===r[1]&&a[2]===r[2]||a[0]===s[0]&&a[1]===s[1]&&a[2]===s[2])&&!n.areColinear(r,s,a)));f+=t)a=null;return a?[r,s,a]:null},n.computeBufferNormal=function(e,i){var t=n.findThreeIndependentVertices(e,i);return t?n.computeTriangleNormal(t[0],t[1],t[2]):null},n.prototype.set=function(e,i,t){return this[0]=e,this[1]=i,this[2]=t,this},n.prototype.copy=function(e){if(!e)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","copy","missingVector"));return this[0]=e[0],this[1]=e[1],this[2]=e[2],this},n.prototype.equals=function(e){return this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2]},n.prototype.add=function(e){if(!e)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","add","missingVector"));return this[0]+=e[0],this[1]+=e[1],this[2]+=e[2],this},n.prototype.subtract=function(e){if(!e)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","subtract","missingVector"));return this[0]-=e[0],this[1]-=e[1],this[2]-=e[2],this},n.prototype.multiply=function(e){return this[0]*=e,this[1]*=e,this[2]*=e,this},n.prototype.divide=function(e){return this[0]/=e,this[1]/=e,this[2]/=e,this},n.prototype.multiplyByMatrix=function(e){if(!e)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","multiplyByMatrix","missingMatrix"));var i=e[0]*this[0]+e[1]*this[1]+e[2]*this[2]+e[3],t=e[4]*this[0]+e[5]*this[1]+e[6]*this[2]+e[7],r=e[8]*this[0]+e[9]*this[1]+e[10]*this[2]+e[11],s=e[12]*this[0]+e[13]*this[1]+e[14]*this[2]+e[15];return this[0]=i/s,this[1]=t/s,this[2]=r/s,this},n.prototype.mix=function(e,i){if(!e)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","mix","missingVector"));var t=1-i,r=i;return this[0]=this[0]*t+e[0]*r,this[1]=this[1]*t+e[1]*r,this[2]=this[2]*t+e[2]*r,this},n.prototype.negate=function(){return this[0]=-this[0],this[1]=-this[1],this[2]=-this[2],this},n.prototype.dot=function(e){if(!e)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","dot","missingVector"));return this[0]*e[0]+this[1]*e[1]+this[2]*e[2]},n.prototype.cross=function(e){if(!e)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","cross","missingVector"));var i=this[1]*e[2]-this[2]*e[1],t=this[2]*e[0]-this[0]*e[2],r=this[0]*e[1]-this[1]*e[0];return this[0]=i,this[1]=t,this[2]=r,this},n.prototype.magnitudeSquared=function(){return this.dot(this)},n.prototype.magnitude=function(){return Math.sqrt(this.magnitudeSquared())},n.prototype.normalize=function(){var e=this.magnitude(),i=1/e;return this[0]*=i,this[1]*=i,this[2]*=i,this},n.prototype.distanceToSquared=function(e){if(!e)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","distanceToSquared","missingVector"));var i=this[0]-e[0],t=this[1]-e[1],r=this[2]-e[2];return i*i+t*t+r*r},n.prototype.distanceTo=function(e){if(!e)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec3","distanceTo","missingVector"));return Math.sqrt(this.distanceToSquared(e))},n.prototype.swap=function(e){var i=this[0];return this[0]=e[0],e[0]=i,i=this[1],this[1]=e[1],e[1]=i,i=this[2],this[2]=e[2],e[2]=i,this},n.prototype.toString=function(){return"("+this[0]+", "+this[1]+", "+this[2]+")"},n}),B("geom/Vec2",["../util/Logger","../error/ArgumentError","../geom/Vec3"],function(p,l,n){"use strict";var e=function(t,r){this[0]=t,this[1]=r};return e.prototype=new Float64Array(2),e.prototype.set=function(i,t){return this[0]=i,this[1]=t,this},e.prototype.copy=function(i){if(!i)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec2","copy","missingVector"));return this[0]=i[0],this[1]=i[1],this},e.prototype.equals=function(i){return this[0]===i[0]&&this[1]===i[1]},e.average=function(i,t){if(!i||i.length<1)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec2","average","missingArray"));if(!t)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec2","average","missingResult"));var r=i.length,s;t[0]=0,t[1]=0;for(var a=0,f=i.length;a<f;a++)s=i[a],t[0]+=s[0]/r,t[1]+=s[1]/r;return t},e.prototype.add=function(i){if(!i)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec2","add","missingVector"));return this[0]+=i[0],this[1]+=i[1],this},e.prototype.subtract=function(i){if(!i)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec2","subtract","missingVector"));return this[0]-=i[0],this[1]-=i[1],this},e.prototype.multiply=function(i){return this[0]*=i,this[1]*=i,this},e.prototype.divide=function(i){return this[0]/=i,this[1]/=i,this},e.prototype.mix=function(i,t){if(!i)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec2","mix","missingVector"));var r=1-t,s=t;return this[0]=this[0]*r+i[0]*s,this[1]=this[1]*r+i[1]*s,this},e.prototype.negate=function(){return this[0]=-this[0],this[1]=-this[1],this},e.prototype.dot=function(i){if(!i)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec2","dot","missingVector"));return this[0]*i[0]+this[1]*i[1]},e.prototype.magnitudeSquared=function(){return this.dot(this)},e.prototype.magnitude=function(){return Math.sqrt(this.magnitudeSquared())},e.prototype.normalize=function(){var i=this.magnitude(),t=1/i;return this[0]*=t,this[1]*=t,this},e.prototype.distanceToSquared=function(i){if(!i)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec2","distanceToSquared","missingVector"));var t=this[0]-i[0],r=this[1]-i[1];return t*t+r*r},e.prototype.distanceTo=function(i){if(!i)throw new l(p.logMessage(p.LEVEL_SEVERE,"Vec2","distanceTo","missingVector"));return Math.sqrt(this.distanceToSquared(i))},e.prototype.toVec3=function(){return new n(this[0],this[1],0)},e.prototype.swap=function(i){var t=this[0];return this[0]=i[0],i[0]=t,t=this[1],this[1]=i[1],i[1]=t,this},e.prototype.toString=function(){return"("+this[0]+", "+this[1]+")"},e}),B("util/Offset",["../geom/Vec2"],function(p){"use strict";var l=function(n,e,i,t){this.x=e,this.y=t,this.xUnits=n,this.yUnits=i};return l.prototype.clone=function(){return new l(this.xUnits,this.x,this.yUnits,this.y)},l.prototype.offsetForSize=function(n,e){var i,t;return this.xUnits===WorldWind.OFFSET_FRACTION?i=n*this.x:this.xUnits===WorldWind.OFFSET_INSET_PIXELS?i=n-this.x:i=this.x,this.yUnits===WorldWind.OFFSET_FRACTION?t=e*this.y:this.yUnits===WorldWind.OFFSET_INSET_PIXELS?t=e-this.y:t=this.y,new p(i,t)},l.prototype.toString=function(){return this.xUnits+" "+this.x+" "+this.yUnits+" "+this.y},l}),B("shapes/TextAttributes",["../util/Color","../util/Font","../util/Offset"],function(p,l,n){"use strict";var e=function(i){this._color=i?i._color.clone():p.WHITE.clone(),this._font=i?i._font:new l(14),this._offset=i?i._offset:new n(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0),this._scale=i?i._scale:1,this._depthTest=i?i._depthTest:!1,this._enableOutline=i?i._enableOutline:!0,this._outlineWidth=i?i._outlineWidth:4,this._outlineColor=i?i._outlineColor:new p(0,0,0,.5),this.stateKeyInvalid=!0};return e.prototype.computeStateKey=function(){return"c "+this._color.toHexString(!0)+" f "+this._font.toString()+" o "+this._offset.toString()+" s "+this._scale+" dt "+this._depthTest+" eo "+this._enableOutline+" ow "+this._outlineWidth+" oc "+this._outlineColor.toHexString(!0)},Object.defineProperties(e.prototype,{stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}},color:{get:function(){return this._color},set:function(i){this._color=i,this.stateKeyInvalid=!0}},font:{get:function(){return this._font},set:function(i){this._font=i,this.stateKeyInvalid=!0}},offset:{get:function(){return this._offset},set:function(i){this._offset=i,this.stateKeyInvalid=!0}},scale:{get:function(){return this._scale},set:function(i){this._scale=i,this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(i){this._depthTest=i,this.stateKeyInvalid=!0}},enableOutline:{get:function(){return this._enableOutline},set:function(i){this._enableOutline=i,this.stateKeyInvalid=!0}},outlineWidth:{get:function(){return this._outlineWidth},set:function(i){this._outlineWidth=i,this.stateKeyInvalid=!0}},outlineColor:{get:function(){return this._outlineColor},set:function(i){this._outlineColor=i,this.stateKeyInvalid=!0}}}),e}),B("shapes/AnnotationAttributes",["../util/Color","../util/Font","../util/Insets","../shapes/TextAttributes"],function(p,l,n,e){"use strict";var i=function(t){this._cornerRadius=t?t._cornerRadius:0,this._insets=t?t._insets:new n(0,0,0,0),this._backgroundColor=t?t._backgroundColor.clone():p.WHITE.clone(),this._leaderGapWidth=t?t._leaderGapWidth:40,this._leaderGapHeight=t?t._leaderGapHeight:30,this._opacity=t?t._opacity:1,this._scale=t?t._scale:1,this._drawLeader=t?t._drawLeader:!0,this._width=t?t._width:200,this._height=t?t._height:100,this._textAttributes=t?t._textAttributes:this.createDefaultTextAttributes(),this.stateKeyInvalid=!0};return i.prototype.computeStateKey=function(){return"wi "+this._width+" he "+this._height+" cr "+this._cornerRadius+" in "+this._insets.toString()+" bg "+this.backgroundColor.toHexString(!0)+" dl "+this.drawLeader+" lgw "+this.leaderGapWidth+" lgh "+this.leaderGapHeight+" op "+this.opacity+" ta "+this._textAttributes.stateKey+" sc "+this.scale},i.prototype.createDefaultTextAttributes=function(){var t=new e(null);return t.enableOutline=!1,t},Object.defineProperties(i.prototype,{width:{get:function(){return this._width},set:function(t){this._width=t,this.stateKeyInvalid=!0}},height:{get:function(){return this._height},set:function(t){this._height=t,this.stateKeyInvalid=!0}},cornerRadius:{get:function(){return this._cornerRadius},set:function(t){this._cornerRadius=t,this.stateKeyInvalid=!0}},insets:{get:function(){return this._insets},set:function(t){this._insets=t,this.stateKeyInvalid=!0}},backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this.stateKeyInvalid=!0}},textAttributes:{get:function(){return this._textAttributes},set:function(t){this._textAttributes=t,this.stateKeyInvalid=!0}},drawLeader:{get:function(){return this._drawLeader},set:function(t){this._drawLeader=t,this.stateKeyInvalid=!0}},leaderGapWidth:{get:function(){return this._leaderGapWidth},set:function(t){this._leaderGapWidth=t,this.stateKeyInvalid=!0}},leaderGapHeight:{get:function(){return this._leaderGapHeight},set:function(t){this._leaderGapHeight=t,this.stateKeyInvalid=!0}},opacity:{get:function(){return this._opacity},set:function(t){this._opacity=t,this.stateKeyInvalid=!0}},scale:{get:function(){return this._scale},set:function(t){this._scale=t,this.stateKeyInvalid=!0}},stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}}}),i}),B("shaders/GpuShader",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e,i,t){if(!(i===e.VERTEX_SHADER||i===e.FRAGMENT_SHADER))throw new p(l.logMessage(l.LEVEL_SEVERE,"GpuShader","constructor","The specified shader type is unrecognized."));if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"GpuShader","constructor","The specified shader source is null or undefined."));var r=e.createShader(i);if(!r)throw new p(l.logMessage(l.LEVEL_SEVERE,"GpuShader","constructor","Unable to create shader of type "+(i==e.VERTEX_SHADER?"VERTEX_SHADER.":"FRAGMENT_SHADER.")));if(!this.compile(e,r,i,t)){var s=e.getShaderInfoLog(r);throw e.deleteShader(r),new p(l.logMessage(l.LEVEL_SEVERE,"GpuShader","constructor","Unable to compile shader: "+s))}this.shaderId=r};return n.prototype.compile=function(e,i,t,r){return e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)},n.prototype.dispose=function(e){this.shaderId&&(e.deleteShader(this.shaderId),delete this.shaderId)},n}),B("shaders/GpuProgram",["../error/ArgumentError","../util/Color","../shaders/GpuShader","../util/Logger"],function(p,l,n,e){"use strict";var i=function(t,r,s,a){if(!r||!s)throw new p(e.logMessage(e.LEVEL_SEVERE,"GpuProgram","constructor","The specified shader source is null or undefined."));var f,o,c;try{o=new n(t,t.VERTEX_SHADER,r),c=new n(t,t.FRAGMENT_SHADER,s)}catch(m){throw o&&o.dispose(t),c&&c.dispose(t),m}if(f=t.createProgram(),!f)throw new p(e.logMessage(e.LEVEL_SEVERE,"GpuProgram","constructor","Unable to create shader program."));if(t.attachShader(f,o.shaderId),t.attachShader(f,c.shaderId),a)for(var d=0,h=a.length;d<h;d++)t.bindAttribLocation(f,d,a[d]);if(!this.link(t,f)){var u=t.getProgramInfoLog(f);throw t.detachShader(f,o.shaderId),t.detachShader(f,c.shaderId),t.deleteProgram(f),o.dispose(t),c.dispose(t),new p(e.logMessage(e.LEVEL_SEVERE,"GpuProgram","constructor","Unable to link shader program: "+u))}this.programId=f,this.attributeLocations={},this.uniformLocations={},this.vertexShader=o,this.fragmentShader=c,this.size=r.length+s.length,this.scratchArray=new Float32Array(16)};return i.prototype.dispose=function(t){this.programId&&(this.vertexShader&&t.detachShader(this.programId,this.vertexShader.shaderId),this.fragmentShader&&t.detachShader(this.programId,this.fragmentShader.shaderId),t.deleteProgram(this.programId),delete this.programId),this.vertexShader&&(this.vertexShader.dispose(t),delete this.vertexShader),this.fragmentShader&&(this.fragmentShader.dispose(t),delete this.fragmentShader),this.attributeLocations={},this.uniformLocations={}},i.prototype.attributeLocation=function(t,r){if(!r||r.length==0)throw new p(e.logMessage(e.LEVEL_SEVERE,"GpuProgram","attributeLocation","The specified attribute name is null, undefined or empty."));var s=this.attributeLocations[r];return s||(s=t.getAttribLocation(this.programId,r),this.attributeLocations[r]=s),s},i.prototype.uniformLocation=function(t,r){if(!r||r.length==0)throw new p(e.logMessage(e.LEVEL_SEVERE,"GpuProgram","uniformLocation","The specified uniform name is null, undefined or empty."));var s=this.uniformLocations[r];return s||(s=t.getUniformLocation(this.programId,r),this.uniformLocations[r]=s),s},i.prototype.link=function(t,r){return t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)},i.prototype.loadUniformMatrix=function(t,r,s){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"GpuProgram","loadUniformMatrix","missingMatrix"));var a=r.columnMajorComponents(this.scratchArray);t.uniformMatrix4fv(s,!1,a)},i.prototype.loadUniformColor=function(t,r,s){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"GpuProgram","loadUniformColor","missingColor"));var a=r.premultipliedComponents(this.scratchArray);t.uniform4f(s,a[0],a[1],a[2],a[3])},i.prototype.loadUniformColorComponents=function(t,r,s,a,f,o){t.uniform4f(o,r*f,s*f,a*f,f)},i}),B("shaders/BasicTextureProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(p,l,n,e){"use strict";var i=function(t){var r="attribute vec4 vertexPoint;\nattribute vec4 vertexTexCoord;\nattribute vec4 normalVector;\nuniform mat4 mvpMatrix;\nuniform mat4 mvInverseMatrix;\nuniform mat4 texCoordMatrix;\nuniform bool applyLighting;\nvarying vec2 texCoord;\nvarying vec4 normal;\nvoid main() {gl_Position = mvpMatrix * vertexPoint;\ntexCoord = (texCoordMatrix * vertexTexCoord).st;\nif (applyLighting) {normal = mvInverseMatrix * normalVector;}\n}",s="precision mediump float;\nuniform float opacity;\nuniform vec4 color;\nuniform bool enableTexture;\nuniform bool modulateColor;\nuniform sampler2D textureSampler;\nuniform bool applyLighting;\nvarying vec2 texCoord;\nvarying vec4 normal;\nvoid main() {\nvec4 textureColor = texture2D(textureSampler, texCoord);\nfloat ambient = 0.15; vec4 lightDirection = vec4(0, 0, 1, 0);\nif (enableTexture && !modulateColor)\n    gl_FragColor = textureColor * color * opacity;\nelse if (enableTexture && modulateColor)\n    gl_FragColor = color * floor(textureColor.a + 0.5);\nelse\n    gl_FragColor = color * opacity;\nif (gl_FragColor.a == 0.0) {discard;}\nif (applyLighting) {\n    vec4 n = normal * (gl_FrontFacing ? 1.0 : -1.0);\n    gl_FragColor.rgb *= clamp(ambient + dot(lightDirection, n), 0.0, 1.0);\n}\n}",a=["vertexPoint","normalVector","vertexTexCoord"];n.call(this,t,r,s,a),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.normalVectorLocation=this.attributeLocation(t,"normalVector"),this.vertexTexCoordLocation=this.attributeLocation(t,"vertexTexCoord"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.mvInverseMatrixLocation=this.uniformLocation(t,"mvInverseMatrix"),this.colorLocation=this.uniformLocation(t,"color"),this.textureEnabledLocation=this.uniformLocation(t,"enableTexture"),this.modulateColorLocation=this.uniformLocation(t,"modulateColor"),this.textureUnitLocation=this.uniformLocation(t,"textureSampler"),this.textureMatrixLocation=this.uniformLocation(t,"texCoordMatrix"),this.opacityLocation=this.uniformLocation(t,"opacity"),this.applyLightingLocation=this.uniformLocation(t,"applyLighting")};return i.key="WorldWindGpuBasicTextureProgram",i.prototype=Object.create(n.prototype),i.prototype.loadModelviewInverse=function(t,r){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"BasicTextureProgram","loadModelviewInverse","missingMatrix"));this.loadUniformMatrix(t,r,this.mvInverseMatrixLocation)},i.prototype.loadModelviewProjection=function(t,r){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"BasicTextureProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(t,r,this.mvpMatrixLocation)},i.prototype.loadColor=function(t,r){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"BasicTextureProgram","loadColor","missingColor"));this.loadUniformColor(t,r,this.colorLocation)},i.prototype.loadTextureEnabled=function(t,r){t.uniform1i(this.textureEnabledLocation,r?1:0)},i.prototype.loadModulateColor=function(t,r){t.uniform1i(this.modulateColorLocation,r?1:0)},i.prototype.loadTextureUnit=function(t,r){t.uniform1i(this.textureUnitLocation,r-t.TEXTURE0)},i.prototype.loadTextureMatrix=function(t,r){this.loadUniformMatrix(t,r,this.textureMatrixLocation)},i.prototype.loadOpacity=function(t,r){t.uniform1f(this.opacityLocation,r)},i.prototype.loadApplyLighting=function(t,r){t.uniform1i(this.applyLightingLocation,r)},i}),B("geom/Line",["../error/ArgumentError","../util/Logger","../geom/Vec3"],function(p,l,n){"use strict";var e=function(i,t){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"Line","constructor","Origin is null or undefined."));if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"Line","constructor","Direction is null or undefined."));this.origin=i,this.direction=t};return e.fromSegment=function(i,t){if(!i||!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"Line","fromSegment","missingPoint"));var r=new n(i[0],i[1],i[2]),s=new n(t[0]-i[0],t[1]-i[1],t[2]-i[2]);return new e(r,s)},e.prototype.pointAt=function(i,t){if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"Line","pointAt","missingResult."));return t[0]=this.origin[0]+this.direction[0]*i,t[1]=this.origin[1]+this.direction[1]*i,t[2]=this.origin[2]+this.direction[2]*i,t},e.prototype.equals=function(i){return i?this.origin.equals(i.origin)&&this.direction.equals(i.direction):!1},e.prototype.clone=function(){var i=new e(new n(0,0,0),new n(0,0,0));return i.copy(this),i},e.prototype.copy=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"Line","copy","missingLine"));return this.origin.copy(i.origin),this.direction.copy(i.direction),this},e}),B("geom/Plane",["../error/ArgumentError","../geom/Line","../util/Logger","../geom/Vec3"],function(p,l,n,e){"use strict";var i=function(t,r,s,a){this.normal=new e(t,r,s),this.distance=a};return i.fromPoints=function(t,r,s){if(!t||!r||!s)throw new p(n.logMessage(n.LEVEL_SEVERE,"Plane","fromPoints","missingVector"));var a=new e(r[0],r[1],r[2]);a.subtract(t);var f=new e(s[0],s[1],s[2]);f.subtract(t),a.cross(f),a.normalize();var o=-a.dot(t);return new i(a[0],a[1],a[2],o)},i.prototype.dot=function(t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"Plane","dot","missingVector"));return this.normal.dot(t)+this.distance},i.prototype.distanceToPoint=function(t){return this.dot(t)},i.prototype.transformByMatrix=function(t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"Plane","transformByMatrix","missingMatrix"));var r=t[0]*this.normal[0]+t[1]*this.normal[1]+t[2]*this.normal[2]+t[3]*this.distance,s=t[4]*this.normal[0]+t[5]*this.normal[1]+t[6]*this.normal[2]+t[7]*this.distance,a=t[8]*this.normal[0]+t[9]*this.normal[1]+t[10]*this.normal[2]+t[11]*this.distance,f=t[12]*this.normal[0]+t[13]*this.normal[1]+t[14]*this.normal[2]+t[15]*this.distance;return this.normal[0]=r,this.normal[1]=s,this.normal[2]=a,this.distance=f,this},i.prototype.normalize=function(){var t=this.normal.magnitude();return t===0?this:(this.normal.divide(t),this.distance/=t,this)},i.prototype.intersectsSegment=function(t,r){var s=this.dot(t),a=this.dot(r);return s*a<=0},i.prototype.intersectsSegmentAt=function(t,r,s){var a=this.dot(t),f=this.dot(r);if(a===0&&f===0)return s[0]=t[0],s[1]=t[1],s[2]=t[2],!0;if(a===f)return!1;var o=-a/(f-a),c=1-o;return s[0]=o*t[0]+c*r[0],s[1]=o*t[1]+c*r[1],s[2]=o*t[2]+c*r[2],a*f<=0},i.prototype.onSameSide=function(t,r){if(!t||!r)throw new p(n.logMessage(n.LEVEL_SEVERE,"Plane","onSameSide","missingPoint"));var s=this.distanceToPoint(t),a=this.distanceToPoint(r);return s<0&&a<0?-1:s>0&&a>0?1:0},i.prototype.clip=function(t,r){if(!t||!r)throw new p(n.logMessage(n.LEVEL_SEVERE,"Plane","clip","missingPoint"));if(t.equals(r))return null;var s=l.fromSegment(t,r),a=this.normal.dot(s.direction),f,o,c;return a===0?(f=this.dot(s.origin),f===0?[t,r]:null):(o=-this.dot(s.origin)/a,o<0||o>1?null:(c=s.pointAt(o,new e(0,0,0)),a>0?[c,r]:[t,c]))},i}),B("geom/Rectangle",["../util/Logger"],function(p){"use strict";var l=function(n,e,i,t){this.x=n,this.y=e,this.width=i,this.height=t};return l.prototype.set=function(n,e,i,t){this.x=n,this.y=e,this.width=i,this.height=t},l.prototype.getMinX=function(){return this.x},l.prototype.getMinY=function(){return this.y},l.prototype.getMaxX=function(){return this.x+this.width},l.prototype.getMaxY=function(){return this.y+this.height},l.prototype.containsPoint=function(n){return n[0]>=this.x&&n[0]<=this.x+this.width&&n[1]>=this.y&&n[1]<=this.y+this.height},l.prototype.intersects=function(n){return!(n.x+n.width<this.x||n.x>this.x+this.width||n.y+n.height<this.y||n.y>this.y+this.height)},l.prototype.intersectsRectangles=function(n){if(n){for(var e=0;e<n.length;e++)if(this.intersects(n[e]))return!0}return!1},l.prototype.toString=function(){return this.x+", "+this.y+", "+this.width+", "+this.height},l}),B("util/WWMath",["../geom/Angle","../error/ArgumentError","../geom/Line","../util/Logger","../geom/Rectangle","../geom/Vec3"],function(p,l,n,e,i,t){"use strict";var r={clamp:function(s,a,f){return s<a?a:s>f?f:s},interpolate:function(s,a,f){return(1-s)*a+s*f},cbrt:function(s){return typeof Math.cbrt=="function"?Math.cbrt(s):Math.pow(s,.3333333333333333)},computeEllipsoidalGlobeIntersection:function(s,a,f,o){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeEllipsoidalGlobeIntersection","missingLine"));if(!o)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeEllipsoidalGlobeIntersection","missingResult"));var c=s.direction[0],d=s.direction[1],h=s.direction[2],u=s.origin[0],m=s.origin[1],g=s.origin[2],_=a/f,y=_*_,v=a*a,b=c*c+y*d*d+h*h,R=2*(u*c+y*m*d+g*h),M=u*u+y*m*m+g*g-v,P=R*R-4*b*M,T;return P<0?!1:(T=(-R-Math.sqrt(P))/(2*b),o[0]=u+c*T,o[1]=m+d*T,o[2]=g+h*T,!0)},computeTriangleIntersection:function(s,a,f,o,c){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingLine"));if(!a||!f||!o)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingVertex"));if(!c)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeTriangleIntersection","missingResult"));var d=s.direction[0],h=s.direction[1],u=s.direction[2],m=s.origin[0],g=s.origin[1],_=s.origin[2],y=1e-5,v=f[0]-a[0],b=f[1]-a[1],R=f[2]-a[2],M=o[0]-a[0],P=o[1]-a[1],T=o[2]-a[2],E=h*T-u*P,x=u*M-d*T,S=d*P-h*M,L=v*E+b*x+R*S;if(L>-y&&L<y)return!1;var C=1/L,F=m-a[0],q=g-a[1],it=_-a[2],st=C*(F*E+q*x+it*S);if(st<-y||st>1+y)return!1;var pt=q*R-it*b,_t=it*v-F*R,X=F*b-q*v,ot=C*(d*pt+h*_t+u*X);if(ot<-y||st+ot>1+y)return!1;var Tt=C*(M*pt+P*_t+T*X);return Tt<0?!1:(c[0]=m+d*Tt,c[1]=g+h*Tt,c[2]=_+u*Tt,!0)},computeIndexedTrianglesIntersection:function(s,a,f,o){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingLine"));if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingPoints"));if(!f)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingIndices"));if(!o)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeIndexedTrianglesIntersection","missingResults"));for(var c=new t(0,0,0),d=new t(0,0,0),h=new t(0,0,0),u=new t(0,0,0),m=0,g=f.length;m<g;m+=3){var _=3*f[m],y=3*f[m+1],v=3*f[m+2];c[0]=a[_],c[1]=a[_+1],c[2]=a[_+2],d[0]=a[y],d[1]=a[y+1],d[2]=a[y+2],h[0]=a[v],h[1]=a[v+1],h[2]=a[v+2],r.computeTriangleIntersection(s,c,d,h,u)&&(o.push(u),u=new t(0,0,0))}return o.length>0},computeTriStripIntersections:function(s,a,f,o){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingLine"));if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingPoints"));if(!f)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingIndices"));if(!o)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","computeTriStripIntersections","missingResults"));var c=s.direction[0],d=s.direction[1],h=s.direction[2],u=s.origin[0],m=s.origin[1],g=s.origin[2],_,y,v,b,R,M,P,T,E,x,S,L,C,F,q,it,st,pt,_t,X,ot,Tt,Vt,Gt,qt,Qt,ne,j,J,at,xt=1e-5;at=3*f[0],b=a[at++],R=a[at++],M=a[at],at=3*f[1],P=a[at++],T=a[at++],E=a[at];for(var Rt=2,Lt=f.length;Rt<Lt;Rt++)_=b,y=R,v=M,b=P,R=T,M=E,at=3*f[Rt],P=a[at++],T=a[at++],E=a[at],x=b-_,S=R-y,L=M-v,C=P-_,F=T-y,q=E-v,it=d*q-h*F,st=h*C-c*q,pt=c*F-d*C,j=x*it+S*st+L*pt,!(j>-xt&&j<xt)&&(J=1/j,_t=u-_,X=m-y,ot=g-v,qt=J*(_t*it+X*st+ot*pt),!(qt<-xt||qt>1+xt)&&(Tt=X*L-ot*S,Vt=ot*x-_t*L,Gt=_t*S-X*x,Qt=J*(c*Tt+d*Vt+h*Gt),!(Qt<-xt||qt+Qt>1+xt)&&(ne=J*(C*Tt+F*Vt+q*Gt),ne>=0&&o.push(new t(u+c*ne,m+d*ne,g+h*ne)))))},fabs:function(s){return s>=0?s:-s},fmod:function(s,a){return a===0?0:s-Math.floor(s/a)*a},fract:function(s){return s-Math.floor(s)},mod:function(s,a){return(s%a+a)%a},max:function(s,a){return s>a?s:a},localCoordinateAxesAtPoint:function(s,a,f,o,c){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingVector"));if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingGlobe"));if(!f||!o||!c)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","localCoordinateAxesAtPoint","missingResult"));var d=s[0],h=s[1],u=s[2];a.surfaceNormalAtPoint(d,h,u,c),a.northTangentAtPoint(d,h,u,o),f.set(o[0],o[1],o[2]),f.cross(c),f.normalize(),o.set(c[0],c[1],c[2]),o.cross(f),o.normalize()},horizonDistanceForGlobeRadius:function(s,a){if(s<0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","horizontalDistanceForGlobeRadius","The specified globe radius is negative."));return s>0&&a>0?Math.sqrt(a*(2*s+a)):0},perspectiveNearDistanceForFarDistance:function(s,a,f){if(s<0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified distance is negative."));if(a<0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified resolution is negative."));if(f<1)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectiveNearDistanceForFarDistance","The specified depth bits is negative."));var o=(1<<f)-1;return s/(o/(1-a/s)-o+1)},perspectiveNearDistance:function(s,a,f){if(s<=0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","invalidWidth"));if(a<=0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","invalidHeight"));if(f<0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectiveNearDistance","The specified distance is negative."));var o=a/s;return 2*f/Math.sqrt(o*o+5)},perspectiveFrustumRectangle:function(s,a,f){if(s<=0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","invalidWidth"));if(a<=0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","invalidHeight"));if(f<0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectiveFrustumRectangle","The specified distance is negative."));var o=f,c=f*a/s;return new i(-o/2,-c/2,o,c)},perspectivePixelSize:function(s,a,f){if(s<=0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectivePixelSize","invalidWidth"));if(a<=0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectivePixelSize","invalidHeight"));if(f<0)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","perspectivePixelSize","The specified distance is negative."));var o=r.perspectiveFrustumRectangle(s,a,f).height;return o/a},boundingRectForUnitQuad:function(s){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"WWMath","boundingRectForUnitQuad","missingMatrix"));var a=s,f=a[3],o=a[7],c=a[0]+a[3],d=a[4]+a[7],h=a[1]+a[3],u=a[5]+a[7],m=a[0]+a[1]+a[3],g=a[4]+a[5]+a[7],_=Math.min(Math.min(f,c),Math.min(h,m)),y=Math.max(Math.max(f,c),Math.max(h,m)),v=Math.min(Math.min(o,d),Math.min(u,g)),b=Math.max(Math.max(o,d),Math.max(u,g));return new i(_,v,y-_,b-v)},isPowerOfTwo:function(s){return s!=0&&(s&s-1)===0},signum:function(s){return s>0?1:s<0?-1:0},gudermannianInverse:function(s){return Math.log(Math.tan(Math.PI/4+s*p.DEGREES_TO_RADIANS/2))/Math.PI},epsg3857ToEpsg4326:function(s,a){var f=6378100,o=Math.PI/2-2*Math.atan(Math.exp(-a/f)),c=s/f;return[r.clamp(o*p.RADIANS_TO_DEGREES,-90,90),r.clamp(c*p.RADIANS_TO_DEGREES,-180,180)]},powerOfTwoFloor:function(s){var a=Math.floor(Math.log(s)/Math.log(2));return Math.pow(2,a)},normalizeAngle360:function(s){var a=s%360;return a>=0?a:a<0?360+a:360-a}};return r}),B("geom/Location",["../geom/Angle","../error/ArgumentError","../util/Logger","../geom/Plane","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t){"use strict";var r=function(s,a){this.latitude=s,this.longitude=a};return r.ZERO=new r(0,0),r.fromRadians=function(s,a){return new r(s*p.RADIANS_TO_DEGREES,a*p.RADIANS_TO_DEGREES)},r.prototype.copy=function(s){if(!s)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","copy","missingLocation"));return this.latitude=s.latitude,this.longitude=s.longitude,this},r.prototype.set=function(s,a){return this.latitude=s,this.longitude=a,this},r.prototype.equals=function(s){return s&&s.latitude===this.latitude&&s.longitude===this.longitude},r.interpolateAlongPath=function(s,a,f,o,c){if(!f||!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","interpolateAlongPath","missingLocation"));if(!c)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","interpolateAlongPath","missingResult"));return s===WorldWind.GREAT_CIRCLE?this.interpolateGreatCircle(a,f,o,c):s&&s===WorldWind.RHUMB_LINE?this.interpolateRhumb(a,f,o,c):this.interpolateLinear(a,f,o,c)},r.interpolateGreatCircle=function(s,a,f,o){if(!a||!f)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","interpolateGreatCircle","missingLocation"));if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","interpolateGreatCircle","missingResult"));if(a.equals(f))return o.latitude=a.latitude,o.longitude=a.longitude,o;var c=t.clamp(s,0,1),d=this.greatCircleAzimuth(a,f),h=this.greatCircleDistance(a,f);return this.greatCircleLocation(a,d,c*h,o)},r.greatCircleAzimuth=function(s,a){if(!s||!a)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","greatCircleAzimuth","missingLocation"));var f=s.latitude*p.DEGREES_TO_RADIANS,o=a.latitude*p.DEGREES_TO_RADIANS,c=s.longitude*p.DEGREES_TO_RADIANS,d=a.longitude*p.DEGREES_TO_RADIANS,h,u,m;return f==o&&c==d?0:c==d?f>o?180:0:(u=Math.cos(o)*Math.sin(d-c),h=Math.cos(f)*Math.sin(o)-Math.sin(f)*Math.cos(o)*Math.cos(d-c),m=Math.atan2(u,h),isNaN(m)?0:m*p.RADIANS_TO_DEGREES)},r.greatCircleDistance=function(s,a){if(!s||!a)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","greatCircleDistance","missingLocation"));var f=s.latitude*p.DEGREES_TO_RADIANS,o=a.latitude*p.DEGREES_TO_RADIANS,c=s.longitude*p.DEGREES_TO_RADIANS,d=a.longitude*p.DEGREES_TO_RADIANS,h,u,m,g;return f==o&&c==d?0:(h=Math.sin((o-f)/2),u=Math.sin((d-c)/2),m=h*h+Math.cos(f)*Math.cos(o)*u*u,g=2*Math.asin(Math.sqrt(m)),isNaN(g)?0:g)},r.greatCircleLocation=function(s,a,f,o){if(!s)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","greatCircleLocation","missingLocation"));if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","greatCircleLocation","missingResult"));if(f==0)return o.latitude=s.latitude,o.longitude=s.longitude,o;var c=s.latitude*p.DEGREES_TO_RADIANS,d=s.longitude*p.DEGREES_TO_RADIANS,h=a*p.DEGREES_TO_RADIANS,u,m;return u=Math.asin(Math.sin(c)*Math.cos(f)+Math.cos(c)*Math.sin(f)*Math.cos(h)),m=d+Math.atan2(Math.sin(f)*Math.sin(h),Math.cos(c)*Math.cos(f)-Math.sin(c)*Math.sin(f)*Math.cos(h)),isNaN(u)||isNaN(m)?(o.latitude=s.latitude,o.longitude=s.longitude):(o.latitude=p.normalizedDegreesLatitude(u*p.RADIANS_TO_DEGREES),o.longitude=p.normalizedDegreesLongitude(m*p.RADIANS_TO_DEGREES)),o},r.interpolateRhumb=function(s,a,f,o){if(!a||!f)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","interpolateRhumb","missingLocation"));if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","interpolateRhumb","missingResult"));if(a.equals(f))return o.latitude=a.latitude,o.longitude=a.longitude,o;var c=t.clamp(s,0,1),d=this.rhumbAzimuth(a,f),h=this.rhumbDistance(a,f);return this.rhumbLocation(a,d,c*h,o)},r.rhumbAzimuth=function(s,a){if(!s||!a)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","rhumbAzimuth","missingLocation"));var f=s.latitude*p.DEGREES_TO_RADIANS,o=a.latitude*p.DEGREES_TO_RADIANS,c=s.longitude*p.DEGREES_TO_RADIANS,d=a.longitude*p.DEGREES_TO_RADIANS,h,u,m;return f==o&&c==d?0:(h=d-c,u=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(f/2+Math.PI/4)),t.fabs(h)>Math.PI&&(h=h>0?-(2*Math.PI-h):2*Math.PI+h),m=Math.atan2(h,u),isNaN(m)?0:m*p.RADIANS_TO_DEGREES)},r.rhumbDistance=function(s,a){if(!s||!a)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","rhumbDistance","missingLocation"));var f=s.latitude*p.DEGREES_TO_RADIANS,o=a.latitude*p.DEGREES_TO_RADIANS,c=s.longitude*p.DEGREES_TO_RADIANS,d=a.longitude*p.DEGREES_TO_RADIANS,h,u,m,g,_;return f==o&&c==d?0:(h=o-f,u=d-c,m=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(f/2+Math.PI/4)),g=h/m,(isNaN(m)||isNaN(g))&&(g=Math.cos(f)),t.fabs(u)>Math.PI&&(u=u>0?-(2*Math.PI-u):2*Math.PI+u),_=Math.sqrt(h*h+g*g*u*u),isNaN(_)?0:_)},r.rhumbLocation=function(s,a,f,o){if(!s)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","rhumbLocation","missingLocation"));if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","rhumbLocation","missingResult"));if(f==0)return o.latitude=s.latitude,o.longitude=s.longitude,o;var c=s.latitude*p.DEGREES_TO_RADIANS,d=s.longitude*p.DEGREES_TO_RADIANS,h=a*p.DEGREES_TO_RADIANS,u=c+f*Math.cos(h),m=Math.log(Math.tan(u/2+Math.PI/4)/Math.tan(c/2+Math.PI/4)),g=(u-c)/m,_,y;return(isNaN(m)||isNaN(g)||!isFinite(g))&&(g=Math.cos(c)),_=f*Math.sin(h)/g,t.fabs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u),y=t.fmod(d+_+Math.PI,2*Math.PI)-Math.PI,isNaN(u)||isNaN(y)?(o.latitude=s.latitude,o.longitude=s.longitude):(o.latitude=p.normalizedDegreesLatitude(u*p.RADIANS_TO_DEGREES),o.longitude=p.normalizedDegreesLongitude(y*p.RADIANS_TO_DEGREES)),o},r.interpolateLinear=function(s,a,f,o){if(!a||!f)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","interpolateLinear","missingLocation"));if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","interpolateLinear","missingResult"));if(a.equals(f))return o.latitude=a.latitude,o.longitude=a.longitude,o;var c=t.clamp(s,0,1),d=this.linearAzimuth(a,f),h=this.linearDistance(a,f);return this.linearLocation(a,d,c*h,o)},r.linearAzimuth=function(s,a){if(!s||!a)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","linearAzimuth","missingLocation"));var f=s.latitude*p.DEGREES_TO_RADIANS,o=a.latitude*p.DEGREES_TO_RADIANS,c=s.longitude*p.DEGREES_TO_RADIANS,d=a.longitude*p.DEGREES_TO_RADIANS,h,u,m;return f==o&&c==d?0:(h=d-c,u=o-f,t.fabs(h)>Math.PI&&(h=h>0?-(2*Math.PI-h):2*Math.PI+h),m=Math.atan2(h,u),isNaN(m)?0:m*p.RADIANS_TO_DEGREES)},r.linearDistance=function(s,a){if(!s||!a)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","linearDistance","missingLocation"));var f=s.latitude*p.DEGREES_TO_RADIANS,o=a.latitude*p.DEGREES_TO_RADIANS,c=s.longitude*p.DEGREES_TO_RADIANS,d=a.longitude*p.DEGREES_TO_RADIANS,h,u,m;return f==o&&c==d?0:(h=o-f,u=d-c,t.fabs(u)>Math.PI&&(u=u>0?-(2*Math.PI-u):2*Math.PI+u),m=Math.sqrt(h*h+u*u),isNaN(m)?0:m)},r.linearLocation=function(s,a,f,o){if(!s)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","linearLocation","missingLocation"));if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","linearLocation","missingResult"));if(f==0)return o.latitude=s.latitude,o.longitude=s.longitude,o;var c=s.latitude*p.DEGREES_TO_RADIANS,d=s.longitude*p.DEGREES_TO_RADIANS,h=a*p.DEGREES_TO_RADIANS,u=c+f*Math.cos(h),m;return t.fabs(u)>Math.PI/2&&(u=u>0?Math.PI-u:-Math.PI-u),m=t.fmod(d+f*Math.sin(h)+Math.PI,2*Math.PI)-Math.PI,isNaN(u)||isNaN(m)?(o.latitude=s.latitude,o.longitude=s.longitude):(o.latitude=p.normalizedDegreesLatitude(u*p.RADIANS_TO_DEGREES),o.longitude=p.normalizedDegreesLongitude(m*p.RADIANS_TO_DEGREES)),o},r.locationsCrossDateLine=function(s){if(!s)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","locationsCrossDateline","missingLocation"));for(var a=null,f=0,o=s.length;f<o;f+=1){var c=s[f];if(a!=null&&t.signum(a.longitude)!=t.signum(c.longitude)){var d=Math.abs(a.longitude-c.longitude);if(d>180&&d<360)return!0}a=c}return!1},r.greatCircleArcExtremeLocations=function(s){if(!s)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","greatCircleArcExtremeLocations","missingLocation"));for(var a=null,f=null,o=null,c=0,d=s.length;c<d;c+=1){var h=s[c];if(o!=null){var u=r.greatCircleArcExtremeForTwoLocations(o,h);if(u==null)continue;(a==null||a.latitude>u[0].latitude)&&(a=u[0]),(f==null||f.latitude<u[1].latitude)&&(f=u[1])}o=h}return[a,f]},r.greatCircleArcExtremeForTwoLocations=function(s,a){if(!s||!a)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","greatCircleArcExtremeForTwoLocations","missingLocation"));var f,o,c,d=null,h=null,u=90,m=-90,g=[s,a];for(f=0,o=g.length;f<o;f+=1)c=g[f],u>=c.latitude&&(u=c.latitude,d=c),m<=c.latitude&&(m=c.latitude,h=c);var _=r.greatCircleAzimuth(s,a),y=r.greatCircleDistance(s,a),v=r.greatCircleExtremeLocationsUsingAzimuth(s,_);for(f=0,o=v.length;f<o;f+=1){c=v[f];var b=r.greatCircleAzimuth(s,c),R=r.greatCircleDistance(s,c);t.signum(b)==t.signum(_)&&R>=0&&R<=y&&(u>=c.latitude&&(u=c.latitude,d=c),m<=c.latitude&&(m=c.latitude,h=c))}return[d,h]},r.greatCircleExtremeLocationsUsingAzimuth=function(s,a){if(!s)throw new l(n.logMessage(n.LEVEL_SEVERE,"Location","greatCircleArcExtremeLocationsUsingAzimuth","missingLocation"));var f=s.latitude,o=a*p.DEGREES_TO_RADIANS,c=-Math.tan(f)/Math.cos(o),d=Math.atan(c),h=d+Math.PI/2,u=d-Math.PI/2;return[r.greatCircleLocation(s,a,h,new r(0,0)),r.greatCircleLocation(s,a,u,new r(0,0))]},r.intersectionWithMeridian=function(s,a,f,o){var c=o.computePointFromLocation(s.latitude,s.longitude,new i(0,0,0)),d=o.computePointFromLocation(a.latitude,a.longitude,new i(0,0,0)),h=o.computePointFromLocation(90,f,new i(0,0,0)),u=o.computePointFromLocation(0,f,new i(0,0,0)),m=e.fromPoints(h,u,i.ZERO),g=new i(0,0,0);if(!m.intersectsSegmentAt(c,d,g))return null;var _=new WorldWind.Position(0,0,0);return o.computePositionFromPoint(g[0],g[1],g[2],_),_.latitude},r.meridianIntersection=function(s,a,f){var o=s.longitude<0?s.longitude+360:s.longitude,c=a.longitude<0?a.longitude+360:a.longitude;if(o===c)return null;var d=f<0?f+360:f,h=(a.latitude-s.latitude)/(c-o),u=s.latitude+h*(d-o);return u},r.poles={NONE:0,NORTH:1,SOUTH:2},r}),B("geom/Position",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../util/WWMath"],function(p,l,n,e,i){"use strict";var t=function(r,s,a){this.latitude=r,this.longitude=s,this.altitude=a};return t.ZERO=new t(0,0,0),t.fromRadians=function(r,s,a){return new t(r*p.RADIANS_TO_DEGREES,s*p.RADIANS_TO_DEGREES,a)},t.prototype.copy=function(r){if(!r)throw new l(e.logMessage(e.LEVEL_SEVERE,"Position","copy","missingPosition"));return this.latitude=r.latitude,this.longitude=r.longitude,this.altitude=r.altitude,this},t.prototype.equals=function(r){return r&&r.latitude===this.latitude&&r.longitude===this.longitude&&r.altitude===this.altitude},t.interpolateGreatCircle=function(r,s,a,f){if(!s||!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"Position","interpolateGreatCircle","missingPosition"));if(!f)throw new l(e.logMessage(e.LEVEL_SEVERE,"Position","interpolateGreatCircle","missingResult"));var o=i.clamp(r,0,1);return f.altitude=i.interpolate(o,s.altitude,a.altitude),n.interpolateGreatCircle(o,s,a,f),f},t.interpolateRhumb=function(r,s,a,f){if(!s||!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"Position","interpolateRhumb","missingPosition"));if(!f)throw new l(e.logMessage(e.LEVEL_SEVERE,"Position","interpolateRhumb","missingResult"));var o=i.clamp(r,0,1);return f.altitude=i.interpolate(o,s.altitude,a.altitude),n.interpolateRhumb(o,s,a,f),f},t.interpolateLinear=function(r,s,a,f){if(!s||!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"Position","interpolateLinear","missingPosition"));if(!f)throw new l(e.logMessage(e.LEVEL_SEVERE,"Position","interpolateLinear","missingResult"));var o=i.clamp(r,0,1);return f.altitude=i.interpolate(o,s.altitude,a.altitude),n.interpolateLinear(o,s,a,f),f},t.prototype.toString=function(){return"("+this.latitude.toString()+"\xB0, "+this.longitude.toString()+"\xB0, "+this.altitude.toString()+")"},t}),B("render/Texture",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(p,l,n){"use strict";var e=function(i,t,r){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"Texture","constructor","missingGlContext"));if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"Texture","constructor","missingImage"));r||(r=i.CLAMP_TO_EDGE);var s=i.createTexture(),a=n.isPowerOfTwo(t.width)&&n.isPowerOfTwo(t.height);this.originalImageWidth=t.width,this.originalImageHeight=t.height,r===i.REPEAT&&!a&&(t=this.resizeImage(t),a=!0),this.imageWidth=t.width,this.imageHeight=t.height,this.size=t.width*t.height*4,i.bindTexture(i.TEXTURE_2D,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,a?i.LINEAR_MIPMAP_LINEAR:i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,r),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),a&&i.generateMipmap(i.TEXTURE_2D),this.textureId=s,this.creationTime=new Date,this.texParameters={},this.anisotropicFilterExt=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic")};return e.prototype.setTexParameter=function(i,t){this.texParameters[i]=t},e.prototype.getTexParameter=function(i){return this.texParameters[i]},e.prototype.clearTexParameters=function(){this.texParameters={}},e.prototype.dispose=function(i){i.deleteTexture(this.textureId),delete this.textureId},e.prototype.bind=function(i){var t=i.currentGlContext;return t.bindTexture(t.TEXTURE_2D,this.textureId),this.applyTexParameters(i),i.frameStatistics.incrementTextureLoadCount(1),!0},e.prototype.applyTexParameters=function(i){var t=i.currentGlContext,r=this.texParameters[t.TEXTURE_MAG_FILTER]||t.LINEAR;t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,r),r===t.LINEAR&&this.anisotropicFilterExt&&t.texParameteri(t.TEXTURE_2D,this.anisotropicFilterExt.TEXTURE_MAX_ANISOTROPY_EXT,4)},e.prototype.resizeImage=function(i){var t=document.createElement("canvas");t.width=n.powerOfTwoFloor(i.width),t.height=n.powerOfTwoFloor(i.height);var r=t.getContext("2d");return r.drawImage(i,0,0,t.width,t.height),t},e}),B("geom/Matrix",["../geom/Angle","../error/ArgumentError","../util/Logger","../geom/Plane","../geom/Position","../geom/Rectangle","../render/Texture","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r,s,a){"use strict";var f=function(o,c,d,h,u,m,g,_,y,v,b,R,M,P,T,E){this[0]=o,this[1]=c,this[2]=d,this[3]=h,this[4]=u,this[5]=m,this[6]=g,this[7]=_,this[8]=y,this[9]=v,this[10]=b,this[11]=R,this[12]=M,this[13]=P,this[14]=T,this[15]=E};return f.prototype=new Float64Array(16),f.fromIdentity=function(){return new f(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},f.principalAxesFromPoints=function(o,c,d,h){if(!o||o.length<1)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","principalAxesFromPoints","missingPoints"));if(!c||!d||!h)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","principalAxesFromPoints","An axis argument is null or undefined."));var u=f.fromIdentity();u.setToCovarianceOfPoints(o),u.eigensystemFromSymmetricMatrix(c,d,h),c.normalize(),d.normalize(),h.normalize()},f.prototype.set=function(o,c,d,h,u,m,g,_,y,v,b,R,M,P,T,E){return this[0]=o,this[1]=c,this[2]=d,this[3]=h,this[4]=u,this[5]=m,this[6]=g,this[7]=_,this[8]=y,this[9]=v,this[10]=b,this[11]=R,this[12]=M,this[13]=P,this[14]=T,this[15]=E,this},f.prototype.setToIdentity=function(){this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1},f.prototype.copy=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","copy","missingMatrix"));this[0]=o[0],this[1]=o[1],this[2]=o[2],this[3]=o[3],this[4]=o[4],this[5]=o[5],this[6]=o[6],this[7]=o[7],this[8]=o[8],this[9]=o[9],this[10]=o[10],this[11]=o[11],this[12]=o[12],this[13]=o[13],this[14]=o[14],this[15]=o[15]},f.prototype.clone=function(){var o=f.fromIdentity();return o.copy(this),o},f.prototype.equals=function(o){return o&&this[0]==o[0]&&this[1]==o[1]&&this[2]==o[2]&&this[3]==o[3]&&this[4]==o[4]&&this[5]==o[5]&&this[6]==o[6]&&this[7]==o[7]&&this[8]==o[8]&&this[9]==o[9]&&this[10]==o[10]&&this[11]==o[11]&&this[12]==o[12]&&this[13]==o[13]&&this[14]==o[14]&&this[15]==o[15]},f.prototype.columnMajorComponents=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","columnMajorComponents","missingResult"));return o[0]=this[0],o[1]=this[4],o[2]=this[8],o[3]=this[12],o[4]=this[1],o[5]=this[5],o[6]=this[9],o[7]=this[13],o[8]=this[2],o[9]=this[6],o[10]=this[10],o[11]=this[14],o[12]=this[3],o[13]=this[7],o[14]=this[11],o[15]=this[15],o},f.prototype.setToTranslation=function(o,c,d){return this[0]=1,this[1]=0,this[2]=0,this[3]=o,this[4]=0,this[5]=1,this[6]=0,this[7]=c,this[8]=0,this[9]=0,this[10]=1,this[11]=d,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},f.prototype.setTranslation=function(o,c,d){return this[3]=o,this[7]=c,this[11]=d,this},f.prototype.setToScale=function(o,c,d){return this[0]=o,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=c,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=d,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},f.prototype.setScale=function(o,c,d){return this[0]=o,this[5]=c,this[10]=d,this},f.prototype.setToTransposeOfMatrix=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","setToTransposeOfMatrix","missingMatrix"));return this[0]=o[0],this[1]=o[4],this[2]=o[8],this[3]=o[12],this[4]=o[1],this[5]=o[5],this[6]=o[9],this[7]=o[13],this[8]=o[2],this[9]=o[6],this[10]=o[10],this[11]=o[14],this[12]=o[3],this[13]=o[7],this[14]=o[11],this[15]=o[15],this},f.prototype.setToMultiply=function(o,c){if(!o||!c)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","setToMultiply","missingMatrix"));var d=o,h=c;return this[0]=d[0]*h[0]+d[1]*h[4]+d[2]*h[8]+d[3]*h[12],this[1]=d[0]*h[1]+d[1]*h[5]+d[2]*h[9]+d[3]*h[13],this[2]=d[0]*h[2]+d[1]*h[6]+d[2]*h[10]+d[3]*h[14],this[3]=d[0]*h[3]+d[1]*h[7]+d[2]*h[11]+d[3]*h[15],this[4]=d[4]*h[0]+d[5]*h[4]+d[6]*h[8]+d[7]*h[12],this[5]=d[4]*h[1]+d[5]*h[5]+d[6]*h[9]+d[7]*h[13],this[6]=d[4]*h[2]+d[5]*h[6]+d[6]*h[10]+d[7]*h[14],this[7]=d[4]*h[3]+d[5]*h[7]+d[6]*h[11]+d[7]*h[15],this[8]=d[8]*h[0]+d[9]*h[4]+d[10]*h[8]+d[11]*h[12],this[9]=d[8]*h[1]+d[9]*h[5]+d[10]*h[9]+d[11]*h[13],this[10]=d[8]*h[2]+d[9]*h[6]+d[10]*h[10]+d[11]*h[14],this[11]=d[8]*h[3]+d[9]*h[7]+d[10]*h[11]+d[11]*h[15],this[12]=d[12]*h[0]+d[13]*h[4]+d[14]*h[8]+d[15]*h[12],this[13]=d[12]*h[1]+d[13]*h[5]+d[14]*h[9]+d[15]*h[13],this[14]=d[12]*h[2]+d[13]*h[6]+d[14]*h[10]+d[15]*h[14],this[15]=d[12]*h[3]+d[13]*h[7]+d[14]*h[11]+d[15]*h[15],this},f.prototype.setToCovarianceOfPoints=function(o){if(!o||o.length<1)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","setToCovarianceOfPoints","missingArray"));var c,d,h,u,m=0,g=0,_=0,y=0,v=0,b=0,R=0,M=new s(0,0,0);c=s.averageOfBuffer(o,new s(0,0,0));for(var P=0,T=o.length/3;P<T;P++)M[0]=o[P*3],M[1]=o[P*3+1],M[2]=o[P*3+2],d=M[0]-c[0],h=M[1]-c[1],u=M[2]-c[2],++m,g+=d*d,_+=h*h,y+=u*u,v+=d*h,b+=d*u,R+=h*u;return this[0]=g/m,this[1]=v/m,this[2]=b/m,this[3]=0,this[4]=v/m,this[5]=_/m,this[6]=R/m,this[7]=0,this[8]=b/m,this[9]=R/m,this[10]=y/m,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=0,this},f.prototype.multiplyByTranslation=function(o,c,d){return this.multiply(1,0,0,o,0,1,0,c,0,0,1,d,0,0,0,1),this},f.prototype.multiplyByRotation=function(o,c,d,h){var u=Math.cos(h*p.DEGREES_TO_RADIANS),m=Math.sin(h*p.DEGREES_TO_RADIANS);return this.multiply(u+(1-u)*o*o,(1-u)*o*c-m*d,(1-u)*o*d+m*c,0,(1-u)*o*c+m*d,u+(1-u)*c*c,(1-u)*c*d-m*o,0,(1-u)*o*d-m*c,(1-u)*c*d+m*o,u+(1-u)*d*d,0,0,0,0,1),this},f.prototype.multiplyByScale=function(o,c,d){return this.multiply(o,0,0,0,0,c,0,0,0,0,d,0,0,0,0,1),this},f.prototype.setToUnitYFlip=function(){return this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=-1,this[6]=0,this[7]=1,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},f.prototype.multiplyByLocalCoordinateTransform=function(o,c){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","multiplyByLocalCoordinateTransform","Origin vector is null or undefined"));if(!c)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","multiplyByLocalCoordinateTransform","missingGlobe"));var d=new s(0,0,0),h=new s(0,0,0),u=new s(0,0,0);return a.localCoordinateAxesAtPoint(o,c,d,h,u),this.multiply(d[0],h[0],u[0],o[0],d[1],h[1],u[1],o[1],d[2],h[2],u[2],o[2],0,0,0,1),this},f.prototype.multiplyByTextureTransform=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","multiplyByTextureTransform","missingTexture"));var c=o.originalImageWidth/o.imageWidth,d=o.originalImageHeight/o.imageHeight;return this.multiply(c,0,0,0,0,-d,0,d,0,0,1,0,0,0,0,1),this},f.prototype.extractTranslation=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","extractTranslation","missingResult"));return o[0]=this[3],o[1]=this[7],o[2]=this[11],o},f.prototype.extractRotationAngles=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","extractRotationAngles","missingResult"));var c=Math.atan2(this[6],this[10]),d=Math.atan2(-this[2],Math.sqrt(this[0]*this[0]+this[1]*this[1])),h=Math.cos(c),u=Math.sin(c),m=Math.atan2(u*this[8]-h*this[4],h*this[5]-u*this[9]);return o[0]=c*p.RADIANS_TO_DEGREES,o[1]=d*p.RADIANS_TO_DEGREES,o[2]=m*p.RADIANS_TO_DEGREES,o},f.prototype.multiplyByFirstPersonModelview=function(o,c,d,h,u){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","multiplyByFirstPersonModelview","missingPosition"));if(!u)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","multiplyByFirstPersonModelview","missingGlobe"));var m,g,_,y,v,b,R,M,P,T,E,x,S,L,C=new s(0,0,0),F=new s(0,0,0),q=new s(0,0,0),it=new s(0,0,0);return m=Math.cos(h*p.DEGREES_TO_RADIANS),g=Math.sin(h*p.DEGREES_TO_RADIANS),this.multiply(m,g,0,0,-g,m,0,0,0,0,1,0,0,0,0,1),m=Math.cos(d*p.DEGREES_TO_RADIANS),g=Math.sin(d*p.DEGREES_TO_RADIANS),this.multiply(1,0,0,0,0,m,g,0,0,-g,m,0,0,0,0,1),m=Math.cos(c*p.DEGREES_TO_RADIANS),g=Math.sin(c*p.DEGREES_TO_RADIANS),this.multiply(m,-g,0,0,g,m,0,0,0,0,1,0,0,0,0,1),u.computePointFromPosition(o.latitude,o.longitude,o.altitude,C),_=C[0],y=C[1],v=C[2],a.localCoordinateAxesAtPoint(C,u,F,q,it),b=F[0],R=F[1],M=F[2],P=q[0],T=q[1],E=q[2],x=it[0],S=it[1],L=it[2],this.multiply(b,R,M,-b*_-R*y-M*v,P,T,E,-P*_-T*y-E*v,x,S,L,-x*_-S*y-L*v,0,0,0,1),this},f.prototype.multiplyByLookAtModelview=function(o,c,d,h,u,m){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","missingPosition"));if(c<0)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","Range is less than zero"));if(!m)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","multiplyByLookAtModelview","missingGlobe"));return this.multiplyByTranslation(0,0,-c),this.multiplyByFirstPersonModelview(o,d,h,u,m),this},f.prototype.setToPerspectiveProjection=function(o,c,d,h){if(o<=0)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","invalidWidth"));if(c<=0)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","invalidHeight"));if(d===h)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","Near and far distance are the same."));if(d<=0||h<=0)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","setToPerspectiveProjection","Near or far distance is less than or equal to zero."));var u=a.perspectiveFrustumRectangle(o,c,d),m=u.getMinX(),g=u.getMaxX(),_=u.getMinY(),y=u.getMaxY();return this[0]=2*d/(g-m),this[1]=0,this[2]=(g+m)/(g-m),this[3]=0,this[4]=0,this[5]=2*d/(y-_),this[6]=(y+_)/(y-_),this[7]=0,this[8]=0,this[9]=0,this[10]=-(h+d)/(h-d),this[11]=-2*d*h/(h-d),this[12]=0,this[13]=0,this[14]=-1,this[15]=0,this},f.prototype.setToScreenProjection=function(o,c){if(o<=0)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","setToScreenProjection","invalidWidth"));if(c<=0)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","setToScreenProjection","invalidHeight"));return this[0]=2/o,this[1]=0,this[2]=0,this[3]=-1,this[4]=0,this[5]=2/c,this[6]=0,this[7]=-1,this[8]=0,this[9]=0,this[10]=2,this[11]=-1,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},f.prototype.extractEyePoint=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","extractEyePoint","missingResult"));return o[0]=-(this[0]*this[3])-this[4]*this[7]-this[8]*this[11],o[1]=-(this[1]*this[3])-this[5]*this[7]-this[9]*this[11],o[2]=-(this[2]*this[3])-this[6]*this[7]-this[10]*this[11],o},f.prototype.extractForwardVector=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","extractForwardVector","missingResult"));return o[0]=-this[8],o[1]=-this[9],o[2]=-this[10],o},f.prototype.extractViewingParameters=function(o,c,d,h){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","extractViewingParameters","The specified origin is null or undefined."));if(!d)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","extractViewingParameters","missingGlobe"));if(!h)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","extractViewingParameters","missingResult"));var u=new i(0,0,0),m=f.fromIdentity(),g,_,y,v,b,R,M,P,T;return d.computePositionFromPoint(o[0],o[1],o[2],u),m.copy(this),m.multiplyByLocalCoordinateTransform(o,d),g=-m[11],_=m[10],y=Math.sqrt(m[2]*m[2]+m[6]*m[6]),v=Math.atan2(y,_)*p.RADIANS_TO_DEGREES,b=Math.cos(c*p.DEGREES_TO_RADIANS),R=Math.sin(c*p.DEGREES_TO_RADIANS),M=b*m[0]-R*m[4],P=R*m[5]-b*m[1],T=Math.atan2(P,M)*p.RADIANS_TO_DEGREES,h.origin=u,h.range=g,h.heading=T,h.tilt=v,h.roll=c,h},f.prototype.offsetProjectionDepth=function(o){return this[10]*=1+o,this},f.prototype.multiplyMatrix=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","multiplyMatrix","missingMatrix"));var c=this,d=o,h,u,m,g;return h=c[0],u=c[1],m=c[2],g=c[3],c[0]=h*d[0]+u*d[4]+m*d[8]+g*d[12],c[1]=h*d[1]+u*d[5]+m*d[9]+g*d[13],c[2]=h*d[2]+u*d[6]+m*d[10]+g*d[14],c[3]=h*d[3]+u*d[7]+m*d[11]+g*d[15],h=c[4],u=c[5],m=c[6],g=c[7],c[4]=h*d[0]+u*d[4]+m*d[8]+g*d[12],c[5]=h*d[1]+u*d[5]+m*d[9]+g*d[13],c[6]=h*d[2]+u*d[6]+m*d[10]+g*d[14],c[7]=h*d[3]+u*d[7]+m*d[11]+g*d[15],h=c[8],u=c[9],m=c[10],g=c[11],c[8]=h*d[0]+u*d[4]+m*d[8]+g*d[12],c[9]=h*d[1]+u*d[5]+m*d[9]+g*d[13],c[10]=h*d[2]+u*d[6]+m*d[10]+g*d[14],c[11]=h*d[3]+u*d[7]+m*d[11]+g*d[15],h=c[12],u=c[13],m=c[14],g=c[15],c[12]=h*d[0]+u*d[4]+m*d[8]+g*d[12],c[13]=h*d[1]+u*d[5]+m*d[9]+g*d[13],c[14]=h*d[2]+u*d[6]+m*d[10]+g*d[14],c[15]=h*d[3]+u*d[7]+m*d[11]+g*d[15],this},f.prototype.multiply=function(o,c,d,h,u,m,g,_,y,v,b,R,M,P,T,E){var x=this,S,L,C,F;return S=x[0],L=x[1],C=x[2],F=x[3],x[0]=S*o+L*u+C*y+F*M,x[1]=S*c+L*m+C*v+F*P,x[2]=S*d+L*g+C*b+F*T,x[3]=S*h+L*_+C*R+F*E,S=x[4],L=x[5],C=x[6],F=x[7],x[4]=S*o+L*u+C*y+F*M,x[5]=S*c+L*m+C*v+F*P,x[6]=S*d+L*g+C*b+F*T,x[7]=S*h+L*_+C*R+F*E,S=x[8],L=x[9],C=x[10],F=x[11],x[8]=S*o+L*u+C*y+F*M,x[9]=S*c+L*m+C*v+F*P,x[10]=S*d+L*g+C*b+F*T,x[11]=S*h+L*_+C*R+F*E,S=x[12],L=x[13],C=x[14],F=x[15],x[12]=S*o+L*u+C*y+F*M,x[13]=S*c+L*m+C*v+F*P,x[14]=S*d+L*g+C*b+F*T,x[15]=S*h+L*_+C*R+F*E,this},f.prototype.invertMatrix=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","invertMatrix","missingMatrix"));var c=[[],[],[],[]];c[0][0]=o[0],c[0][1]=o[1],c[0][2]=o[2],c[0][3]=o[3],c[1][0]=o[4],c[1][1]=o[5],c[1][2]=o[6],c[1][3]=o[7],c[2][0]=o[8],c[2][1]=o[9],c[2][2]=o[10],c[2][3]=o[11],c[3][0]=o[12],c[3][1]=o[13],c[3][2]=o[14],c[3][3]=o[15];var d=[],h=f.ludcmp(c,d),u,m;for(u=0;u<4;u+=1)h*=c[u][u];if(Math.abs(h)<1e-8)return null;var g=[[],[],[],[]],_=[];for(m=0;m<4;m+=1){for(u=0;u<4;u+=1)_[u]=0;for(_[m]=1,f.lubksb(c,d,_),u=0;u<4;u+=1)g[u][m]=_[u]}return this[0]=g[0][0],this[1]=g[0][1],this[2]=g[0][2],this[3]=g[0][3],this[4]=g[1][0],this[5]=g[1][1],this[6]=g[1][2],this[7]=g[1][3],this[8]=g[2][0],this[9]=g[2][1],this[10]=g[2][2],this[11]=g[2][3],this[12]=g[3][0],this[13]=g[3][1],this[14]=g[3][2],this[15]=g[3][3],this},f.lubksb=function(o,c,d){var h=-1,u,m,g;for(u=0;u<4;u+=1){var _=c[u];if(g=d[_],d[_]=d[u],h!=-1)for(m=h;m<=u-1;m+=1)g-=o[u][m]*d[m];else g!=0&&(h=u);d[u]=g}for(u=3;u>=0;u-=1){for(g=d[u],m=u+1;m<4;m+=1)g-=o[u][m]*d[m];d[u]=g/o[u][u]}},f.ludcmp=function(o,c){var d=1e-20,h=[],u=1,m,g,_,y,v,b,R,M;for(g=0;g<4;g+=1){for(v=0,_=0;_<4;_+=1)(m=Math.abs(o[g][_]))>v&&(v=m);if(v==0)return 0;h[g]=1/v}for(_=0;_<4;_+=1){for(g=0;g<_;g+=1){for(b=o[g][_],y=0;y<g;y+=1)b-=o[g][y]*o[y][_];o[g][_]=b}for(v=0,R=-1,g=_;g<4;g+=1){for(b=o[g][_],y=0;y<_;y++)b-=o[g][y]*o[y][_];o[g][_]=b,(M=h[g]*Math.abs(b))>=v&&(v=M,R=g)}if(_!=R){for(y=0;y<4;y+=1)M=o[R][y],o[R][y]=o[_][y],o[_][y]=M;u=-u,h[R]=h[_]}if(c[_]=R,o[_][_]==0&&(o[_][_]=d),_!=3)for(M=1/o[_][_],g=_+1;g<4;g+=1)o[g][_]*=M}return u},f.prototype.invertOrthonormalMatrix=function(o){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","invertOrthonormalMatrix","missingMatrix"));var c=o;return this[0]=c[0],this[1]=c[4],this[2]=c[8],this[3]=0-c[0]*c[3]-c[4]*c[7]-c[8]*c[11],this[4]=c[1],this[5]=c[5],this[6]=c[9],this[7]=0-c[1]*c[3]-c[5]*c[7]-c[9]*c[11],this[8]=c[2],this[9]=c[6],this[10]=c[10],this[11]=0-c[2]*c[3]-c[6]*c[7]-c[10]*c[11],this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},f.prototype.eigensystemFromSymmetricMatrix=function(o,c,d){if(!o||!c||!d)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","eigensystemFromSymmetricMatrix","missingResult"));if(this[1]!=this[4]||this[2]!=this[8]||this[6]!=this[9])throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","eigensystemFromSymmetricMatrix","Matrix is not symmetric"));for(var h=1e-10,u=this[0],m=this[1],g=this[2],_=this[5],y=this[6],v=this[10],b=[[1,0,0],[0,1,0],[0,0,1]],R=32,M,P,T,E,x,S,L,C,F,q,it,st=0;st<R&&!(a.fabs(m)<h&&a.fabs(g)<h&&a.fabs(y)<h);st++){if(m!=0)for(M=(_-u)*.5/m,P=M*M,T=P+1,E=T!=P?(M<0?-1:1)*(Math.sqrt(T)-a.fabs(M)):.5/M,x=1/Math.sqrt(E*E+1),S=x*E,u-=E*m,_+=E*m,m=0,L=x*g-S*y,y=S*g+x*y,g=L,C=0;C<3;C++)L=x*b[C][0]-S*b[C][1],b[C][1]=S*b[C][0]+x*b[C][1],b[C][0]=L;if(g!=0)for(M=(v-u)*.5/g,P=M*M,T=P+1,E=T!=P?(M<0?-1:1)*(Math.sqrt(T)-a.fabs(M)):.5/M,x=1/Math.sqrt(E*E+1),S=x*E,u-=E*g,v+=E*g,g=0,L=x*m-S*y,y=S*m+x*y,m=L,C=0;C<3;C++)L=x*b[C][0]-S*b[C][2],b[C][2]=S*b[C][0]+x*b[C][2],b[C][0]=L;if(y!=0)for(M=(v-_)*.5/y,P=M*M,T=P+1,E=T!=P?(M<0?-1:1)*(Math.sqrt(T)-a.fabs(M)):.5/M,x=1/Math.sqrt(E*E+1),S=x*E,_-=E*y,v+=E*y,y=0,L=x*m-S*g,g=S*m+x*g,m=L,C=0;C<3;C++)L=x*b[C][1]-S*b[C][2],b[C][2]=S*b[C][1]+x*b[C][2],b[C][1]=L}F=0,q=1,it=2,u<_&&(L=u,u=_,_=L,L=F,F=q,q=L),_<v&&(L=_,_=v,v=L,L=q,q=it,it=L),u<_&&(L=u,u=_,_=L,L=F,F=q,q=L),o[0]=b[0][F],o[1]=b[1][F],o[2]=b[2][F],c[0]=b[0][q],c[1]=b[1][q],c[2]=b[2][q],d[0]=b[0][it],d[1]=b[1][it],d[2]=b[2][it],o.normalize(),c.normalize(),d.normalize(),o.multiply(u),c.multiply(_),d.multiply(v)},f.prototype.upper3By3=function(){var o=f.fromIdentity();return o[0]=this[0],o[1]=this[1],o[2]=this[2],o[4]=this[4],o[5]=this[5],o[6]=this[6],o[8]=this[8],o[9]=this[9],o[10]=this[10],o},f.prototype.unProject=function(o,c,d){if(!o)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","unProject","missingPoint"));if(!c)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","unProject","missingViewport"));if(!d)throw new l(n.logMessage(n.LEVEL_SEVERE,"Matrix","unProject","missingResult"));var h=o[0],u=o[1],m=o[2];if(h=(h-c.x)/c.width,u=(u-c.y)/c.height,h=h*2-1,u=u*2-1,m=m*2-1,m<-1||m>1)return!1;var g=this[0]*h+this[1]*u+this[2]*m+this[3],_=this[4]*h+this[5]*u+this[6]*m+this[7],y=this[8]*h+this[9]*u+this[10]*m+this[11],v=this[12]*h+this[13]*u+this[14]*m+this[15];return v===0?!1:(d[0]=g/v,d[1]=_/v,d[2]=y/v,!0)},f}),B("pick/PickedObject",[],function(){"use strict";var p=function(l,n,e,i,t){this.color=l,this.userObject=n,this.position=e,this.parentLayer=i,this.isTerrain=t,this.isOnTop=!1};return p}),B("error/UnsupportedOperationError",["../error/AbstractError"],function(p){"use strict";var l=function(n){p.call(this,"UnsupportedOperationError",n);var e;try{throw new Error}catch(i){e=i.stack}this.stack=e};return l.prototype=Object.create(p.prototype),l}),B("render/Renderable",["../util/Logger","../error/UnsupportedOperationError"],function(p,l){"use strict";var n=function(){this.displayName="Renderable",this.enabled=!0,this.pickDelegate=null,this.userProperties={}};return n.prototype.render=function(e){throw new l(p.logMessage(p.LEVEL_SEVERE,"Renderable","render","abstractInvocation"))},n}),B("shapes/Annotation",["../shapes/AnnotationAttributes","../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Insets","../util/Logger","../geom/Matrix","../util/Offset","../pick/PickedObject","../render/Renderable","../shapes/TextAttributes","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u){"use strict";var m=function(g,_){if(!g)throw new l(r.logMessage(r.LEVEL_SEVERE,"Annotation","constructor","missingPosition"));o.call(this),this.position=g,this.attributes=_||new p(null),this.altitudeMode=WorldWind.ABSOLUTE,this.layer=null,this.lastStateKey=null,this.calloutTransform=s.fromIdentity(),this.calloutOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0),this.label="",this.labelTexture=null,this.labelTransform=s.fromIdentity(),this.placePoint=new h(0,0,0),this.depthOffset=-2.05,this.calloutPoints=null};return m.matrix=s.fromIdentity(),m.screenPoint=new h(0,0,0),m.scratchPoint=new h(0,0,0),m.prototype=Object.create(o.prototype),Object.defineProperties(m.prototype,{text:{get:function(){return this.label},set:function(g){this.label=g,this.lastStateKey=null}}}),m.prototype.renderOrdered=function(g){if(this.drawOrderedAnnotation(g),g.pickingMode){var _=new f(this.pickColor.clone(),this,this.position,this.layer,!1);g.pickPoint&&this.labelBounds.containsPoint(g.convertPointToViewport(g.pickPoint,m.scratchPoint))&&(_.labelPicked=!0),g.resolvePick(_)}},m.prototype.clone=function(){var g=new m(this.position);return g.copy(this),g.pickDelegate=this.pickDelegate?this.pickDelegate:this,g},m.prototype.copy=function(g){return this.position=g.position,this.enabled=g.enabled,this.attributes=g.attributes,this.label=g.label,this.altitudeMode=g.altitudeMode,this.pickDelegate=g.pickDelegate,this.depthOffset=g.depthOffset,this},m.prototype.render=function(g){if(this.enabled&&g.accumulateOrderedRenderables&&!(g.globe.projectionLimits&&!g.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude))){var _;if(this.lastFrameTime!==g.timestamp)_=this.makeOrderedRenderable(g);else{var y=this.clone();_=y.makeOrderedRenderable(g)}_&&(_.layer=g.currentLayer,this.lastFrameTime=g.timestamp,g.addOrderedRenderable(_))}},m.prototype.drawOrderedAnnotation=function(g){this.beginDrawing(g);try{this.doDrawOrderedAnnotation(g)}finally{this.endDrawing(g)}},m.prototype.makeOrderedRenderable=function(g){var _,y,v,b,R,M,P,T,E;if(this.label=g.textRenderer.wrap(this.label,this.attributes.width,this.attributes.height),g.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint),this.eyeDistance=g.eyePoint.distanceTo(this.placePoint),!g.projectWithDepth(this.placePoint,this.depthOffset,m.screenPoint))return null;this.labelTexture=g.createTextTexture(this.label,this.attributes.textAttributes),_=this.labelTexture.imageWidth,y=this.labelTexture.imageHeight,v=this.attributes.scale,b=this.attributes.insets.left,R=this.attributes.insets.right,M=this.attributes.insets.top,P=this.attributes.insets.bottom,E=this.attributes.leaderGapHeight,T=this.calloutOffset.offsetForSize((_+b+R)*v,(y+M+P)*v),this.calloutTransform.setTranslation(m.screenPoint[0]-T[0],m.screenPoint[1]+E,m.screenPoint[2]),this.labelTransform.setTranslation(m.screenPoint[0]-T[0]+b*v,m.screenPoint[1]+E+P*v,m.screenPoint[2]),this.labelTransform.setScale(_*v,y*v,1),this.labelBounds=u.boundingRectForUnitQuad(this.labelTransform);var x=(_+b+R)*v,S=(y+M+P)*v,L=x/2,C=-E;return this.attributes.drawLeader||(C=0),this.attributes.stateKey!==this.lastStateKey&&(this.calloutPoints=this.createCallout(x,S,L,C,this.attributes.leaderGapWidth,this.attributes.cornerRadius)),this},m.prototype.beginDrawing=function(g){var _=g.currentGlContext,y;g.findAndBindProgram(n),y=g.currentProgram,_.enableVertexAttribArray(y.vertexPointLocation),_.enableVertexAttribArray(y.vertexTexCoordLocation),y.loadModulateColor(_,g.pickingMode)},m.prototype.endDrawing=function(g){var _=g.currentGlContext,y=g.currentProgram;_.disableVertexAttribArray(y.vertexPointLocation),_.disableVertexAttribArray(y.vertexTexCoordLocation),g.bindProgram(null)},m.prototype.drawCorner=function(g,_,y,v,b,R,M,P){if(y<1)return P;for(var T=(b-v)/(R-1),E=1;E<R-1;E++){var x=v+T*E,S=g+Math.cos(x)*y,L=_+Math.sin(x)*y;M[P++]=S,M[P++]=L}return P},m.prototype.createCallout=function(g,_,y,v,b,R){var M=16,P=2*(12+(R<1?0:4*(M-2))),T=new Float32Array(P),E=0;return T[E++]=g/2+b/2,T[E++]=0,T[E++]=g-R,T[E++]=0,E=this.drawCorner(g-R,R,R,-Math.PI/2,0,M,T,E),T[E++]=g,T[E++]=R,T[E++]=g,T[E++]=_-R,E=this.drawCorner(g-R,_-R,R,0,Math.PI/2,M,T,E),T[E++]=g-R,T[E++]=_,T[E++]=R,T[E++]=_,E=this.drawCorner(R,_-R,R,Math.PI/2,Math.PI,M,T,E),T[E++]=0,T[E++]=_-R,T[E++]=0,T[E++]=R,E=this.drawCorner(R,R,R,Math.PI,Math.PI*1.5,M,T,E),T[E++]=R,T[E++]=0,T[E++]=g/2-b/2,T[E++]=0,T[E++]=y,T[E++]=v,T[E++]=g/2+b/2,T[E]=0,T},m.prototype.doDrawOrderedAnnotation=function(g){var _=g.currentGlContext,y=g.currentProgram,v,b=!1;g.pickingMode&&(this.pickColor=g.uniquePickColor()),y.loadOpacity(_,g.pickingMode?1:this.attributes.opacity*this.layer.opacity);var R=this.attributes.stateKey!==this.lastStateKey;(!this.calloutCacheKey||R)&&(this.calloutCacheKey=g.gpuResourceCache.generateCacheKey());var M=g.gpuResourceCache.resourceForKey(this.calloutCacheKey);M||(M=_.createBuffer(),g.gpuResourceCache.putResource(this.calloutCacheKey,M,this.calloutPoints.length*4),b=!0),R&&this.calloutCacheKey&&g.gpuResourceCache.removeResource(this.calloutCacheKey),this.lastStateKey=this.attributes.stateKey,m.matrix.copy(g.screenProjection),m.matrix.multiplyMatrix(this.calloutTransform),y.loadModelviewProjection(_,m.matrix),_.bindBuffer(_.ARRAY_BUFFER,M),b&&(_.bufferData(_.ARRAY_BUFFER,this.calloutPoints,_.STATIC_DRAW),g.frameStatistics.incrementVboLoadCount(1)),y.loadColor(_,g.pickingMode?this.pickColor:this.attributes.backgroundColor),y.loadTextureEnabled(_,!1),_.vertexAttribPointer(y.vertexPointLocation,2,_.FLOAT,!1,0,0),_.vertexAttribPointer(y.vertexTexCoordLocation,2,_.FLOAT,!1,0,0),_.drawArrays(_.TRIANGLE_FAN,0,this.calloutPoints.length/2),m.matrix.copy(g.screenProjection),m.matrix.multiplyMatrix(this.labelTransform),y.loadModelviewProjection(_,m.matrix),m.matrix.setToIdentity(),m.matrix.multiplyByTextureTransform(this.labelTexture),y.loadTextureMatrix(_,m.matrix),y.loadColor(_,g.pickingMode?this.pickColor:e.WHITE),v=this.labelTexture.bind(g),y.loadTextureEnabled(_,v),_.bindBuffer(_.ARRAY_BUFFER,g.unitQuadBuffer3()),_.vertexAttribPointer(y.vertexPointLocation,3,_.FLOAT,!1,0,0),_.bindBuffer(_.ARRAY_BUFFER,g.unitQuadBuffer()),_.vertexAttribPointer(y.vertexTexCoordLocation,2,_.FLOAT,!1,0,0),_.drawArrays(_.TRIANGLE_STRIP,0,4)},m}),B("util/measure/MeasurerUtils",["../../geom/Location","../../geom/Position"],function(p,l){"use strict";var n={subdividePositions:function(e,i,t,r,s){var a=[],f=new p(0,0),o=new p(0,0),c=i[0],d;this.addPosition(e,a,c,t);for(var h=1;h<i.length;h++){var u=i[h],m=p.greatCircleDistance(c,u);f=p.interpolateAlongPath(r,.5,c,u,f);var g=m*e.radiusAt(f.latitude,f.longitude);if(g>s)for(var _=null,y=null,v=Math.ceil(g/s),b=1;b<v;b++){var R=b/v;r===WorldWind.LINEAR?o=p.interpolateLinear(R,c,u,o):r===WorldWind.RHUMB_LINE?(_==null&&(_=p.rhumbAzimuth(c,u),y=p.rhumbDistance(c,u)),o=p.rhumbLocation(c,_,R*y,o)):(_==null&&(_=p.greatCircleAzimuth(c,u),y=p.greatCircleDistance(c,u)),o=p.greatCircleLocation(c,_,R*y,o)),t?d=e.elevationAtLocation(o.latitude,o.longitude):d=c.altitude*(1-R)+u.altitude*R,a.push(new l(o.latitude,o.longitude,d))}this.addPosition(e,a,u,t),c=u}return a},addPosition:function(e,i,t,r){var s=t.altitude;return r&&(s=e.elevationAtLocation(t.latitude,t.longitude)),i.push(new l(t.latitude,t.longitude,s)),i},isLocationInside:function(e,i){for(var t=!1,r=i[0],s=1,a=i.length;s<a;s++){var f=i[s];(f.latitude<=e.latitude&&e.latitude<r.latitude||r.latitude<=e.latitude&&e.latitude<f.latitude)&&e.longitude<(r.longitude-f.longitude)*(e.latitude-f.latitude)/(r.latitude-f.latitude)+f.longitude&&(t=!t),r=f}return t},angleBetweenVectors:function(e,i){var t=e.dot(i),r=e.magnitude()*i.magnitude();return r!==0&&r!==1&&(t/=r),t<-1?t=-1:t>1&&(t=1),Math.acos(t)}};return n}),B("geom/Sector",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t){"use strict";var r=function(s,a,f,o){this.minLatitude=s,this.maxLatitude=a,this.minLongitude=f,this.maxLongitude=o};return r.ZERO=new r(0,0,0,0),r.FULL_SPHERE=new r(-90,90,-180,180),r.prototype.copy=function(s){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"Sector","copy","missingSector"));return this.minLatitude=s.minLatitude,this.maxLatitude=s.maxLatitude,this.minLongitude=s.minLongitude,this.maxLongitude=s.maxLongitude,this},r.prototype.isEmpty=function(){return this.minLatitude===this.maxLatitude&&this.minLongitude===this.maxLongitude},r.prototype.deltaLatitude=function(){return this.maxLatitude-this.minLatitude},r.prototype.deltaLongitude=function(){return this.maxLongitude-this.minLongitude},r.prototype.centroidLatitude=function(){return .5*(this.minLatitude+this.maxLatitude)},r.prototype.centroidLongitude=function(){return .5*(this.minLongitude+this.maxLongitude)},r.prototype.centroid=function(s){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"Sector","centroid","missingResult"));return s.latitude=this.centroidLatitude(),s.longitude=this.centroidLongitude(),s},r.prototype.minLatitudeRadians=function(){return this.minLatitude*p.DEGREES_TO_RADIANS},r.prototype.maxLatitudeRadians=function(){return this.maxLatitude*p.DEGREES_TO_RADIANS},r.prototype.minLongitudeRadians=function(){return this.minLongitude*p.DEGREES_TO_RADIANS},r.prototype.maxLongitudeRadians=function(){return this.maxLongitude*p.DEGREES_TO_RADIANS},r.prototype.setToBoundingSector=function(s){if(!s||s.length<2)throw new l(e.logMessage(e.LEVEL_SEVERE,"Sector","setToBoundingSector","missingArray"));for(var a=90,f=-90,o=180,c=-180,d=0,h=s.length;d<h;d+=1){var u=s[d];u&&(a=Math.min(a,u.latitude),f=Math.max(f,u.latitude),o=Math.min(o,u.longitude),c=Math.max(c,u.longitude))}return this.minLatitude=a,this.maxLatitude=f,this.minLongitude=o,this.maxLongitude=c,this},r.splitBoundingSectors=function(s){if(!s||s.length<2)throw new l(e.logMessage(e.LEVEL_SEVERE,"Sector","splitBoundingSectors","missingArray"));for(var a=90,f=180,o=-90,c=-180,d=null,h=0,u=s.length;h<u;h+=1){var m=s[h],g=m.latitude;g<a&&(a=g),g>o&&(o=g);var _=m.longitude;if(_>=0&&_<f&&(f=_),_<=0&&_>c&&(c=_),d!=null){var y=d.longitude;t.signum(_)!=t.signum(y)&&Math.abs(_-y)<180&&(c=0,f=0)}d=m}return a===o&&f===c?null:[new r(a,o,f,180),new r(a,o,-180,c)]},r.prototype.intersects=function(s){return s&&this.minLongitude<=s.maxLongitude&&this.maxLongitude>=s.minLongitude&&this.minLatitude<=s.maxLatitude&&this.maxLatitude>=s.minLatitude},r.prototype.overlaps=function(s){return s&&this.minLongitude<s.maxLongitude&&this.maxLongitude>s.minLongitude&&this.minLatitude<s.maxLatitude&&this.maxLatitude>s.minLatitude},r.prototype.contains=function(s){return s&&this.minLatitude<=s.minLatitude&&this.maxLatitude>=s.maxLatitude&&this.minLongitude<=s.minLongitude&&this.maxLongitude>=s.maxLongitude},r.prototype.containsLocation=function(s,a){return this.minLatitude<=s&&this.maxLatitude>=s&&this.minLongitude<=a&&this.maxLongitude>=a},r.prototype.intersection=function(s){if(!s instanceof r)throw new l(e.logMessage(e.LEVEL_SEVERE,"Sector","intersection","missingSector"));return this.minLatitude<s.minLatitude&&(this.minLatitude=s.minLatitude),this.maxLatitude>s.maxLatitude&&(this.maxLatitude=s.maxLatitude),this.minLongitude<s.minLongitude&&(this.minLongitude=s.minLongitude),this.maxLongitude>s.maxLongitude&&(this.maxLongitude=s.maxLongitude),this.maxLatitude<this.minLatitude&&(this.maxLatitude=this.minLatitude),this.maxLongitude<this.minLongitude&&(this.maxLongitude=this.minLongitude),this},r.prototype.getCorners=function(){var s=[];return s.push(new n(this.minLatitude,this.minLongitude)),s.push(new n(this.minLatitude,this.maxLongitude)),s.push(new n(this.maxLatitude,this.maxLongitude)),s.push(new n(this.maxLatitude,this.minLongitude)),s},r.prototype.computeBoundingPoints=function(s,a){if(s===null)throw new l(e.logMessage(e.LEVEL_SEVERE,"Sector","computeBoundingBox","missingGlobe"));var f=s.minAndMaxElevationsForSector(this),o=f[0]*a,c=f[1]*a;o===c&&(c=o+10);for(var d=[],h=this.getCorners(),u=0;u<h.length;u++)d.push(s.computePointFromPosition(h[u].latitude,h[u].longitude,o,new i(0,0,0))),d.push(s.computePointFromPosition(h[u].latitude,h[u].longitude,c,new i(0,0,0)));var m=this.centroid(new n(0,0));if(d.push(s.computePointFromPosition(m.latitude,m.longitude,c,new i(0,0,0))),this.minLatitude<0&&this.maxLatitude>0?(d.push(s.computePointFromPosition(this.minLatitude,m.longitude,c,new i(0,0,0))),d.push(s.computePointFromPosition(this.maxLatitude,m.longitude,c,new i(0,0,0))),d.push(s.computePointFromPosition(0,this.minLongitude,c,new i(0,0,0))),d.push(s.computePointFromPosition(0,this.maxLongitude,c,new i(0,0,0)))):this.minLatitude<0?d.push(s.computePointFromPosition(this.maxLatitude,m.longitude,c,new i(0,0,0))):d.push(s.computePointFromPosition(this.minLatitude,m.longitude,c,new i(0,0,0))),this.deltaLongitude()>=360){var g=this.minLatitude;d.push(s.computePointFromPosition(g,0,c,new i(0,0,0))),d.push(s.computePointFromPosition(g,90,c,new i(0,0,0))),d.push(s.computePointFromPosition(g,-90,c,new i(0,0,0))),d.push(s.computePointFromPosition(g,180,c,new i(0,0,0)));var _=this.maxLatitude;d.push(s.computePointFromPosition(_,0,c,new i(0,0,0))),d.push(s.computePointFromPosition(_,90,c,new i(0,0,0))),d.push(s.computePointFromPosition(_,-90,c,new i(0,0,0))),d.push(s.computePointFromPosition(_,180,c,new i(0,0,0)))}else if(this.deltaLongitude()>180){var y=m.longitude,v=m.latitude,b=(this.minLongitude+y)/2;d.push(s.computePointFromPosition(v,b,c,new i(0,0,0))),b=(y+this.maxLongitude)/2,d.push(s.computePointFromPosition(v,b,c,new i(0,0,0))),d.push(s.computePointFromPosition(v,this.minLongitude,c,new i(0,0,0))),d.push(s.computePointFromPosition(v,this.maxLongitude,c,new i(0,0,0)))}return d},r.prototype.union=function(s){if(!s instanceof r)throw new l(e.logMessage(e.LEVEL_SEVERE,"Sector","union","missingSector"));return this.minLatitude>s.minLatitude&&(this.minLatitude=s.minLatitude),this.maxLatitude<s.maxLatitude&&(this.maxLatitude=s.maxLatitude),this.minLongitude>s.minLongitude&&(this.minLongitude=s.minLongitude),this.maxLongitude<s.maxLongitude&&(this.maxLongitude=s.maxLongitude),this},r});var D={};D.DEBUG=!1,D.assert=function(p,l){if(D.DEBUG&&!p)throw new Error("Assertion failed"+(l?": "+l:""))},D.GLU_TESS_MAX_COORD=1e150,D.TRUE_PROJECT=!1,D.TESS_MAX_CACHE=100,D.GLU_TESS_DEFAULT_TOLERANCE=0,D.windingRule={GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},D.primitiveType={GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},D.errorType={GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},D.gluEnum={GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901},D.PQHandle,D.PQKey,D.geom={},D.geom.vertEq=function(p,l){return p.s===l.s&&p.t===l.t},D.geom.vertLeq=function(p,l){return p.s<l.s||p.s===l.s&&p.t<=l.t},D.geom.edgeEval=function(p,l,n){var e=l.s-p.s,i=n.s-l.s;return e+i>0?e<i?l.t-p.t+(p.t-n.t)*(e/(e+i)):l.t-n.t+(n.t-p.t)*(i/(e+i)):0},D.geom.edgeSign=function(p,l,n){var e=l.s-p.s,i=n.s-l.s;return e+i>0?(l.t-n.t)*e+(l.t-p.t)*i:0},D.geom.transLeq=function(p,l){return p.t<l.t||p.t===l.t&&p.s<=l.s},D.geom.transEval=function(p,l,n){var e=l.t-p.t,i=n.t-l.t;return e+i>0?e<i?l.s-p.s+(p.s-n.s)*(e/(e+i)):l.s-n.s+(n.s-p.s)*(i/(e+i)):0},D.geom.transSign=function(p,l,n){var e=l.t-p.t,i=n.t-l.t;return e+i>0?(l.s-n.s)*e+(l.s-p.s)*i:0},D.geom.edgeGoesLeft=function(p){return D.geom.vertLeq(p.dst(),p.org)},D.geom.edgeGoesRight=function(p){return D.geom.vertLeq(p.org,p.dst())},D.geom.vertL1dist=function(p,l){return Math.abs(p.s-l.s)+Math.abs(p.t-l.t)},D.geom.vertCCW=function(p,l,n){return p.s*(l.t-n.t)+l.s*(n.t-p.t)+n.s*(p.t-l.t)>=0},D.geom.interpolate_=function(p,l,n,e){return p=p<0?0:p,n=n<0?0:n,p<=n?n===0?(l+e)/2:l+(e-l)*(p/(p+n)):e+(l-e)*(n/(p+n))},D.geom.edgeIntersect=function(p,l,n,e,i){var t,r,s;D.geom.vertLeq(p,l)||(s=p,p=l,l=s),D.geom.vertLeq(n,e)||(s=n,n=e,e=s),D.geom.vertLeq(p,n)||(s=p,p=n,n=s,s=l,l=e,e=s),D.geom.vertLeq(n,l)?D.geom.vertLeq(l,e)?(t=D.geom.edgeEval(p,n,l),r=D.geom.edgeEval(n,l,e),t+r<0&&(t=-t,r=-r),i.s=D.geom.interpolate_(t,n.s,r,l.s)):(t=D.geom.edgeSign(p,n,l),r=-D.geom.edgeSign(p,e,l),t+r<0&&(t=-t,r=-r),i.s=D.geom.interpolate_(t,n.s,r,e.s)):i.s=(n.s+l.s)/2,D.geom.transLeq(p,l)||(s=p,p=l,l=s),D.geom.transLeq(n,e)||(s=n,n=e,e=s),D.geom.transLeq(p,n)||(s=p,p=n,n=s,s=l,l=e,e=s),D.geom.transLeq(n,l)?D.geom.transLeq(l,e)?(t=D.geom.transEval(p,n,l),r=D.geom.transEval(n,l,e),t+r<0&&(t=-t,r=-r),i.t=D.geom.interpolate_(t,n.t,r,l.t)):(t=D.geom.transSign(p,n,l),r=-D.geom.transSign(p,e,l),t+r<0&&(t=-t,r=-r),i.t=D.geom.interpolate_(t,n.t,r,e.t)):i.t=(n.t+l.t)/2},D.mesh={},D.mesh.makeEdge=function(p){var l=D.mesh.makeEdgePair_(p.eHead);return D.mesh.makeVertex_(l,p.vHead),D.mesh.makeVertex_(l.sym,p.vHead),D.mesh.makeFace_(l,p.fHead),l},D.mesh.meshSplice=function(p,l){var n=!1,e=!1;p!==l&&(l.org!==p.org&&(e=!0,D.mesh.killVertex_(l.org,p.org)),l.lFace!==p.lFace&&(n=!0,D.mesh.killFace_(l.lFace,p.lFace)),D.mesh.splice_(l,p),e||(D.mesh.makeVertex_(l,p.org),p.org.anEdge=p),n||(D.mesh.makeFace_(l,p.lFace),p.lFace.anEdge=p))},D.mesh.deleteEdge=function(p){var l=p.sym,n=!1;p.lFace!==p.rFace()&&(n=!0,D.mesh.killFace_(p.lFace,p.rFace())),p.oNext===p?D.mesh.killVertex_(p.org,null):(p.rFace().anEdge=p.oPrev(),p.org.anEdge=p.oNext,D.mesh.splice_(p,p.oPrev()),n||D.mesh.makeFace_(p,p.lFace)),l.oNext===l?(D.mesh.killVertex_(l.org,null),D.mesh.killFace_(l.lFace,null)):(p.lFace.anEdge=l.oPrev(),l.org.anEdge=l.oNext,D.mesh.splice_(l,l.oPrev())),D.mesh.killEdge_(p)},D.mesh.addEdgeVertex=function(p){var l=D.mesh.makeEdgePair_(p),n=l.sym;return D.mesh.splice_(l,p.lNext),l.org=p.dst(),D.mesh.makeVertex_(n,l.org),l.lFace=n.lFace=p.lFace,l},D.mesh.splitEdge=function(p){var l=D.mesh.addEdgeVertex(p),n=l.sym;return D.mesh.splice_(p.sym,p.sym.oPrev()),D.mesh.splice_(p.sym,n),p.sym.org=n.org,n.dst().anEdge=n.sym,n.sym.lFace=p.rFace(),n.winding=p.winding,n.sym.winding=p.sym.winding,n},D.mesh.connect=function(p,l){var n=!1,e=D.mesh.makeEdgePair_(p),i=e.sym;return l.lFace!==p.lFace&&(n=!0,D.mesh.killFace_(l.lFace,p.lFace)),D.mesh.splice_(e,p.lNext),D.mesh.splice_(i,l),e.org=p.dst(),i.org=l.org,e.lFace=i.lFace=p.lFace,p.lFace.anEdge=i,n||D.mesh.makeFace_(e,p.lFace),e},D.mesh.zapFace=function(p){var l=p.anEdge,n=l.lNext,e;do if(e=n,n=e.lNext,e.lFace=null,e.rFace()===null){e.oNext===e?D.mesh.killVertex_(e.org,null):(e.org.anEdge=e.oNext,D.mesh.splice_(e,e.oPrev()));var i=e.sym;i.oNext===i?D.mesh.killVertex_(i.org,null):(i.org.anEdge=i.oNext,D.mesh.splice_(i,i.oPrev())),D.mesh.killEdge_(e)}while(e!==l);var t=p.prev,r=p.next;r.prev=t,t.next=r},D.mesh.meshUnion=function(p,l){var n=p.fHead,e=p.vHead,i=p.eHead,t=l.fHead,r=l.vHead,s=l.eHead;return t.next!==t&&(n.prev.next=t.next,t.next.prev=n.prev,t.prev.next=n,n.prev=t.prev),r.next!==r&&(e.prev.next=r.next,r.next.prev=e.prev,r.prev.next=e,e.prev=r.prev),s.next!==s&&(i.sym.next.sym.next=s.next,s.next.sym.next=i.sym.next,s.sym.next.sym.next=i,i.sym.next=s.sym.next),p},D.mesh.deleteMesh=function(p){},D.mesh.makeEdgePair_=function(p){var l=new D.GluHalfEdge,n=new D.GluHalfEdge,e=p.sym.next;return n.next=e,e.sym.next=l,l.next=p,p.sym.next=n,l.sym=n,l.oNext=l,l.lNext=n,n.sym=l,n.oNext=n,n.lNext=l,l},D.mesh.splice_=function(p,l){var n=p.oNext,e=l.oNext;n.sym.lNext=l,e.sym.lNext=p,p.oNext=e,l.oNext=n},D.mesh.makeVertex_=function(p,l){var n=l.prev,e=new D.GluVertex(l,n);n.next=e,l.prev=e,e.anEdge=p;var i=p;do i.org=e,i=i.oNext;while(i!==p)},D.mesh.makeFace_=function(p,l){var n=l.prev,e=new D.GluFace(l,n);n.next=e,l.prev=e,e.anEdge=p,e.inside=l.inside;var i=p;do i.lFace=e,i=i.lNext;while(i!==p)},D.mesh.killEdge_=function(p){var l=p.next,n=p.sym.next;l.sym.next=n,n.sym.next=l},D.mesh.killVertex_=function(p,l){var n=p.anEdge,e=n;do e.org=l,e=e.oNext;while(e!==n);var i=p.prev,t=p.next;t.prev=i,i.next=t},D.mesh.killFace_=function(p,l){var n=p.anEdge,e=n;do e.lFace=l,e=e.lNext;while(e!==n);var i=p.prev,t=p.next;t.prev=i,i.next=t},D.normal={},D.normal.S_UNIT_X_=1,D.normal.S_UNIT_Y_=0,D.normal.projectPolygon=function(p){var l=!1,n=[p.normal[0],p.normal[1],p.normal[2]];n[0]===0&&n[1]===0&&n[2]===0&&(D.normal.computeNormal_(p,n),l=!0);var e=p.sUnit,i=p.tUnit,t=D.normal.longAxis_(n);if(D.TRUE_PROJECT){D.normal.normalize_(n),e[t]=0,e[(t+1)%3]=D.normal.S_UNIT_X_,e[(t+2)%3]=D.normal.S_UNIT_Y_;var r=D.normal.dot_(e,n);e[0]-=r*n[0],e[1]-=r*n[1],e[2]-=r*n[2],D.normal.normalize_(e),i[0]=n[1]*e[2]-n[2]*e[1],i[1]=n[2]*e[0]-n[0]*e[2],i[2]=n[0]*e[1]-n[1]*e[0],D.normal.normalize_(i)}else e[t]=0,e[(t+1)%3]=D.normal.S_UNIT_X_,e[(t+2)%3]=D.normal.S_UNIT_Y_,i[t]=0,i[(t+1)%3]=n[t]>0?-D.normal.S_UNIT_Y_:D.normal.S_UNIT_Y_,i[(t+2)%3]=n[t]>0?D.normal.S_UNIT_X_:-D.normal.S_UNIT_X_;for(var s=p.mesh.vHead,a=s.next;a!==s;a=a.next)a.s=D.normal.dot_(a.coords,e),a.t=D.normal.dot_(a.coords,i);l&&D.normal.checkOrientation_(p)},D.normal.dot_=function(p,l){return p[0]*l[0]+p[1]*l[1]+p[2]*l[2]},D.normal.normalize_=function(p){var l=p[0]*p[0]+p[1]*p[1]+p[2]*p[2];l=Math.sqrt(l),p[0]/=l,p[1]/=l,p[2]/=l},D.normal.longAxis_=function(p){var l=0;return Math.abs(p[1])>Math.abs(p[0])&&(l=1),Math.abs(p[2])>Math.abs(p[l])&&(l=2),l},D.normal.computeNormal_=function(p,l){var n=[-2*D.GLU_TESS_MAX_COORD,-2*D.GLU_TESS_MAX_COORD,-2*D.GLU_TESS_MAX_COORD],e=[2*D.GLU_TESS_MAX_COORD,2*D.GLU_TESS_MAX_COORD,2*D.GLU_TESS_MAX_COORD],i=[],t=[],r,s=p.mesh.vHead;for(r=s.next;r!==s;r=r.next)for(var a=0;a<3;++a){var f=r.coords[a];f<e[a]&&(e[a]=f,t[a]=r),f>n[a]&&(n[a]=f,i[a]=r)}var o=0;if(n[1]-e[1]>n[0]-e[0]&&(o=1),n[2]-e[2]>n[o]-e[o]&&(o=2),e[o]>=n[o]){l[0]=0,l[1]=0,l[2]=1;return}var c=0,d=t[o],h=i[o],u=[0,0,0],m=[d.coords[0]-h.coords[0],d.coords[1]-h.coords[1],d.coords[2]-h.coords[2]],g=[0,0,0];for(r=s.next;r!==s;r=r.next){g[0]=r.coords[0]-h.coords[0],g[1]=r.coords[1]-h.coords[1],g[2]=r.coords[2]-h.coords[2],u[0]=m[1]*g[2]-m[2]*g[1],u[1]=m[2]*g[0]-m[0]*g[2],u[2]=m[0]*g[1]-m[1]*g[0];var _=u[0]*u[0]+u[1]*u[1]+u[2]*u[2];_>c&&(c=_,l[0]=u[0],l[1]=u[1],l[2]=u[2])}c<=0&&(l[0]=l[1]=l[2]=0,l[D.normal.longAxis_(m)]=1)},D.normal.checkOrientation_=function(p){for(var l=0,n=p.mesh.fHead,e=n.next;e!==n;e=e.next){var i=e.anEdge;if(!(i.winding<=0))do l+=(i.org.s-i.dst().s)*(i.org.t+i.dst().t),i=i.lNext;while(i!==e.anEdge)}if(l<0){for(var t=p.mesh.vHead,r=t.next;r!==t;r=r.next)r.t=-r.t;p.tUnit[0]=-p.tUnit[0],p.tUnit[1]=-p.tUnit[1],p.tUnit[2]=-p.tUnit[2]}},D.render={},D.render.renderMesh=function(p,l,n){for(var e=!1,i=-1,t=l.fHead.prev;t!==l.fHead;t=t.prev)if(t.inside){e||(p.callBeginOrBeginData(D.primitiveType.GL_TRIANGLES),e=!0);var r=t.anEdge;do{if(n){var s=r.rFace().inside?0:1;i!==s&&(i=s,p.callEdgeFlagOrEdgeFlagData(!!i))}p.callVertexOrVertexData(r.org.data),r=r.lNext}while(r!==t.anEdge)}e&&p.callEndOrEndData()},D.render.renderBoundary=function(p,l){for(var n=l.fHead.next;n!==l.fHead;n=n.next)if(n.inside){p.callBeginOrBeginData(D.primitiveType.GL_LINE_LOOP);var e=n.anEdge;do p.callVertexOrVertexData(e.org.data),e=e.lNext;while(e!==n.anEdge);p.callEndOrEndData()}},D.sweep={},D.sweep.SENTINEL_COORD_=4*D.GLU_TESS_MAX_COORD,D.sweep.TOLERANCE_NONZERO_=!1,D.sweep.computeInterior=function(p){p.fatalError=!1,D.sweep.removeDegenerateEdges_(p),D.sweep.initPriorityQ_(p),D.sweep.initEdgeDict_(p);for(var l;(l=p.pq.extractMin())!==null;){for(;;){var n=p.pq.minimum();if(n===null||!D.geom.vertEq(n,l))break;n=p.pq.extractMin(),D.sweep.spliceMergeVertices_(p,l.anEdge,n.anEdge)}D.sweep.sweepEvent_(p,l)}var e=p.dict.getMin().getKey();p.event=e.eUp.org,D.sweep.doneEdgeDict_(p),D.sweep.donePriorityQ_(p),D.sweep.removeDegenerateFaces_(p.mesh),p.mesh.checkMesh()},D.sweep.addWinding_=function(p,l){p.winding+=l.winding,p.sym.winding+=l.sym.winding},D.sweep.edgeLeq_=function(p,l,n){var e=p.event,i=l.eUp,t=n.eUp;if(i.dst()===e)return t.dst()===e?D.geom.vertLeq(i.org,t.org)?D.geom.edgeSign(t.dst(),i.org,t.org)<=0:D.geom.edgeSign(i.dst(),t.org,i.org)>=0:D.geom.edgeSign(t.dst(),e,t.org)<=0;if(t.dst()===e)return D.geom.edgeSign(i.dst(),e,i.org)>=0;var r=D.geom.edgeEval(i.dst(),e,i.org),s=D.geom.edgeEval(t.dst(),e,t.org);return r>=s},D.sweep.deleteRegion_=function(p,l){l.fixUpperEdge,l.eUp.activeRegion=null,p.dict.deleteNode(l.nodeUp),l.nodeUp=null},D.sweep.fixUpperEdge_=function(p,l){D.mesh.deleteEdge(p.eUp),p.fixUpperEdge=!1,p.eUp=l,l.activeRegion=p},D.sweep.topLeftRegion_=function(p){var l=p.eUp.org;do p=p.regionAbove();while(p.eUp.org===l);if(p.fixUpperEdge){var n=D.mesh.connect(p.regionBelow().eUp.sym,p.eUp.lNext);D.sweep.fixUpperEdge_(p,n),p=p.regionAbove()}return p},D.sweep.topRightRegion_=function(p){var l=p.eUp.dst();do p=p.regionAbove();while(p.eUp.dst()===l);return p},D.sweep.addRegionBelow_=function(p,l,n){var e=new D.ActiveRegion;return e.eUp=n,e.nodeUp=p.dict.insertBefore(l.nodeUp,e),n.activeRegion=e,e},D.sweep.isWindingInside_=function(p,l){switch(p.windingRule){case D.windingRule.GLU_TESS_WINDING_ODD:return(l&1)!==0;case D.windingRule.GLU_TESS_WINDING_NONZERO:return l!==0;case D.windingRule.GLU_TESS_WINDING_POSITIVE:return l>0;case D.windingRule.GLU_TESS_WINDING_NEGATIVE:return l<0;case D.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return l>=2||l<=-2}return!1},D.sweep.computeWinding_=function(p,l){l.windingNumber=l.regionAbove().windingNumber+l.eUp.winding,l.inside=D.sweep.isWindingInside_(p,l.windingNumber)},D.sweep.finishRegion_=function(p,l){var n=l.eUp,e=n.lFace;e.inside=l.inside,e.anEdge=n,D.sweep.deleteRegion_(p,l)},D.sweep.finishLeftRegions_=function(p,l,n){for(var e=l,i=l.eUp;e!==n;){e.fixUpperEdge=!1;var t=e.regionBelow(),r=t.eUp;if(r.org!==i.org){if(!t.fixUpperEdge){D.sweep.finishRegion_(p,e);break}r=D.mesh.connect(i.lPrev(),r.sym),D.sweep.fixUpperEdge_(t,r)}i.oNext!==r&&(D.mesh.meshSplice(r.oPrev(),r),D.mesh.meshSplice(i,r)),D.sweep.finishRegion_(p,e),i=t.eUp,e=t}return i},D.sweep.addRightEdges_=function(p,l,n,e,i,t){var r=!0,s=n;do D.sweep.addRegionBelow_(p,l,s.sym),s=s.oNext;while(s!==e);i===null&&(i=l.regionBelow().eUp.rPrev());for(var a=l,f=i,o;o=a.regionBelow(),s=o.eUp.sym,s.org===f.org;)s.oNext!==f&&(D.mesh.meshSplice(s.oPrev(),s),D.mesh.meshSplice(f.oPrev(),s)),o.windingNumber=a.windingNumber-s.winding,o.inside=D.sweep.isWindingInside_(p,o.windingNumber),a.dirty=!0,!r&&D.sweep.checkForRightSplice_(p,a)&&(D.sweep.addWinding_(s,f),D.sweep.deleteRegion_(p,a),D.mesh.deleteEdge(f)),r=!1,a=o,f=s;a.dirty=!0,t&&D.sweep.walkDirtyRegions_(p,a)},D.sweep.callCombine_=function(p,l,n,e,i){var t=[l.coords[0],l.coords[1],l.coords[2]];l.data=null,l.data=p.callCombineOrCombineData(t,n,e),l.data===null&&(i?p.fatalError||(p.callErrorOrErrorData(D.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),p.fatalError=!0):l.data=n[0])},D.sweep.spliceMergeVertices_=function(p,l,n){var e=[null,null,null,null],i=[.5,.5,0,0];e[0]=l.org.data,e[1]=n.org.data,D.sweep.callCombine_(p,l.org,e,i,!1),D.mesh.meshSplice(l,n)},D.sweep.vertexWeights_=function(p,l,n,e,i){var t=D.geom.vertL1dist(l,p),r=D.geom.vertL1dist(n,p),s=i,a=i+1;e[s]=.5*r/(t+r),e[a]=.5*t/(t+r),p.coords[0]+=e[s]*l.coords[0]+e[a]*n.coords[0],p.coords[1]+=e[s]*l.coords[1]+e[a]*n.coords[1],p.coords[2]+=e[s]*l.coords[2]+e[a]*n.coords[2]},D.sweep.getIntersectData_=function(p,l,n,e,i,t){var r=[0,0,0,0],s=[n.data,e.data,i.data,t.data];l.coords[0]=l.coords[1]=l.coords[2]=0,D.sweep.vertexWeights_(l,n,e,r,0),D.sweep.vertexWeights_(l,i,t,r,2),D.sweep.callCombine_(p,l,s,r,!0)},D.sweep.checkForRightSplice_=function(p,l){var n=l.regionBelow(),e=l.eUp,i=n.eUp;if(D.geom.vertLeq(e.org,i.org)){if(D.geom.edgeSign(i.dst(),e.org,i.org)>0)return!1;D.geom.vertEq(e.org,i.org)?e.org!==i.org&&(p.pq.remove(e.org.pqHandle),D.sweep.spliceMergeVertices_(p,i.oPrev(),e)):(D.mesh.splitEdge(i.sym),D.mesh.meshSplice(e,i.oPrev()),l.dirty=n.dirty=!0)}else{if(D.geom.edgeSign(e.dst(),i.org,e.org)<0)return!1;l.regionAbove().dirty=l.dirty=!0,D.mesh.splitEdge(e.sym),D.mesh.meshSplice(i.oPrev(),e)}return!0},D.sweep.checkForLeftSplice_=function(p,l){var n=l.regionBelow(),e=l.eUp,i=n.eUp,t;if(D.geom.vertLeq(e.dst(),i.dst())){if(D.geom.edgeSign(e.dst(),i.dst(),e.org)<0)return!1;l.regionAbove().dirty=l.dirty=!0,t=D.mesh.splitEdge(e),D.mesh.meshSplice(i.sym,t),t.lFace.inside=l.inside}else{if(D.geom.edgeSign(i.dst(),e.dst(),i.org)>0)return!1;l.dirty=n.dirty=!0,t=D.mesh.splitEdge(i),D.mesh.meshSplice(e.lNext,i.sym),t.rFace().inside=l.inside}return!0},D.sweep.checkForIntersect_=function(p,l){var n=l.regionBelow(),e=l.eUp,i=n.eUp,t=e.org,r=i.org,s=e.dst(),a=i.dst(),f=new D.GluVertex;if(t===r)return!1;var o=Math.min(t.t,s.t),c=Math.max(r.t,a.t);if(o>c)return!1;if(D.geom.vertLeq(t,r)){if(D.geom.edgeSign(a,t,r)>0)return!1}else if(D.geom.edgeSign(s,r,t)<0)return!1;D.geom.edgeIntersect(s,t,a,r,f),D.geom.vertLeq(f,p.event)&&(f.s=p.event.s,f.t=p.event.t);var d=D.geom.vertLeq(t,r)?t:r;if(D.geom.vertLeq(d,f)&&(f.s=d.s,f.t=d.t),D.geom.vertEq(f,t)||D.geom.vertEq(f,r))return D.sweep.checkForRightSplice_(p,l),!1;if(!D.geom.vertEq(s,p.event)&&D.geom.edgeSign(s,p.event,f)>=0||!D.geom.vertEq(a,p.event)&&D.geom.edgeSign(a,p.event,f)<=0){if(a===p.event)return D.mesh.splitEdge(e.sym),D.mesh.meshSplice(i.sym,e),l=D.sweep.topLeftRegion_(l),e=l.regionBelow().eUp,D.sweep.finishLeftRegions_(p,l.regionBelow(),n),D.sweep.addRightEdges_(p,l,e.oPrev(),e,e,!0),!0;if(s===p.event){D.mesh.splitEdge(i.sym),D.mesh.meshSplice(e.lNext,i.oPrev()),n=l,l=D.sweep.topRightRegion_(l);var h=l.regionBelow().eUp.rPrev();return n.eUp=i.oPrev(),i=D.sweep.finishLeftRegions_(p,n,null),D.sweep.addRightEdges_(p,l,i.oNext,e.rPrev(),h,!0),!0}return D.geom.edgeSign(s,p.event,f)>=0&&(l.regionAbove().dirty=l.dirty=!0,D.mesh.splitEdge(e.sym),e.org.s=p.event.s,e.org.t=p.event.t),D.geom.edgeSign(a,p.event,f)<=0&&(l.dirty=n.dirty=!0,D.mesh.splitEdge(i.sym),i.org.s=p.event.s,i.org.t=p.event.t),!1}return D.mesh.splitEdge(e.sym),D.mesh.splitEdge(i.sym),D.mesh.meshSplice(i.oPrev(),e),e.org.s=f.s,e.org.t=f.t,e.org.pqHandle=p.pq.insert(e.org),D.sweep.getIntersectData_(p,e.org,t,s,r,a),l.regionAbove().dirty=l.dirty=n.dirty=!0,!1},D.sweep.walkDirtyRegions_=function(p,l){for(var n=l.regionBelow();;){for(;n.dirty;)l=n,n=n.regionBelow();if(!l.dirty&&(n=l,l=l.regionAbove(),l===null||!l.dirty))return;l.dirty=!1;var e=l.eUp,i=n.eUp;if(e.dst()!==i.dst()&&D.sweep.checkForLeftSplice_(p,l)&&(n.fixUpperEdge?(D.sweep.deleteRegion_(p,n),D.mesh.deleteEdge(i),n=l.regionBelow(),i=n.eUp):l.fixUpperEdge&&(D.sweep.deleteRegion_(p,l),D.mesh.deleteEdge(e),l=n.regionAbove(),e=l.eUp)),e.org!==i.org)if(e.dst()!==i.dst()&&!l.fixUpperEdge&&!n.fixUpperEdge&&(e.dst()===p.event||i.dst()===p.event)){if(D.sweep.checkForIntersect_(p,l))return}else D.sweep.checkForRightSplice_(p,l);e.org===i.org&&e.dst()===i.dst()&&(D.sweep.addWinding_(i,e),D.sweep.deleteRegion_(p,l),D.mesh.deleteEdge(e),l=n.regionAbove())}},D.sweep.connectRightVertex_=function(p,l,n){var e=n.oNext,i=l.regionBelow(),t=l.eUp,r=i.eUp,s=!1;if(t.dst()!==r.dst()&&D.sweep.checkForIntersect_(p,l),D.geom.vertEq(t.org,p.event)&&(D.mesh.meshSplice(e.oPrev(),t),l=D.sweep.topLeftRegion_(l),e=l.regionBelow().eUp,D.sweep.finishLeftRegions_(p,l.regionBelow(),i),s=!0),D.geom.vertEq(r.org,p.event)&&(D.mesh.meshSplice(n,r.oPrev()),n=D.sweep.finishLeftRegions_(p,i,null),s=!0),s){D.sweep.addRightEdges_(p,l,n.oNext,e,e,!0);return}var a;D.geom.vertLeq(r.org,t.org)?a=r.oPrev():a=t,a=D.mesh.connect(n.lPrev(),a),D.sweep.addRightEdges_(p,l,a,a.oNext,a.oNext,!1),a.sym.activeRegion.fixUpperEdge=!0,D.sweep.walkDirtyRegions_(p,l)},D.sweep.connectLeftDegenerate_=function(p,l,n){var e=l.eUp;if(D.geom.vertEq(e.org,n)){D.sweep.TOLERANCE_NONZERO_&&D.sweep.spliceMergeVertices_(p,e,n.anEdge);return}if(!D.geom.vertEq(e.dst(),n)){D.mesh.splitEdge(e.sym),l.fixUpperEdge&&(D.mesh.deleteEdge(e.oNext),l.fixUpperEdge=!1),D.mesh.meshSplice(n.anEdge,e),D.sweep.sweepEvent_(p,n);return}if(D.sweep.TOLERANCE_NONZERO_){l=D.sweep.topRightRegion_(l);var i=l.regionBelow(),t=i.eUp.sym,r=t.oNext,s=r;i.fixUpperEdge&&(D.sweep.deleteRegion_(p,i),D.mesh.deleteEdge(t),t=r.oPrev()),D.mesh.meshSplice(n.anEdge,t),D.geom.edgeGoesLeft(r)||(r=null),D.sweep.addRightEdges_(p,l,t.oNext,s,r,!0)}},D.sweep.connectLeftVertex_=function(p,l){var n=new D.ActiveRegion;n.eUp=l.anEdge.sym;var e=p.dict.search(n).getKey(),i=e.regionBelow(),t=e.eUp,r=i.eUp;if(D.geom.edgeSign(t.dst(),l,t.org)===0){D.sweep.connectLeftDegenerate_(p,e,l);return}var s=D.geom.vertLeq(r.dst(),t.dst())?e:i,a;if(e.inside||s.fixUpperEdge){if(s===e)a=D.mesh.connect(l.anEdge.sym,t.lNext);else{var f=D.mesh.connect(r.dNext(),l.anEdge);a=f.sym}s.fixUpperEdge?D.sweep.fixUpperEdge_(s,a):D.sweep.computeWinding_(p,D.sweep.addRegionBelow_(p,e,a)),D.sweep.sweepEvent_(p,l)}else D.sweep.addRightEdges_(p,e,l.anEdge,l.anEdge,null,!0)},D.sweep.sweepEvent_=function(p,l){p.event=l;for(var n=l.anEdge;n.activeRegion===null;)if(n=n.oNext,n===l.anEdge){D.sweep.connectLeftVertex_(p,l);return}var e=D.sweep.topLeftRegion_(n.activeRegion),i=e.regionBelow(),t=i.eUp,r=D.sweep.finishLeftRegions_(p,i,null);r.oNext===t?D.sweep.connectRightVertex_(p,e,r):D.sweep.addRightEdges_(p,e,r.oNext,t,t,!0)},D.sweep.addSentinel_=function(p,l){var n=new D.ActiveRegion,e=D.mesh.makeEdge(p.mesh);e.org.s=D.sweep.SENTINEL_COORD_,e.org.t=l,e.dst().s=-D.sweep.SENTINEL_COORD_,e.dst().t=l,p.event=e.dst(),n.eUp=e,n.windingNumber=0,n.inside=!1,n.fixUpperEdge=!1,n.sentinel=!0,n.dirty=!1,n.nodeUp=p.dict.insert(n)},D.sweep.initEdgeDict_=function(p){p.dict=new D.Dict(p,D.sweep.edgeLeq_),D.sweep.addSentinel_(p,-D.sweep.SENTINEL_COORD_),D.sweep.addSentinel_(p,D.sweep.SENTINEL_COORD_)},D.sweep.doneEdgeDict_=function(p){for(var l=0,n;(n=p.dict.getMin().getKey())!==null;)n.sentinel,D.sweep.deleteRegion_(p,n);p.dict=null},D.sweep.removeDegenerateEdges_=function(p){for(var l=p.mesh.eHead,n,e=l.next;e!==l;e=n){n=e.next;var i=e.lNext;D.geom.vertEq(e.org,e.dst())&&e.lNext.lNext!==e&&(D.sweep.spliceMergeVertices_(p,i,e),D.mesh.deleteEdge(e),e=i,i=e.lNext),i.lNext===e&&(i!==e&&((i===n||i===n.sym)&&(n=n.next),D.mesh.deleteEdge(i)),(e===n||e===n.sym)&&(n=n.next),D.mesh.deleteEdge(e))}},D.sweep.initPriorityQ_=function(p){var l=new D.PriorityQ(D.geom.vertLeq);p.pq=l;var n=p.mesh.vHead,e;for(e=n.next;e!==n;e=e.next)e.pqHandle=l.insert(e);l.init()},D.sweep.donePriorityQ_=function(p){p.pq.deleteQ(),p.pq=null},D.sweep.removeDegenerateFaces_=function(p){for(var l,n=p.fHead.next;n!==p.fHead;n=l){l=n.next;var e=n.anEdge;e.lNext.lNext===e&&(D.sweep.addWinding_(e.oNext,e),D.mesh.deleteEdge(e))}},D.tessmono={},D.tessmono.tessellateMonoRegion_=function(p){for(var l=p.anEdge;D.geom.vertLeq(l.dst(),l.org);l=l.lPrev());for(;D.geom.vertLeq(l.org,l.dst());l=l.lNext);for(var n=l.lPrev(),e;l.lNext!==n;)if(D.geom.vertLeq(l.dst(),n.org)){for(;n.lNext!==l&&(D.geom.edgeGoesLeft(n.lNext)||D.geom.edgeSign(n.org,n.dst(),n.lNext.dst())<=0);)e=D.mesh.connect(n.lNext,n),n=e.sym;n=n.lPrev()}else{for(;n.lNext!==l&&(D.geom.edgeGoesRight(l.lPrev())||D.geom.edgeSign(l.dst(),l.org,l.lPrev().org)>=0);)e=D.mesh.connect(l,l.lPrev()),l=e.sym;l=l.lNext}for(;n.lNext.lNext!==l;)e=D.mesh.connect(n.lNext,n),n=e.sym},D.tessmono.tessellateInterior=function(p){for(var l,n=p.fHead.next;n!==p.fHead;n=l)l=n.next,n.inside&&D.tessmono.tessellateMonoRegion_(n)},D.tessmono.discardExterior=function(p){for(var l,n=p.fHead.next;n!==p.fHead;n=l)l=n.next,n.inside||D.mesh.zapFace(n)},D.tessmono.setWindingNumber=function(p,l,n){for(var e,i=p.eHead.next;i!==p.eHead;i=e)e=i.next,i.rFace().inside!==i.lFace.inside?i.winding=i.lFace.inside?l:-l:n?D.mesh.deleteEdge(i):i.winding=0},D.Dict=function(p,l){this.head_=new D.DictNode,this.frame_=p,this.leq_=l},D.Dict.prototype.deleteDict_=function(){},D.Dict.prototype.insertBefore=function(p,l){do p=p.prev;while(p.key!==null&&!this.leq_(this.frame_,p.key,l));var n=new D.DictNode(l,p.next,p);return p.next.prev=n,p.next=n,n},D.Dict.prototype.insert=function(p){return this.insertBefore(this.head_,p)},D.Dict.prototype.deleteNode=function(p){p.next.prev=p.prev,p.prev.next=p.next},D.Dict.prototype.search=function(p){var l=this.head_;do l=l.next;while(l.key!==null&&!this.leq_(this.frame_,p,l.key));return l},D.Dict.prototype.getMin=function(){return this.head_.next},D.Dict.prototype.getMax=function(){return this.head_.prev},D.DictNode=function(p,l,n){this.key=p||null,this.next=l||this,this.prev=n||this},D.DictNode.prototype.getKey=function(){return this.key},D.DictNode.prototype.getSuccessor=function(){return this.next},D.DictNode.prototype.getPredecessor=function(){return this.prev},D.CachedVertex=function(){this.coords=[0,0,0],this.data=null},D.GluTesselator=function(){this.state=D.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null,this.callError_=null,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.relTolerance=D.GLU_TESS_DEFAULT_TOLERANCE,this.windingRule=D.windingRule.GLU_TESS_WINDING_ODD,this.fatalError=!1,this.dict=null,this.pq=null,this.event=null,this.callCombine_=null,this.boundaryOnly=!1,this.callBegin_=null,this.callEdgeFlag_=null,this.callVertex_=null,this.callEnd_=null,this.callMesh_=null,this.callBeginData_=null,this.callEdgeFlagData_=null,this.callVertexData_=null,this.callEndData_=null,this.callErrorData_=null,this.callCombineData_=null,this.polygonData_=null,this.emptyCache=!1,this.cacheCount=0,this.cache=new Array(D.TESS_MAX_CACHE);for(var p=0;p<D.TESS_MAX_CACHE;p++)this.cache[p]=new D.CachedVertex},D.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2},D.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(D.GluTesselator.tessState_.T_DORMANT)},D.GluTesselator.prototype.gluTessProperty=function(p,l){switch(p){case D.gluEnum.GLU_TESS_TOLERANCE:if(l<0||l>1)break;this.relTolerance=l;return;case D.gluEnum.GLU_TESS_WINDING_RULE:var n=l;switch(n){case D.windingRule.GLU_TESS_WINDING_ODD:case D.windingRule.GLU_TESS_WINDING_NONZERO:case D.windingRule.GLU_TESS_WINDING_POSITIVE:case D.windingRule.GLU_TESS_WINDING_NEGATIVE:case D.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=n;return;default:}break;case D.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly=!!l;return;default:this.callErrorOrErrorData(D.gluEnum.GLU_INVALID_ENUM);return}this.callErrorOrErrorData(D.gluEnum.GLU_INVALID_VALUE)},D.GluTesselator.prototype.gluGetTessProperty=function(p){switch(p){case D.gluEnum.GLU_TESS_TOLERANCE:return this.relTolerance;case D.gluEnum.GLU_TESS_WINDING_RULE:var l=this.windingRule;return l;case D.gluEnum.GLU_TESS_BOUNDARY_ONLY:return this.boundaryOnly;default:this.callErrorOrErrorData(D.gluEnum.GLU_INVALID_ENUM);break}return!1},D.GluTesselator.prototype.gluTessNormal=function(p,l,n){this.normal[0]=p,this.normal[1]=l,this.normal[2]=n},D.GluTesselator.prototype.gluTessCallback=function(p,l){var n=l||null;switch(p){case D.gluEnum.GLU_TESS_BEGIN:this.callBegin_=n;return;case D.gluEnum.GLU_TESS_BEGIN_DATA:this.callBeginData_=n;return;case D.gluEnum.GLU_TESS_EDGE_FLAG:this.callEdgeFlag_=n;return;case D.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.callEdgeFlagData_=n;return;case D.gluEnum.GLU_TESS_VERTEX:this.callVertex_=n;return;case D.gluEnum.GLU_TESS_VERTEX_DATA:this.callVertexData_=n;return;case D.gluEnum.GLU_TESS_END:this.callEnd_=n;return;case D.gluEnum.GLU_TESS_END_DATA:this.callEndData_=n;return;case D.gluEnum.GLU_TESS_ERROR:this.callError_=n;return;case D.gluEnum.GLU_TESS_ERROR_DATA:this.callErrorData_=n;return;case D.gluEnum.GLU_TESS_COMBINE:this.callCombine_=n;return;case D.gluEnum.GLU_TESS_COMBINE_DATA:this.callCombineData_=n;return;case D.gluEnum.GLU_TESS_MESH:this.callMesh_=n;return;default:this.callErrorOrErrorData(D.gluEnum.GLU_INVALID_ENUM);return}},D.GluTesselator.prototype.gluTessVertex=function(p,l){var n=!1,e=[0,0,0];this.requireState_(D.GluTesselator.tessState_.T_IN_CONTOUR),this.emptyCache&&(this.emptyCache_(),this.lastEdge_=null);for(var i=0;i<3;++i){var t=p[i];t<-D.GLU_TESS_MAX_COORD&&(t=-D.GLU_TESS_MAX_COORD,n=!0),t>D.GLU_TESS_MAX_COORD&&(t=D.GLU_TESS_MAX_COORD,n=!0),e[i]=t}if(n&&this.callErrorOrErrorData(D.errorType.GLU_TESS_COORD_TOO_LARGE),this.mesh===null){if(this.cacheCount<D.TESS_MAX_CACHE){this.cacheVertex_(e,l);return}this.emptyCache_()}this.addVertex_(e,l)},D.GluTesselator.prototype.gluTessBeginPolygon=function(p){this.requireState_(D.GluTesselator.tessState_.T_DORMANT),this.state=D.GluTesselator.tessState_.T_IN_POLYGON,this.cacheCount=0,this.emptyCache=!1,this.mesh=null,this.polygonData_=p},D.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(D.GluTesselator.tessState_.T_IN_POLYGON),this.state=D.GluTesselator.tessState_.T_IN_CONTOUR,this.lastEdge_=null,this.cacheCount>0&&(this.emptyCache=!0)},D.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(D.GluTesselator.tessState_.T_IN_CONTOUR),this.state=D.GluTesselator.tessState_.T_IN_POLYGON},D.GluTesselator.prototype.gluTessEndPolygon=function(){if(this.requireState_(D.GluTesselator.tessState_.T_IN_POLYGON),this.state=D.GluTesselator.tessState_.T_DORMANT,this.mesh===null&&this.emptyCache_(),D.normal.projectPolygon(this),D.sweep.computeInterior(this),!this.fatalError){var p=this.mesh;if(this.boundaryOnly?D.tessmono.setWindingNumber(p,1,!0):D.tessmono.tessellateInterior(p),this.mesh.checkMesh(),this.callBegin_||this.callEnd_||this.callVertex_||this.callEdgeFlag_||this.callBeginData_||this.callEndData_||this.callVertexData_||this.callEdgeFlagData_)if(this.boundaryOnly)D.render.renderBoundary(this,this.mesh);else{var l=!!(this.callEdgeFlag_||this.callEdgeFlagData_);D.render.renderMesh(this,this.mesh,l)}if(this.callMesh_){D.tessmono.discardExterior(this.mesh),this.callMesh_(this.mesh),this.mesh=null,this.polygonData_=null;return}}D.mesh.deleteMesh(this.mesh),this.polygonData_=null,this.mesh=null},D.GluTesselator.prototype.makeDormant_=function(){this.mesh&&D.mesh.deleteMesh(this.mesh),this.state=D.GluTesselator.tessState_.T_DORMANT,this.lastEdge_=null,this.mesh=null},D.GluTesselator.prototype.requireState_=function(p){this.state!==p&&this.gotoState_(p)},D.GluTesselator.prototype.gotoState_=function(p){for(;this.state!==p;)if(this.state<p)switch(this.state){case D.GluTesselator.tessState_.T_DORMANT:this.callErrorOrErrorData(D.errorType.GLU_TESS_MISSING_BEGIN_POLYGON),this.gluTessBeginPolygon(null);break;case D.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(D.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour();break}else switch(this.state){case D.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorOrErrorData(D.errorType.GLU_TESS_MISSING_END_CONTOUR),this.gluTessEndContour();break;case D.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorOrErrorData(D.errorType.GLU_TESS_MISSING_END_POLYGON),this.makeDormant_();break}},D.GluTesselator.prototype.addVertex_=function(p,l){var n=this.lastEdge_;n===null?(n=D.mesh.makeEdge(this.mesh),D.mesh.meshSplice(n,n.sym)):(D.mesh.splitEdge(n),n=n.lNext),n.org.data=l,n.org.coords[0]=p[0],n.org.coords[1]=p[1],n.org.coords[2]=p[2],n.winding=1,n.sym.winding=-1,this.lastEdge_=n},D.GluTesselator.prototype.cacheVertex_=function(p,l){var n=this.cache[this.cacheCount];n.data=l,n.coords[0]=p[0],n.coords[1]=p[1],n.coords[2]=p[2],++this.cacheCount},D.GluTesselator.prototype.emptyCache_=function(){this.mesh=new D.GluMesh;for(var p=0;p<this.cacheCount;p++){var l=this.cache[p];this.addVertex_(l.coords,l.data)}this.cacheCount=0,this.emptyCache=!1},D.GluTesselator.prototype.callBeginOrBeginData=function(p){this.callBeginData_?this.callBeginData_(p,this.polygonData_):this.callBegin_&&this.callBegin_(p)},D.GluTesselator.prototype.callVertexOrVertexData=function(p){this.callVertexData_?this.callVertexData_(p,this.polygonData_):this.callVertex_&&this.callVertex_(p)},D.GluTesselator.prototype.callEdgeFlagOrEdgeFlagData=function(p){this.callEdgeFlagData_?this.callEdgeFlagData_(p,this.polygonData_):this.callEdgeFlag_&&this.callEdgeFlag_(p)},D.GluTesselator.prototype.callEndOrEndData=function(){this.callEndData_?this.callEndData_(this.polygonData_):this.callEnd_&&this.callEnd_()},D.GluTesselator.prototype.callCombineOrCombineData=function(p,l,n){var e;return this.callCombineData_?e=this.callCombineData_(p,l,n,this.polygonData_):this.callCombine_&&(e=this.callCombine_(p,l,n)),e===void 0&&(e=null),e},D.GluTesselator.prototype.callErrorOrErrorData=function(p){this.callErrorData_?this.callErrorData_(p,this.polygonData_):this.callError_&&this.callError_(p)},D.GluFace=function(p,l){this.next=p||this,this.prev=l||this,this.anEdge=null,this.data=null,this.inside=!1},D.GluHalfEdge=function(p){this.next=p||this,this.sym=null,this.oNext=null,this.lNext=null,this.org=null,this.lFace=null,this.activeRegion=null,this.winding=0},D.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace},D.GluHalfEdge.prototype.dst=function(){return this.sym.org},D.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext},D.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym},D.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym},D.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext},D.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym},D.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym},D.GluMesh=function(){this.vHead=new D.GluVertex,this.fHead=new D.GluFace,this.eHead=new D.GluHalfEdge,this.eHeadSym=new D.GluHalfEdge,this.eHead.sym=this.eHeadSym,this.eHeadSym.sym=this.eHead},D.GluMesh.prototype.checkMesh=function(){if(D.DEBUG){var p=this.fHead,l=this.vHead,n=this.eHead,e,i,t=p;for(t=p;(i=t.next)!==p;t=i){e=i.anEdge;do e=e.lNext;while(e!==i.anEdge)}var r,s=l;for(s=l;(r=s.next)!==l;s=r){e=r.anEdge;do e=e.oNext;while(e!==r.anEdge)}var a=n;for(a=n;(e=a.next)!==n;a=e);}},D.GluVertex=function(p,l){this.next=p||this,this.prev=l||this,this.anEdge=null,this.data=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=null},D.PQHandleElem=function(){this.key=null,this.node=0},D.PQHandleElem.realloc=function(p,l){var n=new Array(l),e=0;if(p!==null)for(;e<p.length;e++)n[e]=p[e];for(;e<l;e++)n[e]=new D.PQHandleElem;return n},D.PQNode=function(){this.handle=0},D.PQNode.realloc=function(p,l){var n=new Array(l),e=0;if(p!==null)for(;e<p.length;e++)n[e]=p[e];for(;e<l;e++)n[e]=new D.PQNode;return n},D.PriorityQ=function(p){this.keys_=D.PriorityQ.prototype.PQKeyRealloc_(null,D.PriorityQ.INIT_SIZE_),this.order_=null,this.size_=0,this.max_=D.PriorityQ.INIT_SIZE_,this.initialized_=!1,this.leq_=p,this.heap_=new D.PriorityQHeap(this.leq_)},D.PriorityQ.INIT_SIZE_=32,D.PriorityQ.prototype.deleteQ=function(){this.heap_.deleteHeap(),this.heap_=null,this.order_=null,this.keys_=null},D.PriorityQ.prototype.init=function(){this.order_=[];for(var p=0;p<this.size_;p++)this.order_[p]=p;var l=function(i,t){return function(r,s){return t(i[r],i[s])?1:-1}}(this.keys_,this.leq_);if(this.order_.sort(l),this.max_=this.size_,this.initialized_=!0,this.heap_.init(),D.DEBUG){var n=0,e=n+this.size_-1;for(p=n;p<e;++p);}},D.PriorityQ.prototype.insert=function(p){if(this.initialized_)return this.heap_.insert(p);var l=this.size_;return++this.size_>=this.max_&&(this.max_*=2,this.keys_=D.PriorityQ.prototype.PQKeyRealloc_(this.keys_,this.max_)),this.keys_[l]=p,-(l+1)},D.PriorityQ.prototype.PQKeyRealloc_=function(p,l){var n=new Array(l),e=0;if(p!==null)for(;e<p.length;e++)n[e]=p[e];for(;e<l;e++)n[e]=null;return n},D.PriorityQ.prototype.keyLessThan_=function(p,l){var n=this.keys_[p],e=this.keys_[l];return!this.leq_(e,n)},D.PriorityQ.prototype.keyGreaterThan_=function(p,l){var n=this.keys_[p],e=this.keys_[l];return!this.leq_(n,e)},D.PriorityQ.prototype.extractMin=function(){if(this.size_===0)return this.heap_.extractMin();var p=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var l=this.heap_.minimum();if(this.leq_(l,p))return this.heap_.extractMin()}do--this.size_;while(this.size_>0&&this.keys_[this.order_[this.size_-1]]===null);return p},D.PriorityQ.prototype.minimum=function(){if(this.size_===0)return this.heap_.minimum();var p=this.keys_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var l=this.heap_.minimum();if(this.leq_(l,p))return l}return p},D.PriorityQ.prototype.isEmpty_=function(){return this.size_===0&&this.heap_.isEmpty()},D.PriorityQ.prototype.remove=function(p){if(p>=0){this.heap_.remove(p);return}for(p=-(p+1),this.keys_[p]=null;this.size_>0&&this.keys_[this.order_[this.size_-1]]===null;)--this.size_},D.PriorityQHeap=function(p){this.nodes_=D.PQNode.realloc(null,D.PriorityQHeap.INIT_SIZE_+1),this.handles_=D.PQHandleElem.realloc(null,D.PriorityQHeap.INIT_SIZE_+1),this.size_=0,this.max_=D.PriorityQHeap.INIT_SIZE_,this.freeList_=0,this.initialized_=!1,this.leq_=p,this.nodes_[1].handle=1},D.PriorityQHeap.INIT_SIZE_=32,D.PriorityQHeap.prototype.deleteHeap=function(){this.handles_=null,this.nodes_=null},D.PriorityQHeap.prototype.init=function(){for(var p=this.size_;p>=1;--p)this.floatDown_(p);this.initialized_=!0},D.PriorityQHeap.prototype.insert=function(p){var l=++this.size_;l*2>this.max_&&(this.max_*=2,this.nodes_=D.PQNode.realloc(this.nodes_,this.max_+1),this.handles_=D.PQHandleElem.realloc(this.handles_,this.max_+1));var n;return this.freeList_===0?n=l:(n=this.freeList_,this.freeList_=this.handles_[n].node),this.nodes_[l].handle=n,this.handles_[n].node=l,this.handles_[n].key=p,this.initialized_&&this.floatUp_(l),n},D.PriorityQHeap.prototype.isEmpty=function(){return this.size_===0},D.PriorityQHeap.prototype.minimum=function(){return this.handles_[this.nodes_[1].handle].key},D.PriorityQHeap.prototype.extractMin=function(){var p=this.nodes_,l=this.handles_,n=p[1].handle,e=l[n].key;return this.size_>0&&(p[1].handle=p[this.size_].handle,l[p[1].handle].node=1,l[n].key=null,l[n].node=this.freeList_,this.freeList_=n,--this.size_>0&&this.floatDown_(1)),e},D.PriorityQHeap.prototype.remove=function(p){var l=this.nodes_,n=this.handles_,e=n[p].node;l[e].handle=l[this.size_].handle,n[l[e].handle].node=e,e<=--this.size_&&(e<=1||this.leq_(n[l[e>>1].handle].key,n[l[e].handle].key)?this.floatDown_(e):this.floatUp_(e)),n[p].key=null,n[p].node=this.freeList_,this.freeList_=p},D.PriorityQHeap.prototype.floatDown_=function(p){for(var l=this.nodes_,n=this.handles_,e=l[p].handle;;){var i=p<<1;i<this.size_&&this.leq_(n[l[i+1].handle].key,n[l[i].handle].key)&&++i;var t=l[i].handle;if(i>this.size_||this.leq_(n[e].key,n[t].key)){l[p].handle=e,n[e].node=p;break}l[p].handle=t,n[t].node=p,p=i}},D.PriorityQHeap.prototype.floatUp_=function(p){for(var l=this.nodes_,n=this.handles_,e=l[p].handle;;){var i=p>>1,t=l[i].handle;if(i===0||this.leq_(n[t].key,n[e].key)){l[p].handle=e,n[e].node=p;break}l[p].handle=t,n[t].node=p,p=i}},D.ActiveRegion=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},D.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()},D.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()},typeof ji<"u"&&(ji.exports=D),B("util/libtess",function(){}),B("util/measure/AreaMeasurer",["../../geom/Angle","../../error/ArgumentError","../../geom/Location","../Logger","./MeasurerUtils","../../geom/Sector","../../geom/Vec3","../libtess"],function(p,l,n,e,i,t,r,s){"use strict";var a=function(f){if(!f)throw new l(e.logMessage(e.LEVEL_SEVERE,"AreaMeasurer","constructor","missingWorldWindow"));this.wwd=f,this.DEFAULT_AREA_SAMPLING_STEPS=32,this._areaTerrainSamplingSteps=this.DEFAULT_AREA_SAMPLING_STEPS,this._maxSegmentLength=1e5,this.subdividedPositions=null,this.vecZ=new r(0,0,1),this.scratchLocation=new n(0,0)};return Object.defineProperties(a.prototype,{areaTerrainSamplingSteps:{get:function(){return this._areaTerrainSamplingSteps},set:function(f){this._areaTerrainSamplingSteps=f}},maxSegmentLength:{get:function(){return this._maxSegmentLength},set:function(f){this._maxSegmentLength=f}}}),a.prototype.getArea=function(f,o,c){var d=this.wwd.globe;return o?this.computeSurfaceAreaSampling(d,f,c):this.computeProjectedAreaGeometry(d,f,c)},a.prototype.computeSurfaceAreaSampling=function(f,o,c){var d=new t(0,0,0,0);d.setToBoundingSector(o),this.subdividedPositions=i.subdividePositions(f,o,!0,c,this._maxSegmentLength);for(var h=Math.max(this.DEFAULT_AREA_SAMPLING_STEPS,this._areaTerrainSamplingSteps),u=d.deltaLatitude()*p.DEGREES_TO_RADIANS,m=d.deltaLongitude()*p.DEGREES_TO_RADIANS,g=Math.max(u/h,m/h),_=Math.round(u/g),y=Math.round(m/g*Math.cos(d.centroidLatitude()*p.DEGREES_TO_RADIANS)),v=u/_,b=m/y,R=0,M=0;M<_;M++)for(var P=d.minLatitude*p.DEGREES_TO_RADIANS+v*M,T=f.radiusAt((P+v/2)*p.RADIANS_TO_DEGREES,d.centroidLongitude()),E=b*T*Math.cos(P+v/2),x=v*T,S=E*x,L=0;L<y;L++){var C=d.minLongitude*p.DEGREES_TO_RADIANS+b*L,F=P*p.RADIANS_TO_DEGREES,q=(P+v)*p.RADIANS_TO_DEGREES,it=C*p.RADIANS_TO_DEGREES,st=(C+b)*p.RADIANS_TO_DEGREES,pt=new t(F,q,it,st),_t=i.isLocationInside(pt.centroid(this.scratchLocation),this.subdividedPositions);if(_t){var X=f.elevationAtLocation(F,it),ot=f.elevationAtLocation(F,st),Tt=f.elevationAtLocation(q,it),Vt=new r(E,0,ot-X),Gt=new r(0,x,Tt-X);Vt.normalize(),Gt.normalize();var qt=Vt.cross(Gt).normalize(),Qt=Math.tan(i.angleBetweenVectors(this.vecZ,qt)),ne=Math.sqrt(1+Qt*Qt);R+=S*ne}}return R},a.prototype.computeProjectedAreaGeometry=function(f,o,c){this.subdividedPositions=i.subdividePositions(f,o,!1,c,this._maxSegmentLength);var d=this.subdividedPositions.length,h=this.subdividedPositions[0],u=this.subdividedPositions[d-1];h.equals(u)&&d--;for(var m=[],g=0,_=0;_<d;_++){var y=this.subdividedPositions[_];m[g++]=y.longitude*p.DEGREES_TO_RADIANS,m[g++]=y.latitude*p.DEGREES_TO_RADIANS,m[g++]=0}var v=this.tessellatePolygon(d,m),b=0,R=v.length/9;for(_=0;_<R;_++){g=_*9;var M=[v[g+0],v[g+1],v[g+2],v[g+3],v[g+4],v[g+5],v[g+6],v[g+7],v[g+8]];b+=this.computeTriangleProjectedArea(f,M)}return b},a.prototype.computeTriangleProjectedArea=function(f,o){var c=o[0],d=o[1],h=o[3],u=o[4],m=o[6],g=o[7],_=Math.abs(c*(u-g)+h*(g-d)+m*(d-u));_/=2;var y=(c+h+m)/3,v=(d+u+g)/3,b=f.radiusAt(v*p.RADIANS_TO_DEGREES,y*p.RADIANS_TO_DEGREES);return _*=Math.cos(v)*b*b,_},a.prototype.tessellatePolygon=function(f,o){var c=new D.GluTesselator,d=[],h;c.gluTessCallback(D.gluEnum.GLU_TESS_BEGIN,function(m){m!==D.primitiveType.GL_TRIANGLES&&e.logMessage(e.LEVEL_WARNING,"AreaMeasurer","tessellatePolygon","Tessellation error, primitive is not TRIANGLES.")}),c.gluTessCallback(D.gluEnum.GLU_TESS_VERTEX_DATA,function(m,g){g.push(m[0]),g.push(m[1]),g.push(m[2])}),c.gluTessCallback(D.gluEnum.GLU_TESS_EDGE_FLAG,function(){}),c.gluTessCallback(D.gluEnum.GLU_TESS_ERROR,function(m){e.logMessage(e.LEVEL_WARNING,"AreaMeasurer","tessellatePolygon","Tessellation error "+m+".")}),c.gluTessBeginPolygon(d),c.gluTessBeginContour();for(var u=0;u<f;u++)h=o.slice(3*u,3*u+3),c.gluTessVertex(h,h);return c.gluTessEndContour(),c.gluTessEndPolygon(),d},a}),B("util/AbsentResourceList",[],function(){"use strict";var p=function(l,n){this.maxTrys=l,this.minCheckInterval=n,this.tryAgainInterval=6e4,this.possiblyAbsent={}};return p.prototype.isResourceAbsent=function(l){var n=this.possiblyAbsent[l];if(!n)return!1;if(n.permanent)return!0;var e=Date.now()-n.timeOfLastMark;return e>this.tryAgainInterval?(delete this.possiblyAbsent[l],!1):e<this.minCheckInterval||n.numTrys>this.maxTrys},p.prototype.markResourceAbsent=function(l){var n=this.possiblyAbsent[l];n||(n={timeOfLastMark:Date.now(),numTrys:0},this.possiblyAbsent[l]=n),n.numTrys=n.numTrys+1,n.timeOfLastMark=Date.now()},p.prototype.markResourceAbsentPermanently=function(l){var n=this.possiblyAbsent[l];n||(n={timeOfLastMark:Date.now(),numTrys:0},this.possiblyAbsent[l]=n),n.numTrys=n.numTrys+1,n.timeOfLastMark=Date.now(),n.permanent=!0},p.prototype.unmarkResourceAbsent=function(l){var n=this.possiblyAbsent[l];n&&delete this.possiblyAbsent[l]},p}),B("globe/ElevationCoverage",["../error/ArgumentError","../util/Logger","../geom/Sector"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationCoverage","constructor","missingResolution"));this.timestamp=Date.now(),this.displayName="Coverage",this._enabled=!0,this.resolution=i,this.coverageSector=n.FULL_SPHERE};return Object.defineProperties(e.prototype,{enabled:{get:function(){return this._enabled},set:function(i){this._enabled=i,this.timestamp=Date.now()}}}),e.prototype.minAndMaxElevationsForSector=function(i,t){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationCoverage","minAndMaxElevationsForSector","missingSector"));if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationCoverage","minAndMaxElevationsForSector","missingResult"));return t[0]>0&&(t[0]=0),t[1]<0&&(t[1]=0),!0},e.prototype.elevationAtLocation=function(i,t){return 0},e.prototype.elevationsForGrid=function(i,t,r,s){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationCoverage","elevationsForGrid","missingSector"));if(t<=0||r<=0)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationCoverage","elevationsForGrid","numLat or numLon is less than 1"));if(!s||s.length<t*r)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationCoverage","elevationsForGrid","missingArray"));for(var a=0,f=s.length;a<f;a++)s[a]=0;return!0},e}),B("globe/ElevationImage",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(p,l,n){"use strict";var e=function(i,t,r){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationImage","constructor","missingSector"));this.sector=i,this.imageWidth=t,this.imageHeight=r,this.size=this.imageWidth*this.imageHeight,this.hasData=!0,this.hasMissingData=!1};return e.NO_DATA=0,e.isNoData=function(i,t,r,s){var a=e.NO_DATA;return i===a&&t===a&&r===a&&s===a},e.prototype.pixel=function(i,t){return i<0||i>=this.imageWidth||t<0||t>=this.imageHeight?0:(t=this.imageHeight-t-1,this.imageData[i+t*this.imageWidth])},e.prototype.elevationAtLocation=function(i,t){var r=this.sector.maxLatitude,s=this.sector.minLongitude,a=this.sector.deltaLatitude(),f=this.sector.deltaLongitude(),o=(this.imageWidth-1)*(t-s)/f,c=(this.imageHeight-1)*(r-i)/a,d=Math.floor(n.clamp(o,0,this.imageWidth-1)),h=Math.floor(n.clamp(d+1,0,this.imageWidth-1)),u=Math.floor(n.clamp(c,0,this.imageHeight-1)),m=Math.floor(n.clamp(u+1,0,this.imageHeight-1)),g=this.imageData,_=g[d+u*this.imageWidth],y=g[h+u*this.imageWidth],v=g[d+m*this.imageWidth],b=g[h+m*this.imageWidth],R=o-d,M=c-u;return e.isNoData(_,y,v,b)?NaN:(1-R)*(1-M)*_+R*(1-M)*y+(1-R)*M*v+R*M*b},e.prototype.elevationsForGrid=function(i,t,r,s){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationImage","elevationsForGrid","missingSector"));if(t<1||r<1)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationImage","elevationsForGrid","The specified number of sample points is less than 1."));if(!s)throw new p(l.logMessage(l.LEVEL_SEVERE,"ElevationImage","elevationsForGrid","missingResult"));var a=this.sector.minLatitude,f=this.sector.maxLatitude,o=this.sector.minLongitude,c=this.sector.maxLongitude,d=f-a,h=c-o,u=i.minLatitude,m=i.maxLatitude,g=i.minLongitude,_=i.maxLongitude,y=(m-u)/(t>1?t-1:1),v=(_-g)/(r>1?r-1:1),b,R,M,P,T=0,E=this.imageData;for(P=0,b=u;P<t;P+=1,b+=y)if(P===t-1&&(b=m),b>=a&&b<=f){var x=(this.imageHeight-1)*(f-b)/d,S=Math.floor(n.clamp(x,0,this.imageHeight-1)),L=Math.floor(n.clamp(S+1,0,this.imageHeight-1)),C=x-S;for(M=0,R=g;M<r;M+=1,R+=v){if(M===r-1&&(R=_),R>=o&&R<=c&&isNaN(s[T])){var F=(this.imageWidth-1)*(R-o)/h,q=Math.floor(n.clamp(F,0,this.imageWidth-1)),it=Math.floor(n.clamp(q+1,0,this.imageWidth-1)),st=F-q,pt=E[q+S*this.imageWidth],_t=E[it+S*this.imageWidth],X=E[q+L*this.imageWidth],ot=E[it+L*this.imageWidth];e.isNoData(pt,_t,X,ot)?s[T]=NaN:s[T]=(1-st)*(1-C)*pt+st*(1-C)*_t+(1-st)*C*X+st*C*ot}T++}}else T+=r},e.prototype.minAndMaxElevationsForSector=function(i){if(!this.hasData)return null;var t=[];if(!i)t[0]=this.minElevation,t[1]=this.maxElevation;else if(i.contains(this.sector))t[0]>this.minElevation&&(t[0]=this.minElevation),t[1]<this.maxElevation&&(t[1]=this.maxElevation);else{var r=this.sector.maxLatitude,s=this.sector.minLongitude,a=this.sector.deltaLatitude(),f=this.sector.deltaLongitude(),o=i.minLatitude,c=i.maxLatitude,d=i.minLongitude,h=i.maxLongitude,u=Math.floor((this.imageHeight-1)*(r-c)/a),m=Math.ceil((this.imageHeight-1)*(r-o)/a),g=Math.floor((this.imageWidth-1)*(d-s)/f),_=Math.ceil((this.imageWidth-1)*(h-s)/f);u=n.clamp(u,0,this.imageHeight-1),m=n.clamp(m,0,this.imageHeight-1),g=n.clamp(g,0,this.imageWidth-1),_=n.clamp(_,0,this.imageWidth-1);for(var y=this.imageData,v=Number.MAX_VALUE,b=-v,R=u;R<=m;R++)for(var M=g;M<=_;M++){var P=y[Math.floor(M+R*this.imageWidth)];v>P&&(v=P),b<P&&(b=P)}t[0]>v&&(t[0]=v),t[1]<b&&(t[1]=b)}return t},e.prototype.findMinAndMaxElevation=function(){if(this.hasData=!1,this.hasMissingData=!1,this.imageData&&this.imageData.length>0){this.minElevation=Number.MAX_VALUE,this.maxElevation=-Number.MAX_VALUE;for(var i=this.imageData,t=this.imageWidth*this.imageHeight,r=0;r<t;r++){var s=i[r];s!==e.NO_DATA?(this.hasData=!0,this.minElevation>s&&(this.minElevation=s),this.maxElevation<s&&(this.maxElevation=s)):this.hasMissingData=!0}}this.hasData||(this.minElevation=0,this.maxElevation=0)},e}),B("formats/geotiff/GeoTiffConstants",[],function(){"use strict";var p={Tag:{MODEL_PIXEL_SCALE:33550,MODEL_TRANSFORMATION:34264,MODEL_TIEPOINT:33922,GEO_KEY_DIRECTORY:34735,GEO_DOUBLE_PARAMS:34736,GEO_ASCII_PARAMS:34737,GDAL_NODATA:42113,GDAL_METADATA:42112},Key:{GTModelTypeGeoKey:1024,GTRasterTypeGeoKey:1025,GTCitationGeoKey:1026,GeographicTypeGeoKey:2048,GeogCitationGeoKey:2049,GeogGeodeticDatumGeoKey:2050,GeogPrimeMeridianGeoKey:2051,GeogLinearUnitsGeoKey:2052,GeogLinearUnitSizeGeoKey:2053,GeogAngularUnitsGeoKey:2054,GeogAngularUnitSizeGeoKey:2055,GeogEllipsoidGeoKey:2056,GeogSemiMajorAxisGeoKey:2057,GeogSemiMinorAxisGeoKey:2058,GeogInvFlatteningGeoKey:2059,GeogAzimuthUnitsGeoKey:2060,GeogPrimeMeridianLongGeoKey:2061,GeogTOWGS84GeoKey:2062,ProjectedCSTypeGeoKey:3072,PCSCitationGeoKey:3073,ProjectionGeoKey:3074,ProjCoordTransGeoKey:3075,ProjLinearUnitsGeoKey:3076,ProjLinearUnitSizeGeoKey:3077,ProjStdParallel1GeoKey:3078,ProjStdParallel2GeoKey:3079,ProjNatOriginLongGeoKey:3080,ProjNatOriginLatGeoKey:3081,ProjFalseEastingGeoKey:3082,ProjFalseNorthingGeoKey:3083,ProjFalseOriginLongGeoKey:3084,ProjFalseOriginLatGeoKey:3085,ProjFalseOriginEastingGeoKey:3086,ProjFalseOriginNorthingGeoKey:3087,ProjCenterLongGeoKey:3088,ProjCenterLatGeoKey:3089,ProjCenterEastingGeoKey:3090,ProjCenterNorthingGeoKey:3091,ProjScaleAtNatOriginGeoKey:3092,ProjScaleAtCenterGeoKey:3093,ProjAzimuthAngleGeoKey:3094,ProjStraightVertPoleLongGeoKey:3095,VerticalCSTypeGeoKey:4096,VerticalCitationGeoKey:4097,VerticalDatumGeoKey:4098,VerticalUnitsGeoKey:4099}};return p}),B("formats/geotiff/GeoTiffKeyEntry",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffConstants","../../util/Logger"],function(p,l,n,e){"use strict";var i=function(t,r,s,a){if(!t)throw new l(e.logMessage(e.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingKeyId"));if(r==null)throw new l(e.logMessage(e.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingTiffTagLocation"));if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingCount"));if(a==null)throw new l(e.logMessage(e.LEVEL_SEVERE,"GeoTiffKeyEntry","constructor","missingValueOffset"));this._keyId=t,this._tiffTagLocation=r,this._count=s,this._valueOffset=a};return Object.defineProperties(i.prototype,{keyId:{get:function(){return this._keyId}},tiffTagLocation:{get:function(){return this._tiffTagLocation}},count:{get:function(){return this._count}},valueOffset:{get:function(){return this._valueOffset}}}),i.prototype.getGeoKeyValue=function(t,r){var s;if(this.tiffTagLocation===0)s=this.valueOffset;else if(this.tiffTagLocation===n.Tag.GEO_ASCII_PARAMS){var a="";if(r){for(var f=this.valueOffset;f<this.count-1;f++)a+=r[f];r[this.count-1]!="|"&&(a+=r[this.count-1]),s=a}}else this.tiffTagLocation===n.Tag.GEO_DOUBLE_PARAMS&&t&&(s=t[this.valueOffset]);return s},i}),B("formats/geotiff/GeoTiffMetadata",[],function(){"use strict";var p=function(){this._bitsPerSample=null,this._colorMap=null,this._compression=null,this._extraSamples=null,this._imageDescription=null,this._imageLength=null,this._imageWidth=null,this._maxSampleValue=null,this._minSampleValue=null,this._orientation=0,this._photometricInterpretation=null,this._planarConfiguration=null,this._resolutionUnit=null,this._rowsPerStrip=null,this._samplesPerPixel=null,this._sampleFormat=null,this._software=null,this._stripByteCounts=null,this._stripOffsets=null,this._tileByteCounts=null,this._tileOffsets=null,this._tileLength=null,this._tileWidth=null,this._xResolution=null,this._yResolution=null,this._geoAsciiParams=null,this._geoDoubleParams=null,this._geoKeyDirectory=null,this._modelPixelScale=null,this._modelTiepoint=null,this._modelTransformation=null,this._noData=null,this._metaData=null,this._bbox=null,this._gtModelTypeGeoKey=null,this._gtRasterTypeGeoKey=null,this._gtCitationGeoKey=null,this._geographicTypeGeoKey=null,this._geogCitationGeoKey=null,this._geogAngularUnitsGeoKey=null,this._geogAngularUnitSizeGeoKey=null,this._geogSemiMajorAxisGeoKey=null,this._geogInvFlatteningGeoKey=null,this._projectedCSType=null,this._projLinearUnits=null};return Object.defineProperties(p.prototype,{bitsPerSample:{get:function(){return this._bitsPerSample},set:function(l){this._bitsPerSample=l}},colorMap:{get:function(){return this._colorMap},set:function(l){this._colorMap=l}},compression:{get:function(){return this._compression},set:function(l){this._compression=l}},extraSamples:{get:function(){return this._extraSamples},set:function(l){this._extraSamples=l}},imageDescription:{get:function(){return this._imageDescription},set:function(l){this._imageDescription=l}},imageLength:{get:function(){return this._imageLength},set:function(l){this._imageLength=l}},imageWidth:{get:function(){return this._imageWidth},set:function(l){this._imageWidth=l}},maxSampleValue:{get:function(){return this._maxSampleValue},set:function(l){this._maxSampleValue=l}},minSampleValue:{get:function(){return this._minSampleValue},set:function(l){this._minSampleValue=l}},orientation:{get:function(){return this._orientation},set:function(l){this._orientation=l}},photometricInterpretation:{get:function(){return this._photometricInterpretation},set:function(l){this._photometricInterpretation=l}},planarConfiguration:{get:function(){return this._planarConfiguration},set:function(l){this._planarConfiguration=l}},resolutionUnit:{get:function(){return this._resolutionUnit},set:function(l){this._resolutionUnit=l}},rowsPerStrip:{get:function(){return this._rowsPerStrip},set:function(l){this._rowsPerStrip=l}},samplesPerPixel:{get:function(){return this._samplesPerPixel},set:function(l){this._samplesPerPixel=l}},sampleFormat:{get:function(){return this._sampleFormat},set:function(l){this._sampleFormat=l}},software:{get:function(){return this._software},set:function(l){this._software=l}},stripByteCounts:{get:function(){return this._stripByteCounts},set:function(l){this._stripByteCounts=l}},stripOffsets:{get:function(){return this._stripOffsets},set:function(l){this._stripOffsets=l}},tileByteCounts:{get:function(){return this._tileByteCounts},set:function(l){this._tileByteCounts=l}},tileOffsets:{get:function(){return this._tileOffsets},set:function(l){this._tileOffsets=l}},tileLength:{get:function(){return this._tileLength},set:function(l){this._tileLength=l}},tileWidth:{get:function(){return this._tileWidth},set:function(l){this._tileWidth=l}},geoAsciiParams:{get:function(){return this._geoAsciiParams},set:function(l){this._geoAsciiParams=l}},geoDoubleParams:{get:function(){return this._geoDoubleParams},set:function(l){this._geoDoubleParams=l}},geoKeyDirectory:{get:function(){return this._geoKeyDirectory},set:function(l){this._geoKeyDirectory=l}},modelPixelScale:{get:function(){return this._modelPixelScale},set:function(l){this._modelPixelScale=l}},modelTiepoint:{get:function(){return this._modelTiepoint},set:function(l){this._modelTiepoint=l}},modelTransformation:{get:function(){return this._modelTransformation},set:function(l){this._modelTransformation=l}},noData:{get:function(){return this._noData},set:function(l){this._noData=l}},metaData:{get:function(){return this._metaData},set:function(l){this._metaData=l}},bbox:{get:function(){return this._bbox},set:function(l){this._bbox=l}},gtModelTypeGeoKey:{get:function(){return this._gtModelTypeGeoKey},set:function(l){this._gtModelTypeGeoKey=l}},gtRasterTypeGeoKey:{get:function(){return this._gtRasterTypeGeoKey},set:function(l){this._gtRasterTypeGeoKey=l}},gtCitationGeoKey:{get:function(){return this._gtCitationGeoKey},set:function(l){this._gtCitationGeoKey=l}},geographicTypeGeoKey:{get:function(){return this._geographicTypeGeoKey},set:function(l){this._geographicTypeGeoKey=l}},geogCitationGeoKey:{get:function(){return this._geogCitationGeoKey},set:function(l){this._geogCitationGeoKey=l}},geogAngularUnitsGeoKey:{get:function(){return this._geogAngularUnitsGeoKey},set:function(l){this._geogAngularUnitsGeoKey=l}},geogAngularUnitSizeGeoKey:{get:function(){return this._geogAngularUnitSizeGeoKey},set:function(l){this._geogAngularUnitSizeGeoKey=l}},geogSemiMajorAxisGeoKey:{get:function(){return this._geogSemiMajorAxisGeoKey},set:function(l){this._geogSemiMajorAxisGeoKey=l}},geogInvFlatteningGeoKey:{get:function(){return this._geogInvFlatteningGeoKey},set:function(l){this._geogInvFlatteningGeoKey=l}},projectedCSType:{get:function(){return this._projectedCSType},set:function(l){this._projectedCSType=l}},projLinearUnits:{get:function(){return this._projLinearUnits},set:function(l){this._projLinearUnits=l}},xResolution:{get:function(){return this._xResolution},set:function(l){this._xResolution=l}},yResolution:{get:function(){return this._yResolution},set:function(l){this._yResolution=l}}}),p}),B("formats/geotiff/TiffConstants",[],function(){"use strict";var p={Tag:{NEW_SUBFILE_TYPE:254,SUBFILE_TYPE:255,IMAGE_WIDTH:256,IMAGE_LENGTH:257,BITS_PER_SAMPLE:258,COMPRESSION:259,PHOTOMETRIC_INTERPRETATION:262,THRESHHOLDING:263,CELL_WIDTH:264,CELL_LENGTH:265,FILL_ORDER:266,DOCUMENT_NAME:269,IMAGE_DESCRIPTION:270,MAKE:271,MODEL:272,STRIP_OFFSETS:273,ORIENTATION:274,SAMPLES_PER_PIXEL:277,ROWS_PER_STRIP:278,STRIP_BYTE_COUNTS:279,MIN_SAMPLE_VALUE:280,MAX_SAMPLE_VALUE:281,X_RESOLUTION:282,Y_RESOLUTION:283,PLANAR_CONFIGURATION:284,PAGE_NAME:285,X_POSITION:286,Y_POSITION:287,FREE_OFFSETS:288,FREE_BYTE_COUNTS:289,GRAY_RESPONSE_UNIT:290,GRAY_RESPONSE_CURVE:291,T4_OPTIONS:292,T6_PTIONS:293,RESOLUTION_UNIT:296,PAGE_NUMBER:297,TRANSFER_FUNCTION:301,SOFTWARE:305,DATE_TIME:306,ARTIST:315,HOST_COMPUTER:316,PREDICTOR:317,WHITE_POINT:318,PRIMARY_CHROMATICITIES:319,COLOR_MAP:320,HALFTONE_HINTS:321,TILE_WIDTH:322,TILE_LENGTH:323,TILE_OFFSETS:324,TILE_BYTE_COUNTS:325,INK_SET:332,INK_NAMES:333,NUMBER_OF_INKS:334,DOT_RANGE:336,TARGET_PRINTER:337,EXTRA_SAMPLES:338,SAMPLE_FORMAT:339,S_MIN_SAMPLE_VALUE:340,S_MAX_SAMPLE_VALUE:341,TRANSFER_RANGE:342,JPEG_PROC:512,JPEG_INTERCHANGE_FORMAT:513,JPEG_INTERCHANGE_FORMAT_LENGTH:514,JPEG_RESTART_INTERVAL:515,JPEG_LOSSLESS_PREDICTORS:517,JPEG_POINT_TRANSFORMS:518,JPEG_Q_TABLES:519,JPEG_DC_TABLES:520,JPEG_AC_TABLES:521,Y_Cb_Cr_COEFFICIENTS:529,Y_Cb_Cr_SUB_SAMPLING:530,Y_Cb_Cr_POSITIONING:531,REFERENCE_BLACK_WHITE:532,COPYRIGHT:33432},Compression:{UNCOMPRESSED:1,CCITT_1D:2,GROUP_3_FAX:3,GROUP_4_FAX:4,LZW:5,JPEG:6,PACK_BITS:32773},Orientation:{Row0_IS_TOP__Col0_IS_LHS:1,Row0_IS_TOP__Col0_IS_RHS:2,Row0_IS_BOTTOM__Col0_IS_RHS:3,Row0_IS_BOTTOM__Col0_IS_LHS:4,Row0_IS_LHS__Col0_IS_TOP:5,Row0_IS_RHS__Col0_IS_TOP:6,Row0_IS_RHS__Col0_IS_BOTTOM:7,Row0_IS_LHS__Col0_IS_BOTTOM:8},PhotometricInterpretation:{WHITE_IS_ZERO:0,BLACK_IS_ZERO:1,RGB:2,RGB_PALETTE:3,TRANSPARENCY_MASK:4,CMYK:5,Y_Cb_Cr:6,CIE_LAB:7},PlanarConfiguration:{CHUNKY:1,PLANAR:2},ResolutionUnit:{NONE:1,INCH:2,CENTIMETER:3},SampleFormat:{UNSIGNED:1,SIGNED:2,IEEE_FLOAT:3,UNDEFINED:4,DEFAULT:1},Type:{BYTE:1,ASCII:2,SHORT:3,LONG:4,RATIONAL:5,SBYTE:6,UNDEFINED:7,SSHORT:8,SLONG:9,SRATIONAL:10,FLOAT:11,DOUBLE:12}};return p}),B("formats/geotiff/GeoTiffUtil",["../../error/ArgumentError","../../util/Logger","./TiffConstants"],function(p,l,n){"use strict";var e={getBytes:function(i,t,r,s,a){if(r<=0)throw new p(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","getBytes","noBytesRequested"));if(r<=1)return a?i.getInt8(t,s):i.getUint8(t,s);if(r<=2)return a?i.getInt16(t,s):i.getUint16(t,s);if(r<=3)return a?i.getInt32(t,s)>>>8:i.getUint32(t,s)>>>8;if(r<=4)return a?i.getInt32(t,s):i.getUint32(t,s);if(r<=8)return i.getFloat64(t,s);throw new p(l.logMessage(l.LEVEL_SEVERE,"GeoTiffReader","getBytes","tooManyBytesRequested"))},getSampleBytes:function(i,t,r,s,a){var f;switch(s){case n.SampleFormat.UNSIGNED:f=this.getBytes(i,t,r,a,!1);break;case n.SampleFormat.SIGNED:f=this.getBytes(i,t,r,a,!0);break;case n.SampleFormat.IEEE_FLOAT:r==3?f=i.getFloat32(t,a)>>>8:r==4?f=i.getFloat32(t,a):r==8?f=i.getFloat64(t,a):l.log(l.LEVEL_WARNING,"Do not attempt to parse the data  not handled: "+r);break;case n.SampleFormat.UNDEFINED:default:f=this.getBytes(i,t,r,a,!1);break}return f},getRGBAFillValue:function(i,t,r,s){return typeof s>"u"&&(s=1),"rgba("+i+", "+t+", "+r+", "+s+")"},clampColorSample:function(i,t){var r=Math.pow(2,8-t);return Math.floor(i*r+(r-1))}};return e}),B("util/proj4-src",[],function(){"use strict";var p=function(w){w("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),w("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),w("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),w.WGS84=w["EPSG:4326"],w["EPSG:3785"]=w["EPSG:3857"],w.GOOGLE=w["EPSG:3857"],w["EPSG:900913"]=w["EPSG:3857"],w["EPSG:102113"]=w["EPSG:3857"]},l=1,n=2,e=4,i=5,t=484813681109536e-20,r=Math.PI/2,s=.16666666666666666,a=.04722222222222222,f=.022156084656084655,o=typeof Number.EPSILON>"u"?1e-10:Number.EPSILON,c=.017453292519943295,d=57.29577951308232,h=Math.PI/4,u=Math.PI*2,m=3.14159265359,g={};g.greenwich=0,g.lisbon=-9.131906111111,g.paris=2.337229166667,g.bogota=-74.080916666667,g.madrid=-3.687938888889,g.rome=12.452333333333,g.bern=7.439583333333,g.jakarta=106.807719444444,g.ferro=-17.666666666667,g.brussels=4.367975,g.stockholm=18.058277777778,g.athens=23.7163375,g.oslo=10.722916666667;var _={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},y=/[\s_\-\/\(\)]/g;function v(w,A){if(w[A])return w[A];for(var U=Object.keys(w),ft=A.toLowerCase().replace(y,""),lt=-1,gt,mt;++lt<U.length;)if(gt=U[lt],mt=gt.toLowerCase().replace(y,""),mt===ft)return w[gt]}var b=function(w){var A={},U=w.split("+").map(function(yt){return yt.trim()}).filter(function(yt){return yt}).reduce(function(yt,It){var jt=It.split("=");return jt.push(!0),yt[jt[0].toLowerCase()]=jt[1],yt},{}),ft,lt,gt,mt={proj:"projName",datum:"datumCode",rf:function(yt){A.rf=parseFloat(yt)},lat_0:function(yt){A.lat0=yt*c},lat_1:function(yt){A.lat1=yt*c},lat_2:function(yt){A.lat2=yt*c},lat_ts:function(yt){A.lat_ts=yt*c},lon_0:function(yt){A.long0=yt*c},lon_1:function(yt){A.long1=yt*c},lon_2:function(yt){A.long2=yt*c},alpha:function(yt){A.alpha=parseFloat(yt)*c},lonc:function(yt){A.longc=yt*c},x_0:function(yt){A.x0=parseFloat(yt)},y_0:function(yt){A.y0=parseFloat(yt)},k_0:function(yt){A.k0=parseFloat(yt)},k:function(yt){A.k0=parseFloat(yt)},a:function(yt){A.a=parseFloat(yt)},b:function(yt){A.b=parseFloat(yt)},r_a:function(){A.R_A=!0},zone:function(yt){A.zone=parseInt(yt,10)},south:function(){A.utmSouth=!0},towgs84:function(yt){A.datum_params=yt.split(",").map(function(It){return parseFloat(It)})},to_meter:function(yt){A.to_meter=parseFloat(yt)},units:function(yt){A.units=yt;var It=v(_,yt);It&&(A.to_meter=It.to_meter)},from_greenwich:function(yt){A.from_greenwich=yt*c},pm:function(yt){var It=v(g,yt);A.from_greenwich=(It||parseFloat(yt))*c},nadgrids:function(yt){yt==="@null"?A.datumCode="none":A.nadgrids=yt},axis:function(yt){var It="ewnsud";yt.length===3&&It.indexOf(yt.substr(0,1))!==-1&&It.indexOf(yt.substr(1,1))!==-1&&It.indexOf(yt.substr(2,1))!==-1&&(A.axis=yt)}};for(ft in U)lt=U[ft],ft in mt?(gt=mt[ft],typeof gt=="function"?gt(lt):A[gt]=lt):A[ft]=lt;return typeof A.datumCode=="string"&&A.datumCode!=="WGS84"&&(A.datumCode=A.datumCode.toLowerCase()),A},R=1,M=2,P=3,T=4,E=5,x=-1,S=/\s/,L=/[A-Za-z]/,C=/[A-Za-z84]/,F=/[,\]]/,q=/[\d\.E\-\+]/;function it(w){if(typeof w!="string")throw new Error("not a string");this.text=w.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=R}it.prototype.readCharicter=function(){var w=this.text[this.place++];if(this.state!==T)for(;S.test(w);){if(this.place>=this.text.length)return;w=this.text[this.place++]}switch(this.state){case R:return this.neutral(w);case M:return this.keyword(w);case T:return this.quoted(w);case E:return this.afterquote(w);case P:return this.number(w);case x:return}},it.prototype.afterquote=function(w){if(w==='"'){this.word+='"',this.state=T;return}if(F.test(w)){this.word=this.word.trim(),this.afterItem(w);return}throw new Error("havn't handled \""+w+'" in afterquote yet, index '+this.place)},it.prototype.afterItem=function(w){if(w===","){this.word!==null&&this.currentObject.push(this.word),this.word=null,this.state=R;return}if(w==="]"){this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=R,this.currentObject=this.stack.pop(),this.currentObject||(this.state=x);return}},it.prototype.number=function(w){if(q.test(w)){this.word+=w;return}if(F.test(w)){this.word=parseFloat(this.word),this.afterItem(w);return}throw new Error("havn't handled \""+w+'" in number yet, index '+this.place)},it.prototype.quoted=function(w){if(w==='"'){this.state=E;return}this.word+=w},it.prototype.keyword=function(w){if(C.test(w)){this.word+=w;return}if(w==="["){var A=[];A.push(this.word),this.level++,this.root===null?this.root=A:this.currentObject.push(A),this.stack.push(this.currentObject),this.currentObject=A,this.state=R;return}if(F.test(w)){this.afterItem(w);return}throw new Error("havn't handled \""+w+'" in keyword yet, index '+this.place)},it.prototype.neutral=function(w){if(L.test(w)){this.word=w,this.state=M;return}if(w==='"'){this.word="",this.state=T;return}if(q.test(w)){this.word=w,this.state=P;return}if(F.test(w)){this.afterItem(w);return}throw new Error("havn't handled \""+w+'" in neutral yet, index '+this.place)},it.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===x)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function st(w){var A=new it(w);return A.output()}function pt(w,A,U){Array.isArray(A)&&(U.unshift(A),A=null);var ft=A?{}:w,lt=U.reduce(function(gt,mt){return _t(mt,gt),gt},ft);A&&(w[A]=lt)}function _t(w,A){if(!Array.isArray(w)){A[w]=!0;return}var U=w.shift();if(U==="PARAMETER"&&(U=w.shift()),w.length===1){if(Array.isArray(w[0])){A[U]={},_t(w[0],A[U]);return}A[U]=w[0];return}if(!w.length){A[U]=!0;return}if(U==="TOWGS84"){A[U]=w;return}Array.isArray(U)||(A[U]={});var ft;switch(U){case"UNIT":case"PRIMEM":case"VERT_DATUM":A[U]={name:w[0].toLowerCase(),convert:w[1]},w.length===3&&_t(w[2],A[U]);return;case"SPHEROID":case"ELLIPSOID":A[U]={name:w[0],a:w[1],rf:w[2]},w.length===4&&_t(w[3],A[U]);return;case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":w[0]=["name",w[0]],pt(A,U,w);return;default:for(ft=-1;++ft<w.length;)if(!Array.isArray(w[ft]))return _t(w,A[U]);return pt(A,U,w)}}var X=.017453292519943295;function ot(w,A){var U=A[0],ft=A[1];!(U in w)&&ft in w&&(w[U]=w[ft],A.length===3&&(w[U]=A[2](w[U])))}function Tt(w){return w*X}function Vt(w){w.type==="GEOGCS"?w.projName="longlat":w.type==="LOCAL_CS"?(w.projName="identity",w.local=!0):typeof w.PROJECTION=="object"?w.projName=Object.keys(w.PROJECTION)[0]:w.projName=w.PROJECTION,w.UNIT&&(w.units=w.UNIT.name.toLowerCase(),w.units==="metre"&&(w.units="meter"),w.UNIT.convert&&(w.type==="GEOGCS"?w.DATUM&&w.DATUM.SPHEROID&&(w.to_meter=w.UNIT.convert*w.DATUM.SPHEROID.a):w.to_meter=w.UNIT.convert));var A=w.GEOGCS;w.type==="GEOGCS"&&(A=w),A&&(A.DATUM?w.datumCode=A.DATUM.name.toLowerCase():w.datumCode=A.name.toLowerCase(),w.datumCode.slice(0,2)==="d_"&&(w.datumCode=w.datumCode.slice(2)),(w.datumCode==="new_zealand_geodetic_datum_1949"||w.datumCode==="new_zealand_1949")&&(w.datumCode="nzgd49"),w.datumCode==="wgs_1984"&&(w.PROJECTION==="Mercator_Auxiliary_Sphere"&&(w.sphere=!0),w.datumCode="wgs84"),w.datumCode.slice(-6)==="_ferro"&&(w.datumCode=w.datumCode.slice(0,-6)),w.datumCode.slice(-8)==="_jakarta"&&(w.datumCode=w.datumCode.slice(0,-8)),~w.datumCode.indexOf("belge")&&(w.datumCode="rnb72"),A.DATUM&&A.DATUM.SPHEROID&&(w.ellps=A.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),w.ellps.toLowerCase().slice(0,13)==="international"&&(w.ellps="intl"),w.a=A.DATUM.SPHEROID.a,w.rf=parseFloat(A.DATUM.SPHEROID.rf,10)),~w.datumCode.indexOf("osgb_1936")&&(w.datumCode="osgb36")),w.b&&!isFinite(w.b)&&(w.b=w.a);function U(gt){var mt=w.to_meter||1;return gt*mt}var ft=function(gt){return ot(w,gt)},lt=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",Tt],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",Tt],["x0","false_easting",U],["y0","false_northing",U],["long0","central_meridian",Tt],["lat0","latitude_of_origin",Tt],["lat0","standard_parallel_1",Tt],["lat1","standard_parallel_1",Tt],["lat2","standard_parallel_2",Tt],["alpha","azimuth",Tt],["srsCode","name"]];lt.forEach(ft),!w.long0&&w.longc&&(w.projName==="Albers_Conic_Equal_Area"||w.projName==="Lambert_Azimuthal_Equal_Area")&&(w.long0=w.longc),!w.lat_ts&&w.lat1&&(w.projName==="Stereographic_South_Pole"||w.projName==="Polar Stereographic (variant B)")&&(w.lat0=Tt(w.lat1>0?90:-90),w.lat_ts=w.lat1)}var Gt=function(w){var A=st(w),U=A.shift(),ft=A.shift();A.unshift(["name",ft]),A.unshift(["type",U]);var lt={};return _t(A,lt),Vt(lt),lt};function qt(w){var A=this;if(arguments.length===2){var U=arguments[1];typeof U=="string"?U.charAt(0)==="+"?qt[w]=b(arguments[1]):qt[w]=Gt(arguments[1]):qt[w]=U}else if(arguments.length===1){if(Array.isArray(w))return w.map(function(ft){Array.isArray(ft)?qt.apply(A,ft):qt(ft)});if(typeof w=="string"){if(w in qt)return qt[w]}else"EPSG"in w?qt["EPSG:"+w.EPSG]=w:"ESRI"in w?qt["ESRI:"+w.ESRI]=w:"IAU2000"in w?qt["IAU2000:"+w.IAU2000]=w:console.log(w);return}}p(qt);function Qt(w){return typeof w=="string"}function ne(w){return w in qt}var j=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function J(w){return j.some(function(A){return w.indexOf(A)>-1})}function at(w){return w[0]==="+"}function xt(w){if(Qt(w)){if(ne(w))return qt[w];if(J(w))return Gt(w);if(at(w))return b(w)}else return w}var Rt=function(w,A){w=w||{};var U,ft;if(!A)return w;for(ft in A)U=A[ft],U!==void 0&&(w[ft]=U);return w},Lt=function(w,A,U){var ft=w*A;return U/Math.sqrt(1-ft*ft)},te=function(w){return w<0?-1:1},zt=function(w){return Math.abs(w)<=m?w:w-te(w)*u},ee=function(w,A,U){var ft=w*U,lt=.5*w;return ft=Math.pow((1-ft)/(1+ft),lt),Math.tan(.5*(r-A))/ft},$=function(w,A){for(var U=.5*w,ft,lt,gt=r-2*Math.atan(A),mt=0;mt<=15;mt++)if(ft=w*Math.sin(gt),lt=r-2*Math.atan(A*Math.pow((1-ft)/(1+ft),U))-gt,gt+=lt,Math.abs(lt)<=1e-10)return gt;return-9999};function N(){var w=this.b/this.a;this.es=1-w*w,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Lt(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)}function K(w){var A=w.x,U=w.y;if(U*d>90&&U*d<-90&&A*d>180&&A*d<-180)return null;var ft,lt;if(Math.abs(Math.abs(U)-r)<=o)return null;if(this.sphere)ft=this.x0+this.a*this.k0*zt(A-this.long0),lt=this.y0+this.a*this.k0*Math.log(Math.tan(h+.5*U));else{var gt=Math.sin(U),mt=ee(this.e,U,gt);ft=this.x0+this.a*this.k0*zt(A-this.long0),lt=this.y0-this.a*this.k0*Math.log(mt)}return w.x=ft,w.y=lt,w}function k(w){var A=w.x-this.x0,U=w.y-this.y0,ft,lt;if(this.sphere)lt=r-2*Math.atan(Math.exp(-U/(this.a*this.k0)));else{var gt=Math.exp(-U/(this.a*this.k0));if(lt=$(this.e,gt),lt===-9999)return null}return ft=zt(this.long0+A/(this.a*this.k0)),w.x=ft,w.y=lt,w}var Y=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"],ht={init:N,forward:K,inverse:k,names:Y};function wt(){}function Et(w){return w}var Mt=["longlat","identity"],Dt={init:wt,forward:Et,inverse:Et,names:Mt},At=[ht,Dt],Xt={},ie=[];function le(w,A){var U=ie.length;return w.names?(ie[U]=w,w.names.forEach(function(ft){Xt[ft.toLowerCase()]=U}),this):(console.log(A),!0)}function W(w){if(!w)return!1;var A=w.toLowerCase();if(typeof Xt[A]<"u"&&ie[Xt[A]])return ie[Xt[A]]}function ct(){At.forEach(le)}var z={start:ct,add:le,get:W},nt={};nt.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},nt.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},nt.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},nt.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},nt.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},nt.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},nt.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},nt.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},nt.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},nt.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},nt.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},nt.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},nt.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},nt.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},nt.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},nt.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},nt.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},nt.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},nt.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},nt.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},nt.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},nt.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},nt.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},nt.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},nt.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},nt.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},nt.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},nt.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},nt.hough={a:6378270,rf:297,ellipseName:"Hough"},nt.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},nt.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},nt.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},nt.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},nt.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},nt.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},nt.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},nt.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},nt.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},nt.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},nt.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},nt.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Ht=nt.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};nt.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};function Kt(w,A,U,ft){var lt=w*w,gt=A*A,mt=(lt-gt)/lt,yt=0;ft?(w*=1-mt*(s+mt*(a+mt*f)),lt=w*w,mt=0):yt=Math.sqrt(mt);var It=(lt-gt)/gt;return{es:mt,e:yt,ep2:It}}function fe(w,A,U,ft,lt){if(!w){var gt=v(nt,ft);gt||(gt=Ht),w=gt.a,A=gt.b,U=gt.rf}return U&&!A&&(A=(1-1/U)*w),(U===0||Math.abs(w-A)<o)&&(lt=!0,A=w),{a:w,b:A,rf:U,sphere:lt}}var Ft={};Ft.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},Ft.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},Ft.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},Ft.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},Ft.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},Ft.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},Ft.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},Ft.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},Ft.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},Ft.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},Ft.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},Ft.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},Ft.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},Ft.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},Ft.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},Ft.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};function he(w,A,U,ft,lt,gt){var mt={};return w===void 0||w==="none"?mt.datum_type=i:mt.datum_type=e,A&&(mt.datum_params=A.map(parseFloat),(mt.datum_params[0]!==0||mt.datum_params[1]!==0||mt.datum_params[2]!==0)&&(mt.datum_type=l),mt.datum_params.length>3&&(mt.datum_params[3]!==0||mt.datum_params[4]!==0||mt.datum_params[5]!==0||mt.datum_params[6]!==0)&&(mt.datum_type=n,mt.datum_params[3]*=t,mt.datum_params[4]*=t,mt.datum_params[5]*=t,mt.datum_params[6]=mt.datum_params[6]/1e6+1)),mt.a=U,mt.b=ft,mt.es=lt,mt.ep2=gt,mt}function Bt(w,A){if(!(this instanceof Bt))return new Bt(w);A=A||function(It){if(It)throw It};var U=xt(w);if(typeof U!="object"){A(w);return}var ft=Bt.projections.get(U.projName);if(!ft){A(w);return}if(U.datumCode&&U.datumCode!=="none"){var lt=v(Ft,U.datumCode);lt&&(U.datum_params=lt.towgs84?lt.towgs84.split(","):null,U.ellps=lt.ellipse,U.datumName=lt.datumName?lt.datumName:U.datumCode)}U.k0=U.k0||1,U.axis=U.axis||"enu",U.ellps=U.ellps||"wgs84";var gt=fe(U.a,U.b,U.rf,U.ellps,U.sphere),mt=Kt(gt.a,gt.b,gt.rf,U.R_A),yt=U.datum||he(U.datumCode,U.datum_params,gt.a,gt.b,mt.es,mt.ep2);Rt(this,U),Rt(this,ft),this.a=gt.a,this.b=gt.b,this.rf=gt.rf,this.sphere=gt.sphere,this.es=mt.es,this.e=mt.e,this.ep2=mt.ep2,this.datum=yt,this.init(),A(null,this)}Bt.projections=z,Bt.projections.start();function $t(w,A){return w.datum_type!==A.datum_type||w.a!==A.a||Math.abs(w.es-A.es)>5e-11?!1:w.datum_type===l?w.datum_params[0]===A.datum_params[0]&&w.datum_params[1]===A.datum_params[1]&&w.datum_params[2]===A.datum_params[2]:w.datum_type===n?w.datum_params[0]===A.datum_params[0]&&w.datum_params[1]===A.datum_params[1]&&w.datum_params[2]===A.datum_params[2]&&w.datum_params[3]===A.datum_params[3]&&w.datum_params[4]===A.datum_params[4]&&w.datum_params[5]===A.datum_params[5]&&w.datum_params[6]===A.datum_params[6]:!0}function Ue(w,A,U){var ft=w.x,lt=w.y,gt=w.z?w.z:0,mt,yt,It,jt;if(lt<-r&&lt>-1.001*r)lt=-r;else if(lt>r&&lt<1.001*r)lt=r;else if(lt<-r||lt>r)return null;return ft>Math.PI&&(ft-=2*Math.PI),yt=Math.sin(lt),jt=Math.cos(lt),It=yt*yt,mt=U/Math.sqrt(1-A*It),{x:(mt+gt)*jt*Math.cos(ft),y:(mt+gt)*jt*Math.sin(ft),z:(mt*(1-A)+gt)*yt}}function Ee(w,A,U,ft){var lt=1e-12,gt=lt*lt,mt=30,yt,It,jt,re,Jt,ae,be,ye,ve,we,Ae,De,Be,ti=w.x,qe=w.y,Ye=w.z?w.z:0,pi,ui,xi;if(yt=Math.sqrt(ti*ti+qe*qe),It=Math.sqrt(ti*ti+qe*qe+Ye*Ye),yt/U<lt){if(pi=0,It/U<lt)return ui=r,xi=-ft,{x:w.x,y:w.y,z:w.z}}else pi=Math.atan2(qe,ti);jt=Ye/It,re=yt/It,Jt=1/Math.sqrt(1-A*(2-A)*re*re),ye=re*(1-A)*Jt,ve=jt*Jt,Be=0;do Be++,be=U/Math.sqrt(1-A*ve*ve),xi=yt*ye+Ye*ve-be*(1-A*ve*ve),ae=A*be/(be+xi),Jt=1/Math.sqrt(1-ae*(2-ae)*re*re),we=re*(1-ae)*Jt,Ae=jt*Jt,De=Ae*ye-we*ve,ye=we,ve=Ae;while(De*De>gt&&Be<mt);return ui=Math.atan(Ae/Math.abs(we)),{x:pi,y:ui,z:xi}}function pe(w,A,U){if(A===l)return{x:w.x+U[0],y:w.y+U[1],z:w.z+U[2]};if(A===n){var ft=U[0],lt=U[1],gt=U[2],mt=U[3],yt=U[4],It=U[5],jt=U[6];return{x:jt*(w.x-It*w.y+yt*w.z)+ft,y:jt*(It*w.x+w.y-mt*w.z)+lt,z:jt*(-yt*w.x+mt*w.y+w.z)+gt}}}function Ie(w,A,U){if(A===l)return{x:w.x-U[0],y:w.y-U[1],z:w.z-U[2]};if(A===n){var ft=U[0],lt=U[1],gt=U[2],mt=U[3],yt=U[4],It=U[5],jt=U[6],re=(w.x-ft)/jt,Jt=(w.y-lt)/jt,ae=(w.z-gt)/jt;return{x:re+It*Jt-yt*ae,y:-It*re+Jt+mt*ae,z:yt*re-mt*Jt+ae}}}function Qe(w){return w===l||w===n}var Oe=function(w,A,U){return $t(w,A)||w.datum_type===i||A.datum_type===i||w.es===A.es&&w.a===A.a&&!Qe(w.datum_type)&&!Qe(A.datum_type)?U:(U=Ue(U,w.es,w.a),Qe(w.datum_type)&&(U=pe(U,w.datum_type,w.datum_params)),Qe(A.datum_type)&&(U=Ie(U,A.datum_type,A.datum_params)),Ee(U,A.es,A.a,A.b))},$e=function(w,A,U){var ft=U.x,lt=U.y,gt=U.z||0,mt,yt,It,jt={};for(It=0;It<3;It++)if(!(A&&It===2&&U.z===void 0))switch(It===0?(mt=ft,yt="x"):It===1?(mt=lt,yt="y"):(mt=gt,yt="z"),w.axis[It]){case"e":jt[yt]=mt;break;case"w":jt[yt]=-mt;break;case"n":jt[yt]=mt;break;case"s":jt[yt]=-mt;break;case"u":U[yt]!==void 0&&(jt.z=mt);break;case"d":U[yt]!==void 0&&(jt.z=-mt);break;default:return null}return jt},Fe=function(w){var A={x:w[0],y:w[1]};return w.length>2&&(A.z=w[2]),w.length>3&&(A.m=w[3]),A};function ii(w,A){return(w.datum.datum_type===l||w.datum.datum_type===n)&&A.datumCode!=="WGS84"||(A.datum.datum_type===l||A.datum.datum_type===n)&&w.datumCode!=="WGS84"}function ni(w,A,U){var ft;return Array.isArray(U)&&(U=Fe(U)),w.datum&&A.datum&&ii(w,A)&&(ft=new Bt("WGS84"),U=ni(w,ft,U),w=ft),w.axis!=="enu"&&(U=$e(w,!1,U)),w.projName==="longlat"?U={x:U.x*c,y:U.y*c}:(w.to_meter&&(U={x:U.x*w.to_meter,y:U.y*w.to_meter}),U=w.inverse(U)),w.from_greenwich&&(U.x+=w.from_greenwich),U=Oe(w.datum,A.datum,U),A.from_greenwich&&(U={x:U.x-A.from_greenwich,y:U.y}),A.projName==="longlat"?U={x:U.x*d,y:U.y*d}:(U=A.forward(U),A.to_meter&&(U={x:U.x/A.to_meter,y:U.y/A.to_meter})),A.axis!=="enu"?$e(A,!0,U):U}var _i=Bt("WGS84");function Ge(w,A,U){var ft;return Array.isArray(U)?(ft=ni(w,A,U),U.length===3?[ft.x,ft.y,ft.z]:[ft.x,ft.y]):ni(w,A,U)}function Je(w){return w instanceof Bt?w:w.oProj?w.oProj:Bt(w)}function ze(w,A,U){w=Je(w);var ft=!1,lt;return typeof A>"u"?(A=w,w=_i,ft=!0):(typeof A.x<"u"||Array.isArray(A))&&(U=A,A=w,w=_i,ft=!0),A=Je(A),U?Ge(w,A,U):(lt={forward:function(gt){return Ge(w,A,gt)},inverse:function(gt){return Ge(A,w,gt)}},ft&&(lt.oProj=A),lt)}var ri=6,je="AJSAJS",He="AFAFAF",li=65,ai=73,si=79,yi=86,gi=90,ki={forward:vi,inverse:et,toPoint:Z};function vi(w,A){return A=A||5,Q(V({lat:w[1],lon:w[0]}),A)}function et(w){var A=H(Pt(w.toUpperCase()));return A.lat&&A.lon?[A.lon,A.lat,A.lon,A.lat]:[A.left,A.bottom,A.right,A.top]}function Z(w){var A=H(Pt(w.toUpperCase()));return A.lat&&A.lon?[A.lon,A.lat]:[(A.left+A.right)/2,(A.top+A.bottom)/2]}function O(w){return w*(Math.PI/180)}function I(w){return 180*(w/Math.PI)}function V(w){var A=w.lat,U=w.lon,ft=6378137,lt=.00669438,gt=.9996,mt,yt,It,jt,re,Jt,ae,be=O(A),ye=O(U),ve,we;we=Math.floor((U+180)/6)+1,U===180&&(we=60),A>=56&&A<64&&U>=3&&U<12&&(we=32),A>=72&&A<84&&(U>=0&&U<9?we=31:U>=9&&U<21?we=33:U>=21&&U<33?we=35:U>=33&&U<42&&(we=37)),mt=(we-1)*6-180+3,ve=O(mt),yt=lt/(1-lt),It=ft/Math.sqrt(1-lt*Math.sin(be)*Math.sin(be)),jt=Math.tan(be)*Math.tan(be),re=yt*Math.cos(be)*Math.cos(be),Jt=Math.cos(be)*(ye-ve),ae=ft*((1-lt/4-3*lt*lt/64-5*lt*lt*lt/256)*be-(3*lt/8+3*lt*lt/32+45*lt*lt*lt/1024)*Math.sin(2*be)+(15*lt*lt/256+45*lt*lt*lt/1024)*Math.sin(4*be)-35*lt*lt*lt/3072*Math.sin(6*be));var Ae=gt*It*(Jt+(1-jt+re)*Jt*Jt*Jt/6+(5-18*jt+jt*jt+72*re-58*yt)*Jt*Jt*Jt*Jt*Jt/120)+5e5,De=gt*(ae+It*Math.tan(be)*(Jt*Jt/2+(5-jt+9*re+4*re*re)*Jt*Jt*Jt*Jt/24+(61-58*jt+jt*jt+600*re-330*yt)*Jt*Jt*Jt*Jt*Jt*Jt/720));return A<0&&(De+=1e7),{northing:Math.round(De),easting:Math.round(Ae),zoneNumber:we,zoneLetter:G(A)}}function H(w){var A=w.northing,U=w.easting,ft=w.zoneLetter,lt=w.zoneNumber;if(lt<0||lt>60)return null;var gt=.9996,mt=6378137,yt=.00669438,It,jt=(1-Math.sqrt(1-yt))/(1+Math.sqrt(1-yt)),re,Jt,ae,be,ye,ve,we,Ae,De,Be=U-5e5,ti=A;ft<"N"&&(ti-=1e7),we=(lt-1)*6-180+3,It=yt/(1-yt),ve=ti/gt,Ae=ve/(mt*(1-yt/4-3*yt*yt/64-5*yt*yt*yt/256)),De=Ae+(3*jt/2-27*jt*jt*jt/32)*Math.sin(2*Ae)+(21*jt*jt/16-55*jt*jt*jt*jt/32)*Math.sin(4*Ae)+151*jt*jt*jt/96*Math.sin(6*Ae),re=mt/Math.sqrt(1-yt*Math.sin(De)*Math.sin(De)),Jt=Math.tan(De)*Math.tan(De),ae=It*Math.cos(De)*Math.cos(De),be=mt*(1-yt)/Math.pow(1-yt*Math.sin(De)*Math.sin(De),1.5),ye=Be/(re*gt);var qe=De-re*Math.tan(De)/be*(ye*ye/2-(5+3*Jt+10*ae-4*ae*ae-9*It)*ye*ye*ye*ye/24+(61+90*Jt+298*ae+45*Jt*Jt-252*It-3*ae*ae)*ye*ye*ye*ye*ye*ye/720);qe=I(qe);var Ye=(ye-(1+2*Jt+ae)*ye*ye*ye/6+(5-2*ae+28*Jt-3*ae*ae+8*It+24*Jt*Jt)*ye*ye*ye*ye*ye/120)/Math.cos(De);Ye=we+I(Ye);var pi;if(w.accuracy){var ui=H({northing:w.northing+w.accuracy,easting:w.easting+w.accuracy,zoneLetter:w.zoneLetter,zoneNumber:w.zoneNumber});pi={top:ui.lat,right:ui.lon,bottom:qe,left:Ye}}else pi={lat:qe,lon:Ye};return pi}function G(w){var A="Z";return 84>=w&&w>=72?A="X":72>w&&w>=64?A="W":64>w&&w>=56?A="V":56>w&&w>=48?A="U":48>w&&w>=40?A="T":40>w&&w>=32?A="S":32>w&&w>=24?A="R":24>w&&w>=16?A="Q":16>w&&w>=8?A="P":8>w&&w>=0?A="N":0>w&&w>=-8?A="M":-8>w&&w>=-16?A="L":-16>w&&w>=-24?A="K":-24>w&&w>=-32?A="J":-32>w&&w>=-40?A="H":-40>w&&w>=-48?A="G":-48>w&&w>=-56?A="F":-56>w&&w>=-64?A="E":-64>w&&w>=-72?A="D":-72>w&&w>=-80&&(A="C"),A}function Q(w,A){var U="00000"+w.easting,ft="00000"+w.northing;return w.zoneNumber+w.zoneLetter+tt(w.easting,w.northing,w.zoneNumber)+U.substr(U.length-5,A)+ft.substr(ft.length-5,A)}function tt(w,A,U){var ft=ut(U),lt=Math.floor(w/1e5),gt=Math.floor(A/1e5)%20;return dt(lt,gt,ft)}function ut(w){var A=w%ri;return A===0&&(A=ri),A}function dt(w,A,U){var ft=U-1,lt=je.charCodeAt(ft),gt=He.charCodeAt(ft),mt=lt+w-1,yt=gt+A,It=!1;mt>gi&&(mt=mt-gi+li-1,It=!0),(mt===ai||lt<ai&&mt>ai||(mt>ai||lt<ai)&&It)&&mt++,(mt===si||lt<si&&mt>si||(mt>si||lt<si)&&It)&&(mt++,mt===ai&&mt++),mt>gi&&(mt=mt-gi+li-1),yt>yi?(yt=yt-yi+li-1,It=!0):It=!1,(yt===ai||gt<ai&&yt>ai||(yt>ai||gt<ai)&&It)&&yt++,(yt===si||gt<si&&yt>si||(yt>si||gt<si)&&It)&&(yt++,yt===ai&&yt++),yt>yi&&(yt=yt-yi+li-1);var jt=String.fromCharCode(mt)+String.fromCharCode(yt);return jt}function Pt(w){if(w&&w.length===0)throw"MGRSPoint coverting from nothing";for(var A=w.length,U=null,ft="",lt,gt=0;!/[A-Z]/.test(lt=w.charAt(gt));){if(gt>=2)throw"MGRSPoint bad conversion from: "+w;ft+=lt,gt++}var mt=parseInt(ft,10);if(gt===0||gt+3>A)throw"MGRSPoint bad conversion from: "+w;var yt=w.charAt(gt++);if(yt<="A"||yt==="B"||yt==="Y"||yt>="Z"||yt==="I"||yt==="O")throw"MGRSPoint zone letter "+yt+" not handled: "+w;U=w.substring(gt,gt+=2);for(var It=ut(mt),jt=bt(U.charAt(0),It),re=Ct(U.charAt(1),It);re<kt(yt);)re+=2e6;var Jt=A-gt;if(Jt%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+w;var ae=Jt/2,be=0,ye=0,ve,we,Ae,De,Be;return ae>0&&(ve=1e5/Math.pow(10,ae),we=w.substring(gt,gt+ae),be=parseFloat(we)*ve,Ae=w.substring(gt+ae),ye=parseFloat(Ae)*ve),De=be+jt,Be=ye+re,{easting:De,northing:Be,zoneLetter:yt,zoneNumber:mt,accuracy:ve}}function bt(w,A){for(var U=je.charCodeAt(A-1),ft=1e5,lt=!1;U!==w.charCodeAt(0);){if(U++,U===ai&&U++,U===si&&U++,U>gi){if(lt)throw"Bad character: "+w;U=li,lt=!0}ft+=1e5}return ft}function Ct(w,A){if(w>"V")throw"MGRSPoint given invalid Northing "+w;for(var U=He.charCodeAt(A-1),ft=0,lt=!1;U!==w.charCodeAt(0);){if(U++,U===ai&&U++,U===si&&U++,U>yi){if(lt)throw"Bad character: "+w;U=li,lt=!0}ft+=1e5}return ft}function kt(w){var A;switch(w){case"C":A=11e5;break;case"D":A=2e6;break;case"E":A=28e5;break;case"F":A=37e5;break;case"G":A=46e5;break;case"H":A=55e5;break;case"J":A=64e5;break;case"K":A=73e5;break;case"L":A=82e5;break;case"M":A=91e5;break;case"N":A=0;break;case"P":A=8e5;break;case"Q":A=17e5;break;case"R":A=26e5;break;case"S":A=35e5;break;case"T":A=44e5;break;case"U":A=53e5;break;case"V":A=62e5;break;case"W":A=7e6;break;case"X":A=79e5;break;default:A=-1}if(A>=0)return A;throw"Invalid zone letter: "+w}function Ot(w,A,U){if(!(this instanceof Ot))return new Ot(w,A,U);if(Array.isArray(w))this.x=w[0],this.y=w[1],this.z=w[2]||0;else if(typeof w=="object")this.x=w.x,this.y=w.y,this.z=w.z||0;else if(typeof w=="string"&&typeof A>"u"){var ft=w.split(",");this.x=parseFloat(ft[0],10),this.y=parseFloat(ft[1],10),this.z=parseFloat(ft[2],10)||0}else this.x=w,this.y=A,this.z=U||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Ot.fromMGRS=function(w){return new Ot(Z(w))},Ot.prototype.toMGRS=function(w){return vi([this.x,this.y],w)};var Wt="2.4.3",Ut=1,Nt=.25,Yt=.046875,Zt=.01953125,se=.01068115234375,oe=.75,ue=.46875,ce=.013020833333333334,ge=.007120768229166667,_e=.3645833333333333,Pe=.005696614583333333,Se=.3076171875,We=function(w){var A=[];A[0]=Ut-w*(Nt+w*(Yt+w*(Zt+w*se))),A[1]=w*(oe-w*(Yt+w*(Zt+w*se)));var U=w*w;return A[2]=U*(ue-w*(ce+w*ge)),U*=w,A[3]=U*(_e-w*Pe),A[4]=U*w*Se,A},Ve=function(w,A,U,ft){return U*=A,A*=A,ft[0]*w-U*(ft[1]+A*(ft[2]+A*(ft[3]+A*ft[4])))},me=20,Le=function(w,A,U){for(var ft=1/(1-A),lt=w,gt=me;gt;--gt){var mt=Math.sin(lt),yt=1-A*mt*mt;if(yt=(Ve(lt,mt,Math.cos(lt),U)-w)*(yt*Math.sqrt(yt))*ft,lt-=yt,Math.abs(yt)<o)return lt}return lt};function de(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=We(this.es),this.ml0=Ve(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))}function ke(w){var A=w.x,U=w.y,ft=zt(A-this.long0),lt,gt,mt,yt=Math.sin(U),It=Math.cos(U);if(this.es){var re=It*ft,Jt=Math.pow(re,2),ae=this.ep2*Math.pow(It,2),be=Math.pow(ae,2),ye=Math.abs(It)>o?Math.tan(U):0,ve=Math.pow(ye,2),we=Math.pow(ve,2);lt=1-this.es*Math.pow(yt,2),re=re/Math.sqrt(lt);var Ae=Ve(U,yt,It,this.en);gt=this.a*(this.k0*re*(1+Jt/6*(1-ve+ae+Jt/20*(5-18*ve+we+14*ae-58*ve*ae+Jt/42*(61+179*we-we*ve-479*ve)))))+this.x0,mt=this.a*(this.k0*(Ae-this.ml0+yt*ft*re/2*(1+Jt/12*(5-ve+9*ae+4*be+Jt/30*(61+we-58*ve+270*ae-330*ve*ae+Jt/56*(1385+543*we-we*ve-3111*ve))))))+this.y0}else{var jt=It*Math.sin(ft);if(Math.abs(Math.abs(jt)-1)<o)return 93;if(gt=.5*this.a*this.k0*Math.log((1+jt)/(1-jt))+this.x0,mt=It*Math.cos(ft)/Math.sqrt(1-Math.pow(jt,2)),jt=Math.abs(mt),jt>=1){if(jt-1>o)return 93;mt=0}else mt=Math.acos(mt);U<0&&(mt=-mt),mt=this.a*this.k0*(mt-this.lat0)+this.y0}return w.x=gt,w.y=mt,w}function Ne(w){var A,U,ft,lt,gt=(w.x-this.x0)*(1/this.a),mt=(w.y-this.y0)*(1/this.a);if(this.es)if(A=this.ml0+mt/this.k0,U=Le(A,this.es,this.en),Math.abs(U)<r){var Jt=Math.sin(U),ae=Math.cos(U),be=Math.abs(ae)>o?Math.tan(U):0,ye=this.ep2*Math.pow(ae,2),ve=Math.pow(ye,2),we=Math.pow(be,2),Ae=Math.pow(we,2);A=1-this.es*Math.pow(Jt,2);var De=gt*Math.sqrt(A)/this.k0,Be=Math.pow(De,2);A=A*be,ft=U-A*Be/(1-this.es)*.5*(1-Be/12*(5+3*we-9*ye*we+ye-4*ve-Be/30*(61+90*we-252*ye*we+45*Ae+46*ye-Be/56*(1385+3633*we+4095*Ae+1574*Ae*we)))),lt=zt(this.long0+De*(1-Be/6*(1+2*we+ye-Be/20*(5+28*we+24*Ae+8*ye*we+6*ye-Be/42*(61+662*we+1320*Ae+720*Ae*we))))/ae)}else ft=r*te(mt),lt=0;else{var yt=Math.exp(gt/this.k0),It=.5*(yt-1/yt),jt=this.lat0+mt/this.k0,re=Math.cos(jt);A=Math.sqrt((1-Math.pow(re,2))/(1+Math.pow(It,2))),ft=Math.asin(A),mt<0&&(ft=-ft),It===0&&re===0?lt=0:lt=zt(Math.atan2(It,re)+this.long0)}return w.x=lt,w.y=ft,w}var Re=["Transverse_Mercator","Transverse Mercator","tmerc"],xe={init:de,forward:ke,inverse:Ne,names:Re},Me=function(w){var A=Math.exp(w);return A=(A-1/A)/2,A},Te=function(w,A){w=Math.abs(w),A=Math.abs(A);var U=Math.max(w,A),ft=Math.min(w,A)/(U||1);return U*Math.sqrt(1+Math.pow(ft,2))},hi=function(w){var A=1+w,U=A-1;return U===0?w:w*Math.log(A)/U},Ze=function(w){var A=Math.abs(w);return A=hi(A*(1+A/(Te(1,A)+1))),w<0?-A:A},ci=function(w,A){for(var U=2*Math.cos(2*A),ft=w.length-1,lt=w[ft],gt=0,mt;--ft>=0;)mt=-gt+U*lt+w[ft],gt=lt,lt=mt;return A+mt*Math.sin(2*A)},Ri=function(w,A){for(var U=2*Math.cos(A),ft=w.length-1,lt=w[ft],gt=0,mt;--ft>=0;)mt=-gt+U*lt+w[ft],gt=lt,lt=mt;return Math.sin(A)*mt},Mi=function(w){var A=Math.exp(w);return A=(A+1/A)/2,A},ir=function(w,A,U){for(var ft=Math.sin(A),lt=Math.cos(A),gt=Me(U),mt=Mi(U),yt=2*lt*mt,It=-2*ft*gt,jt=w.length-1,re=w[jt],Jt=0,ae=0,be=0,ye,ve;--jt>=0;)ye=ae,ve=Jt,ae=re,Jt=be,re=-ye+yt*ae-It*Jt+w[jt],be=-ve+It*ae+yt*Jt;return yt=ft*mt,It=lt*gt,[yt*re-It*be,yt*be+It*re]};function or(){if(this.es===void 0||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var w=this.es/(1+Math.sqrt(1-this.es)),A=w/(2-w),U=A;this.cgb[0]=A*(2+A*(-2/3+A*(-2+A*(116/45+A*(26/45+A*(-2854/675)))))),this.cbg[0]=A*(-2+A*(2/3+A*(4/3+A*(-82/45+A*(32/45+A*(4642/4725)))))),U=U*A,this.cgb[1]=U*(7/3+A*(-8/5+A*(-227/45+A*(2704/315+A*(2323/945))))),this.cbg[1]=U*(5/3+A*(-16/15+A*(-13/9+A*(904/315+A*(-1522/945))))),U=U*A,this.cgb[2]=U*(56/15+A*(-136/35+A*(-1262/105+A*(73814/2835)))),this.cbg[2]=U*(-26/15+A*(34/21+A*(8/5+A*(-12686/2835)))),U=U*A,this.cgb[3]=U*(4279/630+A*(-332/35+A*(-399572/14175))),this.cbg[3]=U*(1237/630+A*(-12/5+A*(-24832/14175))),U=U*A,this.cgb[4]=U*(4174/315+A*(-144838/6237)),this.cbg[4]=U*(-734/315+A*(109598/31185)),U=U*A,this.cgb[5]=U*(601676/22275),this.cbg[5]=U*(444337/155925),U=Math.pow(A,2),this.Qn=this.k0/(1+A)*(1+U*(1/4+U*(1/64+U/256))),this.utg[0]=A*(-.5+A*(2/3+A*(-37/96+A*(1/360+A*(81/512+A*(-96199/604800)))))),this.gtu[0]=A*(.5+A*(-2/3+A*(5/16+A*(41/180+A*(-127/288+A*(7891/37800)))))),this.utg[1]=U*(-1/48+A*(-1/15+A*(437/1440+A*(-46/105+A*(1118711/3870720))))),this.gtu[1]=U*(13/48+A*(-3/5+A*(557/1440+A*(281/630+A*(-1983433/1935360))))),U=U*A,this.utg[2]=U*(-17/480+A*(37/840+A*(209/4480+A*(-5569/90720)))),this.gtu[2]=U*(61/240+A*(-103/140+A*(15061/26880+A*(167603/181440)))),U=U*A,this.utg[3]=U*(-4397/161280+A*(11/504+A*(830251/7257600))),this.gtu[3]=U*(49561/161280+A*(-179/168+A*(6601661/7257600))),U=U*A,this.utg[4]=U*(-4583/161280+A*(108847/3991680)),this.gtu[4]=U*(34729/80640+A*(-3418889/1995840)),U=U*A,this.utg[5]=U*(-20648693/638668800),this.gtu[5]=U*(212378941/319334400);var ft=ci(this.cbg,this.lat0);this.Zb=-this.Qn*(ft+Ri(this.gtu,2*ft))}function lr(w){var A=zt(w.x-this.long0),U=w.y;U=ci(this.cbg,U);var ft=Math.sin(U),lt=Math.cos(U),gt=Math.sin(A),mt=Math.cos(A);U=Math.atan2(ft,mt*lt),A=Math.atan2(gt*lt,Te(ft,lt*mt)),A=Ze(Math.tan(A));var yt=ir(this.gtu,2*U,2*A);U=U+yt[0],A=A+yt[1];var It,jt;return Math.abs(A)<=2.623395162778?(It=this.a*(this.Qn*A)+this.x0,jt=this.a*(this.Qn*U+this.Zb)+this.y0):(It=1/0,jt=1/0),w.x=It,w.y=jt,w}function hr(w){var A=(w.x-this.x0)*(1/this.a),U=(w.y-this.y0)*(1/this.a);U=(U-this.Zb)/this.Qn,A=A/this.Qn;var ft,lt;if(Math.abs(A)<=2.623395162778){var gt=ir(this.utg,2*U,2*A);U=U+gt[0],A=A+gt[1],A=Math.atan(Me(A));var mt=Math.sin(U),yt=Math.cos(U),It=Math.sin(A),jt=Math.cos(A);U=Math.atan2(mt*jt,Te(It,jt*yt)),A=Math.atan2(It,jt*yt),ft=zt(A+this.long0),lt=ci(this.cgb,U)}else ft=1/0,lt=1/0;return w.x=ft,w.y=lt,w}var ur=["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"],qi={init:or,forward:lr,inverse:hr,names:ur},fr=function(w,A){if(w===void 0){if(w=Math.floor((zt(A)+Math.PI)*30/Math.PI)+1,w<0)return 0;if(w>60)return 60}return w},cr="etmerc";function dr(){var w=fr(this.zone,this.long0);if(w===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(w)-183)*c,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,qi.init.apply(this),this.forward=qi.forward,this.inverse=qi.inverse}var pr=["Universal Transverse Mercator System","utm"],mr={init:dr,names:pr,dependsOn:cr},Zi=function(w,A){return Math.pow((1-w)/(1+w),A)},gr=20;function _r(){var w=Math.sin(this.lat0),A=Math.cos(this.lat0);A*=A,this.rc=Math.sqrt(1-this.es)/(1-this.es*w*w),this.C=Math.sqrt(1+this.es*A*A/(1-this.es)),this.phic0=Math.asin(w/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+h)/(Math.pow(Math.tan(.5*this.lat0+h),this.C)*Zi(this.e*w,this.ratexp))}function yr(w){var A=w.x,U=w.y;return w.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*U+h),this.C)*Zi(this.e*Math.sin(U),this.ratexp))-r,w.x=this.C*A,w}function vr(w){for(var A=1e-14,U=w.x/this.C,ft=w.y,lt=Math.pow(Math.tan(.5*ft+h)/this.K,1/this.C),gt=gr;gt>0&&(ft=2*Math.atan(lt*Zi(this.e*Math.sin(w.y),-.5*this.e))-r,!(Math.abs(ft-w.y)<A));--gt)w.y=ft;return gt?(w.x=U,w.y=ft,w):null}var Er=["gauss"],Qi={init:_r,forward:yr,inverse:vr,names:Er};function wr(){Qi.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))}function br(w){var A,U,ft,lt;return w.x=zt(w.x-this.long0),Qi.forward.apply(this,[w]),A=Math.sin(w.y),U=Math.cos(w.y),ft=Math.cos(w.x),lt=this.k0*this.R2/(1+this.sinc0*A+this.cosc0*U*ft),w.x=lt*U*Math.sin(w.x),w.y=lt*(this.cosc0*A-this.sinc0*U*ft),w.x=this.a*w.x+this.x0,w.y=this.a*w.y+this.y0,w}function Tr(w){var A,U,ft,lt,gt;if(w.x=(w.x-this.x0)/this.a,w.y=(w.y-this.y0)/this.a,w.x/=this.k0,w.y/=this.k0,gt=Math.sqrt(w.x*w.x+w.y*w.y)){var mt=2*Math.atan2(gt,this.R2);A=Math.sin(mt),U=Math.cos(mt),lt=Math.asin(U*this.sinc0+w.y*A*this.cosc0/gt),ft=Math.atan2(w.x*A,gt*this.cosc0*U-w.y*this.sinc0*A)}else lt=this.phic0,ft=0;return w.x=ft,w.y=lt,Qi.inverse.apply(this,[w]),w.x=zt(w.x+this.long0),w}var Sr=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"],Ji={init:wr,forward:br,inverse:Tr,names:Sr};function xr(w,A,U){return A*=U,Math.tan(.5*(r+w))*Math.pow((1-A)/(1+A),.5*U)}function Rr(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=o&&(this.k0=.5*(1+te(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=o&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=o&&(this.k0=.5*this.cons*Lt(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ee(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Lt(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-r,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))}function Mr(w){var A=w.x,U=w.y,ft=Math.sin(U),lt=Math.cos(U),gt,mt,yt,It,jt,re,Jt=zt(A-this.long0);return Math.abs(Math.abs(A-this.long0)-Math.PI)<=o&&Math.abs(U+this.lat0)<=o?(w.x=NaN,w.y=NaN,w):this.sphere?(gt=2*this.k0/(1+this.sinlat0*ft+this.coslat0*lt*Math.cos(Jt)),w.x=this.a*gt*lt*Math.sin(Jt)+this.x0,w.y=this.a*gt*(this.coslat0*ft-this.sinlat0*lt*Math.cos(Jt))+this.y0,w):(mt=2*Math.atan(this.ssfn_(U,ft,this.e))-r,It=Math.cos(mt),yt=Math.sin(mt),Math.abs(this.coslat0)<=o?(jt=ee(this.e,U*this.con,this.con*ft),re=2*this.a*this.k0*jt/this.cons,w.x=this.x0+re*Math.sin(A-this.long0),w.y=this.y0-this.con*re*Math.cos(A-this.long0),w):(Math.abs(this.sinlat0)<o?(gt=2*this.a*this.k0/(1+It*Math.cos(Jt)),w.y=gt*yt):(gt=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*yt+this.cosX0*It*Math.cos(Jt))),w.y=gt*(this.cosX0*yt-this.sinX0*It*Math.cos(Jt))+this.y0),w.x=gt*It*Math.sin(Jt)+this.x0,w))}function Pr(w){w.x-=this.x0,w.y-=this.y0;var A,U,ft,lt,gt,mt=Math.sqrt(w.x*w.x+w.y*w.y);if(this.sphere){var yt=2*Math.atan(mt/(.5*this.a*this.k0));return A=this.long0,U=this.lat0,mt<=o?(w.x=A,w.y=U,w):(U=Math.asin(Math.cos(yt)*this.sinlat0+w.y*Math.sin(yt)*this.coslat0/mt),Math.abs(this.coslat0)<o?this.lat0>0?A=zt(this.long0+Math.atan2(w.x,-1*w.y)):A=zt(this.long0+Math.atan2(w.x,w.y)):A=zt(this.long0+Math.atan2(w.x*Math.sin(yt),mt*this.coslat0*Math.cos(yt)-w.y*this.sinlat0*Math.sin(yt))),w.x=A,w.y=U,w)}else if(Math.abs(this.coslat0)<=o){if(mt<=o)return U=this.lat0,A=this.long0,w.x=A,w.y=U,w;w.x*=this.con,w.y*=this.con,ft=mt*this.cons/(2*this.a*this.k0),U=this.con*$(this.e,ft),A=this.con*zt(this.con*this.long0+Math.atan2(w.x,-1*w.y))}else lt=2*Math.atan(mt*this.cosX0/(2*this.a*this.k0*this.ms1)),A=this.long0,mt<=o?gt=this.X0:(gt=Math.asin(Math.cos(lt)*this.sinX0+w.y*Math.sin(lt)*this.cosX0/mt),A=zt(this.long0+Math.atan2(w.x*Math.sin(lt),mt*this.cosX0*Math.cos(lt)-w.y*this.sinX0*Math.sin(lt)))),U=-1*$(this.e,Math.tan(.5*(r+gt)));return w.x=A,w.y=U,w}var Cr=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],Lr={init:Rr,forward:Mr,inverse:Pr,names:Cr,ssfn_:xr};function Ar(){var w=this.lat0;this.lambda0=this.long0;var A=Math.sin(w),U=this.a,ft=this.rf,lt=1/ft,gt=2*lt-Math.pow(lt,2),mt=this.e=Math.sqrt(gt);this.R=this.k0*U*Math.sqrt(1-gt)/(1-gt*Math.pow(A,2)),this.alpha=Math.sqrt(1+gt/(1-gt)*Math.pow(Math.cos(w),4)),this.b0=Math.asin(A/this.alpha);var yt=Math.log(Math.tan(Math.PI/4+this.b0/2)),It=Math.log(Math.tan(Math.PI/4+w/2)),jt=Math.log((1+mt*A)/(1-mt*A));this.K=yt-this.alpha*It+this.alpha*mt/2*jt}function Or(w){var A=Math.log(Math.tan(Math.PI/4-w.y/2)),U=this.e/2*Math.log((1+this.e*Math.sin(w.y))/(1-this.e*Math.sin(w.y))),ft=-this.alpha*(A+U)+this.K,lt=2*(Math.atan(Math.exp(ft))-Math.PI/4),gt=this.alpha*(w.x-this.lambda0),mt=Math.atan(Math.sin(gt)/(Math.sin(this.b0)*Math.tan(lt)+Math.cos(this.b0)*Math.cos(gt))),yt=Math.asin(Math.cos(this.b0)*Math.sin(lt)-Math.sin(this.b0)*Math.cos(lt)*Math.cos(gt));return w.y=this.R/2*Math.log((1+Math.sin(yt))/(1-Math.sin(yt)))+this.y0,w.x=this.R*mt+this.x0,w}function Ir(w){for(var A=w.x-this.x0,U=w.y-this.y0,ft=A/this.R,lt=2*(Math.atan(Math.exp(U/this.R))-Math.PI/4),gt=Math.asin(Math.cos(this.b0)*Math.sin(lt)+Math.sin(this.b0)*Math.cos(lt)*Math.cos(ft)),mt=Math.atan(Math.sin(ft)/(Math.cos(this.b0)*Math.cos(ft)-Math.sin(this.b0)*Math.tan(lt))),yt=this.lambda0+mt/this.alpha,It=0,jt=gt,re=-1e3,Jt=0;Math.abs(jt-re)>1e-7;){if(++Jt>20)return;It=1/this.alpha*(Math.log(Math.tan(Math.PI/4+gt/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(jt))/2)),re=jt,jt=2*Math.atan(Math.exp(It))-Math.PI/2}return w.x=yt,w.y=jt,w}var Nr=["somerc"],Dr={init:Ar,forward:Or,inverse:Ir,names:Nr};function kr(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var w=Math.sin(this.lat0),A=Math.cos(this.lat0),U=this.e*w;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(A,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-U*U);var ft=ee(this.e,this.lat0,w),lt=this.bl/A*Math.sqrt((1-this.es)/(1-U*U));lt*lt<1&&(lt=1);var gt,mt;if(!isNaN(this.longc))this.lat0>=0?gt=lt+Math.sqrt(lt*lt-1):gt=lt-Math.sqrt(lt*lt-1),this.el=gt*Math.pow(ft,this.bl),mt=.5*(gt-1/gt),this.gamma0=Math.asin(Math.sin(this.alpha)/lt),this.long0=this.longc-Math.asin(mt*Math.tan(this.gamma0))/this.bl;else{var yt=ee(this.e,this.lat1,Math.sin(this.lat1)),It=ee(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(lt+Math.sqrt(lt*lt-1))*Math.pow(ft,this.bl):this.el=(lt-Math.sqrt(lt*lt-1))*Math.pow(ft,this.bl);var jt=Math.pow(yt,this.bl),re=Math.pow(It,this.bl);gt=this.el/jt,mt=.5*(gt-1/gt);var Jt=(this.el*this.el-re*jt)/(this.el*this.el+re*jt),ae=(re-jt)/(re+jt),be=zt(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(Jt*Math.tan(.5*this.bl*be)/ae)/this.bl,this.long0=zt(this.long0);var ye=zt(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*ye)/mt),this.alpha=Math.asin(lt*Math.sin(this.gamma0))}this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(lt*lt-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(lt*lt-1),Math.cos(this.alpha))}function Fr(w){var A=w.x,U=w.y,ft=zt(A-this.long0),lt,gt,mt;if(Math.abs(Math.abs(U)-r)<=o)U>0?mt=-1:mt=1,gt=this.al/this.bl*Math.log(Math.tan(h+mt*this.gamma0*.5)),lt=-1*mt*r*this.al/this.bl;else{var yt=ee(this.e,U,Math.sin(U)),It=this.el/Math.pow(yt,this.bl),jt=.5*(It-1/It),re=.5*(It+1/It),Jt=Math.sin(this.bl*ft),ae=(jt*Math.sin(this.gamma0)-Jt*Math.cos(this.gamma0))/re;Math.abs(Math.abs(ae)-1)<=o?gt=Number.POSITIVE_INFINITY:gt=.5*this.al*Math.log((1-ae)/(1+ae))/this.bl,Math.abs(Math.cos(this.bl*ft))<=o?lt=this.al*this.bl*ft:lt=this.al*Math.atan2(jt*Math.cos(this.gamma0)+Jt*Math.sin(this.gamma0),Math.cos(this.bl*ft))/this.bl}return this.no_rot?(w.x=this.x0+lt,w.y=this.y0+gt):(lt-=this.uc,w.x=this.x0+gt*Math.cos(this.alpha)+lt*Math.sin(this.alpha),w.y=this.y0+lt*Math.cos(this.alpha)-gt*Math.sin(this.alpha)),w}function Vr(w){var A,U;this.no_rot?(U=w.y-this.y0,A=w.x-this.x0):(U=(w.x-this.x0)*Math.cos(this.alpha)-(w.y-this.y0)*Math.sin(this.alpha),A=(w.y-this.y0)*Math.cos(this.alpha)+(w.x-this.x0)*Math.sin(this.alpha),A+=this.uc);var ft=Math.exp(-1*this.bl*U/this.al),lt=.5*(ft-1/ft),gt=.5*(ft+1/ft),mt=Math.sin(this.bl*A/this.al),yt=(mt*Math.cos(this.gamma0)+lt*Math.sin(this.gamma0))/gt,It=Math.pow(this.el/Math.sqrt((1+yt)/(1-yt)),1/this.bl);return Math.abs(yt-1)<o?(w.x=this.long0,w.y=r):Math.abs(yt+1)<o?(w.x=this.long0,w.y=-1*r):(w.y=$(this.e,It),w.x=zt(this.long0-Math.atan2(lt*Math.cos(this.gamma0)-mt*Math.sin(this.gamma0),Math.cos(this.bl*A/this.al))/this.bl)),w}var Gr=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"],Wr={init:kr,forward:Fr,inverse:Vr,names:Gr};function Br(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<o)){var w=this.b/this.a;this.e=Math.sqrt(1-w*w);var A=Math.sin(this.lat1),U=Math.cos(this.lat1),ft=Lt(this.e,A,U),lt=ee(this.e,this.lat1,A),gt=Math.sin(this.lat2),mt=Math.cos(this.lat2),yt=Lt(this.e,gt,mt),It=ee(this.e,this.lat2,gt),jt=ee(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>o?this.ns=Math.log(ft/yt)/Math.log(lt/It):this.ns=A,isNaN(this.ns)&&(this.ns=A),this.f0=ft/(this.ns*Math.pow(lt,this.ns)),this.rh=this.a*this.f0*Math.pow(jt,this.ns),this.title||(this.title="Lambert Conformal Conic")}}function Ur(w){var A=w.x,U=w.y;Math.abs(2*Math.abs(U)-Math.PI)<=o&&(U=te(U)*(r-2*o));var ft=Math.abs(Math.abs(U)-r),lt,gt;if(ft>o)lt=ee(this.e,U,Math.sin(U)),gt=this.a*this.f0*Math.pow(lt,this.ns);else{if(ft=U*this.ns,ft<=0)return null;gt=0}var mt=this.ns*zt(A-this.long0);return w.x=this.k0*(gt*Math.sin(mt))+this.x0,w.y=this.k0*(this.rh-gt*Math.cos(mt))+this.y0,w}function Kr(w){var A,U,ft,lt,gt,mt=(w.x-this.x0)/this.k0,yt=this.rh-(w.y-this.y0)/this.k0;this.ns>0?(A=Math.sqrt(mt*mt+yt*yt),U=1):(A=-Math.sqrt(mt*mt+yt*yt),U=-1);var It=0;if(A!==0&&(It=Math.atan2(U*mt,U*yt)),A!==0||this.ns>0){if(U=1/this.ns,ft=Math.pow(A/(this.a*this.f0),U),lt=$(this.e,ft),lt===-9999)return null}else lt=-r;return gt=zt(It/this.ns+this.long0),w.x=gt,w.y=lt,w}var zr=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"],jr={init:Br,forward:Ur,inverse:Kr,names:zr};function qr(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.7417649320975901-.308341501185665),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq}function Yr(w){var A,U,ft,lt,gt,mt,yt,It=w.x,jt=w.y,re=zt(It-this.long0);return A=Math.pow((1+this.e*Math.sin(jt))/(1-this.e*Math.sin(jt)),this.alfa*this.e/2),U=2*(Math.atan(this.k*Math.pow(Math.tan(jt/2+this.s45),this.alfa)/A)-this.s45),ft=-re*this.alfa,lt=Math.asin(Math.cos(this.ad)*Math.sin(U)+Math.sin(this.ad)*Math.cos(U)*Math.cos(ft)),gt=Math.asin(Math.cos(U)*Math.sin(ft)/Math.cos(lt)),mt=this.n*gt,yt=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(lt/2+this.s45),this.n),w.y=yt*Math.cos(mt)/1,w.x=yt*Math.sin(mt)/1,this.czech||(w.y*=-1,w.x*=-1),w}function Hr(w){var A,U,ft,lt,gt,mt,yt,It,jt=w.x;w.x=w.y,w.y=jt,this.czech||(w.y*=-1,w.x*=-1),mt=Math.sqrt(w.x*w.x+w.y*w.y),gt=Math.atan2(w.y,w.x),lt=gt/Math.sin(this.s0),ft=2*(Math.atan(Math.pow(this.ro0/mt,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),A=Math.asin(Math.cos(this.ad)*Math.sin(ft)-Math.sin(this.ad)*Math.cos(ft)*Math.cos(lt)),U=Math.asin(Math.cos(ft)*Math.sin(lt)/Math.cos(A)),w.x=this.long0-U/this.alfa,yt=A,It=0;var re=0;do w.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(A/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(yt))/(1-this.e*Math.sin(yt)),this.e/2))-this.s45),Math.abs(yt-w.y)<1e-10&&(It=1),yt=w.y,re+=1;while(It===0&&re<15);return re>=15?null:w}var Xr=["Krovak","krovak"],$r={init:qr,forward:Yr,inverse:Hr,names:Xr},di=function(w,A,U,ft,lt){return w*lt-A*Math.sin(2*lt)+U*Math.sin(4*lt)-ft*Math.sin(6*lt)},Fi=function(w){return 1-.25*w*(1+w/16*(3+1.25*w))},Vi=function(w){return .375*w*(1+.25*w*(1+.46875*w))},Gi=function(w){return .05859375*w*w*(1+.75*w)},Wi=function(w){return w*w*w*(35/3072)},Ai=function(w,A,U){var ft=A*U;return w/Math.sqrt(1-ft*ft)},Oi=function(w){return Math.abs(w)<r?w:w-te(w)*Math.PI},Yi=function(w,A,U,ft,lt){var gt,mt;gt=w/A;for(var yt=0;yt<15;yt++)if(mt=(w-(A*gt-U*Math.sin(2*gt)+ft*Math.sin(4*gt)-lt*Math.sin(6*gt)))/(A-2*U*Math.cos(2*gt)+4*ft*Math.cos(4*gt)-6*lt*Math.cos(6*gt)),gt+=mt,Math.abs(mt)<=1e-10)return gt;return NaN};function Zr(){this.sphere||(this.e0=Fi(this.es),this.e1=Vi(this.es),this.e2=Gi(this.es),this.e3=Wi(this.es),this.ml0=this.a*di(this.e0,this.e1,this.e2,this.e3,this.lat0))}function Qr(w){var A,U,ft=w.x,lt=w.y;if(ft=zt(ft-this.long0),this.sphere)A=this.a*Math.asin(Math.cos(lt)*Math.sin(ft)),U=this.a*(Math.atan2(Math.tan(lt),Math.cos(ft))-this.lat0);else{var gt=Math.sin(lt),mt=Math.cos(lt),yt=Ai(this.a,this.e,gt),It=Math.tan(lt)*Math.tan(lt),jt=ft*Math.cos(lt),re=jt*jt,Jt=this.es*mt*mt/(1-this.es),ae=this.a*di(this.e0,this.e1,this.e2,this.e3,lt);A=yt*jt*(1-re*It*(1/6-(8-It+8*Jt)*re/120)),U=ae-this.ml0+yt*gt/mt*re*(.5+(5-It+6*Jt)*re/24)}return w.x=A+this.x0,w.y=U+this.y0,w}function Jr(w){w.x-=this.x0,w.y-=this.y0;var A=w.x/this.a,U=w.y/this.a,ft,lt;if(this.sphere){var gt=U+this.lat0;ft=Math.asin(Math.sin(gt)*Math.cos(A)),lt=Math.atan2(Math.tan(A),Math.cos(gt))}else{var mt=this.ml0/this.a+U,yt=Yi(mt,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(yt)-r)<=o)return w.x=this.long0,w.y=r,U<0&&(w.y*=-1),w;var It=Ai(this.a,this.e,Math.sin(yt)),jt=It*It*It/this.a/this.a*(1-this.es),re=Math.pow(Math.tan(yt),2),Jt=A*this.a/It,ae=Jt*Jt;ft=yt-It*Math.tan(yt)/jt*Jt*Jt*(.5-(1+3*re)*Jt*Jt/24),lt=Jt*(1-ae*(re/3+(1+3*re)*re*ae/15))/Math.cos(yt)}return w.x=zt(lt+this.long0),w.y=Oi(ft),w}var tn=["Cassini","Cassini_Soldner","cass"],en={init:Zr,forward:Qr,inverse:Jr,names:tn},Ti=function(w,A){var U;return w>1e-7?(U=w*A,(1-w*w)*(A/(1-U*U)-.5/w*Math.log((1-U)/(1+U)))):2*A},rn=1,nn=2,sn=3,an=4;function on(){var w=Math.abs(this.lat0);if(Math.abs(w-r)<o?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(w)<o?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var A;switch(this.qp=Ti(this.e,1),this.mmf=.5/(1-this.es),this.apa=gn(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),A=Math.sin(this.lat0),this.sinb1=Ti(this.e,A)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*A*A)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd;break}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))}function ln(w){var A,U,ft,lt,gt,mt,yt,It,jt,re,Jt=w.x,ae=w.y;if(Jt=zt(Jt-this.long0),this.sphere){if(gt=Math.sin(ae),re=Math.cos(ae),ft=Math.cos(Jt),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(U=this.mode===this.EQUIT?1+re*ft:1+this.sinph0*gt+this.cosph0*re*ft,U<=o)return null;U=Math.sqrt(2/U),A=U*re*Math.sin(Jt),U*=this.mode===this.EQUIT?gt:this.cosph0*gt-this.sinph0*re*ft}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(ft=-ft),Math.abs(ae+this.phi0)<o)return null;U=h-ae*.5,U=2*(this.mode===this.S_POLE?Math.cos(U):Math.sin(U)),A=U*Math.sin(Jt),U*=ft}}else{switch(yt=0,It=0,jt=0,ft=Math.cos(Jt),lt=Math.sin(Jt),gt=Math.sin(ae),mt=Ti(this.e,gt),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(yt=mt/this.qp,It=Math.sqrt(1-yt*yt)),this.mode){case this.OBLIQ:jt=1+this.sinb1*yt+this.cosb1*It*ft;break;case this.EQUIT:jt=1+It*ft;break;case this.N_POLE:jt=r+ae,mt=this.qp-mt;break;case this.S_POLE:jt=ae-r,mt=this.qp+mt;break}if(Math.abs(jt)<o)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:jt=Math.sqrt(2/jt),this.mode===this.OBLIQ?U=this.ymf*jt*(this.cosb1*yt-this.sinb1*It*ft):U=(jt=Math.sqrt(2/(1+It*ft)))*yt*this.ymf,A=this.xmf*jt*It*lt;break;case this.N_POLE:case this.S_POLE:mt>=0?(A=(jt=Math.sqrt(mt))*lt,U=ft*(this.mode===this.S_POLE?jt:-jt)):A=U=0;break}}return w.x=this.a*A+this.x0,w.y=this.a*U+this.y0,w}function hn(w){w.x-=this.x0,w.y-=this.y0;var A=w.x/this.a,U=w.y/this.a,ft,lt,gt,mt,yt,It,jt;if(this.sphere){var re=0,Jt,ae=0;if(Jt=Math.sqrt(A*A+U*U),lt=Jt*.5,lt>1)return null;switch(lt=2*Math.asin(lt),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(ae=Math.sin(lt),re=Math.cos(lt)),this.mode){case this.EQUIT:lt=Math.abs(Jt)<=o?0:Math.asin(U*ae/Jt),A*=ae,U=re*Jt;break;case this.OBLIQ:lt=Math.abs(Jt)<=o?this.phi0:Math.asin(re*this.sinph0+U*ae*this.cosph0/Jt),A*=ae*this.cosph0,U=(re-Math.sin(lt)*this.sinph0)*Jt;break;case this.N_POLE:U=-U,lt=r-lt;break;case this.S_POLE:lt-=r;break}ft=U===0&&(this.mode===this.EQUIT||this.mode===this.OBLIQ)?0:Math.atan2(A,U)}else{if(jt=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(A/=this.dd,U*=this.dd,It=Math.sqrt(A*A+U*U),It<o)return w.x=0,w.y=this.phi0,w;mt=2*Math.asin(.5*It/this.rq),gt=Math.cos(mt),A*=mt=Math.sin(mt),this.mode===this.OBLIQ?(jt=gt*this.sinb1+U*mt*this.cosb1/It,yt=this.qp*jt,U=It*this.cosb1*gt-U*this.sinb1*mt):(jt=U*mt/It,yt=this.qp*jt,U=It*gt)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(U=-U),yt=A*A+U*U,!yt)return w.x=0,w.y=this.phi0,w;jt=1-yt/this.qp,this.mode===this.S_POLE&&(jt=-jt)}ft=Math.atan2(A,U),lt=_n(Math.asin(jt),this.apa)}return w.x=zt(this.long0+ft),w.y=lt,w}var un=.3333333333333333,fn=.17222222222222222,cn=.10257936507936508,dn=.06388888888888888,pn=.0664021164021164,mn=.016415012942191543;function gn(w){var A,U=[];return U[0]=w*un,A=w*w,U[0]+=A*fn,U[1]=A*dn,A*=w,U[0]+=A*cn,U[1]+=A*pn,U[2]=A*mn,U}function _n(w,A){var U=w+w;return w+A[0]*Math.sin(U)+A[1]*Math.sin(U+U)+A[2]*Math.sin(U+U+U)}var yn=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],vn={init:on,forward:ln,inverse:hn,names:yn,S_POLE:rn,N_POLE:nn,EQUIT:sn,OBLIQ:an},Si=function(w){return Math.abs(w)>1&&(w=w>1?1:-1),Math.asin(w)};function En(){Math.abs(this.lat1+this.lat2)<o||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Lt(this.e3,this.sin_po,this.cos_po),this.qs1=Ti(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Lt(this.e3,this.sin_po,this.cos_po),this.qs2=Ti(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ti(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>o?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)}function wn(w){var A=w.x,U=w.y;this.sin_phi=Math.sin(U),this.cos_phi=Math.cos(U);var ft=Ti(this.e3,this.sin_phi,this.cos_phi),lt=this.a*Math.sqrt(this.c-this.ns0*ft)/this.ns0,gt=this.ns0*zt(A-this.long0),mt=lt*Math.sin(gt)+this.x0,yt=this.rh-lt*Math.cos(gt)+this.y0;return w.x=mt,w.y=yt,w}function bn(w){var A,U,ft,lt,gt,mt;return w.x-=this.x0,w.y=this.rh-w.y+this.y0,this.ns0>=0?(A=Math.sqrt(w.x*w.x+w.y*w.y),ft=1):(A=-Math.sqrt(w.x*w.x+w.y*w.y),ft=-1),lt=0,A!==0&&(lt=Math.atan2(ft*w.x,ft*w.y)),ft=A*this.ns0/this.a,this.sphere?mt=Math.asin((this.c-ft*ft)/(2*this.ns0)):(U=(this.c-ft*ft)/this.ns0,mt=this.phi1z(this.e3,U)),gt=zt(lt/this.ns0+this.long0),w.x=gt,w.y=mt,w}function Tn(w,A){var U,ft,lt,gt,mt,yt=Si(.5*A);if(w<o)return yt;for(var It=w*w,jt=1;jt<=25;jt++)if(U=Math.sin(yt),ft=Math.cos(yt),lt=w*U,gt=1-lt*lt,mt=.5*gt*gt/ft*(A/(1-It)-U/gt+.5/w*Math.log((1-lt)/(1+lt))),yt=yt+mt,Math.abs(mt)<=1e-7)return yt;return null}var Sn=["Albers_Conic_Equal_Area","Albers","aea"],xn={init:En,forward:wn,inverse:bn,names:Sn,phi1z:Tn};function Rn(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1}function Mn(w){var A,U,ft,lt,gt,mt,yt,It,jt=w.x,re=w.y;return ft=zt(jt-this.long0),A=Math.sin(re),U=Math.cos(re),lt=Math.cos(ft),mt=this.sin_p14*A+this.cos_p14*U*lt,gt=1,mt>0||Math.abs(mt)<=o?(yt=this.x0+this.a*gt*U*Math.sin(ft)/mt,It=this.y0+this.a*gt*(this.cos_p14*A-this.sin_p14*U*lt)/mt):(yt=this.x0+this.infinity_dist*U*Math.sin(ft),It=this.y0+this.infinity_dist*(this.cos_p14*A-this.sin_p14*U*lt)),w.x=yt,w.y=It,w}function Pn(w){var A,U,ft,lt,gt,mt;return w.x=(w.x-this.x0)/this.a,w.y=(w.y-this.y0)/this.a,w.x/=this.k0,w.y/=this.k0,(A=Math.sqrt(w.x*w.x+w.y*w.y))?(lt=Math.atan2(A,this.rc),U=Math.sin(lt),ft=Math.cos(lt),mt=Si(ft*this.sin_p14+w.y*U*this.cos_p14/A),gt=Math.atan2(w.x*U,A*this.cos_p14*ft-w.y*this.sin_p14*U),gt=zt(this.long0+gt)):(mt=this.phic0,gt=0),w.x=gt,w.y=mt,w}var Cn=["gnom"],Ln={init:Rn,forward:Mn,inverse:Pn,names:Cn},An=function(w,A){var U=1-(1-w*w)/(2*w)*Math.log((1-w)/(1+w));if(Math.abs(Math.abs(A)-U)<1e-6)return A<0?-1*r:r;for(var ft=Math.asin(.5*A),lt,gt,mt,yt,It=0;It<30;It++)if(gt=Math.sin(ft),mt=Math.cos(ft),yt=w*gt,lt=Math.pow(1-yt*yt,2)/(2*mt)*(A/(1-w*w)-gt/(1-yt*yt)+.5/w*Math.log((1-yt)/(1+yt))),ft+=lt,Math.abs(lt)<=1e-10)return ft;return NaN};function On(){this.sphere||(this.k0=Lt(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))}function In(w){var A=w.x,U=w.y,ft,lt,gt=zt(A-this.long0);if(this.sphere)ft=this.x0+this.a*gt*Math.cos(this.lat_ts),lt=this.y0+this.a*Math.sin(U)/Math.cos(this.lat_ts);else{var mt=Ti(this.e,Math.sin(U));ft=this.x0+this.a*this.k0*gt,lt=this.y0+this.a*mt*.5/this.k0}return w.x=ft,w.y=lt,w}function Nn(w){w.x-=this.x0,w.y-=this.y0;var A,U;return this.sphere?(A=zt(this.long0+w.x/this.a/Math.cos(this.lat_ts)),U=Math.asin(w.y/this.a*Math.cos(this.lat_ts))):(U=An(this.e,2*w.y*this.k0/this.a),A=zt(this.long0+w.x/(this.a*this.k0))),w.x=A,w.y=U,w}var Dn=["cea"],kn={init:On,forward:In,inverse:Nn,names:Dn};function Fn(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)}function Vn(w){var A=w.x,U=w.y,ft=zt(A-this.long0),lt=Oi(U-this.lat0);return w.x=this.x0+this.a*ft*this.rc,w.y=this.y0+this.a*lt,w}function Gn(w){var A=w.x,U=w.y;return w.x=zt(this.long0+(A-this.x0)/(this.a*this.rc)),w.y=Oi(this.lat0+(U-this.y0)/this.a),w}var Wn=["Equirectangular","Equidistant_Cylindrical","eqc"],Bn={init:Fn,forward:Vn,inverse:Gn,names:Wn},rr=20;function Un(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Fi(this.es),this.e1=Vi(this.es),this.e2=Gi(this.es),this.e3=Wi(this.es),this.ml0=this.a*di(this.e0,this.e1,this.e2,this.e3,this.lat0)}function Kn(w){var A=w.x,U=w.y,ft,lt,gt,mt=zt(A-this.long0);if(gt=mt*Math.sin(U),this.sphere)Math.abs(U)<=o?(ft=this.a*mt,lt=-1*this.a*this.lat0):(ft=this.a*Math.sin(gt)/Math.tan(U),lt=this.a*(Oi(U-this.lat0)+(1-Math.cos(gt))/Math.tan(U)));else if(Math.abs(U)<=o)ft=this.a*mt,lt=-1*this.ml0;else{var yt=Ai(this.a,this.e,Math.sin(U))/Math.tan(U);ft=yt*Math.sin(gt),lt=this.a*di(this.e0,this.e1,this.e2,this.e3,U)-this.ml0+yt*(1-Math.cos(gt))}return w.x=ft+this.x0,w.y=lt+this.y0,w}function zn(w){var A,U,ft,lt,gt,mt,yt,It,jt;if(ft=w.x-this.x0,lt=w.y-this.y0,this.sphere)if(Math.abs(lt+this.a*this.lat0)<=o)A=zt(ft/this.a+this.long0),U=0;else{mt=this.lat0+lt/this.a,yt=ft*ft/this.a/this.a+mt*mt,It=mt;var re;for(gt=rr;gt;--gt)if(re=Math.tan(It),jt=-1*(mt*(It*re+1)-It-.5*(It*It+yt)*re)/((It-mt)/re-1),It+=jt,Math.abs(jt)<=o){U=It;break}A=zt(this.long0+Math.asin(ft*Math.tan(It)/this.a)/Math.sin(U))}else if(Math.abs(lt+this.ml0)<=o)U=0,A=zt(this.long0+ft/this.a);else{mt=(this.ml0+lt)/this.a,yt=ft*ft/this.a/this.a+mt*mt,It=mt;var Jt,ae,be,ye,ve;for(gt=rr;gt;--gt)if(ve=this.e*Math.sin(It),Jt=Math.sqrt(1-ve*ve)*Math.tan(It),ae=this.a*di(this.e0,this.e1,this.e2,this.e3,It),be=this.e0-2*this.e1*Math.cos(2*It)+4*this.e2*Math.cos(4*It)-6*this.e3*Math.cos(6*It),ye=ae/this.a,jt=(mt*(Jt*ye+1)-ye-.5*Jt*(ye*ye+yt))/(this.es*Math.sin(2*It)*(ye*ye+yt-2*mt*ye)/(4*Jt)+(mt-ye)*(Jt*be-2/Math.sin(2*It))-be),It-=jt,Math.abs(jt)<=o){U=It;break}Jt=Math.sqrt(1-this.es*Math.pow(Math.sin(U),2))*Math.tan(U),A=zt(this.long0+Math.asin(ft*Jt/this.a)/Math.sin(U))}return w.x=A,w.y=U,w}var jn=["Polyconic","poly"],qn={init:Un,forward:Kn,inverse:zn,names:jn};function Yn(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013}function Hn(w){var A,U=w.x,ft=w.y,lt=ft-this.lat0,gt=U-this.long0,mt=lt/t*1e-5,yt=gt,It=1,jt=0;for(A=1;A<=10;A++)It=It*mt,jt=jt+this.A[A]*It;var re=jt,Jt=yt,ae=1,be=0,ye,ve,we=0,Ae=0;for(A=1;A<=6;A++)ye=ae*re-be*Jt,ve=be*re+ae*Jt,ae=ye,be=ve,we=we+this.B_re[A]*ae-this.B_im[A]*be,Ae=Ae+this.B_im[A]*ae+this.B_re[A]*be;return w.x=Ae*this.a+this.x0,w.y=we*this.a+this.y0,w}function Xn(w){var A,U=w.x,ft=w.y,lt=U-this.x0,gt=ft-this.y0,mt=gt/this.a,yt=lt/this.a,It=1,jt=0,re,Jt,ae=0,be=0;for(A=1;A<=6;A++)re=It*mt-jt*yt,Jt=jt*mt+It*yt,It=re,jt=Jt,ae=ae+this.C_re[A]*It-this.C_im[A]*jt,be=be+this.C_im[A]*It+this.C_re[A]*jt;for(var ye=0;ye<this.iterations;ye++){var ve=ae,we=be,Ae,De,Be=mt,ti=yt;for(A=2;A<=6;A++)Ae=ve*ae-we*be,De=we*ae+ve*be,ve=Ae,we=De,Be=Be+(A-1)*(this.B_re[A]*ve-this.B_im[A]*we),ti=ti+(A-1)*(this.B_im[A]*ve+this.B_re[A]*we);ve=1,we=0;var qe=this.B_re[1],Ye=this.B_im[1];for(A=2;A<=6;A++)Ae=ve*ae-we*be,De=we*ae+ve*be,ve=Ae,we=De,qe=qe+A*(this.B_re[A]*ve-this.B_im[A]*we),Ye=Ye+A*(this.B_im[A]*ve+this.B_re[A]*we);var pi=qe*qe+Ye*Ye;ae=(Be*qe+ti*Ye)/pi,be=(ti*qe-Be*Ye)/pi}var ui=ae,xi=be,Bi=1,Ui=0;for(A=1;A<=9;A++)Bi=Bi*ui,Ui=Ui+this.D[A]*Bi;var nr=this.lat0+Ui*t*1e5,Da=this.long0+xi;return w.x=Da,w.y=nr,w}var $n=["New_Zealand_Map_Grid","nzmg"],Zn={init:Yn,forward:Hn,inverse:Xn,names:$n};function Qn(){}function Jn(w){var A=w.x,U=w.y,ft=zt(A-this.long0),lt=this.x0+this.a*ft,gt=this.y0+this.a*Math.log(Math.tan(Math.PI/4+U/2.5))*1.25;return w.x=lt,w.y=gt,w}function ts(w){w.x-=this.x0,w.y-=this.y0;var A=zt(this.long0+w.x/this.a),U=2.5*(Math.atan(Math.exp(.8*w.y/this.a))-Math.PI/4);return w.x=A,w.y=U,w}var es=["Miller_Cylindrical","mill"],is={init:Qn,forward:Jn,inverse:ts,names:es},rs=20;function ns(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=We(this.es)}function ss(w){var A,U,ft=w.x,lt=w.y;if(ft=zt(ft-this.long0),this.sphere){if(!this.m)lt=this.n!==1?Math.asin(this.n*Math.sin(lt)):lt;else for(var gt=this.n*Math.sin(lt),mt=rs;mt;--mt){var yt=(this.m*lt+Math.sin(lt)-gt)/(this.m+Math.cos(lt));if(lt-=yt,Math.abs(yt)<o)break}A=this.a*this.C_x*ft*(this.m+Math.cos(lt)),U=this.a*this.C_y*lt}else{var It=Math.sin(lt),jt=Math.cos(lt);U=this.a*Ve(lt,It,jt,this.en),A=this.a*ft*jt/Math.sqrt(1-this.es*It*It)}return w.x=A,w.y=U,w}function as(w){var A,U,ft,lt;return w.x-=this.x0,ft=w.x/this.a,w.y-=this.y0,A=w.y/this.a,this.sphere?(A/=this.C_y,ft=ft/(this.C_x*(this.m+Math.cos(A))),this.m?A=Si((this.m*A+Math.sin(A))/this.n):this.n!==1&&(A=Si(Math.sin(A)/this.n)),ft=zt(ft+this.long0),A=Oi(A)):(A=Le(w.y/this.a,this.es,this.en),lt=Math.abs(A),lt<r?(lt=Math.sin(A),U=this.long0+w.x*Math.sqrt(1-this.es*lt*lt)/(this.a*Math.cos(A)),ft=zt(U)):lt-o<r&&(ft=this.long0)),w.x=ft,w.y=A,w}var os=["Sinusoidal","sinu"],ls={init:ns,forward:ss,inverse:as,names:os};function hs(){}function us(w){for(var A=w.x,U=w.y,ft=zt(A-this.long0),lt=U,gt=Math.PI*Math.sin(U),mt=0;;mt++){var yt=-(lt+Math.sin(lt)-gt)/(1+Math.cos(lt));if(lt+=yt,Math.abs(yt)<o)break}lt/=2,Math.PI/2-Math.abs(U)<o&&(ft=0);var It=.900316316158*this.a*ft*Math.cos(lt)+this.x0,jt=1.4142135623731*this.a*Math.sin(lt)+this.y0;return w.x=It,w.y=jt,w}function fs(w){var A,U;w.x-=this.x0,w.y-=this.y0,U=w.y/(1.4142135623731*this.a),Math.abs(U)>.999999999999&&(U=.999999999999),A=Math.asin(U);var ft=zt(this.long0+w.x/(.900316316158*this.a*Math.cos(A)));ft<-Math.PI&&(ft=-Math.PI),ft>Math.PI&&(ft=Math.PI),U=(2*A+Math.sin(2*A))/Math.PI,Math.abs(U)>1&&(U=1);var lt=Math.asin(U);return w.x=ft,w.y=lt,w}var cs=["Mollweide","moll"],tr={init:hs,forward:us,inverse:fs,names:cs};function As(){Math.abs(this.lat1+this.lat2)<o||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Fi(this.es),this.e1=Vi(this.es),this.e2=Gi(this.es),this.e3=Wi(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Lt(this.e,this.sinphi,this.cosphi),this.ml1=di(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<o?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Lt(this.e,this.sinphi,this.cosphi),this.ml2=di(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=di(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))}function St(w){var A=w.x,U=w.y,ft;if(this.sphere)ft=this.a*(this.g-U);else{var lt=di(this.e0,this.e1,this.e2,this.e3,U);ft=this.a*(this.g-lt)}var gt=this.ns*zt(A-this.long0),mt=this.x0+ft*Math.sin(gt),yt=this.y0+this.rh-ft*Math.cos(gt);return w.x=mt,w.y=yt,w}function ga(w){w.x-=this.x0,w.y=this.rh-w.y+this.y0;var A,U,ft,lt;this.ns>=0?(U=Math.sqrt(w.x*w.x+w.y*w.y),A=1):(U=-Math.sqrt(w.x*w.x+w.y*w.y),A=-1);var gt=0;if(U!==0&&(gt=Math.atan2(A*w.x,A*w.y)),this.sphere)return lt=zt(this.long0+gt/this.ns),ft=Oi(this.g-U/this.a),w.x=lt,w.y=ft,w;var mt=this.g-U/this.a;return ft=Yi(mt,this.e0,this.e1,this.e2,this.e3),lt=zt(this.long0+gt/this.ns),w.x=lt,w.y=ft,w}var _a=["Equidistant_Conic","eqdc"],ya={init:As,forward:St,inverse:ga,names:_a};function va(){this.R=this.a}function Ea(w){var A=w.x,U=w.y,ft=zt(A-this.long0),lt,gt;Math.abs(U)<=o&&(lt=this.x0+this.R*ft,gt=this.y0);var mt=Si(2*Math.abs(U/Math.PI));(Math.abs(ft)<=o||Math.abs(Math.abs(U)-r)<=o)&&(lt=this.x0,U>=0?gt=this.y0+Math.PI*this.R*Math.tan(.5*mt):gt=this.y0+Math.PI*this.R*-Math.tan(.5*mt));var yt=.5*Math.abs(Math.PI/ft-ft/Math.PI),It=yt*yt,jt=Math.sin(mt),re=Math.cos(mt),Jt=re/(jt+re-1),ae=Jt*Jt,be=Jt*(2/jt-1),ye=be*be,ve=Math.PI*this.R*(yt*(Jt-ye)+Math.sqrt(It*(Jt-ye)*(Jt-ye)-(ye+It)*(ae-ye)))/(ye+It);ft<0&&(ve=-ve),lt=this.x0+ve;var we=It+Jt;return ve=Math.PI*this.R*(be*we-yt*Math.sqrt((ye+It)*(It+1)-we*we))/(ye+It),U>=0?gt=this.y0+ve:gt=this.y0-ve,w.x=lt,w.y=gt,w}function wa(w){var A,U,ft,lt,gt,mt,yt,It,jt,re,Jt,ae,be;return w.x-=this.x0,w.y-=this.y0,Jt=Math.PI*this.R,ft=w.x/Jt,lt=w.y/Jt,gt=ft*ft+lt*lt,mt=-Math.abs(lt)*(1+gt),yt=mt-2*lt*lt+ft*ft,It=-2*mt+1+2*lt*lt+gt*gt,be=lt*lt/It+(2*yt*yt*yt/It/It/It-9*mt*yt/It/It)/27,jt=(mt-yt*yt/3/It)/It,re=2*Math.sqrt(-jt/3),Jt=3*be/jt/re,Math.abs(Jt)>1&&(Jt>=0?Jt=1:Jt=-1),ae=Math.acos(Jt)/3,w.y>=0?U=(-re*Math.cos(ae+Math.PI/3)-yt/3/It)*Math.PI:U=-(-re*Math.cos(ae+Math.PI/3)-yt/3/It)*Math.PI,Math.abs(ft)<o?A=this.long0:A=zt(this.long0+Math.PI*(gt-1+Math.sqrt(1+2*(ft*ft-lt*lt)+gt*gt))/2/ft),w.x=A,w.y=U,w}var ba=["Van_der_Grinten_I","VanDerGrinten","vandg"],Ta={init:va,forward:Ea,inverse:wa,names:ba};function Sa(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)}function xa(w){var A=w.x,U=w.y,ft=Math.sin(w.y),lt=Math.cos(w.y),gt=zt(A-this.long0),mt,yt,It,jt,re,Jt,ae,be,ye,ve,we,Ae,De,Be,ti,qe,Ye,pi,ui,xi,Bi,Ui,nr;return this.sphere?Math.abs(this.sin_p12-1)<=o?(w.x=this.x0+this.a*(r-U)*Math.sin(gt),w.y=this.y0-this.a*(r-U)*Math.cos(gt),w):Math.abs(this.sin_p12+1)<=o?(w.x=this.x0+this.a*(r+U)*Math.sin(gt),w.y=this.y0+this.a*(r+U)*Math.cos(gt),w):(pi=this.sin_p12*ft+this.cos_p12*lt*Math.cos(gt),qe=Math.acos(pi),Ye=qe/Math.sin(qe),w.x=this.x0+this.a*Ye*lt*Math.sin(gt),w.y=this.y0+this.a*Ye*(this.cos_p12*ft-this.sin_p12*lt*Math.cos(gt)),w):(mt=Fi(this.es),yt=Vi(this.es),It=Gi(this.es),jt=Wi(this.es),Math.abs(this.sin_p12-1)<=o?(re=this.a*di(mt,yt,It,jt,r),Jt=this.a*di(mt,yt,It,jt,U),w.x=this.x0+(re-Jt)*Math.sin(gt),w.y=this.y0-(re-Jt)*Math.cos(gt),w):Math.abs(this.sin_p12+1)<=o?(re=this.a*di(mt,yt,It,jt,r),Jt=this.a*di(mt,yt,It,jt,U),w.x=this.x0+(re+Jt)*Math.sin(gt),w.y=this.y0+(re+Jt)*Math.cos(gt),w):(ae=ft/lt,be=Ai(this.a,this.e,this.sin_p12),ye=Ai(this.a,this.e,ft),ve=Math.atan((1-this.es)*ae+this.es*be*this.sin_p12/(ye*lt)),we=Math.atan2(Math.sin(gt),this.cos_p12*Math.tan(ve)-this.sin_p12*Math.cos(gt)),we===0?ui=Math.asin(this.cos_p12*Math.sin(ve)-this.sin_p12*Math.cos(ve)):Math.abs(Math.abs(we)-Math.PI)<=o?ui=-Math.asin(this.cos_p12*Math.sin(ve)-this.sin_p12*Math.cos(ve)):ui=Math.asin(Math.sin(gt)*Math.cos(ve)/Math.sin(we)),Ae=this.e*this.sin_p12/Math.sqrt(1-this.es),De=this.e*this.cos_p12*Math.cos(we)/Math.sqrt(1-this.es),Be=Ae*De,ti=De*De,xi=ui*ui,Bi=xi*ui,Ui=Bi*ui,nr=Ui*ui,qe=be*ui*(1-xi*ti*(1-ti)/6+Bi/8*Be*(1-2*ti)+Ui/120*(ti*(4-7*ti)-3*Ae*Ae*(1-7*ti))-nr/48*Be),w.x=this.x0+qe*Math.sin(we),w.y=this.y0+qe*Math.cos(we),w))}function Ra(w){w.x-=this.x0,w.y-=this.y0;var A,U,ft,lt,gt,mt,yt,It,jt,re,Jt,ae,be,ye,ve,we,Ae,De,Be,ti,qe,Ye,pi;return this.sphere?(A=Math.sqrt(w.x*w.x+w.y*w.y),A>2*r*this.a?void 0:(U=A/this.a,ft=Math.sin(U),lt=Math.cos(U),gt=this.long0,Math.abs(A)<=o?mt=this.lat0:(mt=Si(lt*this.sin_p12+w.y*ft*this.cos_p12/A),yt=Math.abs(this.lat0)-r,Math.abs(yt)<=o?this.lat0>=0?gt=zt(this.long0+Math.atan2(w.x,-w.y)):gt=zt(this.long0-Math.atan2(-w.x,w.y)):gt=zt(this.long0+Math.atan2(w.x*ft,A*this.cos_p12*lt-w.y*this.sin_p12*ft))),w.x=gt,w.y=mt,w)):(It=Fi(this.es),jt=Vi(this.es),re=Gi(this.es),Jt=Wi(this.es),Math.abs(this.sin_p12-1)<=o?(ae=this.a*di(It,jt,re,Jt,r),A=Math.sqrt(w.x*w.x+w.y*w.y),be=ae-A,mt=Yi(be/this.a,It,jt,re,Jt),gt=zt(this.long0+Math.atan2(w.x,-1*w.y)),w.x=gt,w.y=mt,w):Math.abs(this.sin_p12+1)<=o?(ae=this.a*di(It,jt,re,Jt,r),A=Math.sqrt(w.x*w.x+w.y*w.y),be=A-ae,mt=Yi(be/this.a,It,jt,re,Jt),gt=zt(this.long0+Math.atan2(w.x,w.y)),w.x=gt,w.y=mt,w):(A=Math.sqrt(w.x*w.x+w.y*w.y),we=Math.atan2(w.x,w.y),ye=Ai(this.a,this.e,this.sin_p12),Ae=Math.cos(we),De=this.e*this.cos_p12*Ae,Be=-De*De/(1-this.es),ti=3*this.es*(1-Be)*this.sin_p12*this.cos_p12*Ae/(1-this.es),qe=A/ye,Ye=qe-Be*(1+Be)*Math.pow(qe,3)/6-ti*(1+3*Be)*Math.pow(qe,4)/24,pi=1-Be*Ye*Ye/2-qe*Ye*Ye*Ye/6,ve=Math.asin(this.sin_p12*Math.cos(Ye)+this.cos_p12*Math.sin(Ye)*Ae),gt=zt(this.long0+Math.asin(Math.sin(we)*Math.sin(Ye)/Math.cos(ve))),mt=Math.atan((1-this.es*pi*this.sin_p12/Math.sin(ve))*Math.tan(ve)/(1-this.es)),w.x=gt,w.y=mt,w))}var Ma=["Azimuthal_Equidistant","aeqd"],Pa={init:Sa,forward:xa,inverse:Ra,names:Ma};function Ca(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)}function La(w){var A,U,ft,lt,gt,mt,yt,It,jt=w.x,re=w.y;return ft=zt(jt-this.long0),A=Math.sin(re),U=Math.cos(re),lt=Math.cos(ft),mt=this.sin_p14*A+this.cos_p14*U*lt,gt=1,(mt>0||Math.abs(mt)<=o)&&(yt=this.a*gt*U*Math.sin(ft),It=this.y0+this.a*gt*(this.cos_p14*A-this.sin_p14*U*lt)),w.x=yt,w.y=It,w}function Aa(w){var A,U,ft,lt,gt,mt,yt;return w.x-=this.x0,w.y-=this.y0,A=Math.sqrt(w.x*w.x+w.y*w.y),U=Si(A/this.a),ft=Math.sin(U),lt=Math.cos(U),mt=this.long0,Math.abs(A)<=o?(yt=this.lat0,w.x=mt,w.y=yt,w):(yt=Si(lt*this.sin_p14+w.y*ft*this.cos_p14/A),gt=Math.abs(this.lat0)-r,Math.abs(gt)<=o?(this.lat0>=0?mt=zt(this.long0+Math.atan2(w.x,-w.y)):mt=zt(this.long0-Math.atan2(-w.x,w.y)),w.x=mt,w.y=yt,w):(mt=zt(this.long0+Math.atan2(w.x*ft,A*this.cos_p14*lt-w.y*this.sin_p14*ft)),w.x=mt,w.y=yt,w))}var Oa=["ortho"],Ia={init:Ca,forward:La,inverse:Aa,names:Oa},Na=function(w){w.Proj.projections.add(xe),w.Proj.projections.add(qi),w.Proj.projections.add(mr),w.Proj.projections.add(Ji),w.Proj.projections.add(Lr),w.Proj.projections.add(Dr),w.Proj.projections.add(Wr),w.Proj.projections.add(jr),w.Proj.projections.add($r),w.Proj.projections.add(en),w.Proj.projections.add(vn),w.Proj.projections.add(xn),w.Proj.projections.add(Ln),w.Proj.projections.add(kn),w.Proj.projections.add(Bn),w.Proj.projections.add(qn),w.Proj.projections.add(Zn),w.Proj.projections.add(is),w.Proj.projections.add(ls),w.Proj.projections.add(tr),w.Proj.projections.add(ya),w.Proj.projections.add(Ta),w.Proj.projections.add(Pa),w.Proj.projections.add(Ia)};return ze.defaultDatum="WGS84",ze.Proj=Bt,ze.WGS84=new ze.Proj("WGS84"),ze.Point=Ot,ze.toPoint=Fe,ze.defs=qt,ze.transform=ni,ze.mgrs=ki,ze.version=Wt,Na(ze),ze}),B("formats/geotiff/TiffIFDEntry",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffUtil","../../util/Logger","./TiffConstants"],function(p,l,n,e,i){"use strict";var t=function(r,s,a,f,o,c){if(!r)throw new l(e.logMessage(e.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingTag"));if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingType"));if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingCount"));if(f==null)throw new l(e.logMessage(e.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingValueOffset"));if(!o)throw new l(e.logMessage(e.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingGeoTiffData"));if(c==null)throw new l(e.logMessage(e.LEVEL_SEVERE,"TiffIFDEntry","constructor","missingIsLittleEndian"));this._tag=r,this._type=s,this._count=a,this._valueOffset=f,this._geoTiffData=o,this._isLittleEndian=c};return Object.defineProperties(t.prototype,{tag:{get:function(){return this._tag}},type:{get:function(){return this._type}},count:{get:function(){return this._count}},valueOffset:{get:function(){return this._valueOffset}},geoTiffData:{get:function(){return this._geoTiffData}},isLittleEndian:{get:function(){return this._isLittleEndian}}}),t.prototype.getIFDTypeLength=function(){switch(this.type){case i.Type.BYTE:case i.Type.ASCII:case i.Type.SBYTE:case i.Type.UNDEFINED:return 1;case i.Type.SHORT:case i.Type.SSHORT:return 2;case i.Type.LONG:case i.Type.SLONG:case i.Type.FLOAT:return 4;case i.Type.RATIONAL:case i.Type.SRATIONAL:case i.Type.DOUBLE:return 8;default:return-1}},t.prototype.getIFDEntryValue=function(){var r=[],s=null,a=this.getIFDTypeLength(),f=a*this.count;if(f<=4)this.isLittleEndian===!1?s=this.valueOffset>>>(4-a)*8:s=this.valueOffset,r.push(s);else for(var o=0;o<this.count;o++){var c=a*o;if(a>=8)if(this.type===i.Type.RATIONAL||this.type===i.Type.SRATIONAL)r.push(n.getBytes(this.geoTiffData,this.valueOffset+c,4,this.isLittleEndian)),r.push(n.getBytes(this.geoTiffData,this.valueOffset+c+4,4,this.isLittleEndian));else if(this.type===i.Type.DOUBLE)r.push(n.getBytes(this.geoTiffData,this.valueOffset+c,8,this.isLittleEndian));else throw new p(e.logMessage(e.LEVEL_SEVERE,"TiffIFDEntry","parse","invalidTypeOfIFD"));else r.push(n.getBytes(this.geoTiffData,this.valueOffset+c,a,this.isLittleEndian))}return this.type===i.Type.ASCII?(r.forEach(function(d,h,u){d===0?u.splice(h,1):u[h]=String.fromCharCode(d)}),r.join("")):r},t}),B("util/WWUtil",["../error/ArgumentError","../geom/Line","../util/Logger","../geom/Rectangle","../geom/Vec3"],function(p,l,n,e,i){"use strict";var t={latLonRegex:/^(\-?\d+(\.\d+)?),\s*(\-?\d+(\.\d+)?)$/,suffixForMimeType:function(r){return r==="image/png"?"png":r==="image/jpeg"?"jpg":r==="application/bil16"||r==="application/bil32"?"bil":null},currentUrlSansFilePart:function(){for(var r=window.location.protocol,s=window.location.host,a=window.location.pathname,f=a.split("/"),o="",c=0,d=f.length;c<d-1;c++)f[c].length>0&&(o=o+"/"+f[c]);return r+"//"+s+o},worldwindlibLocation:function(){for(var r=document.getElementsByTagName("script"),s="/worldwind.",a=0;a<r.length;a++){var f=r[a].src.indexOf(s);if(f>=0)return r[a].src.substring(0,f)+"/"}return null},urlPath:function(r){if(!r)return"";for(var s=r.split("/"),a="",f=0,o=s.length;f<o;f++){var c=s[f];!c||c.length===0||c.indexOf(":")!=-1||c==="."||c===".."||c==="null"||c==="undefined"||(a.length!==0&&(a=a+"/"),a=a+c)}return a},fillArray:function(r,s){if(r)for(var a=0,f=r.length;a<f;a++)r[a]=s},multiplyArray:function(r,s){if(r)for(var a=0,f=r.length;a<f;a++)r[a]*=s},jsonpCounter:0,jsonp:function(r,s,a){var f="gov_nasa_worldwind_jsonp_"+t.jsonpCounter++;window[f]=function(u){delete window[f],a(u)};var o=r+(r.indexOf("?")===-1?"?":"&");o+=s+"="+f;var c=document.createElement("script");c.async=!0,o=o.substr(0,o.indexOf("?"))+encodeURIComponent(o.substr(r.indexOf("?"))),c.src=o;var d=document.getElementsByTagName("head")[0],h=function(){c.onload=void 0,c.onerror=void 0,d.removeChild(c)};c.onload=h,c.onerror=h,d.appendChild(c)},arrayEquals:function(r,s){return r.length==s.length&&r.every(function(a,f){return a===s[f]||a.equals&&a.equals(s[f])})},transformToBoolean:function(r){return r==0||r=="0"||r=="false"?!1:!!r},clone:function(r){var s={},a,f=Object.keys(r);for(a=0;a<f.length;a++)s[f[a]]=r[f[a]];return s},guid:function(){function r(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return r()+r()+"-"+r()+"-"+r()+"-"+r()+"-"+r()+r()+r()},date:function(r){return new Date(r)},startsWith:function(r,s,a){return a=a||0,r.substr(a,s.length)===s},endsWith:function(r,s,a){(typeof a!="number"||!isFinite(a)||Math.floor(a)!==a||a>r.length)&&(a=r.length),a-=s.length;var f=r.lastIndexOf(s,a);return f!==-1&&f===a}};return t}),B("formats/geotiff/GeoTiffReader",["../../error/AbstractError","../../error/ArgumentError","./GeoTiffConstants","./GeoTiffKeyEntry","./GeoTiffMetadata","./GeoTiffUtil","../../geom/Location","../../geom/Sector","../../util/Logger","../../util/proj4-src","./TiffConstants","./TiffIFDEntry","../../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o,c,d){"use strict";var h=function(u){if(!u)throw new l(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","constructor","missingArrayBuffer"));this._isLittleEndian=!1,this._imageFileDirectories=[],this._geoTiffData=new DataView(u),this._metadata=new i,this.parse()};return Object.defineProperties(h.prototype,{isLittleEndian:{get:function(){return this._isLittleEndian}},imageFileDirectories:{get:function(){return this._imageFileDirectories}},geoTiffData:{get:function(){return this._geoTiffData}},metadata:{get:function(){return this._metadata}}}),h.retrieveFromUrl=function(u,m){if(!u)throw new l(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","retrieveFromUrl","missingUrl"));if(!m)throw new l(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","retrieveFromUrl","The specified callback is null or undefined."));var g=new XMLHttpRequest;g.open("GET",u,!0),g.responseType="arraybuffer",g.onreadystatechange=(function(){if(g.readyState===4)if(g.status===200){var _=g.response;_&&m(new h(_),g)}else a.log(a.LEVEL_WARNING,"GeoTiff retrieval failed ("+g.statusText+"): "+u),m(null,g)}).bind(this),g.onerror=function(){a.log(a.LEVEL_WARNING,"GeoTiff retrieval failed: "+u),m(null,g)},g.ontimeout=function(){a.log(a.LEVEL_WARNING,"GeoTiff retrieval timed out: "+u),m(null,g)},g.send(null)},h.prototype.parse=function(){if(!this._imageFileDirectories.length){if(this.getEndianness(),!this.isTiffFileType())throw new p(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","parse","invalidTiffFileType"));var u=t.getBytes(this.geoTiffData,4,4,this.isLittleEndian);this.parseImageFileDirectory(u),this.getMetadataFromImageFileDirectory(),this.parseGeoKeys(),this.setBBox()}},h.prototype.getEndianness=function(){var u=t.getBytes(this.geoTiffData,0,2,this.isLittleEndian);if(u===18761)this._isLittleEndian=!0;else if(u===19789)this._isLittleEndian=!1;else throw new p(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","getEndianness","invalidByteOrderValue"))},h.prototype.getImage=function(){return this.createImage()},h.prototype.getImageData=function(){return this.createTypedElevationArray()},h.prototype.isTiffFileType=function(){var u=t.getBytes(this.geoTiffData,2,2,this.isLittleEndian);return u===42},h.prototype.isGeoTiff=function(){return!!this.getIFDByTag(n.Tag.GEO_KEY_DIRECTORY)},h.prototype.createImage=function(){var u=this.metadata.bitsPerSample,m=this.metadata.samplesPerPixel,g=this.metadata.photometricInterpretation,_=this.metadata.imageLength,y=this.metadata.imageWidth;if(this.metadata.colorMap)var v=this.metadata.colorMap,b=Math.pow(2,u[0]);var R=document.createElement("canvas");R.width=y,R.height=_;var M=R.getContext("2d");if(this.metadata.stripOffsets){var P=this.parseStrips(!1);if(this.metadata.rowsPerStrip)var T=this.metadata.rowsPerStrip;else var T=_;for(var E=P.length,x=0,S=T,L=_%T,C=L===0?T:L,F=0;F<E;F++){F+1===E&&(S=C);for(var q=P[F].length,it=x*F,st=0,pt=0;st<S,pt<q;st++)for(var _t=0;_t<y;_t++,pt++){var X=P[F][pt];M.fillStyle=this.getFillStyle(X,g,u,m,v,b),M.fillRect(_t,it+st,1,1)}x=T}}else if(this.metadata.tileOffsets)for(var ot=this.parseTiles(!1),Tt=this.metadata.tileWidth,Vt=this.metadata.tileLength,Gt=Math.ceil(y/Tt),st=0;st<_;st++)for(var _t=0;_t<y;_t++){var qt=Math.floor(_t/Tt),Qt=Math.floor(st/Vt),ne=Qt*Gt+qt,j=_t%Tt,J=st%Vt,at=J*Tt+j,X=ot[ne][at];M.fillStyle=this.getFillStyle(X,g,u,m,v,b),M.fillRect(_t,st,1,1)}return this._geoTiffData=null,R},h.prototype.getFillStyle=function(u,m,g,_,y,v){var b=0,R=0,M=0,P=1;switch(this.metadata.noData&&u[0]==this.metadata.noData&&(P=0),m){case o.PhotometricInterpretation.WHITE_IS_ZERO:var T=Math.pow(2,g)-1;u[0]=T-u[0];case o.PhotometricInterpretation.BLACK_IS_ZERO:b=R=M=t.clampColorSample(u[0],g[0]);break;case o.PhotometricInterpretation.RGB:if(b=t.clampColorSample(u[0],g[0]),R=t.clampColorSample(u[1],g[1]),M=t.clampColorSample(u[2],g[2]),_===4&&this.metadata.extraSamples[0]===2){var E=Math.pow(2,g[3]);P=u[3]/E}break;case o.PhotometricInterpretation.RGB_PALETTE:if(y){var x=u[0];b=t.clampColorSample(y[x],16),R=t.clampColorSample(y[v+x],16),M=t.clampColorSample(y[2*v+x],16)}break;case o.PhotometricInterpretation.TRANSPARENCY_MASK:a.log(a.LEVEL_WARNING,"Photometric interpretation not yet implemented: TRANSPARENCY_MASK");break;case o.PhotometricInterpretation.CMYK:a.log(a.LEVEL_WARNING,"Photometric interpretation not yet implemented: CMYK");break;case o.PhotometricInterpretation.Y_Cb_Cr:a.log(a.LEVEL_WARNING,"Photometric interpretation not yet implemented: Y_Cb_Cr");break;case o.PhotometricInterpretation.CIE_LAB:a.log(a.LEVEL_WARNING,"Photometric interpretation not yet implemented: CIE_LAB");break;default:a.log("Unknown photometric interpretation: "+m);break}return t.getRGBAFillValue(b,R,M,P)},h.prototype.createTypedElevationArray=function(){var u=[],m,g=this.metadata.bitsPerSample[0];if(this.metadata.stripOffsets)for(var _=this.parseStrips(!0),y=0;y<_.length;y++)u=u.concat(_[y]);else if(this.metadata.tileOffsets)for(var v=this.parseTiles(!0),b=this.metadata.imageWidth,R=this.metadata.imageLength,M=this.metadata.tileWidth,P=this.metadata.tileLength,T=Math.ceil(b/M),E=0;E<R;E++)for(var x=0;x<b;x++){var S=Math.floor(x/M),L=Math.floor(E/P),C=L*T+S,F=x%M,q=E%P,it=q*M+F,st=v[C][it];u.push(st)}if(this.metadata.sampleFormat)var pt=this.metadata.sampleFormat[0];else var pt=o.SampleFormat.UNSIGNED;switch(g){case 8:pt===o.SampleFormat.SIGNED?m=new Int8Array(u):m=new Uint8Array(u);break;case 16:pt===o.SampleFormat.SIGNED?m=new Int16Array(u):m=new Uint16Array(u);break;case 32:pt===o.SampleFormat.SIGNED?m=new Int32Array(u):pt===o.SampleFormat.IEEE_FLOAT?m=new Float32Array(u):m=new Uint32Array(u);break;case 64:m=new Float64Array(u);break;default:break}return m},h.prototype.parseStrips=function(u){var m=this.metadata.samplesPerPixel,g=this.metadata.bitsPerSample,_=this.metadata.stripOffsets,y=this.metadata.stripByteCounts,v=this.metadata.compression;if(this.metadata.sampleFormat)var b=this.metadata.sampleFormat;else var b=o.SampleFormat.UNSIGNED;for(var R=m*g[0],M=R/8,P=[],T=0;T<_.length;T++){var E=_[T],x=y[T];P[T]=this.parseBlock(u,v,M,x,E,g,b)}return P},h.prototype.parseBlock=function(u,m,g,_,y,v,b){var R=[];switch(m){case o.Compression.UNCOMPRESSED:for(var M=0,P=g;M<_;M+=P){for(var T=0,pt=[];T<v.length;T++){var E=v[T]/8,x=T*E;pt.push(t.getSampleBytes(this.geoTiffData,y+M+x,E,b[T],this.isLittleEndian))}u?R.push(pt[0]):R.push(pt)}break;case o.Compression.CCITT_1D:a.log(a.LEVEL_WARNING,"Compression type not yet implemented: CCITT_1D");break;case o.Compression.GROUP_3_FAX:a.log(a.LEVEL_WARNING,"Compression type not yet implemented: GROUP_3_FAX");break;case o.Compression.GROUP_4_FAX:a.log(a.LEVEL_WARNING,"Compression type not yet implemented: GROUP_4_FAX");break;case o.Compression.LZW:a.log(a.LEVEL_WARNING,"Compression type not yet implemented: LZW");break;case o.Compression.JPEG:a.log(a.LEVEL_WARNING,"Compression type not yet implemented: JPEG");break;case o.Compression.PACK_BITS:if(this.metadata.tileOffsets)var S=this.metadata.tileWidth,L=this.metadata.tileWidth,C=new ArrayBuffer(S*L*g);else var F=this.metadata.rowsPerStrip,q=this.metadata.imageWidth,C=new ArrayBuffer(F*q*g);for(var it=new DataView(C),st=!0,pt=[],_t=0,X=0,ot=0,M=0;M<_;M+=1)if(st){_t=1,X=1,st=!1;var Tt=this.geoTiffData.getInt8(y+M,this.isLittleEndian);Tt>=0&&Tt<=127?_t=Tt+1:Tt>=-127&&Tt<=-1?X=-Tt+1:st=!0}else{for(var Vt=t.getBytes(this.geoTiffData,y+M,1,this.isLittleEndian),Gt=0;Gt<X;Gt++)it.setInt8(ot,Vt),ot++;_t--,_t===0&&(st=!0)}for(var M=0,P=g;M<C.byteLength;M+=P){for(var T=0,pt=[];T<v.length;T++){var E=v[T]/8,x=T*E;pt.push(t.getSampleBytes(it,M+x,E,b[T],this.isLittleEndian))}u?R.push(pt[0]):R.push(pt)}break}return R},h.prototype.parseTiles=function(u){var m=this.metadata.samplesPerPixel,g=this.metadata.bitsPerSample,_=this.metadata.compression;if(this.metadata.sampleFormat)var y=this.metadata.sampleFormat;else{var y=new Array(m);d.fillArray(y,o.SampleFormat.UNSIGNED)}for(var v=m*g[0],b=v/8,R=this.metadata.tileWidth,M=this.metadata.tileLength,P=this.metadata.tileOffsets,T=this.metadata.tileByteCounts,E=this.metadata.imageLength,x=this.metadata.imageWidth,S=Math.ceil(x/R),L=Math.ceil(E/M),C=[],F=0;F<L;F++)for(var q=0;q<S;q++){var it=S*F+q,st=P[it],pt=T[it];C[it]=this.parseBlock(u,_,b,pt,st,g,y)}return C},h.prototype.geoTiffImageToPCS=function(u,m){if(u==null)throw new l(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","geoTiffImageToPCS","missingXValue"));if(m==null)throw new l(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","geoTiffImageToPCS","missingYValue"));var g=[u,m],_=this.metadata.modelTiepoint,y=this.metadata.modelPixelScale,v=this.metadata.modelTransformation,b=_?_.length:0,R=y?y.length:0,M=v?v.length:0;if(!(b>6&&R===0))if(M===16){var P=u,T=m;u=P*v[0]+T*v[1]+v[3],m=P*v[4]+T*v[5]+v[7],g=[u,m]}else R<3||b<6?g=[u,m]:(u=(u-_[0])*y[0]+_[3],m=(m-_[1])*(-1*y[1])+_[4],g=[u,m]);return f.defs([["EPSG:26771","+proj=tmerc +lat_0=36.66666666666666 +lon_0=-88.33333333333333 +k=0.9999749999999999 +x_0=152400.3048006096 +y_0=0 +ellps=clrk66 +datum=NAD27 +to_meter=0.3048006096012192 +no_defs "],["EPSG:32633","+proj=utm +zone=33 +datum=WGS84 +units=m +no_defs"]]),this.metadata.projectedCSType&&(g=f("EPSG:"+this.metadata.projectedCSType,"EPSG:4326",g)),new r(g[1],g[0])},h.prototype.setBBox=function(){var u=this.geoTiffImageToPCS(0,0),m=this.geoTiffImageToPCS(this.metadata.imageWidth,0),g=this.geoTiffImageToPCS(0,this.metadata.imageLength),_=this.geoTiffImageToPCS(this.metadata.imageWidth,this.metadata.imageLength);this.metadata.bbox=new s(g.latitude,u.latitude,u.longitude,m.longitude)},h.prototype.getMetadataFromImageFileDirectory=function(){for(var u=0;u<this.imageFileDirectories[0].length;u++)switch(this.imageFileDirectories[0][u].tag){case o.Tag.BITS_PER_SAMPLE:this.metadata.bitsPerSample=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.COLOR_MAP:this.metadata.colorMap=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.COMPRESSION:this.metadata.compression=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.EXTRA_SAMPLES:this.metadata.extraSamples=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.IMAGE_DESCRIPTION:this.metadata.imageDescription=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.IMAGE_LENGTH:this.metadata.imageLength=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.IMAGE_WIDTH:this.metadata.imageWidth=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.MAX_SAMPLE_VALUE:this.metadata.maxSampleValue=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.MIN_SAMPLE_VALUE:this.metadata.minSampleValue=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.ORIENTATION:this.metadata.orientation=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.PHOTOMETRIC_INTERPRETATION:this.metadata.photometricInterpretation=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.PLANAR_CONFIGURATION:this.metadata.planarConfiguration=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.ROWS_PER_STRIP:this.metadata.rowsPerStrip=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.RESOLUTION_UNIT:this.metadata.resolutionUnit=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.SAMPLES_PER_PIXEL:this.metadata.samplesPerPixel=this.imageFileDirectories[0][u].getIFDEntryValue()[0];break;case o.Tag.SAMPLE_FORMAT:this.metadata.sampleFormat=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.SOFTWARE:this.metadata.software=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.STRIP_BYTE_COUNTS:this.metadata.stripByteCounts=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.STRIP_OFFSETS:this.metadata.stripOffsets=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.TILE_BYTE_COUNTS:this.metadata.tileByteCounts=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.TILE_OFFSETS:this.metadata.tileOffsets=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.TILE_LENGTH:this.metadata.tileLength=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.TILE_WIDTH:this.metadata.tileWidth=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.X_RESOLUTION:this.metadata.xResolution=this.imageFileDirectories[0][u].getIFDEntryValue();break;case o.Tag.Y_RESOLUTION:this.metadata.tileWidth=this.imageFileDirectories[0][u].getIFDEntryValue();break;case n.Tag.GEO_ASCII_PARAMS:this.metadata.geoAsciiParams=this.imageFileDirectories[0][u].getIFDEntryValue();break;case n.Tag.GEO_DOUBLE_PARAMS:this.metadata.geoDubleParams=this.imageFileDirectories[0][u].getIFDEntryValue();break;case n.Tag.GEO_KEY_DIRECTORY:this.metadata.geoKeyDirectory=this.imageFileDirectories[0][u].getIFDEntryValue();break;case n.Tag.MODEL_PIXEL_SCALE:this.metadata.modelPixelScale=this.imageFileDirectories[0][u].getIFDEntryValue();break;case n.Tag.MODEL_TIEPOINT:this.metadata.modelTiepoint=this.imageFileDirectories[0][u].getIFDEntryValue();break;case n.Tag.GDAL_METADATA:this.metadata.metaData=this.imageFileDirectories[0][u].getIFDEntryValue();break;case n.Tag.GDAL_NODATA:this.metadata.noData=this.imageFileDirectories[0][u].getIFDEntryValue();break;default:a.log(a.LEVEL_WARNING,"Ignored GeoTiff tag: "+this.imageFileDirectories[0][u].tag)}},h.prototype.parseGeoKeys=function(){if(!this.isGeoTiff())throw new p(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","parse","invalidGeoTiffFile"));var u=this.metadata.geoKeyDirectory;if(u)for(var m=u[0],g=u[1],_=u[2],y=u[3],v=0;v<y;v++){var b=u[4+v*4],R=u[5+v*4],M=u[6+v*4],P=u[7+v*4];switch(b){case n.Key.GTModelTypeGeoKey:this.metadata.gtModelTypeGeoKey=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.GTRasterTypeGeoKey:this.metadata.gtRasterTypeGeoKey=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.GTCitationGeoKey:this.metadata.gtCitationGeoKey=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.GeographicTypeGeoKey:this.metadata.geographicTypeGeoKey=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.GeogCitationGeoKey:this.metadata.geogCitationGeoKey=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.GeogAngularUnitsGeoKey:this.metadata.geogAngularUnitsGeoKey=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.GeogAngularUnitSizeGeoKey:this.metadata.geogAngularUnitSizeGeoKey=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.GeogSemiMajorAxisGeoKey:this.metadata.geogSemiMajorAxisGeoKey=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.GeogInvFlatteningGeoKey:this.metadata.geogInvFlatteningGeoKey=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.ProjectedCSTypeGeoKey:this.metadata.projectedCSType=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;case n.Key.ProjLinearUnitsGeoKey:this.metadata.projLinearUnits=new e(b,R,M,P).getGeoKeyValue(this.metadata.geoDoubleParams,this.metadata.geoAsciiParams);break;default:a.log(a.LEVEL_WARNING,"Ignored GeoTiff key: "+b);break}}else throw new p(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","parseGeoKeys","missingGeoKeyDirectoryTag"))},h.prototype.parseImageFileDirectory=function(u){if(!u)throw new l(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","parseImageFileDirectory","missingOffset"));for(var m=t.getBytes(this.geoTiffData,u,2,this.isLittleEndian),g=[],_=u+2,y=0;y<m;_+=12,y++){var v=t.getBytes(this.geoTiffData,_,2,this.isLittleEndian),b=t.getBytes(this.geoTiffData,_+2,2,this.isLittleEndian),R=t.getBytes(this.geoTiffData,_+4,4,this.isLittleEndian),M=t.getBytes(this.geoTiffData,_+8,4,this.isLittleEndian);g.push(new c(v,b,R,M,this.geoTiffData,this.isLittleEndian))}this._imageFileDirectories.push(g);var P=t.getBytes(this.geoTiffData,_,4,this.isLittleEndian);P!==0&&this.parseImageFileDirectory(P)},h.prototype.getIFDByTag=function(u){if(!u)throw new l(a.logMessage(a.LEVEL_SEVERE,"GeoTiffReader","getIFDByTag","missingTag"));for(var m=0;m<this.imageFileDirectories[0].length;m++)if(this.imageFileDirectories[0][m].tag===u)return this.imageFileDirectories[0][m];return null},h}),B("util/Level",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger"],function(p,l,n,e){"use strict";var i=function(t,r,s){if(!r)throw new l(e.logMessage(e.LEVEL_SEVERE,"Level","constructor","The specified tile delta is null or undefined"));if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"Level","constructor","The specified parent level set is null or undefined"));this.levelNumber=t,this.tileDelta=r,this.parent=s,this.texelSize=r.latitude*p.DEGREES_TO_RADIANS/s.tileHeight,this.tileWidth=s.tileWidth,this.tileHeight=s.tileHeight,this.sector=s.sector};return i.prototype.isFirstLevel=function(){return this.parent.firstLevel()==this},i.prototype.isLastLevel=function(){return this.parent.lastLevel()==this},i.prototype.previousLevel=function(){return this.parent.level(this.levelNumber-1)},i.prototype.nextLevel=function(){return this.parent.level(this.levelNumber+1)},i.prototype.compare=function(t){if(!t)throw new l(e.logMessage(e.LEVEL_SEVERE,"Level","compare","The specified level is null or undefined"));return this.levelNumber<t.levelNumber?-1:this.levelNumber>t.levelNumber?1:0},i}),B("util/LevelSet",["../error/ArgumentError","../util/Level","../geom/Location","../util/Logger"],function(p,l,n,e){"use strict";var i=function(t,r,s,a,f){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"LevelSet","constructor","missingSector"));if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"LevelSet","constructor","The specified level zero delta is null or undefined"));if(r.latitude<=0||r.longitude<=0)throw new p(e.logMessage(e.LEVEL_SEVERE,"LevelSet","constructor","The specified level zero delta is less than or equal to zero."));if(s<1)throw new p(e.logMessage(e.LEVEL_SEVERE,"LevelSet","constructor","The specified number of levels is less than one."));if(a<1||f<1)throw new p(e.logMessage(e.LEVEL_SEVERE,"LevelSet","constructor","The specified tile width or tile height is less than one."));this.sector=t,this.levelZeroDelta=r,this.numLevels=s,this.tileWidth=a,this.tileHeight=f,this.levels=[];for(var o=0;o<s;o+=1){var c=Math.pow(2,o),d=r.latitude/c,h=r.longitude/c,u=new n(d,h),m=new l(o,u,this);this.levels[o]=m}};return i.numLevelsForResolution=function(t,r){if(!t||!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"LevelSet","numLevelsForResolution","missingResolution"));var s=Math.log(t/r)/Math.log(2);return s<0&&(s=0),s+1},i.prototype.level=function(t){return t<0||t>=this.levels.length?null:this.levels[t]},i.prototype.levelForTexelSize=function(t){var r=this.lastLevel();if(r.texelSize>=t)return r;for(var s=0,a=this.levels.length;s<a;s+=1){var f=this.levels[s];if(f.texelSize<=t)return f}return r},i.prototype.firstLevel=function(){return this.levels[0]},i.prototype.lastLevel=function(){return this.levels[this.levels.length-1]},i}),B("cache/MemoryCache",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e,i){if(!e||e<1)throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","constructor","The specified capacity is undefined, zero or negative"));if(!i||i>=e||i<0)throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","constructor","The specified low-water value is undefined, greater than or equal to the capacity, or less than 1"));this._capacity=e,this._lowWater=i,this.usedCapacity=0,this.freeCapacity=e,this.entries={},this.listeners=[]};return Object.defineProperties(n.prototype,{capacity:{get:function(){return this._capacity},set:function(e){if(!e||e<1)throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","capacity","Specified cache capacity is undefined, 0 or negative."));var i=this._capacity;this._capacity=e,this._capacity<=this.lowWater&&(this._lowWater=.85*this._capacity),this._capacity<i&&this.makeSpace(0)}},lowWater:{get:function(){return this._lowWater},set:function(e){if(!e||e>=this._capacity||e<0)throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","lowWater","Specified cache low-water value is undefined, negative or not less than the current capacity."));this._lowWater=e}}}),n.prototype.entryForKey=function(e){if(!e)return null;var i=this.entries[e];return i?(i.lastUsed=Date.now(),i.entry):null},n.prototype.putEntry=function(e,i,t){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","putEntry","missingKey."));if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","putEntry","missingEntry."));if(t<1)throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","putEntry","The specified entry size is less than 1."));var r=this.entries[e],s;r&&this.removeEntry(e),this.usedCapacity+t>this._capacity&&this.makeSpace(t),this.usedCapacity+=t,this.freeCapacity=this._capacity-this.usedCapacity,s={key:e,entry:i,size:t,lastUsed:Date.now(),agingFactor:1},this.entries[e]=s},n.prototype.clear=function(e){if(e)for(var i in this.entries)this.entries.hasOwnProperty(i)&&this.removeCacheEntry(i);this.entries={},this.freeCapacity=this._capacity,this.usedCapacity=0},n.prototype.removeEntry=function(e){if(e){var i=this.entries[e];i&&this.removeCacheEntry(i)}},n.prototype.setEntryAgingFactor=function(e,i){if(e){var t=this.entries[e];t&&(t.agingFactor=i)}},n.prototype.removeCacheEntry=function(e){delete this.entries[e.key],this.usedCapacity-=e.size,this.freeCapacity=this._capacity-this.usedCapacity;for(var i=0,t=this.listeners.length;i<t;i++)try{this.listeners[i].entryRemoved(e.key,e.entry)}catch(r){this.listeners[i].removalError(r,e.key,e.entry)}},n.prototype.containsKey=function(e){return e&&this.entries[e]},n.prototype.addCacheListener=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","addCacheListener","missingListener"));if(typeof e.entryRemoved!="function"||typeof e.removalError!="function")throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","addCacheListener","The specified listener does not implement the required functions."));this.listeners.push(e)},n.prototype.removeCacheListener=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"MemoryCache","removeCacheListener","missingListener"));var i=this.listeners.indexOf(e);i>-1&&this.listeners.splice(i,1)},n.prototype.makeSpace=function(e){var i=[],t=Date.now();for(var r in this.entries)this.entries.hasOwnProperty(r)&&i.push(this.entries[r]);i.sort(function(f,o){var c=(t-f.lastUsed)*f.agingFactor,d=(t-o.lastUsed)*o.agingFactor;return d-c});for(var s=0,a=i.length;s<a&&(this.usedCapacity>this._lowWater||this.freeCapacity<e);s++)this.removeCacheEntry(i[s])},n}),B("shaders/BasicProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(p,l,n,e){"use strict";var i=function(t){var r="attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nvoid main() {gl_Position = mvpMatrix * vertexPoint;}",s="precision mediump float;\nuniform vec4 color;\nvoid main() {gl_FragColor = color;}";n.call(this,t,r,s),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.colorLocation=this.uniformLocation(t,"color")};return i.key="WorldWindGpuBasicProgram",i.prototype=Object.create(n.prototype),i.prototype.loadModelviewProjection=function(t,r){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"BasicProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(t,r,this.mvpMatrixLocation)},i.prototype.loadColor=function(t,r){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"BasicProgram","loadColor","missingColor"));this.loadUniformColor(t,r,this.colorLocation)},i.prototype.loadColorComponents=function(t,r,s,a,f){this.loadUniformColorComponents(t,r,s,a,f,this.colorLocation)},i}),B("geom/Frustum",["../error/ArgumentError","../geom/Matrix","../geom/Plane","../util/Logger"],function(p,l,n,e){"use strict";var i=function(t,r,s,a,f,o){if(!t||!r||!s||!a||!f||!o)throw new p(e.logMessage(e.LEVEL_SEVERE,"Frustum","constructor","missingPlane"));this._left=t,this._right=r,this._bottom=s,this._top=a,this._near=f,this._far=o,this._planes=[this._left,this._right,this._top,this._bottom,this._near,this._far]};return Object.defineProperties(i.prototype,{left:{get:function(){return this._left}},right:{get:function(){return this._right}},bottom:{get:function(){return this._bottom}},top:{get:function(){return this._top}},near:{get:function(){return this._near}},far:{get:function(){return this._far}}}),i.prototype.transformByMatrix=function(t){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"Frustum","transformByMatrix","missingMatrix"));return this._left.transformByMatrix(t),this._right.transformByMatrix(t),this._bottom.transformByMatrix(t),this._top.transformByMatrix(t),this._near.transformByMatrix(t),this._far.transformByMatrix(t),this},i.prototype.normalize=function(){return this._left.normalize(),this._right.normalize(),this._bottom.normalize(),this._top.normalize(),this._near.normalize(),this._far.normalize(),this},i.unitFrustum=function(){return new i(new n(1,0,0,1),new n(-1,0,0,1),new n(0,1,1,1),new n(0,-1,0,1),new n(0,0,-1,1),new n(0,0,1,1))},i.fromProjectionMatrix=function(t){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"Frustum","fromProjectionMatrix","missingMatrix"));var r,s,a,f,o,c,d,h,u,m,g;return r=t[12]+t[0],s=t[13]+t[1],a=t[14]+t[2],f=t[15]+t[3],o=Math.sqrt(r*r+s*s+a*a),c=new n(r/o,s/o,a/o,f/o),r=t[12]-t[0],s=t[13]-t[1],a=t[14]-t[2],f=t[15]-t[3],o=Math.sqrt(r*r+s*s+a*a),d=new n(r/o,s/o,a/o,f/o),r=t[12]+t[4],s=t[13]+t[5],a=t[14]+t[6],f=t[15]+t[7],o=Math.sqrt(r*r+s*s+a*a),u=new n(r/o,s/o,a/o,f/o),r=t[12]-t[4],s=t[13]-t[5],a=t[14]-t[6],f=t[15]-t[7],o=Math.sqrt(r*r+s*s+a*a),h=new n(r/o,s/o,a/o,f/o),r=t[12]+t[8],s=t[13]+t[9],a=t[14]+t[10],f=t[15]+t[11],o=Math.sqrt(r*r+s*s+a*a),m=new n(r/o,s/o,a/o,f/o),r=t[12]-t[8],s=t[13]-t[9],a=t[14]-t[10],f=t[15]-t[11],o=Math.sqrt(r*r+s*s+a*a),g=new n(r/o,s/o,a/o,f/o),new i(c,d,u,h,m,g)},i.prototype.containsPoint=function(t){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"Frustum","containsPoint","missingPoint"));return!(this._far.dot(t)<=0||this._left.dot(t)<=0||this._right.dot(t)<=0||this._top.dot(t)<=0||this._bottom.dot(t)<=0||this._near.dot(t)<=0)},i.prototype.intersectsSegment=function(t,r){if(!t||!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"Frustum","containsPoint","missingPoint"));if(this.containsPoint(t)||this.containsPoint(r))return!0;if(t.equals(r))return!1;for(var s=0,a=this._planes.length;s<a;s++){if(this._planes[s].onSameSide(t,r)<0)return!1;if(this._planes[s].clip(t,r)!=null)return!0}return!1},i}),B("error/NotYetImplementedError",["../error/AbstractError"],function(p){"use strict";var l=function(n){p.call(this,"NotYetImplementedError",n);var e;try{throw new Error}catch(i){e=i.stack}this.stack=e};return l.prototype=Object.create(p.prototype),l}),B("geom/BoundingBox",["../error/ArgumentError","../shaders/BasicProgram","../geom/Frustum","../util/Logger","../geom/Matrix","../error/NotYetImplementedError","../geom/Plane","../geom/Sector","../geom/Vec3","../util/WWMath","../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o){"use strict";var c=function(){this.center=new a(0,0,0),this.bottomCenter=new a(-.5,0,0),this.topCenter=new a(.5,0,0),this.r=new a(1,0,0),this.s=new a(0,1,0),this.t=new a(0,0,1),this.radius=Math.sqrt(3),this.tmp1=new a(0,0,0),this.tmp2=new a(0,0,0),this.tmp3=new a(0,0,0),this.scratchElevations=new Float64Array(9),this.scratchPoints=new Float64Array(3*this.scratchElevations.length)};return c.scratchMatrix=i.fromIdentity(),c.prototype.getCorners=function(){var d=new a(this.s[0],this.s[1],this.s[2]),h=new a(this.t[0],this.t[1],this.t[2]),u=new a(this.s[0],this.s[1],this.s[2]),m=new a(this.s[0],this.s[1],this.s[2]);d.add(this.t).multiply(-.5),h.subtract(this.s).multiply(.5),u.add(this.t).multiply(.5),m.subtract(this.t).multiply(.5);for(var g=[],_=0;_<4;_++)g.push(new a(this.bottomCenter[0],this.bottomCenter[1],this.bottomCenter[2]));for(_=0;_<4;_++)g.push(new a(this.topCenter[0],this.topCenter[1],this.topCenter[2]));return g[0].add(d),g[1].add(h),g[2].add(u),g[3].add(m),g[4].add(d),g[5].add(h),g[6].add(u),g[7].add(m),g},c.prototype.setToPoints=function(d){if(!d||d.length<3)throw new p(e.logMessage(e.LEVEL_SEVERE,"BoundingBox","setToPoints","missingArray"));var h=+Number.MAX_VALUE,u=-Number.MAX_VALUE,m=+Number.MAX_VALUE,g=-Number.MAX_VALUE,_=+Number.MAX_VALUE,y=-Number.MAX_VALUE,v=this.r,b=this.s,R=this.t,M=new a(0,0,0),P,T,E,x,S,L,C,F,q,it,st,pt,_t,X,ot;i.principalAxesFromPoints(d,v,b,R);for(var Tt=0,Vt=d.length/3;Tt<Vt;Tt++)M[0]=d[Tt*3],M[1]=d[Tt*3+1],M[2]=d[Tt*3+2],P=M.dot(v),h>P&&(h=P),u<P&&(u=P),T=M.dot(b),m>T&&(m=T),g<T&&(g=T),E=M.dot(R),_>E&&(_=E),y<E&&(y=E);return u===h&&(u=h+1),g===m&&(g=m+1),y===_&&(y=_+1),x=u-h,S=g-m,L=y-_,C=u+h,F=g+m,q=y+_,it=.5*v[0]*x,st=.5*v[1]*x,pt=.5*v[2]*x,_t=.5*(v[0]*C+b[0]*F+R[0]*q),X=.5*(v[1]*C+b[1]*F+R[1]*q),ot=.5*(v[2]*C+b[2]*F+R[2]*q),this.center[0]=_t,this.center[1]=X,this.center[2]=ot,this.topCenter[0]=_t+it,this.topCenter[1]=X+st,this.topCenter[2]=ot+pt,this.bottomCenter[0]=_t-it,this.bottomCenter[1]=X-st,this.bottomCenter[2]=ot-pt,v.multiply(x),b.multiply(S),R.multiply(L),this.radius=.5*Math.sqrt(x*x+S*S+L*L),this},c.prototype.setToVec3Points=function(d){if(!d||d.length===0)throw new p(e.logMessage(e.LEVEL_SEVERE,"BoundingBox","setToVec3Points","missingArray"));for(var h=new Float32Array(d.length*3),u=0;u<d.length;u++)for(var m=d[u],g=0;g<3;g++)h[u*3+g]=m[g];return this.setToPoints(h)},c.prototype.setToSector=function(d,h,u,m){if(!d)throw new p(e.logMessage(e.LEVEL_SEVERE,"BoundingBox","setToSector","missingSector"));if(!h)throw new p(e.logMessage(e.LEVEL_SEVERE,"BoundingBox","setToSector","missingGlobe"));var g=this.scratchElevations,_=this.scratchPoints;o.fillArray(g,m),g[0]=g[2]=g[6]=g[8]=u,h.computePointsForGrid(d,3,3,g,a.ZERO,_);var y=12;this.tmp1.set(_[y],_[y+1],_[y+2]),f.localCoordinateAxesAtPoint(this.tmp1,h,this.r,this.s,this.t);for(var v=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],b=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],R=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],M=0,P=_.length;M<P;M+=3)this.tmp1.set(_[M],_[M+1],_[M+2]),this.adjustExtremes(this.r,v,this.s,b,this.t,R,this.tmp1);d.deltaLongitude()>180&&(h.computePointFromPosition(d.centroidLatitude(),d.centroidLongitude()+90,m,this.tmp1),h.computePointFromPosition(d.centroidLatitude(),d.centroidLongitude()-90,m,this.tmp2),this.adjustExtremes(this.r,v,this.s,b,this.t,R,this.tmp1),this.adjustExtremes(this.r,v,this.s,b,this.t,R,this.tmp2)),v[1]-v[0]<b[1]-b[0]&&this.swapAxes(this.r,v,this.s,b),b[1]-b[0]<R[1]-R[0]&&this.swapAxes(this.s,b,this.t,R),v[1]-v[0]<b[1]-b[0]&&this.swapAxes(this.r,v,this.s,b);var T=v[1]-v[0],E=b[1]-b[0],x=R[1]-R[0],S=v[1]+v[0],L=b[1]+b[0],C=R[1]+R[0],F=.5*(this.r[0]*S+this.s[0]*L+this.t[0]*C),q=.5*(this.r[1]*S+this.s[1]*L+this.t[1]*C),it=.5*(this.r[2]*S+this.s[2]*L+this.t[2]*C),st=.5*this.r[0]*T,pt=.5*this.r[1]*T,_t=.5*this.r[2]*T;return this.center.set(F,q,it),this.topCenter.set(F+st,q+pt,it+_t),this.bottomCenter.set(F-st,q-pt,it-_t),this.r.multiply(T),this.s.multiply(E),this.t.multiply(x),this.radius=.5*Math.sqrt(T*T+E*E+x*x),this},c.prototype.translate=function(d){if(!d)throw new p(e.logMessage(e.LEVEL_SEVERE,"BoundingBox","translate","missingVector"));return this.bottomCenter.add(d),this.topCenter.add(d),this.center.add(d),this},c.prototype.distanceTo=function(d){if(!d)throw new p(e.logMessage(e.LEVEL_SEVERE,"BoundingBox","distanceTo","missingPoint"));var h=this.center.distanceTo(d)-this.radius;return h>=0?h:-h},c.prototype.effectiveRadius=function(d){if(!d)throw new p(e.logMessage(e.LEVEL_SEVERE,"BoundingBox","effectiveRadius","missingPlane"));var h=d.normal;return .5*(f.fabs(this.r.dot(h))+f.fabs(this.s.dot(h))+f.fabs(this.t.dot(h)))},c.prototype.intersectsFrustum=function(d){if(!d)throw new p(e.logMessage(e.LEVEL_SEVERE,"BoundingBox","intersectsFrustum","missingFrustum"));return this.tmp1.copy(this.bottomCenter),this.tmp2.copy(this.topCenter),!(this.intersectionPoint(d.near)<0||this.intersectionPoint(d.far)<0||this.intersectionPoint(d.left)<0||this.intersectionPoint(d.right)<0||this.intersectionPoint(d.top)<0||this.intersectionPoint(d.bottom)<0)},c.prototype.intersectionPoint=function(d){var h=d.normal,u=.5*(Math.abs(this.s.dot(h))+Math.abs(this.t.dot(h)));return this.intersectsAt(d,u,this.tmp1,this.tmp2)},c.prototype.intersectsAt=function(d,h,u,m){var g=d.dot(u),_=g<=-h,y=d.dot(m),v=y<=-h;if(_&&v)return-1;if(_==v)return 0;this.tmp3.copy(u),this.tmp3.subtract(m);var b=(h+g)/d.normal.dot(this.tmp3);return this.tmp3.copy(m),this.tmp3.subtract(u),this.tmp3.multiply(b),this.tmp3.add(u),_?u.copy(this.tmp3):m.copy(this.tmp3),b},c.prototype.adjustExtremes=function(d,h,u,m,g,_,y){var v=y.dot(d);h[0]>v&&(h[0]=v),h[1]<v&&(h[1]=v);var b=y.dot(u);m[0]>b&&(m[0]=b),m[1]<b&&(m[1]=b);var R=y.dot(g);_[0]>R&&(_[0]=R),_[1]<R&&(_[1]=R)},c.prototype.swapAxes=function(d,h,u,m){d.swap(u);var g=h[0];h[0]=m[0],m[0]=g,g=h[1],h[1]=m[1],m[1]=g},c.prototype.render=function(d){var h=d.currentGlContext,u=c.scratchMatrix,m=d.findAndBindProgram(l);try{u.copy(d.modelviewProjection),u.multiply(this.r[0],this.s[0],this.t[0],this.center[0],this.r[1],this.s[1],this.t[1],this.center[1],this.r[2],this.s[2],this.t[2],this.center[2],0,0,0,1),u.multiplyByTranslation(-.5,-.5,-.5),m.loadModelviewProjection(h,u),h.disable(h.CULL_FACE),h.bindBuffer(h.ARRAY_BUFFER,d.unitCubeBuffer()),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,d.unitCubeElements()),h.enableVertexAttribArray(m.vertexPointLocation),h.vertexAttribPointer(m.vertexPointLocation,3,h.FLOAT,!1,0,0),m.loadColorComponents(h,0,1,0,.6),h.drawElements(h.LINES,24,h.UNSIGNED_SHORT,72),m.loadColorComponents(h,1,1,1,.3),h.drawElements(h.TRIANGLES,36,h.UNSIGNED_SHORT,0)}finally{h.enable(h.CULL_FACE),h.bindBuffer(h.ARRAY_BUFFER,null),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,null)}},c}),B("util/Tile",["../error/ArgumentError","../geom/BoundingBox","../util/Logger","../geom/Sector","../geom/Vec3","../util/WWUtil"],function(p,l,n,e,i,t){"use strict";var r=function(s,a,f,o){if(!s)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","constructor","missingSector"));if(!a)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","constructor","The specified level is null or undefined."));if(f<0||o<0)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","constructor","The specified row or column is less than zero."));this.sector=s,this.level=a,this.row=f,this.column=o,this.tileWidth=a.tileWidth,this.tileHeight=a.tileHeight,this.texelSize=a.texelSize,this.tileKey=r.computeTileKey(a.levelNumber,f,o),this.extent=null,this.referencePoint=null,this.opacity=1,this.samplePoints=null,this.sampleElevations=null,this.updateTimestamp=null,this.updateVerticalExaggeration=null,this.updateGlobeStateKey=null};return r.prototype.isEqual=function(s){return!s||!s.tileKey?!1:this.tileKey==s.tileKey},r.prototype.size=function(){return 828},r.prototype.distanceTo=function(s){if(!s)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","distanceTo","missingVector"));for(var a=s[0],f=s[1],o=s[2],c,d,h,u=this.samplePoints,m=Number.POSITIVE_INFINITY,g=0,_=u.length;g<_;g+=3)c=a-u[g],d=f-u[g+1],h=o-u[g+2],m=Math.min(m,c*c+d*d+h*h);return Math.sqrt(m)},r.prototype.subdivide=function(s,a){if(!s)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","subdivide","The specified level is null or undefined."));if(!a)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","subdivide","The specified tile factory is null or undefined."));var f=this.sector.minLatitude,o=this.sector.maxLatitude,c=this.sector.centroidLatitude(),d=this.sector.minLongitude,h=this.sector.maxLongitude,u=this.sector.centroidLongitude(),m,g,_,y=[];return m=2*this.row,g=2*this.column,_=new e(f,c,d,u),y.push(a.createTile(_,s,m,g)),m=2*this.row,g=2*this.column+1,_=new e(f,c,u,h),y.push(a.createTile(_,s,m,g)),m=2*this.row+1,g=2*this.column,_=new e(c,o,d,u),y.push(a.createTile(_,s,m,g)),m=2*this.row+1,g=2*this.column+1,_=new e(c,o,u,h),y.push(a.createTile(_,s,m,g)),y},r.prototype.subdivideToCache=function(s,a,f){if(!s)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","subdivideToCache","The specified level is null or undefined."));if(!a)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile factory is null or undefined."));var o=f?f.entryForKey(this.tileKey):null;return o||(o=this.subdivide(s,a),o&&f&&f.putEntry(this.tileKey,o,4*o[0].size())),o},r.prototype.mustSubdivide=function(s,a){var f=s.globe.equatorialRadius*this.texelSize,o=this.distanceTo(s.eyePoint),c=s.pixelSizeAtDistance(o);return f>Math.max(a*c,.5)},r.prototype.update=function(s){var a=s.globe.elevationTimestamp(),f=s.verticalExaggeration,o=s.globeStateKey;(this.updateTimestamp!=a||this.updateVerticalExaggeration!=f||this.updateGlobeStateKey!=o)&&(this.doUpdate(s),s.frameStatistics.incrementTileUpdateCount(1),this.updateTimestamp=a,this.updateVerticalExaggeration=f,this.updateGlobeStateKey=o)},r.prototype.doUpdate=function(s){var a=s.globe,f=s.verticalExaggeration,o=a.minAndMaxElevationsForSector(this.sector),c=o[0]*f,d=o[1]*f;c===d&&(c=d+10),this.extent||(this.extent=new l),this.extent.setToSector(this.sector,a,c,d),this.samplePoints||(this.sampleElevations=new Float64Array(9),this.samplePoints=new Float64Array(3*this.sampleElevations.length)),t.fillArray(this.sampleElevations,.5*(c+d)),a.computePointsForGrid(this.sector,3,3,this.sampleElevations,i.ZERO,this.samplePoints),this.referencePoint||(this.referencePoint=new i(0,0,0)),a.computePointFromPosition(this.sector.centroidLatitude(),this.sector.centroidLongitude(),0,this.referencePoint)},r.computeTileKey=function(s,a,f){return s+"."+a+"."+f},r.computeRow=function(s,a){var f=Math.floor((a+90)/s);return a==90&&(f-=1),f},r.computeColumn=function(s,a){var f=Math.floor((a+180)/s);return a==180&&(f-=1),f},r.computeLastRow=function(s,a){var f=Math.ceil((a+90)/s-1);return a+90<s&&(f=0),f},r.computeLastColumn=function(s,a){var f=Math.ceil((a+180)/s-1);return a+180<s&&(f=0),f},r.computeSector=function(s,a,f){if(!s)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","computeSector","missingLevel"));if(a<0||f<0)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","computeSector","The specified row or column is less than zero."));var o=s.tileDelta.latitude,c=s.tileDelta.longitude,d=-90+a*o,h=-180+f*c,u=d+o,m=h+c;return new e(d,u,h,m)},r.createTilesForLevel=function(s,a,f){if(!s)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","createTilesForLevel","missingLevel"));if(!a)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","createTilesForLevel","The specified tile factory is null or undefined"));if(!f)throw new p(n.logMessage(n.LEVEL_SEVERE,"Tile","createTilesForLevel","missingResult"));for(var o=s.tileDelta.latitude,c=s.tileDelta.longitude,d=s.sector,h=r.computeRow(o,d.minLatitude),u=r.computeRow(o,d.maxLatitude),m=r.computeColumn(c,d.minLongitude),g=r.computeColumn(c,d.maxLongitude),_=-90+h*o,y=-180+m*c,v=_,b,R,M,P=h;P<=u;P+=1){R=v+o,b=y;for(var T=m;T<=g;T+=1){M=b+c;var E=new e(v,R,b,M),x=a.createTile(E,s,P,T);f.push(x),b=M}v=R}},r}),B("globe/TiledElevationCoverage",["../util/AbsentResourceList","../geom/Angle","../error/ArgumentError","../globe/ElevationCoverage","../globe/ElevationImage","../formats/geotiff/GeoTiffReader","../util/LevelSet","../geom/Location","../util/Logger","../cache/MemoryCache","../geom/Sector","../util/Tile","../util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o,c,d){"use strict";var h=function(u){if(!u)throw new n(a.logMessage(a.LEVEL_SEVERE,"TiledElevationCoverage","constructor","missingConfig"));if(!u.coverageSector)throw new n(a.logMessage(a.LEVEL_SEVERE,"TiledElevationCoverage","constructor","missingSector"));if(!u.resolution)throw new n(a.logMessage(a.LEVEL_SEVERE,"TiledElevationCoverage","constructor","missingResolution"));if(!u.retrievalImageFormat)throw new n(a.logMessage(a.LEVEL_SEVERE,"TiledElevationCoverage","constructor","missingImageFormat"));e.call(this,u.resolution);var m=45,g=256,_=r.numLevelsForResolution(m/g,u.resolution),y=Math.ceil(_);this.coverageSector=u.coverageSector,this.retrievalImageFormat=u.retrievalImageFormat,this.minElevation=u.minElevation||0,this.maxElevation=u.maxElevation||0,this.pixelIsPoint=!1,this.levels=new r(this.coverageSector,new s(m,m),y,g,g),this.currentTiles=[],this.currentSector=new o(0,0,0,0),this.tileCache=new f(1e6,8e5),this.imageCache=new f(1e7,8e6),this.retrievalQueueSize=WorldWind.configuration.coverageRetrievalQueueSize,this.currentRetrievals=[],this.absentResourceList=new p(3,5e3),this.urlBuilder=u.urlBuilder||null};return h.prototype=Object.create(e.prototype),h.prototype.minAndMaxElevationsForSector=function(u,m){if(!u)throw new n(a.logMessage(a.LEVEL_SEVERE,"TiledElevationCoverage","minAndMaxElevationsForSector","missingSector"));if(!m)throw new n(a.logMessage(a.LEVEL_SEVERE,"TiledElevationCoverage","minAndMaxElevationsForSector","missingResult"));var g=this.levels.levelForTexelSize(u.deltaLatitude()*l.DEGREES_TO_RADIANS/64);if(this.assembleTiles(g,u,!1),this.currentTiles.length===0)return!1;for(var _=!0,y=0,v=this.currentTiles.length;y<v;y++){var b=this.imageCache.entryForKey(this.currentTiles[y].tileKey);if(b&&b.hasData){var R=b.minElevation;m[0]>R&&(m[0]=R);var M=b.maxElevation;m[1]<M&&(m[1]=M)}(!b||!b.hasData||b.hasMissingData)&&(_=!1)}return _},h.prototype.elevationAtLocation=function(u,m){return this.coverageSector.containsLocation(u,m)?this.pointElevationForLocation(u,m):null},h.prototype.elevationsForGrid=function(u,m,g,_){if(!u)throw new n(a.logMessage(a.LEVEL_SEVERE,"TiledElevationCoverage","elevationsForGrid","missingSector"));if(!m||!g||m<1||g<1)throw new n(a.logMessage(a.LEVEL_SEVERE,"TiledElevationCoverage","elevationsForGrid","The specified number of latitudinal or longitudinal positions is less than one."));var y=u.deltaLatitude()/(m-1)*l.DEGREES_TO_RADIANS,v=this.levels.levelForTexelSize(y);return this.pixelIsPoint?this.pointElevationsForGrid(u,m,g,v,_):this.areaElevationsForGrid(u,m,g,v,_)},h.prototype.pointElevationForLocation=function(u,m){for(var g=this.levels.lastLevel(),_=g.tileDelta.latitude,y=g.tileDelta.longitude,v=c.computeRow(_,u),b=c.computeColumn(y,m),R,M=null,P=g.levelNumber;P>=0;P--){if(R=c.computeTileKey(P,v,b),M=this.imageCache.entryForKey(R),M){var T=M.elevationAtLocation(u,m);return isNaN(T)?null:T}v=Math.floor(v/2),b=Math.floor(b/2)}return null},h.prototype.pointElevationsForGrid=function(u,m,g,_,y){if(this.assembleTiles(_,u,!0),this.currentTiles.length===0)return!1;this.currentTiles.sort(function(M,P){return M.level.levelNumber-P.level.levelNumber});for(var v=0,b=this.currentTiles.length;v<b;v++){var R=this.imageCache.entryForKey(this.currentTiles[v].tileKey);R&&R.elevationsForGrid(u,m,g,y)}return!y.includes(NaN)},h.prototype.areaElevationsForGrid=function(u,m,g,_,y){var v=u.minLatitude,b=u.maxLatitude,R=u.minLongitude,M=u.maxLongitude,P=u.deltaLatitude()/(m>1?m-1:1),T=u.deltaLongitude()/(g>1?g-1:1),E,x,S,L,C,F,q=0;for(C=0,E=v;C<m;C+=1,E+=P)for(C===m-1&&(E=b),F=0,x=R;F<g;F+=1,x+=T)F===g-1&&(x=M),isNaN(y[q])&&this.coverageSector.containsLocation(E,x)&&(S=(x+180)/360,L=(E+90)/180,this.areaElevationForCoord(S,L,_.levelNumber,y,q)),q++;return!y.includes(NaN)},h.prototype.areaElevationForCoord=function(u,m,g,_,y){for(var v,b,R,M,P,T,E,x,S,L,C,F,q,it,st,pt,_t=new Float64Array(4),X=g;X>=0;X--)if(v=this.levels.level(X),b=Math.round(v.tileWidth*360/v.tileDelta.longitude),R=Math.round(v.tileHeight*180/v.tileDelta.latitude),M=1/(2*R),P=1-M,T=0,E=R-1,x=b*d.fract(u),S=R*d.clamp(m,M,P),L=d.mod(Math.floor(x-.5),b),C=d.mod(L+1,b),F=d.clamp(Math.floor(S-.5),T,E),q=d.clamp(F+1,T,E),it=d.fract(x-.5),st=d.fract(S-.5),pt=X==g||X==0,this.lookupPixels(L,C,F,q,v,pt,_t))return i.isNoData(_t[0],_t[1],_t[2],_t[3])?!1:(_[y]=(1-it)*(1-st)*_t[0]+it*(1-st)*_t[1]+(1-it)*st*_t[2]+it*st*_t[3],!0);return!1},h.prototype.lookupPixels=function(u,m,g,_,y,v,b){var R=y.levelNumber,M=y.tileWidth,P=y.tileHeight,T=Math.floor(g/P),E=Math.floor(_/P),x=Math.floor(u/M),S=Math.floor(m/M),L,C,F,q;return T==E&&T==this.cachedRow&&x==S&&x==this.cachedCol?L=C=F=q=this.cachedImage:T==E&&x==S?(L=this.lookupImage(R,T,x,v),C=F=q=L,this.cachedRow=T,this.cachedCol=x,this.cachedImage=L):(L=this.lookupImage(R,T,x,v),C=this.lookupImage(R,T,S,v),F=this.lookupImage(R,E,x,v),q=this.lookupImage(R,E,S,v)),L&&C&&F&&q?(b[0]=L.pixel(u%M,g%P),b[1]=C.pixel(m%M,g%P),b[2]=F.pixel(u%M,_%P),b[3]=q.pixel(m%M,_%P),!0):!1},h.prototype.lookupImage=function(u,m,g,_){var y=c.computeTileKey(u,m,g),v=this.imageCache.entryForKey(y);if(v==null&&_){var b=this.tileForLevel(u,m,g);this.retrieveTileImage(b)}return v},h.prototype.assembleTiles=function(u,m,g){if(this.currentTiles=[],this.currentSector.copy(m),this.currentSector.intersection(this.coverageSector),!this.currentSector.isEmpty())for(var _=u.tileDelta.latitude,y=u.tileDelta.longitude,v=c.computeRow(_,this.currentSector.minLatitude),b=c.computeLastRow(_,this.currentSector.maxLatitude),R=c.computeColumn(y,this.currentSector.minLongitude),M=c.computeLastColumn(y,this.currentSector.maxLongitude),P=v;P<=b;P++)for(var T=R;T<=M;T++)this.addTileOrAncestor(u,P,T,g)},h.prototype.addTileOrAncestor=function(u,m,g,_){var y=this.tileForLevel(u.levelNumber,m,g);this.isTileImageInMemory(y)?this.addToCurrentTiles(y):(_&&this.retrieveTileImage(y),u.isFirstLevel()?this.currentTiles.push(y):this.addAncestor(u,m,g,_))},h.prototype.addAncestor=function(u,m,g,_){for(var y=null,v=Math.floor(m/2),b=Math.floor(g/2),R=u.levelNumber-1;R>=0;R--){if(y=this.tileForLevel(R,v,b),this.isTileImageInMemory(y)){this.addToCurrentTiles(y);return}v=Math.floor(v/2),b=Math.floor(b/2)}this.addToCurrentTiles(y),_&&this.retrieveTileImage(y)},h.prototype.addToCurrentTiles=function(u){this.currentTiles.push(u)},h.prototype.tileForLevel=function(u,m,g){var _=c.computeTileKey(u,m,g),y=this.tileCache.entryForKey(_);if(y)return y;var v=this.levels.level(u),b=c.computeSector(v,m,g);return y=new c(b,v,m,g),this.tileCache.putEntry(_,y,y.size()),y},h.prototype.isTileImageInMemory=function(u){return this.imageCache.containsKey(u.tileKey)},h.prototype.resourceUrlForTile=function(u){return this.urlBuilder.urlForTile(u,this.retrievalImageFormat)},h.prototype.retrieveTileImage=function(u){if(this.currentRetrievals.indexOf(u.tileKey)<0){if(this.currentRetrievals.length>this.retrievalQueueSize)return;var m=this.resourceUrlForTile(u,this.retrievalImageFormat),g=new XMLHttpRequest,_=this;if(!m)return;m=m.substr(0,m.indexOf("?"))+encodeURIComponent(m.substr(m.indexOf("?"))),g.open("GET",m,!0),g.responseType="arraybuffer",g.onreadystatechange=function(){if(g.readyState===4){_.removeFromCurrentRetrievals(u.tileKey);var y=g.getResponseHeader("content-type");if(y=y.split(";")[0],g.status===200)if(y===_.retrievalImageFormat||y==="text/plain"||y==="application/octet-stream"){a.log(a.LEVEL_INFO,"Elevations retrieval succeeded: "+m),_.loadElevationImage(u,g),_.absentResourceList.unmarkResourceAbsent(u.tileKey);var v=document.createEvent("Event");v.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(v)}else y==="text/xml"?(_.absentResourceList.markResourceAbsent(u.tileKey),a.log(a.LEVEL_WARNING,"Elevations retrieval failed ("+g.statusText+"): "+m+".\n "+String.fromCharCode.apply(null,new Uint8Array(g.response)))):(_.absentResourceList.markResourceAbsent(u.tileKey),a.log(a.LEVEL_WARNING,"Elevations retrieval failed: "+m+". Unexpected content type "+y));else _.absentResourceList.markResourceAbsent(u.tileKey),a.log(a.LEVEL_WARNING,"Elevations retrieval failed ("+g.statusText+"): "+m)}},g.onerror=function(){_.removeFromCurrentRetrievals(u.tileKey),_.absentResourceList.markResourceAbsent(u.tileKey),a.log(a.LEVEL_WARNING,"Elevations retrieval failed: "+m)},g.ontimeout=function(){_.removeFromCurrentRetrievals(u.tileKey),_.absentResourceList.markResourceAbsent(u.tileKey),a.log(a.LEVEL_WARNING,"Elevations retrieval timed out: "+m)},g.send(null),this.currentRetrievals.push(u.tileKey)}},h.prototype.removeFromCurrentRetrievals=function(u){var m=this.currentRetrievals.indexOf(u);m>-1&&this.currentRetrievals.splice(m,1)},h.prototype.loadElevationImage=function(u,m){var g=new i(u.sector,u.tileWidth,u.tileHeight),_;this.retrievalImageFormat==="application/bil16"?(g.imageData=new Int16Array(m.response),g.size=g.imageData.length*2):this.retrievalImageFormat==="application/bil32"?(g.imageData=new Float32Array(m.response),g.size=g.imageData.length*4):this.retrievalImageFormat==="image/tiff"&&(_=new t(m.response),g.imageData=_.getImageData(),g.size=g.imageData.length*_.metadata.bitsPerSample[0]/8),g.imageData&&(g.findMinAndMaxElevation(),this.imageCache.putEntry(u.tileKey,g,g.size),this.timestamp=Date.now())},h}),B("util/WmsUrlBuilder",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e,i,t,r,s){if(!e||e.length===0)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsUrlBuilder","constructor","The WMS service address is missing."));if(!i||i.length===0)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsUrlBuilder","constructor","The WMS layer names are not specified."));this.serviceAddress=e,this.layerNames=i,this.styleNames=t||"",this.transparent=!0,this.wmsVersion=r&&r.length>0?r:"1.3.0",this.isWms130OrGreater=this.wmsVersion>="1.3.0",this.crs="EPSG:4326",this.timeString=s};return n.prototype.urlForTile=function(e,i){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","missingTile"));if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","The image format is null or undefined."));var t=e.sector,r=n.fixGetMapString(this.serviceAddress);return r.search(/service=wms/i)<0&&(r=r+"service=WMS"),r=r+"&request=GetMap",r=r+"&version="+this.wmsVersion,r=r+"&transparent="+(this.transparent?"TRUE":"FALSE"),r=r+"&layers="+this.layerNames,r=r+"&styles="+this.styleNames,r=r+"&format="+i,r=r+"&width="+e.tileWidth,r=r+"&height="+e.tileHeight,this.timeString&&(r=r+"&time="+this.timeString),this.isWms130OrGreater?(r=r+"&crs="+this.crs,r=r+"&bbox=",this.crs==="CRS:84"?(r=r+t.minLongitude+","+t.minLatitude+",",r=r+t.maxLongitude+","+t.maxLatitude):(r=r+t.minLatitude+","+t.minLongitude+",",r=r+t.maxLatitude+","+t.maxLongitude)):(r=r+"&srs="+this.crs,r=r+"&bbox=",r=r+t.minLongitude+","+t.minLatitude+",",r=r+t.maxLongitude+","+t.maxLatitude),r=r.replace(" ","%20"),r},n.fixGetMapString=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsUrlBuilder","fixGetMapString","The specified service address is null or undefined."));var i=e.indexOf("?");return i<0?e=e+"?":i!==e.length-1&&(i=e.search(/&$/),i<0&&(e=e+"&")),e},n}),B("globe/AsterV2ElevationCoverage",["../geom/Location","../geom/Sector","../globe/TiledElevationCoverage","../util/WmsUrlBuilder"],function(p,l,n,e){"use strict";var i=function(){n.call(this,{coverageSector:new l(-83.0001,83.0001,-180,180),resolution:.000277777777778,retrievalImageFormat:"application/bil16",minElevation:-11e3,maxElevation:8850,urlBuilder:new e("worldwind26.arc.nasa.gov/elev","aster_v2","","1.3.0")}),this.displayName="ASTER V2 Earth Elevation Coverage"};return i.prototype=Object.create(n.prototype),i}),B("shaders/AtmosphereProgram",["../error/ArgumentError","../shaders/GpuProgram","../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r,s){l.call(this,i,t,r,s),this.FRAGMODE_SKY=1,this.FRAGMODE_GROUND_PRIMARY=2,this.FRAGMODE_GROUND_SECONDARY=3,this.FRAGMODE_GROUND_PRIMARY_TEX_BLEND=4,this.altitude=16e4,this.rayleighScaleDepth=.25,this.fragModeLocation=this.uniformLocation(i,"fragMode"),this.mvpMatrixLocation=this.uniformLocation(i,"mvpMatrix"),this.texCoordMatrixLocation=this.uniformLocation(i,"texCoordMatrix"),this.vertexOriginLocation=this.uniformLocation(i,"vertexOrigin"),this.eyePointLocation=this.uniformLocation(i,"eyePoint"),this.eyeMagnitudeLocation=this.uniformLocation(i,"eyeMagnitude"),this.eyeMagnitude2Location=this.uniformLocation(i,"eyeMagnitude2"),this.lightDirectionLocation=this.uniformLocation(i,"lightDirection"),this.atmosphereRadiusLocation=this.uniformLocation(i,"atmosphereRadius"),this.atmosphereRadius2Location=this.uniformLocation(i,"atmosphereRadius2"),this.globeRadiusLocation=this.uniformLocation(i,"globeRadius"),this.scaleLocation=this.uniformLocation(i,"scale"),this.scaleDepthLocation=this.uniformLocation(i,"scaleDepth"),this.scaleOverScaleDepthLocation=this.uniformLocation(i,"scaleOverScaleDepth"),this.scratchArray9=new Float32Array(9)};return e.key="WorldWindGpuAtmosphereProgram",e.prototype=Object.create(l.prototype),e.prototype.getAltitude=function(){return this.altitude},e.prototype.loadFragMode=function(i,t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"AtmosphereProgram","loadFragMode","missingFragMode"));i.uniform1i(this.fragModeLocation,t)},e.prototype.loadModelviewProjection=function(i,t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"AtmosphereProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(i,t,this.mvpMatrixLocation)},e.prototype.loadVertexOrigin=function(i,t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"AtmosphereProgram","loadVertexOrigin","missingVector"));i.uniform3f(this.vertexOriginLocation,t[0],t[1],t[2])},e.prototype.loadLightDirection=function(i,t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"AtmosphereProgram","loadLightDirection","missingVector"));i.uniform3f(this.lightDirectionLocation,t[0],t[1],t[2])},e.prototype.loadEyePoint=function(i,t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"AtmosphereProgram","loadEyePoint","missingVector"));i.uniform3f(this.eyePointLocation,t[0],t[1],t[2]),i.uniform1f(this.eyeMagnitudeLocation,t.magnitude()),i.uniform1f(this.eyeMagnitude2Location,t.magnitudeSquared())},e.prototype.loadGlobeRadius=function(i,t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"AtmosphereProgram","loadGlobeRadius","missingGlobeRadius"));var r=t,s=r+this.altitude;i.uniform1f(this.globeRadiusLocation,r),i.uniform1f(this.atmosphereRadiusLocation,s),i.uniform1f(this.atmosphereRadius2Location,s*s)},e.prototype.setScale=function(i){i.uniform1f(this.scaleLocation,1/this.getAltitude()),i.uniform1f(this.scaleDepthLocation,this.rayleighScaleDepth),i.uniform1f(this.scaleOverScaleDepthLocation,1/this.getAltitude()/this.rayleighScaleDepth)},e.prototype.loadTexMatrix=function(i,t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"AtmosphereProgram","loadTexMatrix","missingMatrix"));t.columnMajorComponents(this.scratchArray9),i.uniformMatrix3fv(this.texCoordMatrixLocation,!1,this.scratchArray9)},e}),B("shaders/GroundProgram",["../shaders/AtmosphereProgram"],function(p){"use strict";var l=function(n){var e="precision mediump int;\nconst int FRAGMODE_GROUND_PRIMARY_TEX_BLEND = 4;\nconst int SAMPLE_COUNT = 2;\nconst float SAMPLES = 2.0;\nconst float PI = 3.141592653589;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * PI;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * PI;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 invWavelength = vec3(5.60204474633241, 9.473284437923038, 19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nuniform int fragMode;\nuniform mat4 mvpMatrix;\nuniform mat3 texCoordMatrix;\nuniform vec3 vertexOrigin;\nuniform vec3 eyePoint;\nuniform float eyeMagnitude;\nuniform float eyeMagnitude2;\nuniform vec3 lightDirection;\nuniform float atmosphereRadius;\nuniform float atmosphereRadius2;\nuniform float globeRadius;\nuniform float scale;\nuniform float scaleDepth;\nuniform float scaleOverScaleDepth;\nattribute vec4 vertexPoint;\nattribute vec2 vertexTexCoord;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec2 texCoord;\nfloat scaleFunc(float cos) {\n    float x = 1.0 - cos;\n    return scaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid sampleGround() {\n    vec3 point = vertexPoint.xyz + vertexOrigin;\n    vec3 ray = point - eyePoint;\n    float far = length(ray);\n    ray /= far;\n    vec3 start;\n    if (eyeMagnitude < atmosphereRadius) {\n        start = eyePoint;\n    } else {\n        float B = 2.0 * dot(eyePoint, ray);\n        float C = eyeMagnitude2 - atmosphereRadius2;\n        float det = max(0.0, B*B - 4.0 * C);\n        float near = 0.5 * (-B - sqrt(det));\n        start = eyePoint + ray * near;\n        far -= near;\n}\n    float depth = exp((globeRadius - atmosphereRadius) / scaleDepth);\n    float eyeAngle = dot(-ray, point) / length(point);\n    float lightAngle = dot(lightDirection, point) / length(point);\n    float eyeScale = scaleFunc(eyeAngle);\n    float lightScale = scaleFunc(lightAngle);\n    float eyeOffset = depth*eyeScale;\n    float temp = (lightScale + eyeScale);\n    float sampleLength = far / SAMPLES;\n    float scaledLength = sampleLength * scale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    vec3 attenuate = vec3(0.0, 0.0, 0.0);\n    for(int i=0; i<SAMPLE_COUNT; i++)\n    {\n        float height = length(samplePoint);\n        float depth = exp(scaleOverScaleDepth * (globeRadius - height));\n        float scatter = depth*temp - eyeOffset;\n        attenuate = exp(-scatter * (invWavelength * Kr4PI + Km4PI));\n        frontColor += attenuate * (depth * scaledLength);\n        samplePoint += sampleRay;\n    }\n    primaryColor = frontColor * (invWavelength * KrESun + KmESun);\n    secondaryColor = attenuate;\n}\nvoid main()\n {\n    sampleGround();\n    gl_Position = mvpMatrix * vertexPoint;\n    if (fragMode == FRAGMODE_GROUND_PRIMARY_TEX_BLEND) {\n        texCoord = (texCoordMatrix * vec3(vertexTexCoord, 1.0)).st;\n    }\n}",i="precision mediump float;\nprecision mediump int;\nconst int FRAGMODE_GROUND_PRIMARY = 2;\nconst int FRAGMODE_GROUND_SECONDARY = 3;\nconst int FRAGMODE_GROUND_PRIMARY_TEX_BLEND = 4;\nuniform int fragMode;\nuniform sampler2D texSampler;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec2 texCoord;\nvoid main (void)\n{\n    if (fragMode == FRAGMODE_GROUND_PRIMARY) {\n        gl_FragColor = vec4(primaryColor, 1.0);\n    } else if (fragMode == FRAGMODE_GROUND_SECONDARY) {\n        gl_FragColor = vec4(secondaryColor, 1.0);\n    } else if (fragMode == FRAGMODE_GROUND_PRIMARY_TEX_BLEND) {\n        vec4 texColor = texture2D(texSampler, texCoord);\n        gl_FragColor = vec4(primaryColor + texColor.rgb * (1.0 - secondaryColor), 1.0);\n    }\n}";p.call(this,n,e,i,["vertexPoint","vertexTexCoord"])};return l.key="WorldWindGroundProgram",l.prototype=Object.create(p.prototype),l}),B("layer/Layer",["../util/Logger"],function(p){"use strict";var l=function(n){this.displayName=n||"Layer",this.enabled=!0,this.pickEnabled=!0,this.opacity=1,this.minActiveAltitude=-Number.MAX_VALUE,this.maxActiveAltitude=Number.MAX_VALUE,this.inCurrentFrame=!1,this.time=null};return l.prototype.refresh=function(){},l.prototype.render=function(n){this.inCurrentFrame=!1,this.enabled&&(n.pickingMode&&!this.pickEnabled||this.withinActiveAltitudes(n)&&this.isLayerInView(n)&&this.doRender(n))},l.prototype.doRender=function(n){},l.prototype.withinActiveAltitudes=function(n){var e=n.eyePosition;return e?e.altitude>=this.minActiveAltitude&&e.altitude<=this.maxActiveAltitude:!1},l.prototype.isLayerInView=function(n){return!0},l}),B("geom/Matrix3",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e,i,t,r,s,a,f,o,c){this[0]=e,this[1]=i,this[2]=t,this[3]=r,this[4]=s,this[5]=a,this[6]=f,this[7]=o,this[8]=c};return n.prototype=new Float64Array(9),n.fromIdentity=function(){return new n(1,0,0,0,1,0,0,0,1)},n.prototype.setToUnitYFlip=function(){return this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=-1,this[5]=1,this[6]=0,this[7]=0,this[8]=1,this},n.prototype.multiplyMatrix=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"Matrix3","multiplyMatrix","missingMatrix"));var i=this,t=e,r,s,a;return r=i[0],s=i[1],a=i[2],i[0]=r*t[0]+s*t[3]+a*t[6],i[1]=r*t[1]+s*t[4]+a*t[7],i[2]=r*t[2]+s*t[5]+a*t[8],r=i[3],s=i[4],a=i[5],i[3]=r*t[0]+s*t[3]+a*t[6],i[4]=r*t[1]+s*t[4]+a*t[7],i[5]=r*t[2]+s*t[5]+a*t[8],r=i[6],s=i[7],a=i[8],i[6]=r*t[0]+s*t[3]+a*t[6],i[7]=r*t[1]+s*t[4]+a*t[7],i[8]=r*t[2]+s*t[5]+a*t[8],this},n.prototype.multiplyByTileTransform=function(e,i){var t=e.deltaLatitude(),r=e.deltaLongitude(),s=i.deltaLatitude(),a=i.deltaLongitude(),f=r/a,o=t/s,c=(e.minLongitude-i.minLongitude)/a,d=(e.minLatitude-i.minLatitude)/s,h=this;return h[2]+=h[0]*c+h[1]*d,h[5]+=h[3]*c+h[4]*d,h[8]+=h[6]*c+h[6]*d,h[0]*=f,h[1]*=o,h[3]*=f,h[4]*=o,h[6]*=f,h[7]*=o,this},n.prototype.columnMajorComponents=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"Matrix3","columnMajorComponents","missingResult"));return e[0]=this[0],e[1]=this[3],e[2]=this[6],e[3]=this[1],e[4]=this[4],e[5]=this[7],e[6]=this[2],e[7]=this[5],e[8]=this[8],e},n}),B("shaders/SkyProgram",["../shaders/AtmosphereProgram"],function(p){"use strict";var l=function(n){var e="precision mediump int;\nconst int SAMPLE_COUNT = 2;\nconst float SAMPLES = 2.0;\nconst float PI = 3.141592653589;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * PI;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * PI;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 invWavelength = vec3(5.60204474633241, 9.473284437923038, 19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nuniform mat4 mvpMatrix;\nuniform vec3 vertexOrigin;\nuniform vec3 eyePoint;\nuniform float eyeMagnitude;\nuniform float eyeMagnitude2;\nuniform mediump vec3 lightDirection;\nuniform float atmosphereRadius;\nuniform float atmosphereRadius2;\nuniform float globeRadius;\nuniform float scale;\nuniform float scaleDepth;\nuniform float scaleOverScaleDepth;\nattribute vec4 vertexPoint;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nfloat scaleFunc(float cos)\n{\n    float x = 1.0 - cos;\n    return scaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid sampleSky() {\n    vec3 point = vertexPoint.xyz + vertexOrigin;\n    vec3 ray = point - eyePoint;\n    float far = length(ray);\n    ray /= far;\n    vec3 start;\n    float startOffset;\n    if (eyeMagnitude < atmosphereRadius) {\n        start = eyePoint;\n        float height = length(start);\n        float depth = exp(scaleOverScaleDepth * (globeRadius - eyeMagnitude));\n        float startAngle = dot(ray, start) / height;\n        startOffset = depth*scaleFunc(startAngle);\n    } else {\n        float B = 2.0 * dot(eyePoint, ray);\n        float C = eyeMagnitude2 - atmosphereRadius2;\n        float det = max(0.0, B*B - 4.0 * C);\n        float near = 0.5 * (-B - sqrt(det));\n        start = eyePoint + ray * near;\n        far -= near;\n        float startAngle = dot(ray, start) / atmosphereRadius;\n        float startDepth = exp(-1.0 / scaleDepth);\n        startOffset = startDepth*scaleFunc(startAngle);\n    }\n    float sampleLength = far / SAMPLES;\n    float scaledLength = sampleLength * scale;\n    vec3 sampleRay = ray * sampleLength;\n    vec3 samplePoint = start + sampleRay * 0.5;\n    vec3 frontColor = vec3(0.0, 0.0, 0.0);\n    for(int i=0; i<SAMPLE_COUNT; i++)\n    {\n       float height = length(samplePoint);\n       float depth = exp(scaleOverScaleDepth * (globeRadius - height));\n       float lightAngle = dot(lightDirection, samplePoint) / height;\n       float cameraAngle = dot(ray, samplePoint) / height;\n       float scatter = (startOffset + depth*(scaleFunc(lightAngle) - scaleFunc(cameraAngle)));\n       vec3 attenuate = exp(-scatter * (invWavelength * Kr4PI + Km4PI));\n       frontColor += attenuate * (depth * scaledLength);\n       samplePoint += sampleRay;\n    }\n    primaryColor = frontColor * (invWavelength * KrESun);\n    secondaryColor = frontColor * KmESun;\n    direction = eyePoint - point;\n}\nvoid main()\n{\n    sampleSky();\n    gl_Position = mvpMatrix * vertexPoint;\n}",i="#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\nconst float g = -0.95;\nconst float g2 = g * g;\nuniform mediump vec3 lightDirection;\nvarying vec3 primaryColor;\nvarying vec3 secondaryColor;\nvarying vec3 direction;\nvoid main (void)\n{\n    float cos = dot(lightDirection, direction) / length(direction);\n    float rayleighPhase = 0.75 * (1.0 + cos * cos);\n    float miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cos*cos) /         pow(1.0 + g2 - 2.0*g*cos, 1.5);\n    const float exposure = 2.0;\n    vec3 color = primaryColor * rayleighPhase + secondaryColor * miePhase;\n    color = vec3(1.0) - exp(-exposure * color);\n    gl_FragColor = vec4(color, color.b);\n}";p.call(this,n,e,i,["vertexPoint"])};return l.key="WorldWindSkyProgram",l.prototype=Object.create(p.prototype),l}),B("util/SunPosition",["../geom/Angle","../error/ArgumentError","./Logger","./WWMath"],function(p,l,n,e){"use strict";var i={getAsGeographicLocation:function(t){if(!(t instanceof Date))throw new l(n.logMessage(n.LEVEL_SEVERE,"SunPosition","getAsGeographicLocation","missingDate"));var r=this.getAsCelestialLocation(t);return this.celestialToGeographic(r,t)},getAsCelestialLocation:function(t){if(!(t instanceof Date))throw new l(n.logMessage(n.LEVEL_SEVERE,"SunPosition","getAsCelestialLocation","missingDate"));var r=this.computeJulianDate(t),s=r-2451545,a=e.normalizeAngle360(280.46+.9856474*s),f=e.normalizeAngle360(357.528+.9856003*s)*p.DEGREES_TO_RADIANS,o=a+1.915*Math.sin(f)+.02*Math.sin(2*f),c=o*p.DEGREES_TO_RADIANS,d=(23.439-4e-7*s)*p.DEGREES_TO_RADIANS,h=Math.asin(Math.sin(d)*Math.sin(c))*p.RADIANS_TO_DEGREES,u=Math.atan(Math.cos(d)*Math.tan(c))*p.RADIANS_TO_DEGREES;return o>=90&&o<270&&(u+=180),u=e.normalizeAngle360(u),{declination:h,rightAscension:u}},celestialToGeographic:function(t,r){if(!t)throw new l(n.logMessage(n.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingCelestialLocation"));if(!(r instanceof Date))throw new l(n.logMessage(n.LEVEL_SEVERE,"SunPosition","celestialToGeographic","missingDate"));var s=this.computeJulianDate(r),a=s-2451545,f=e.normalizeAngle360(280.46061837+360.98564736629*a),o=e.normalizeAngle360(f-t.rightAscension),c=p.normalizedDegreesLongitude(-o);return{latitude:t.declination,longitude:c}},computeJulianDate:function(t){if(!(t instanceof Date))throw new l(n.logMessage(n.LEVEL_SEVERE,"SunPosition","computeJulianDate","missingDate"));var r=t.getUTCFullYear(),s=t.getUTCMonth()+1,a=t.getUTCDate(),f=t.getUTCHours(),o=t.getUTCMinutes(),c=t.getUTCSeconds(),d=(f+o/60+c/3600)/24;s<=2&&(r-=1,s+=12);var h=Math.floor(r/100),u=2-h+Math.floor(h/4),m=Math.floor(365.25*(r+4716))+Math.floor(30.6001*(s+1))+a+u-1524.5;return m+d}};return i}),B("layer/AtmosphereLayer",["../error/ArgumentError","../shaders/GroundProgram","../layer/Layer","../util/Logger","../geom/Matrix","../geom/Matrix3","../geom/Sector","../shaders/SkyProgram","../util/SunPosition","../geom/Vec3","../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o){"use strict";var c=function(d){n.call(this,"Atmosphere"),this.pickEnabled=!1,this._nightImageSource=d||WorldWind.configuration.baseUrl+"images/dnb_land_ocean_ice_2012.png",this._activeLightDirection=new f(0,0,0),this._fullSphereSector=r.FULL_SPHERE,this._skyData={},this._skyWidth=128,this._skyHeight=128,this._numIndices=0,this._texMatrix=t.fromIdentity(),this._activeTexture=null};return c.prototype=Object.create(n.prototype),Object.defineProperties(c.prototype,{nightImageSource:{get:function(){return this._nightImageSource},set:function(d){this._nightImageSource=d}}}),c.prototype.doRender=function(d){d.globe.is2D()||(this.determineLightDirection(d),this.drawSky(d),this.drawGround(d))},c.prototype.applySkyVertices=function(d){var h=d.currentGlContext,u=d.currentProgram,m=this._skyData,g,_;m.verticesVboCacheKey||(m.verticesVboCacheKey=d.gpuResourceCache.generateCacheKey()),_=d.gpuResourceCache.resourceForKey(m.verticesVboCacheKey),_?(h.bindBuffer(h.ARRAY_BUFFER,_),h.vertexAttribPointer(0,3,h.FLOAT,!1,0,0)):(g=this.assembleVertexPoints(d,this._skyHeight,this._skyWidth,u.getAltitude()),_=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,_),h.bufferData(h.ARRAY_BUFFER,g,h.STATIC_DRAW),h.vertexAttribPointer(0,3,h.FLOAT,!1,0,0),d.gpuResourceCache.putResource(m.verticesVboCacheKey,_,g.length*4),d.frameStatistics.incrementVboLoadCount(1))},c.prototype.applySkyIndices=function(d){var h=d.currentGlContext,u=this._skyData,m,g;u.indicesVboCacheKey||(u.indicesVboCacheKey=d.gpuResourceCache.generateCacheKey()),g=d.gpuResourceCache.resourceForKey(u.indicesVboCacheKey),g?h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,g):(m=this.assembleTriStripIndices(this._skyWidth,this._skyHeight),g=h.createBuffer(),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,g),h.bufferData(h.ELEMENT_ARRAY_BUFFER,m,h.STATIC_DRAW),d.frameStatistics.incrementVboLoadCount(1),d.gpuResourceCache.putResource(u.indicesVboCacheKey,g,m.length*2))},c.prototype.drawSky=function(d){var h=d.currentGlContext,u=d.findAndBindProgram(s);u.loadGlobeRadius(h,d.globe.equatorialRadius),u.loadEyePoint(h,d.eyePoint),u.loadVertexOrigin(h,f.ZERO),u.loadModelviewProjection(h,d.modelviewProjection),u.loadLightDirection(h,this._activeLightDirection),u.setScale(h),this.applySkyVertices(d),this.applySkyIndices(d),h.depthMask(!1),h.frontFace(h.CW),h.enableVertexAttribArray(0),h.drawElements(h.TRIANGLE_STRIP,this._numIndices,h.UNSIGNED_SHORT,0),h.depthMask(!0),h.frontFace(h.CCW),h.disableVertexAttribArray(0)},c.prototype.drawGround=function(d){var h=d.currentGlContext,u=d.findAndBindProgram(l),m=d.terrain,g;u.loadGlobeRadius(h,d.globe.equatorialRadius),u.loadEyePoint(h,d.eyePoint),u.loadLightDirection(h,this._activeLightDirection),u.setScale(h),this.nightImageSource&&this.time!==null&&(this._activeTexture=d.gpuResourceCache.resourceForKey(this.nightImageSource),this._activeTexture||(this._activeTexture=d.gpuResourceCache.retrieveTexture(h,this.nightImageSource)),g=this._activeTexture&&this._activeTexture.bind(d)),m.beginRendering(d);for(var _=0,y=m.surfaceGeometry.length;_<y;_++){var v=m.surfaceGeometry[_],b=v.referencePoint;u.loadVertexOrigin(h,b),g&&(this._texMatrix.setToUnitYFlip(),this._texMatrix.multiplyByTileTransform(v.sector,this._fullSphereSector),u.loadTexMatrix(h,this._texMatrix)),m.beginRenderingTile(d,v),u.loadFragMode(h,u.FRAGMODE_GROUND_SECONDARY),h.blendFunc(h.DST_COLOR,h.ZERO),m.renderTile(d,v);var R=g?u.FRAGMODE_GROUND_PRIMARY_TEX_BLEND:u.FRAGMODE_GROUND_PRIMARY;u.loadFragMode(h,R),h.blendFunc(h.ONE,h.ONE),m.renderTile(d,v),m.endRenderingTile(d,v)}m.endRendering(d),h.blendFunc(h.ONE,h.ONE_MINUS_SRC_ALPHA),this._activeTexture=null},c.prototype.assembleVertexPoints=function(d,h,u,m){var g=h*u,_=new Array(g);o.fillArray(_,m);var y=new Float32Array(g*3);return d.globe.computePointsForGrid(this._fullSphereSector,h,u,_,f.ZERO,y)},c.prototype.assembleTriStripIndices=function(d,h){for(var u=[],m=0,g=0;g<d-1;g++){for(var _=0;_<h;_++)m=_+g*h,u.push(m+h),u.push(m);g<d-2&&(u.push(m),u.push((g+2)*h))}return this._numIndices=u.length,new Uint16Array(u)},c.prototype.determineLightDirection=function(d){if(this.time!==null){var h=a.getAsGeographicLocation(this.time);d.globe.computePointFromLocation(h.latitude,h.longitude,this._activeLightDirection)}else this._activeLightDirection.copy(d.eyePoint);this._activeLightDirection.normalize()},c}),B("util/BasicTimeSequence",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e){if(!e&&e.length<2)throw new p(l.logMessage(l.LEVEL_SEVERE,"BasicTimeSequence","constructor","missingDates"));this.dates=e,this.currentIndex=0,this.currentTime=e[0]};return Object.defineProperties(n.prototype,{scaleForCurrentTime:{get:function(){return this.currentTime?this.currentIndex/this.dates.length:1}}}),n.prototype.next=function(){return this.currentIndex>=this.dates.length-1?null:(this.currentIndex++,this.currentTime=this.dates[this.currentIndex],this.currentTime)},n.prototype.previous=function(){return this.currentIndex<=0?null:(this.currentIndex--,this.currentTime=this.dates[this.currentIndex],this.currentTime)},n.prototype.reset=function(){this.currentIndex=-1,this.currentTime=null},n.prototype.getTimeForScale=function(e){return e<=0?this.currentIndex=0:e>=1?this.currentIndex=this.dates.length-1:this.currentIndex=Math.floor(this.dates.length*e),this.currentTime=this.dates[this.currentIndex],this.currentTime},n}),B("gesture/Touch",[],function(){"use strict";var p=function(l,n,e){this.identifier=l,this._clientX=n,this._clientY=e,this._clientStartX=n,this._clientStartY=e};return Object.defineProperties(p.prototype,{clientX:{get:function(){return this._clientX},set:function(l){this._clientX=l}},clientY:{get:function(){return this._clientY},set:function(l){this._clientY=l}},translationX:{get:function(){return this._clientX-this._clientStartX},set:function(l){this._clientStartX=this._clientX-l}},translationY:{get:function(){return this._clientY-this._clientStartY},set:function(l){this._clientStartY=this._clientY-l}}}),p}),B("gesture/GestureRecognizer",["../error/ArgumentError","../util/Logger","../gesture/Touch"],function(p,l,n){"use strict";var e=function(i,t){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"GestureRecognizer","constructor","missingTarget"));this.target=i,this.enabled=!0,this._state=WorldWind.POSSIBLE,this._nextState=null,this._clientX=0,this._clientY=0,this._clientStartX=0,this._clientStartY=0,this._translationX=0,this._translationY=0,this._translationWeight=.4,this._mouseButtonMask=0,this._touches=[],this._touchCentroidShiftX=0,this._touchCentroidShiftY=0,this._gestureCallbacks=[],this._canRecognizeWith=[],this._requiresFailureOf=[],this._requiredToFailBy=[],t&&this._gestureCallbacks.push(t),this.listenerList=[],e.allRecognizers.push(this)};return e.allRecognizers=[],Object.defineProperties(e.prototype,{state:{get:function(){return this._state},set:function(i){this.transitionToState(i)}},clientX:{get:function(){return this._clientX},set:function(i){this._clientX=i}},clientY:{get:function(){return this._clientY},set:function(i){this._clientY=i}},translationX:{get:function(){return this._translationX},set:function(i){this._translationX=i,this._clientStartX=this._clientX,this._touchCentroidShiftX=0}},translationY:{get:function(){return this._translationY},set:function(i){this._translationY=i,this._clientStartY=this._clientY,this._touchCentroidShiftY=0}},mouseButtonMask:{get:function(){return this._mouseButtonMask}},touchCount:{get:function(){return this._touches.length}},gestureCallbacks:{get:function(){return this._gestureCallbacks}}}),e.prototype.touch=function(i){if(i<0||i>=this._touches.length)throw new p(l.logMessage(l.LEVEL_SEVERE,"GestureRecognizer","touch","indexOutOfRange"));return this._touches[i]},e.prototype.recognizeSimultaneouslyWith=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"GestureRecognizer","recognizeSimultaneouslyWith","The specified gesture recognizer is null or undefined."));var t=this._canRecognizeWith.indexOf(i);t==-1&&(this._canRecognizeWith.push(i),i._canRecognizeWith.push(this))},e.prototype.canRecognizeSimultaneouslyWith=function(i){var t=this._canRecognizeWith.indexOf(i);return t!=-1},e.prototype.requireRecognizerToFail=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"GestureRecognizer","requireRecognizerToFail","The specified gesture recognizer is null or undefined"));var t=this._requiresFailureOf.indexOf(i);t==-1&&(this._requiresFailureOf.push(i),i._requiredToFailBy.push(this))},e.prototype.requiresRecognizerToFail=function(i){var t=this._requiresFailureOf.indexOf(i);return t!=-1},e.prototype.requiredToFailByRecognizer=function(i){var t=this._requiredToFailBy.indexOf(i);return t!=-1},e.prototype.reset=function(){this._state=WorldWind.POSSIBLE,this._nextState=null,this._clientX=0,this._clientY=0,this._clientStartX=0,this._clientStartY=0,this._translationX=0,this._translationY=0,this._mouseButtonMask=0,this._touches=[],this._touchCentroidShiftX=0,this._touchCentroidShiftY=0},e.prototype.prepareToRecognize=function(){},e.prototype.mouseDown=function(i){},e.prototype.mouseMove=function(i){},e.prototype.mouseUp=function(i){},e.prototype.touchStart=function(i){},e.prototype.touchMove=function(i){},e.prototype.touchCancel=function(i){},e.prototype.touchEnd=function(i){},e.prototype.transitionToState=function(i){this._nextState=null,i===WorldWind.FAILED?(this._state=i,this.updateRecognizersWaitingForFailure(),this.resetIfEventsEnded()):i===WorldWind.RECOGNIZED?(this.tryToRecognize(i),this._state===i&&(this.prepareToRecognize(),this.notifyListeners(),this.callGestureCallbacks(),this.resetIfEventsEnded())):i===WorldWind.BEGAN?(this.tryToRecognize(i),this._state===i&&(this.prepareToRecognize(),this.notifyListeners(),this.callGestureCallbacks())):i===WorldWind.CHANGED?(this._state=i,this.notifyListeners(),this.callGestureCallbacks()):i===WorldWind.CANCELLED?(this._state=i,this.notifyListeners(),this.callGestureCallbacks(),this.resetIfEventsEnded()):i===WorldWind.ENDED&&(this._state=i,this.notifyListeners(),this.callGestureCallbacks(),this.resetIfEventsEnded())},e.prototype.updateRecognizersWaitingForFailure=function(){for(var i=0,t=this._requiredToFailBy.length;i<t;i++){var r=this._requiredToFailBy[i];r._nextState!=null&&r.transitionToState(r._nextState)}},e.prototype.tryToRecognize=function(i){if(e.allRecognizers.some(this.canBePreventedByRecognizer,this)){this.transitionToState(WorldWind.FAILED);return}if(e.allRecognizers.some(this.isWaitingForRecognizerToFail,this)){this._nextState=i;return}for(var t=e.allRecognizers.filter(this.canPreventRecognizer,this),r=0,s=t.length;r<s;r++)t[r].transitionToState(WorldWind.FAILED);this._state=i},e.prototype.canPreventRecognizer=function(i){return this!=i&&this.target==i.target&&i.state==WorldWind.POSSIBLE&&(this.requiredToFailByRecognizer(i)||!this.canRecognizeSimultaneouslyWith(i))},e.prototype.canBePreventedByRecognizer=function(i){return this!=i&&this.target==i.target&&i.state==WorldWind.RECOGNIZED&&(this.requiresRecognizerToFail(i)||!this.canRecognizeSimultaneouslyWith(i))},e.prototype.isWaitingForRecognizerToFail=function(i){return this!=i&&this.target==i.target&&i.state==WorldWind.POSSIBLE&&this.requiresRecognizerToFail(i)},e.prototype.addListener=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"GestureRecognizer","addListener","missingListener"));this.listenerList.push(i)},e.prototype.removeListener=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"GestureRecognizer","removeListener","missingListener"));var t=this.listenerList.indexOf(i);t!==-1&&this.listenerList.splice(t,1)},e.prototype.notifyListeners=function(){for(var i=0;i<this.listenerList.length;i++)this.listenerList[i].gestureStateChanged(this)},e.prototype.callGestureCallbacks=function(){for(var i=0,t=this._gestureCallbacks.length;i<t;i++)this._gestureCallbacks[i](this)},e.prototype.onGestureEvent=function(i){if(this.enabled&&!(i.defaultPrevented&&this.state===WorldWind.POSSIBLE)){var t,r;try{if(i.type==="mousedown")this.handleMouseDown(i);else if(i.type==="mousemove")this.handleMouseMove(i);else if(i.type==="mouseup")this.handleMouseUp(i);else if(i.type==="touchstart")for(t=0,r=i.changedTouches.length;t<r;t++)this.handleTouchStart(i.changedTouches.item(t));else if(i.type==="touchmove")for(t=0,r=i.changedTouches.length;t<r;t++)this.handleTouchMove(i.changedTouches.item(t));else if(i.type==="touchcancel")for(t=0,r=i.changedTouches.length;t<r;t++)this.handleTouchCancel(i.changedTouches.item(t));else if(i.type==="touchend")for(t=0,r=i.changedTouches.length;t<r;t++)this.handleTouchEnd(i.changedTouches.item(t));else i.type==="pointerdown"&&i.pointerType==="mouse"?this.handleMouseDown(i):i.type==="pointermove"&&i.pointerType==="mouse"?this.handleMouseMove(i):i.type==="pointercancel"&&i.pointerType==="mouse"||(i.type==="pointerup"&&i.pointerType==="mouse"?this.handleMouseUp(i):i.type==="pointerdown"&&i.pointerType==="touch"?this.handleTouchStart(i):i.type==="pointermove"&&i.pointerType==="touch"?this.handleTouchMove(i):i.type==="pointercancel"&&i.pointerType==="touch"?this.handleTouchCancel(i):i.type==="pointerup"&&i.pointerType==="touch"?this.handleTouchEnd(i):l.logMessage(l.LEVEL_INFO,"GestureRecognizer","handleEvent","Unrecognized event type: "+i.type))}catch(s){l.logMessage(l.LEVEL_SEVERE,"GestureRecognizer","handleEvent","Error handling event.\n"+s.toString())}}},e.prototype.handleMouseDown=function(i){if(!(i.type=="mousedown"&&this._touches.length>0)){var t=1<<i.button;t&this._mouseButtonMask!=0||(this._mouseButtonMask==0&&(this._clientX=i.clientX,this._clientY=i.clientY,this._clientStartX=i.clientX,this._clientStartY=i.clientY,this._translationX=0,this._translationY=0),this._mouseButtonMask|=t,this.mouseDown(i))}},e.prototype.handleMouseMove=function(i){if(this._mouseButtonMask!=0&&!(this._clientX==i.clientX&&this._clientY==i._clientY)){var t=i.clientX-this._clientStartX,r=i.clientY-this._clientStartY,s=this._translationWeight;this._clientX=i.clientX,this._clientY=i.clientY,this._translationX=this._translationX*(1-s)+t*s,this._translationY=this._translationY*(1-s)+r*s,this.mouseMove(i)}},e.prototype.handleMouseUp=function(i){var t=1<<i.button;t&this._mouseButtonMask==0||(this._mouseButtonMask&=~t,this.mouseUp(i),this._mouseButtonMask==0&&this.resetIfEventsEnded())},e.prototype.handleTouchStart=function(i){var t=new n(i.identifier||i.pointerId,i.clientX,i.clientY);this._touches.push(t),this._touches.length==1?(this._clientX=i.clientX,this._clientY=i.clientY,this._clientStartX=i.clientX,this._clientStartY=i.clientY,this._translationX=0,this._translationY=0,this._touchCentroidShiftX=0,this._touchCentroidShiftY=0):this.touchesAddedOrRemoved(),this.touchStart(t)},e.prototype.handleTouchMove=function(i){var t=this.indexOfTouchWithId(i.identifier||i.pointerId);if(t!=-1){var r=this._touches[t];if(!(r.clientX==i.clientX&&r.clientY==i.clientY)){r.clientX=i.clientX,r.clientY=i.clientY;var s=this.touchCentroid(),a=s.clientX-this._clientStartX+this._touchCentroidShiftX,f=s.clientY-this._clientStartY+this._touchCentroidShiftY,o=this._translationWeight;this._clientX=s.clientX,this._clientY=s.clientY,this._translationX=this._translationX*(1-o)+a*o,this._translationY=this._translationY*(1-o)+f*o,this.touchMove(r)}}},e.prototype.handleTouchCancel=function(i){var t=this.indexOfTouchWithId(i.identifier||i.pointerId);if(t!=-1){var r=this._touches[t];this._touches.splice(t,1),this.touchesAddedOrRemoved(),this.touchCancel(r),this.resetIfEventsEnded()}},e.prototype.handleTouchEnd=function(i){var t=this.indexOfTouchWithId(i.identifier||i.pointerId);if(t!=-1){var r=this._touches[t];this._touches.splice(t,1),this.touchesAddedOrRemoved(),this.touchEnd(r),this.resetIfEventsEnded()}},e.prototype.resetIfEventsEnded=function(){this._state!=WorldWind.POSSIBLE&&this._mouseButtonMask==0&&this._touches.length==0&&this.reset()},e.prototype.touchesAddedOrRemoved=function(){this._touchCentroidShiftX+=this._clientX,this._touchCentroidShiftY+=this._clientY;var i=this.touchCentroid();this._clientX=i.clientX,this._clientY=i.clientY,this._touchCentroidShiftX-=this._clientX,this._touchCentroidShiftY-=this._clientY},e.prototype.touchCentroid=function(){for(var i=0,t=0,r=0,s=this._touches.length;r<s;r++){var a=this._touches[r];i+=a.clientX/s,t+=a.clientY/s}return{clientX:i,clientY:t}},e.prototype.indexOfTouchWithId=function(i){for(var t=0,r=this._touches.length;t<r;t++)if(this._touches[t].identifier==i)return t;return-1},e}),B("gesture/ClickRecognizer",["../gesture/GestureRecognizer"],function(p){"use strict";var l=function(n,e){p.call(this,n,e),this.numberOfClicks=1,this.button=0,this.maxMouseMovement=5,this.maxClickDuration=500,this.maxClickInterval=400,this.clicks=[],this.timeout=null};return l.prototype=Object.create(p.prototype),l.prototype.reset=function(){p.prototype.reset.call(this),this.clicks=[],this.cancelFailAfterDelay()},l.prototype.mouseDown=function(n){if(this.state==WorldWind.POSSIBLE)if(this.button!=n.button)this.state=WorldWind.FAILED;else{var e={clientX:this.clientX,clientY:this.clientY};this.clicks.push(e),this.failAfterDelay(this.maxClickDuration)}},l.prototype.mouseMove=function(n){if(this.state==WorldWind.POSSIBLE){var e=this.translationX,i=this.translationY,t=Math.sqrt(e*e+i*i);t>this.maxMouseMovement&&(this.state=WorldWind.FAILED)}},l.prototype.mouseUp=function(n){if(this.state==WorldWind.POSSIBLE&&this.mouseButtonMask==0){var e=this.clicks.length;e==this.numberOfClicks?(this.clientX=this.clicks[0].clientX,this.clientY=this.clicks[0].clientY,this.state=WorldWind.RECOGNIZED):this.failAfterDelay(this.maxClickInterval)}},l.prototype.touchStart=function(n){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},l.prototype.failAfterDelay=function(n){var e=this;e.timeout&&window.clearTimeout(e.timeout),e.timeout=window.setTimeout(function(){e.timeout=null,e.state==WorldWind.POSSIBLE&&(e.state=WorldWind.FAILED)},n)},l.prototype.cancelFailAfterDelay=function(){var n=this;n.timeout&&(window.clearTimeout(n.timeout),n.timeout=null)},l}),B("gesture/DragRecognizer",["../gesture/GestureRecognizer"],function(p){"use strict";var l=function(n,e){p.call(this,n,e),this.button=0,this.interpretDistance=5};return l.prototype=Object.create(p.prototype),l.prototype.mouseMove=function(n){this.state==WorldWind.POSSIBLE?this.shouldInterpret()&&(this.shouldRecognize()?(this.translationX=0,this.translationY=0,this.state=WorldWind.BEGAN):this.state=WorldWind.FAILED):(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CHANGED)},l.prototype.mouseUp=function(n){this.mouseButtonMask==0&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.ENDED))},l.prototype.touchStart=function(n){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},l.prototype.shouldInterpret=function(){var n=this.translationX,e=this.translationY,i=Math.sqrt(n*n+e*e);return i>this.interpretDistance},l.prototype.shouldRecognize=function(){var n=1<<this.button;return n==this.mouseButtonMask},l}),B("gesture/PanRecognizer",["../gesture/GestureRecognizer"],function(p){"use strict";var l=function(n,e){p.call(this,n,e),this.minNumberOfTouches=1,this.maxNumberOfTouches=Number.MAX_VALUE,this.interpretDistance=20};return l.prototype=Object.create(p.prototype),l.prototype.mouseDown=function(n){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},l.prototype.touchMove=function(n){this.state==WorldWind.POSSIBLE?this.shouldInterpret()&&(this.shouldRecognize()?this.state=WorldWind.BEGAN:this.state=WorldWind.FAILED):(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CHANGED)},l.prototype.touchEnd=function(n){this.touchCount==0&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.ENDED))},l.prototype.touchCancel=function(n){this.touchCount==0&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CANCELLED))},l.prototype.prepareToRecognize=function(){this.translationX=0,this.translationY=0},l.prototype.shouldInterpret=function(){var n=this.translationX,e=this.translationY,i=Math.sqrt(n*n+e*e);return i>this.interpretDistance},l.prototype.shouldRecognize=function(){var n=this.touchCount;return n!=0&&n>=this.minNumberOfTouches&&n<=this.maxNumberOfTouches},l}),B("gesture/PinchRecognizer",["../gesture/GestureRecognizer"],function(p){"use strict";var l=function(n,e){p.call(this,n,e),this._scale=1,this._offsetScale=1,this.referenceDistance=0,this.interpretThreshold=20,this.weight=.4,this.pinchTouches=[]};return l.prototype=Object.create(p.prototype),Object.defineProperties(l.prototype,{scale:{get:function(){return this._scale*this._offsetScale}}}),l.prototype.reset=function(){p.prototype.reset.call(this),this._scale=1,this._offsetScale=1,this.referenceDistance=0,this.pinchTouches=[]},l.prototype.mouseDown=function(n){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},l.prototype.touchStart=function(n){this.pinchTouches.length<2&&this.pinchTouches.push(n)==2&&(this.referenceDistance=this.currentPinchDistance(),this._offsetScale*=this._scale,this._scale=1)},l.prototype.touchMove=function(n){if(this.pinchTouches.length==2){if(this.state==WorldWind.POSSIBLE)this.shouldRecognize()&&(this.state=WorldWind.BEGAN);else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED){var e=this.currentPinchDistance(),i=Math.abs(e/this.referenceDistance),t=this.weight;this._scale=this._scale*(1-t)+i*t,this.state=WorldWind.CHANGED}}},l.prototype.touchEnd=function(n){var e=this.pinchTouches.indexOf(n);e!=-1&&this.pinchTouches.splice(e,1),this.touchCount==0&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.ENDED))},l.prototype.touchCancel=function(n){var e=this.pinchTouches.indexOf(n);e!=-1&&this.pinchTouches.splice(e,1),this.touchCount==0&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CANCELLED))},l.prototype.prepareToRecognize=function(){this.referenceDistance=this.currentPinchDistance(),this._scale=1},l.prototype.shouldRecognize=function(){var n=this.currentPinchDistance();return Math.abs(n-this.referenceDistance)>this.interpretThreshold},l.prototype.currentPinchDistance=function(){var n=this.pinchTouches[0],e=this.pinchTouches[1],i=n.clientX-e.clientX,t=n.clientY-e.clientY;return Math.sqrt(i*i+t*t)},l}),B("gesture/RotationRecognizer",["../geom/Angle","../gesture/GestureRecognizer"],function(p,l){"use strict";var n=function(e,i){l.call(this,e,i),this._rotation=0,this._offsetRotation=0,this.referenceAngle=0,this.interpretThreshold=20,this.weight=.4,this.rotationTouches=[]};return n.prototype=Object.create(l.prototype),Object.defineProperties(n.prototype,{rotation:{get:function(){return this._rotation+this._offsetRotation}}}),n.prototype.reset=function(){l.prototype.reset.call(this),this._rotation=0,this._offsetRotation=0,this.referenceAngle=0,this.rotationTouches=[]},n.prototype.mouseDown=function(e){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},n.prototype.touchStart=function(e){this.rotationTouches.length<2&&this.rotationTouches.push(e)==2&&(this.referenceAngle=this.currentTouchAngle(),this._offsetRotation+=this._rotation,this._rotation=0)},n.prototype.touchMove=function(e){if(this.rotationTouches.length==2){if(this.state==WorldWind.POSSIBLE)this.shouldRecognize()&&(this.state=WorldWind.BEGAN);else if(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED){var i=this.currentTouchAngle(),t=p.normalizedDegrees(i-this.referenceAngle),r=this.weight;this._rotation=this._rotation*(1-r)+t*r,this.state=WorldWind.CHANGED}}},n.prototype.touchEnd=function(e){var i=this.rotationTouches.indexOf(e);i!=-1&&this.rotationTouches.splice(i,1),this.touchCount==0&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.ENDED))},n.prototype.touchCancel=function(e){var i=this.rotationTouches.indexOf(e);i!=-1&&(this.rotationTouches.splice(i,1),this.touchCount==0&&(this.state==WorldWind.POSSIBLE?this.state=WorldWind.FAILED:(this.state==WorldWind.BEGAN||this.state==WorldWind.CHANGED)&&(this.state=WorldWind.CANCELLED)))},n.prototype.prepareToRecognize=function(){this.referenceAngle=this.currentTouchAngle(),this._rotation=0},n.prototype.shouldRecognize=function(){var e=this.currentTouchAngle(),i=p.normalizedDegrees(e-this.referenceAngle);return Math.abs(i)>this.interpretThreshold},n.prototype.currentTouchAngle=function(){var e=this.rotationTouches[0],i=this.rotationTouches[1],t=e.clientX-i.clientX,r=e.clientY-i.clientY;return Math.atan2(r,t)*p.RADIANS_TO_DEGREES},n}),B("gesture/TapRecognizer",["../gesture/GestureRecognizer"],function(p){"use strict";var l=function(n,e){p.call(this,n,e),this.numberOfTaps=1,this.numberOfTouches=1,this.maxTouchMovement=20,this.maxTapDuration=500,this.maxTapInterval=400,this.taps=[],this.timeout=null};return l.prototype=Object.create(p.prototype),l.prototype.reset=function(){p.prototype.reset.call(this),this.taps=[],this.cancelFailAfterDelay()},l.prototype.mouseDown=function(n){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},l.prototype.touchStart=function(n){if(this.state==WorldWind.POSSIBLE){var e;this.touchCount>this.numberOfTouches?this.state=WorldWind.FAILED:this.touchCount==1?(e={touchCount:this.touchCount,clientX:this.clientX,clientY:this.clientY},this.taps.push(e),this.failAfterDelay(this.maxTapDuration)):(e=this.taps[this.taps.length-1],e.touchCount=this.touchCount,e.clientX=this.clientX,e.clientY=this.clientY)}},l.prototype.touchMove=function(n){if(this.state==WorldWind.POSSIBLE){var e=this.translationX,i=this.translationY,t=Math.sqrt(e*e+i*i);t>this.maxTouchMovement&&(this.state=WorldWind.FAILED)}},l.prototype.touchEnd=function(n){if(this.state==WorldWind.POSSIBLE&&this.touchCount==0){var e=this.taps.length,i=this.taps[e-1];i.touchCount!=this.numberOfTouches?this.state=WorldWind.FAILED:e==this.numberOfTaps?(this.clientX=this.taps[0].clientX,this.clientY=this.taps[0].clientY,this.state=WorldWind.RECOGNIZED):this.failAfterDelay(this.maxTapInterval)}},l.prototype.touchCancel=function(n){this.state==WorldWind.POSSIBLE&&(this.state=WorldWind.FAILED)},l.prototype.failAfterDelay=function(n){var e=this;e.timeout&&window.clearTimeout(e.timeout),e.timeout=window.setTimeout(function(){e.timeout=null,e.state==WorldWind.POSSIBLE&&(e.state=WorldWind.FAILED)},n)},l.prototype.cancelFailAfterDelay=function(){var n=this;n.timeout&&(window.clearTimeout(n.timeout),n.timeout=null)},l}),B("gesture/TiltRecognizer",["../gesture/PanRecognizer"],function(p){"use strict";var l=function(n,e){p.call(this,n,e),this.maxTouchDistance=250,this.maxTouchDivergence=50};return l.LEFT=1,l.RIGHT=2,l.UP=4,l.DOWN=8,l.prototype=Object.create(p.prototype),l.prototype.shouldInterpret=function(){for(var n=0,e=this.touchCount;n<e;n++){var i=this.touch(n),t=i.translationX,r=i.translationY,s=Math.sqrt(t*t+r*r);if(s>this.interpretDistance)return!0}return!1},l.prototype.shouldRecognize=function(){var n=this.touchCount;if(n<2)return!1;var e=this.touch(0),i=this.touch(1),t=e.clientX-i.clientX,r=e.clientY-i.clientY,s=Math.sqrt(t*t+r*r);if(s>this.maxTouchDistance)return!1;var a=e.translationX-i.translationX,f=e.translationY-i.translationY,o=Math.sqrt(a*a+f*f);if(o>this.maxTouchDivergence)return!1;var c=l.UP|l.DOWN,d=this.touchDirection(e)&c,h=this.touchDirection(i)&c;return(d&h)!=0},l.prototype.touchDirection=function(n){var e=n.translationX,i=n.translationY,t=0;return Math.abs(e)>Math.abs(i)?(t|=e<0?l.LEFT:0,t|=e>0?l.RIGHT:0):(t|=i<0?l.UP:0,t|=i>0?l.DOWN:0),t},l}),B("WorldWindowController",["./error/ArgumentError","./util/Logger","./error/UnsupportedOperationError"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WorldWindowController","constructor","missingWorldWindow"));this.wwd=i,this.allGestureListeners=[]};return e.prototype.onGestureEvent=function(i){for(var t=!1,r=0;r<this.allGestureListeners.length&&!t;r++)t|=this.allGestureListeners[r].onGestureEvent(i);return t},e.prototype.gestureStateChanged=function(i){throw new n(l.logMessage(l.LEVEL_SEVERE,"WorldWindowController","gestureStateChanged","abstractInvocation"))},e.prototype.addGestureListener=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WorldWindowController","addGestureListener","missingListener"));this.allGestureListeners.push(i)},e.prototype.removeGestureListener=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WorldWindowController","removeGestureListener","missingListener"));var t=this.allGestureListeners.indexOf(i);t!==-1&&this.allGestureListeners.splice(t,1)},e.prototype.applyLimits=function(){},e}),B("BasicWorldWindowController",["./geom/Angle","./error/ArgumentError","./gesture/ClickRecognizer","./gesture/DragRecognizer","./gesture/GestureRecognizer","./util/Logger","./geom/Matrix","./gesture/PanRecognizer","./gesture/PinchRecognizer","./geom/Position","./gesture/RotationRecognizer","./gesture/TapRecognizer","./gesture/TiltRecognizer","./geom/Vec2","./geom/Vec3","./WorldWindowController","./util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m,g){"use strict";var _=function(y){m.call(this,y),this.primaryDragRecognizer=new e(this.wwd,null),this.primaryDragRecognizer.addListener(this),this.secondaryDragRecognizer=new e(this.wwd,null),this.secondaryDragRecognizer.addListener(this),this.secondaryDragRecognizer.button=2,this.panRecognizer=new s(this.wwd,null),this.panRecognizer.addListener(this),this.pinchRecognizer=new a(this.wwd,null),this.pinchRecognizer.addListener(this),this.rotationRecognizer=new o(this.wwd,null),this.rotationRecognizer.addListener(this),this.tiltRecognizer=new d(this.wwd,null),this.tiltRecognizer.addListener(this),this.panRecognizer.recognizeSimultaneouslyWith(this.pinchRecognizer),this.panRecognizer.recognizeSimultaneouslyWith(this.rotationRecognizer),this.pinchRecognizer.recognizeSimultaneouslyWith(this.rotationRecognizer),this.panRecognizer.requireRecognizerToFail(this.tiltRecognizer),this.pinchRecognizer.requireRecognizerToFail(this.tiltRecognizer),this.rotationRecognizer.requireRecognizerToFail(this.tiltRecognizer),this.beginPoint=new h(0,0),this.lastPoint=new h(0,0),this.beginHeading=0,this.beginTilt=0,this.beginRange=0,this.lastRotation=0};return _.prototype=Object.create(m.prototype),_.prototype.onGestureEvent=function(y){var v=m.prototype.onGestureEvent.call(this,y);if(!v)if(y.type==="wheel")v=!0,this.handleWheelEvent(y);else for(var b=0,R=i.allRecognizers.length;b<R;b++){var M=i.allRecognizers[b];M.target===this.wwd&&(v|=M.onGestureEvent(y))}return v},_.prototype.gestureStateChanged=function(y){y===this.primaryDragRecognizer||y===this.panRecognizer?this.handlePanOrDrag(y):y===this.secondaryDragRecognizer?this.handleSecondaryDrag(y):y===this.pinchRecognizer?this.handlePinch(y):y===this.rotationRecognizer?this.handleRotation(y):y===this.tiltRecognizer&&this.handleTilt(y)},_.prototype.handlePanOrDrag=function(y){this.wwd.globe.is2D()?this.handlePanOrDrag2D(y):this.handlePanOrDrag3D(y)},_.prototype.handlePanOrDrag3D=function(y){var v=y.state,b=y.translationX,R=y.translationY,M=this.wwd.navigator;if(v===WorldWind.BEGAN)this.lastPoint.set(0,0);else if(v===WorldWind.CHANGED){var P=this.wwd.canvas,T=this.wwd.globe,E=g.max(T.equatorialRadius,T.polarRadius),x=g.max(1,M.range),S=g.perspectivePixelSize(P.clientWidth,P.clientHeight,x),L=(R-this.lastPoint[1])*S,C=-(b-this.lastPoint[0])*S,F=L/E*p.RADIANS_TO_DEGREES,q=C/E*p.RADIANS_TO_DEGREES,it=Math.sin(M.heading*p.DEGREES_TO_RADIANS),st=Math.cos(M.heading*p.DEGREES_TO_RADIANS);M.lookAtLocation.latitude+=F*st-q*it,M.lookAtLocation.longitude+=F*it+q*st,this.lastPoint.set(b,R),this.applyLimits(),this.wwd.redraw()}},_.prototype.handlePanOrDrag2D=function(y){var v=y.state,b=y.clientX,R=y.clientY,M=y.translationX,P=y.translationY,T=this.wwd.navigator;if(v===WorldWind.BEGAN)this.beginPoint.set(b,R),this.lastPoint.set(b,R);else if(v===WorldWind.CHANGED){var E=this.lastPoint[0],x=this.lastPoint[1],S=this.beginPoint[0]+M,L=this.beginPoint[1]+P;this.lastPoint.set(S,L);var C=this.wwd.globe,F=this.wwd.rayThroughScreenPoint(this.wwd.canvasCoordinates(E,x)),q=new u(0,0,0),it=new u(0,0,0),st=new u(0,0,0);if(!C.intersectsLine(F,q)||(F=this.wwd.rayThroughScreenPoint(this.wwd.canvasCoordinates(S,L)),!C.intersectsLine(F,it)))return;var pt=r.fromIdentity();if(this.wwd.computeViewingTransform(null,pt),pt.multiplyByTranslation(it[0]-q[0],it[1]-q[1],it[2]-q[2]),pt.extractEyePoint(F.origin),pt.extractForwardVector(F.direction),!C.intersectsLine(F,st))return;var _t=pt.extractViewingParameters(st,T.roll,C,{});T.lookAtLocation.copy(_t.origin),T.range=_t.range,T.heading=_t.heading,T.tilt=_t.tilt,T.roll=_t.roll,this.applyLimits(),this.wwd.redraw()}},_.prototype.handleSecondaryDrag=function(y){var v=y.state,b=y.translationX,R=y.translationY,M=this.wwd.navigator;if(v===WorldWind.BEGAN)this.beginHeading=M.heading,this.beginTilt=M.tilt;else if(v===WorldWind.CHANGED){var P=180*b/this.wwd.canvas.clientWidth,T=90*R/this.wwd.canvas.clientHeight;M.heading=this.beginHeading+P,M.tilt=this.beginTilt+T,this.applyLimits(),this.wwd.redraw()}},_.prototype.handlePinch=function(y){var v=this.wwd.navigator,b=y.state,R=y.scale;b===WorldWind.BEGAN?this.beginRange=v.range:b===WorldWind.CHANGED&&R!==0&&(v.range=this.beginRange/R,this.applyLimits(),this.wwd.redraw())},_.prototype.handleRotation=function(y){var v=this.wwd.navigator,b=y.state,R=y.rotation;b===WorldWind.BEGAN?this.lastRotation=0:b===WorldWind.CHANGED&&(v.heading-=R-this.lastRotation,this.lastRotation=R,this.applyLimits(),this.wwd.redraw())},_.prototype.handleTilt=function(y){var v=this.wwd.navigator,b=y.state,R=y.translationY;if(b===WorldWind.BEGAN)this.beginTilt=v.tilt;else if(b===WorldWind.CHANGED){var M=-90*R/this.wwd.canvas.clientHeight;v.tilt=this.beginTilt+M,this.applyLimits(),this.wwd.redraw()}},_.prototype.handleWheelEvent=function(y){var v=this.wwd.navigator,b;y.deltaMode===WheelEvent.DOM_DELTA_PIXEL?b=y.deltaY:y.deltaMode===WheelEvent.DOM_DELTA_LINE?b=y.deltaY*40:y.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(b=y.deltaY*400);var R=1+b/1e3;v.range*=R,this.applyLimits(),this.wwd.redraw()},_.prototype.applyLimits=function(){var y=this.wwd.navigator;if(y.lookAtLocation.latitude=g.clamp(y.lookAtLocation.latitude,-90,90),y.lookAtLocation.longitude=p.normalizedDegreesLongitude(y.lookAtLocation.longitude),y.range=g.clamp(y.range,1,Number.MAX_VALUE),y.heading=p.normalizedDegrees(y.heading),y.tilt=g.clamp(y.tilt,0,90),y.roll=p.normalizedDegrees(y.roll),this.wwd.globe.is2D()&&y.enable2DLimits){var v=2*Math.PI*this.wwd.globe.equatorialRadius;y.range=g.clamp(y.range,1,v),y.tilt=0}},_}),B("util/ImageSource",["../error/ArgumentError","../util/Color","../util/Logger"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"ImageSource","constructor","missingImage"));this.image=i,this.key="ImageSource "+ ++e.keyPool};return e.keyPool=0,e}),B("shapes/ScreenImage",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/ImageSource","../util/Logger","../geom/Matrix","../util/Offset","../pick/PickedObject","../render/Renderable","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o){"use strict";var c=function(d,h){if(!d)throw new p(i.logMessage(i.LEVEL_SEVERE,"ScreenImage","constructor","missingOffset"));if(!h)throw new p(i.logMessage(i.LEVEL_SEVERE,"ScreenImage","constructor","missingImage"));a.call(this),this.screenOffset=d,this._imageSource=h,this.imageColor=n.WHITE,this.imageOffset=new r(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),this.imageScale=1,this.imageRotation=0,this.imageTilt=0,this.enabled=!0,this.opacity=1,this.pickDelegate=null,this.activeTexture=null,this.imageTransform=t.fromIdentity(),this.texCoordMatrix=t.fromIdentity(),this.imageBounds=null,this.layer=null};return c.matrix=t.fromIdentity(),c.prototype=Object.create(a.prototype),Object.defineProperties(c.prototype,{imageSource:{get:function(){return this._imageSource},set:function(d){if(!d)throw new p(i.logMessage(i.LEVEL_SEVERE,"ScreenImage","imageSource","missingImage"));this._imageSource=d,this.imageSourceWasUpdated=!0}}}),c.prototype.render=function(d){if(this.enabled&&d.accumulateOrderedRenderables){var h=null;this.lastFrameTime!==d.timestamp&&(h=this.makeOrderedRenderable(d)),h&&h.isVisible(d)&&(h.layer=d.currentLayer,this.lastFrameTime=d.timestamp,d.addOrderedRenderable(h))}},c.prototype.renderOrdered=function(d){if(this.drawOrderedScreenImage(d),d.pickingMode){var h=new s(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);d.resolvePick(h)}},c.prototype.makeOrderedRenderable=function(d){var h,u,m,g,_,y,v;return this.activeTexture=this.getActiveTexture(d),(!this.activeTexture||this.imageSourceWasUpdated)&&(this.activeTexture=d.gpuResourceCache.retrieveTexture(d.currentGlContext,this._imageSource),!this.activeTexture)?null:(this.eyeDistance=0,h=this.activeTexture.imageWidth,u=this.activeTexture.imageHeight,m=this.imageScale,y=this.imageOffset.offsetForSize(h,u),g=d.viewport.width,_=d.viewport.height,v=this.screenOffset.offsetForSize(g,_),this.imageTransform.setTranslation(v[0]-y[0]*m,v[1]-y[1]*m,0),this.imageTransform.setScale(h*m,u*m,1),this.imageBounds=o.boundingRectForUnitQuad(this.imageTransform),this)},c.prototype.getActiveTexture=function(d){return d.gpuResourceCache.resourceForKey(this._imageSource)},c.prototype.isVisible=function(d){return d.pickingMode?d.pickRectangle&&this.imageBounds.intersects(d.pickRectangle):this.imageBounds.intersects(d.viewport)},c.prototype.drawOrderedScreenImage=function(d){this.beginDrawing(d);try{this.doDrawOrderedScreenImage(d)}finally{this.endDrawing(d)}},c.prototype.beginDrawing=function(d){var h=d.currentGlContext,u;d.findAndBindProgram(l),u=d.currentProgram,h.bindBuffer(h.ARRAY_BUFFER,d.unitQuadBuffer()),h.vertexAttribPointer(u.vertexTexCoordLocation,2,h.FLOAT,!1,0,0),h.enableVertexAttribArray(u.vertexPointLocation),h.enableVertexAttribArray(u.vertexTexCoordLocation),u.loadTextureUnit(h,h.TEXTURE0),u.loadModulateColor(h,d.pickingMode),h.disable(h.DEPTH_TEST)},c.prototype.endDrawing=function(d){var h=d.currentGlContext,u=d.currentProgram;h.disableVertexAttribArray(u.vertexPointLocation),h.disableVertexAttribArray(u.vertexTexCoordLocation),h.bindBuffer(h.ARRAY_BUFFER,null),h.bindTexture(h.TEXTURE_2D,null),h.enable(h.DEPTH_TEST)},c.prototype.doDrawOrderedScreenImage=function(d){var h=d.currentGlContext,u=d.currentProgram;h.bindBuffer(h.ARRAY_BUFFER,d.unitQuadBuffer3()),h.vertexAttribPointer(u.vertexPointLocation,3,h.FLOAT,!1,0,0),c.matrix.copy(d.screenProjection),c.matrix.multiplyMatrix(this.imageTransform),c.matrix.multiplyByTranslation(.5,.5,.5),c.matrix.multiplyByRotation(1,0,0,this.imageTilt),c.matrix.multiplyByRotation(0,0,1,this.imageRotation),c.matrix.multiplyByTranslation(-.5,-.5,0),u.loadModelviewProjection(h,c.matrix),u.loadTextureEnabled(h,!0),d.pickingMode?(this.pickColor=d.uniquePickColor(),u.loadColor(h,this.pickColor),u.loadOpacity(h,1)):(u.loadColor(h,this.imageColor),u.loadOpacity(h,this.opacity*this.layer.opacity)),this.texCoordMatrix.setToIdentity(),this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture),u.loadTextureMatrix(h,this.texCoordMatrix),this.activeTexture.bind(d)&&h.drawArrays(h.TRIANGLE_STRIP,0,4)},c}),B("render/TextureTile",["../error/ArgumentError","../util/Logger","../util/Tile"],function(p,l,n){"use strict";var e=function(i,t,r,s){n.call(this,i,t,r,s),this.gpuCacheKey=null};return e.prototype=Object.create(n.prototype),e.prototype.size=function(){return n.prototype.size.call(this)},e.prototype.bind=function(i){var t=i.gpuResourceCache.resourceForKey(this.gpuCacheKey);return t?t.bind(i):!1},e.prototype.applyInternalTransform=function(i,t){},e}),B("render/ImageTile",["../error/ArgumentError","../util/Logger","../render/TextureTile","../util/Tile"],function(p,l,n,e){"use strict";var i=function(t,r,s,a,f){if(!f||f.length<1)throw new p(l.logMessage(l.LEVEL_SEVERE,"ImageTile","constructor","The specified image path is null, undefined or zero length."));n.call(this,t,r,s,a),this.imagePath=f,this.fallbackTile=null,this.gpuCacheKey=f};return i.prototype=Object.create(n.prototype),i.prototype.size=function(){return this.__proto__.__proto__.size.call(this)+this.imagePath.length+8},i.prototype.bind=function(t){var r=this.__proto__.__proto__.bind.call(this,t);return r?!0:this.fallbackTile?this.fallbackTile.bind(t):!1},i.prototype.applyInternalTransform=function(t,r){this.fallbackTile&&!t.gpuResourceCache.resourceForKey(this.imagePath)&&this.applyFallbackTransform(r)},i.prototype.applyFallbackTransform=function(t){var r=this.level.levelNumber-this.fallbackTile.level.levelNumber;if(!(r<=0)){var s=this.fallbackTile.sector.deltaLatitude(),a=this.fallbackTile.sector.deltaLongitude(),f=this.sector.deltaLongitude()/a,o=this.sector.deltaLatitude()/s,c=(this.sector.minLongitude-this.fallbackTile.sector.minLongitude)/a,d=(this.sector.minLatitude-this.fallbackTile.sector.minLatitude)/s;t.multiply(f,0,0,c,0,o,0,d,0,0,1,0,0,0,0,1)}},i}),B("layer/TiledImageLayer",["../util/AbsentResourceList","../error/ArgumentError","../render/ImageTile","../layer/Layer","../util/LevelSet","../util/Logger","../geom/Matrix","../cache/MemoryCache","../render/Texture","../util/Tile","../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o){"use strict";var c=function(d,h,u,m,g,_,y){if(!d)throw new l(t.logMessage(t.LEVEL_SEVERE,"TiledImageLayer","constructor","missingSector"));if(!h)throw new l(t.logMessage(t.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified level-zero delta is null or undefined."));if(!m)throw new l(t.logMessage(t.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified image format is null or undefined."));if(!g)throw new l(t.logMessage(t.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified cache path is null or undefined."));if(!u||u<1)throw new l(t.logMessage(t.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified number of levels is less than one."));if(!_||!y||_<1||y<1)throw new l(t.logMessage(t.LEVEL_SEVERE,"TiledImageLayer","constructor","The specified tile width or height is less than one."));e.call(this,"Tiled Image Layer"),this.retrievalImageFormat=m,this.cachePath=g,this.retrievalQueueSize=WorldWind.configuration.layerRetrievalQueueSize,this.levels=new i(d,h,u,_,y),this.detailControl=1.75,this.crossOrigin="anonymous",this.expiration=null,this.currentTiles=[],this.currentTilesInvalid=!0,this.tileCache=new s(5e5,4e5),this.currentRetrievals=[],this.absentResourceList=new p(3,5e4),this.pickEnabled=!1,this.lasTtMVP=r.fromIdentity()};return c.prototype=Object.create(e.prototype),c.prototype.refresh=function(){this.expiration=new Date,this.currentTilesInvalid=!0},c.prototype.prePopulate=function(d){if(!d)throw new l(t.logMessage(t.LEVEL_SEVERE,"TiledImageLayer","prePopulate","missingWorldWindow"));var h=d.drawContext;(!this.topLevelTiles||this.topLevelTiles.length===0)&&this.createTopLevelTiles(h);for(var u=0;u<this.topLevelTiles.length;u++){var m=this.topLevelTiles[u];this.isTileTextureInMemory(h,m)||this.retrieveTileImage(h,m,!0)}},c.prototype.prePopulateCurrentTiles=function(d){if(!d)throw new l(t.logMessage(t.LEVEL_SEVERE,"TiledImageLayer","prePopulate","missingWorldWindow"));var h=d.drawContext;this.assembleTiles(h);for(var u=0,m=this.currentTiles.length;u<m;u++){var g=this.currentTiles[u];this.isTileTextureInMemory(h,g)||this.retrieveTileImage(h,g,!0)}},c.prototype.isPrePopulated=function(d){if(!d)throw new l(t.logMessage(t.LEVEL_SEVERE,"TiledImageLayer","isPrePopulated","missingWorldWindow"));for(var h=0;h<this.topLevelTiles.length;h++)if(!this.isTileTextureInMemory(d.drawContext,this.topLevelTiles[h]))return!1;return!0},c.prototype.createTile=function(d,h,u,m){var g=this.cachePath+"-layer/"+h.levelNumber+"/"+u+"/"+u+"_"+m+"."+o.suffixForMimeType(this.retrievalImageFormat);return new n(d,h,u,m,g)},c.prototype.doRender=function(d){if(d.terrain){if(this.currentTilesInvalid||!d.modelviewProjection.equals(this.lasTtMVP)||d.globeStateKey!==this.lastGlobeStateKey)if(this.currentTilesInvalid=!1,d.surfaceOpacity>=1&&this.opacity>=1){this.previousTiles={};for(var h=0;h<this.currentTiles.length;h++)this.previousTiles[this.currentTiles[h].imagePath]=this.currentTiles[h];this.assembleTiles(d),this.fadeOutgoingTiles(d)}else this.assembleTiles(d);this.lasTtMVP.copy(d.modelviewProjection),this.lastGlobeStateKey=d.globeStateKey,this.currentTiles.length>0&&(d.surfaceTileRenderer.renderTiles(d,this.currentTiles,this.opacity,d.surfaceOpacity>=1),d.frameStatistics.incrementImageTileCount(this.currentTiles.length),this.inCurrentFrame=!0)}},c.prototype.fadeOutgoingTiles=function(d){for(var h=(d.timestamp-d.previousRedrawTimestamp)/d.fadeTime,u={},m=0;m<this.currentTiles.length;m++){var g=this.currentTiles[m];u[g.imagePath]=g}for(var _ in this.previousTiles)this.previousTiles.hasOwnProperty(_)&&(g=this.previousTiles[_],g.opacity>0&&!u[g.imagePath]&&(g.opacity=Math.max(0,g.opacity-h),g.opacity>0&&(this.currentTiles.push(g),this.currentTilesInvalid=!0,d.redrawRequested=!0)))},c.prototype.isLayerInView=function(d){return d.terrain&&d.terrain.sector&&d.terrain.sector.intersects(this.levels.sector)},c.prototype.createTopLevelTiles=function(d){this.topLevelTiles=[],f.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)},c.prototype.assembleTiles=function(d){this.currentTiles=[],(!this.topLevelTiles||this.topLevelTiles.length===0)&&this.createTopLevelTiles(d);for(var h=0,u=this.topLevelTiles.length;h<u;h++){var m=this.topLevelTiles[h];m.update(d),this.currentAncestorTile=null,this.isTileVisible(d,m)&&this.addTileOrDescendants(d,m)}},c.prototype.addTileOrDescendants=function(d,h){if(this.tileMeetsRenderingCriteria(d,h)){this.addTile(d,h);return}var u=null;try{(this.isTileTextureInMemory(d,h)||h.level.levelNumber===0)&&(u=this.currentAncestorTile,this.currentAncestorTile=h);for(var m=this.levels.level(h.level.levelNumber+1),g=h.subdivideToCache(m,this,this.tileCache),_=0,y=g.length;_<y;_++){var v=g[_];v.update(d),this.levels.sector.intersects(v.sector)&&this.isTileVisible(d,v)&&this.addTileOrDescendants(d,v)}}finally{u&&(this.currentAncestorTile=u)}},c.prototype.addTile=function(d,h){h.fallbackTile=null;var u=d.gpuResourceCache.resourceForKey(h.imagePath);if(u){h.opacity=1,this.currentTiles.push(h),this.expiration&&this.isTextureExpired(u)&&this.retrieveTileImage(d,h);return}this.retrieveTileImage(d,h),this.currentAncestorTile&&this.isTileTextureInMemory(d,this.currentAncestorTile)&&(h.fallbackTile=this.currentAncestorTile,h.fallbackTile.opacity=1,this.currentTiles.push(h))},c.prototype.isTileVisible=function(d,h){return d.globe.projectionLimits&&!h.sector.overlaps(d.globe.projectionLimits)?!1:h.extent.intersectsFrustum(d.frustumInModelCoordinates)},c.prototype.tileMeetsRenderingCriteria=function(d,h){var u=this.detailControl;return(h.sector.minLatitude>=75||h.sector.maxLatitude<=-75)&&(u*=1.2),h.level.isLastLevel()||!h.mustSubdivide(d,u)},c.prototype.isTileTextureInMemory=function(d,h){return d.gpuResourceCache.containsResource(h.imagePath)},c.prototype.isTextureExpired=function(d){return this.expiration&&d.creationTime.getTime()<=this.expiration.getTime()},c.prototype.retrieveTileImage=function(d,h,u){if(this.currentRetrievals.indexOf(h.imagePath)<0){if(this.currentRetrievals.length>this.retrievalQueueSize||this.absentResourceList.isResourceAbsent(h.imagePath))return;var m=this.resourceUrlForTile(h,this.retrievalImageFormat),g=new Image,_=h.imagePath,y=d.gpuResourceCache,v=d.currentGlContext.canvas,b=this;if(!m){this.currentTilesInvalid=!0;return}m=m.substr(0,m.indexOf("?"))+encodeURIComponent(m.substr(m.indexOf("?"))),g.onload=function(){t.log(t.LEVEL_INFO,"Image retrieval succeeded: "+m);var R=b.createTexture(d,h,g);if(b.removeFromCurrentRetrievals(_),R&&(y.putResource(_,R,R.size),b.currentTilesInvalid=!0,b.absentResourceList.unmarkResourceAbsent(_),!u)){var M=document.createEvent("Event");M.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),v.dispatchEvent(M)}},g.onerror=function(){b.removeFromCurrentRetrievals(_),b.absentResourceList.markResourceAbsent(_),t.log(t.LEVEL_WARNING,"Image retrieval failed: "+m)},this.currentRetrievals.push(_),g.crossOrigin=this.crossOrigin,g.src=m}},c.prototype.createTexture=function(d,h,u){return new a(d.currentGlContext,u)},c.prototype.removeFromCurrentRetrievals=function(d){var h=this.currentRetrievals.indexOf(d);h>-1&&this.currentRetrievals.splice(h,1)},c.prototype.resourceUrlForTile=function(d,h){return this.urlBuilder?this.urlBuilder.urlForTile(d,h):null},c}),B("layer/MercatorTiledImageLayer",["../util/Color","../geom/Sector","../layer/TiledImageLayer","../geom/Vec2","../util/WWMath"],function(p,l,n,e,i){"use strict";var t=function(r,s,a,f,o,c,d){n.call(this,r,s,a,f,o,c,d),this.detectBlankImages=!1,this.testPixels=[new e(20,20),new e(235,20),new e(20,235),new e(235,235)],this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d")};return t.prototype=Object.create(n.prototype),t.prototype.createTile=function(r,s,a,f){var o=this.mapSizeForLevel(s.levelNumber),c=i.clamp(f*this.imageSize,0,o),d=i.clamp(a*this.imageSize,0,o),h=i.clamp(c+this.imageSize,0,o),u=i.clamp(d+this.imageSize,0,o),m,g,_,y,v,b;return m=c/o-.5,g=.5-u/o,_=90-360*Math.atan(Math.exp(-g*2*Math.PI))/Math.PI,y=360*m,m=h/o-.5,g=.5-d/o,v=90-360*Math.atan(Math.exp(-g*2*Math.PI))/Math.PI,b=360*m,r=new l(_,v,y,b),n.prototype.createTile.call(this,r,s,a,f)},t.prototype.createTexture=function(r,s,a){var f=r.canvas2D,o=r.ctx2D,c,d=this.destCanvas,h=this.destContext,u=h.createImageData(a.width,a.height),m=s.sector,g=i.gudermannianInverse(m.minLatitude),_=i.gudermannianInverse(m.maxLatitude),y,v,b,R,M,P,T;if(f.width=a.width,f.height=a.height,d.width=a.width,d.height=a.height,o.drawImage(a,0,0,a.width,a.height),c=o.getImageData(0,0,a.width,a.height),this.detectBlankImages&&this.isBlankImage(a,c))return this.absentResourceList.markResourceAbsentPermanently(s.imagePath),null;for(var E=0;E<1;E++)for(var x=0;x<a.height;x++){P=1-x/(a.height-1),y=P*m.deltaLatitude()+m.minLatitude,v=i.gudermannianInverse(y),T=1-(v-g)/(_-g),T=i.clamp(T,0,1),b=Math.floor(T*(a.height-1));for(var S=0;S<a.width;S++)R=4*(S+b*a.width),M=4*(S+x*a.width),u.data[M]=c.data[R],u.data[M+1]=c.data[R+1],u.data[M+2]=c.data[R+2],u.data[M+3]=c.data[R+3]}return h.putImageData(u,0,0),n.prototype.createTexture.call(this,r,s,d)},t.prototype.isBlankImage=function(r,s){for(var a,f,o=null,c=0,d=this.testPixels.length;c<d;c++)if(a=this.testPixels[c],f=4*(a[0]+a[1]*r.width),!o)o=[s.data[f],s.data[f+1],s.data[f+2]];else if(s.data[f]!=o[0]||s.data[f+1]!=o[1]||s.data[f+2]!=o[2])return!1;return!0},t}),B("layer/BingTiledImageLayer",["../geom/Angle","../util/Color","../geom/Location","../util/Offset","../shapes/ScreenImage","../geom/Sector","../layer/MercatorTiledImageLayer"],function(p,l,n,e,i,t,r){"use strict";var s=function(a){this.imageSize=256,r.call(this,new t(-85.05,85.05,-180,180),new n(85.05,180),23,"image/jpeg",a,this.imageSize,this.imageSize),this.displayName=a,this.pickEnabled=!0,this.detectBlankImages=!0};return s.logoImage=null,s.logoLastFrameTime=0,s.prototype=Object.create(r.prototype),s.prototype.doRender=function(a){r.prototype.doRender.call(this,a)},s.prototype.createTopLevelTiles=function(a){this.topLevelTiles=[],this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))},s.prototype.renderLogo=function(a){s.logoImage||(s.logoImage=new i(WorldWind.configuration.bingLogoPlacement,WorldWind.configuration.baseUrl+"images/powered-by-bing.png"),s.logoImage.imageColor=new l(1,1,1,.5)),s.logoLastFrameTime!==a.timestamp&&(s.logoImage.screenOffset=WorldWind.configuration.bingLogoPlacement,s.logoImage.imageOffset=WorldWind.configuration.bingLogoAlignment,s.logoImage.render(a),s.logoLastFrameTime=a.timestamp)},s.prototype.mapSizeForLevel=function(a){return 256<<a+1},s}),B("util/BingImageryUrlBuilder",["../error/ArgumentError","../util/Logger","../util/WWUtil"],function(p,l,n){"use strict";var e=function(i,t){var r="AkttWCS8p6qzxvx5RH3qUcCPgwG9nRJ7IwlpFGb14B0rBorB5DvmXr2Y_eCUNIxH";this.bingMapsKey=t,this.bingMapsKey||(this.bingMapsKey=WorldWind.BingMapsKey),this.bingMapsKey||(this.bingMapsKey=r),this.bingMapsKey===r&&e.showBingMapsKeyWarning(),this.imagerySet=i};return e.showBingMapsKeyWarning=function(){e.keyMessagePrinted||(e.keyMessagePrinted=!0,l.log(l.LEVEL_WARNING,"WARNING: You are using a limited use, non-production Bing Maps key.\nIf you are developing an app or a web page this violates the Bing Terms of Use.\nPlease visit https://www.microsoft.com/en-us/maps/create-a-bing-maps-key to obtain your own key for your application.\nSpecify that key to WorldWind by setting the WorldWind.BingMapsKey property to your key prior to creating any Bing Maps layers.\n"))},e.prototype.requestMetadata=function(){if(!this.metadataRetrievalInProcess){this.metadataRetrievalInProcess=!0;var i="dev.virtualearth.net/REST/V1/Imagery/Metadata/"+this.imagerySet+"/0,0?zl=1&uriScheme=https&key="+this.bingMapsKey,t=this;n.jsonp(i,"jsonp",function(r){t.imageUrl=r.resourceSets[0].resources[0].imageUrl;var s=document.createEvent("Event");s.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(s),t.metadataRetrievalInProcess=!1})}},e.prototype.urlForTile=function(i,t){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"BingImageryUrlBuilder","urlForTile","missingTile"));if(!this.imageUrl)return this.requestMetadata(),null;var r=this.quadKeyFromLevelRowColumn(i.level.levelNumber,i.row,i.column),s;return this.imagerySet==="Aerial"?s=this.imageUrl.replace(/a3/,"a"+r):this.imagerySet==="AerialWithLabels"?s=this.imageUrl.replace(/h3/,"h"+r):this.imagerySet==="Road"&&(s=this.imageUrl.replace(/r3/,"r"+r)),s},e.prototype.quadKeyFromLevelRowColumn=function(i,t,r){for(var s,a,f="",o=i+1;o>0;o--)s=0,a=1<<o-1,r&a&&(s+=1),t&a&&(s+=2),f+=s.toString();return f},e}),B("layer/BingAerialLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(p,l,n,e){"use strict";var i=function(t){n.call(this,"Bing Aerial"),this.urlBuilder=new e("Aerial",t)};return i.prototype=Object.create(n.prototype),i}),B("layer/BingAerialWithLabelsLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(p,l,n,e){"use strict";var i=function(t){n.call(this,"Bing Aerial with Labels"),this.urlBuilder=new e("AerialWithLabels",t)};return i.prototype=Object.create(n.prototype),i}),B("layer/BingRoadsLayer",["../geom/Location","../geom/Sector","../layer/BingTiledImageLayer","../util/BingImageryUrlBuilder"],function(p,l,n,e){"use strict";var i=function(t){n.call(this,"Bing Roads"),this.urlBuilder=new e("Road",t),this.detectBlankImages=!1};return i.prototype=Object.create(n.prototype),i}),B("layer/BingWMSLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(p,l,n,e){"use strict";var i=function(){n.call(this,l.FULL_SPHERE,new p(45,45),16,"image/png","BingWMS",256,256),this.displayName="Bing WMS",this.pickEnabled=!1,this.maxActiveAltitude=1e4,this.urlBuilder=new e("https://worldwind27.arc.nasa.gov/wms/virtualearth","ve","","1.3.0")};return i.prototype=Object.create(n.prototype),i}),B("layer/BMNGLandsatLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(p,l,n,e){"use strict";var i=function(){n.call(this,l.FULL_SPHERE,new p(45,45),12,"image/jpeg","BMNGLandsat256",256,256),this.displayName="Blue Marble & Landsat",this.pickEnabled=!1,this.urlBuilder=new e("worldwind25.arc.nasa.gov/wms","BlueMarble-200405,esat","","1.3.0")};return i.prototype=Object.create(n.prototype),i}),B("layer/BMNGLayer",["../geom/Location","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(p,l,n,e){"use strict";var i=function(t){n.call(this,l.FULL_SPHERE,new p(45,45),7,"image/jpeg",t||"BMNG256",256,256),this.displayName="Blue Marble",this.pickEnabled=!1,this.urlBuilder=new e("worldwind25.arc.nasa.gov/wms",t||"BlueMarble-200405","","1.3.0")};return i.prototype=Object.create(n.prototype),i}),B("layer/RenderableLayer",["../error/ArgumentError","../layer/Layer","../util/Logger"],function(p,l,n){"use strict";var e=function(i){l.call(this,i),this.renderables=[]};return e.prototype=Object.create(l.prototype),e.prototype.addRenderable=function(i){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"RenderableLayer","addRenderable","missingRenderable"));this.renderables.push(i)},e.prototype.addRenderables=function(i){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"RenderableLayer","addRenderables","The renderables array is null or undefined."));for(var t=0,r=i.length;t<r;t++)this.addRenderable(i[t])},e.prototype.removeRenderable=function(i){var t=this.renderables.indexOf(i);t>=0&&this.renderables.splice(t,1)},e.prototype.removeAllRenderables=function(){this.renderables=[]},e.prototype.doRender=function(i){for(var t=i.orderedRenderables.length,r=0,s=this.renderables.length;r<s;r++)try{this.renderables[r].render(i)}catch(a){n.logMessage(n.LEVEL_SEVERE,"RenderableLayer","doRender","Error while rendering shape "+this.renderables[r].displayName+".\n"+a.toString())}i.orderedRenderables.length>t&&(this.inCurrentFrame=!0)},e}),B("render/SurfaceTile",["../error/ArgumentError","../util/Logger","../geom/Matrix","../geom/Sector","../error/UnsupportedOperationError"],function(p,l,n,e,i){"use strict";var t=function(r){if(!r)throw new p(l.logMessage(l.LEVEL_SEVERE,"SurfaceTile","constructor","missingSector"));this.sector=r};return t.prototype.bind=function(r){throw new i(l.logMessage(l.LEVEL_SEVERE,"SurfaceTile","bind","abstractInvocation"))},t.prototype.applyInternalTransform=function(r,s){throw new i(l.logMessage(l.LEVEL_SEVERE,"SurfaceTile","applyInternalTransform","abstractInvocation"))},t}),B("shapes/SurfaceImage",["../error/ArgumentError","../util/Logger","../pick/PickedObject","../render/SurfaceTile"],function(p,l,n,e){"use strict";var i=function(t,r){if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"SurfaceImage","constructor","missingSector"));if(!r)throw new p(l.logMessage(l.LEVEL_SEVERE,"SurfaceImage","constructor","missingImage"));e.call(this,t),this.enabled=!0,this._imageSource=r,this.resamplingMode=WorldWind.FILTER_LINEAR,this.opacity=1,this.displayName="Surface Image",this.imageSourceWasUpdated=!0};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{imageSource:{get:function(){return this._imageSource},set:function(t){if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"SurfaceImage","imageSource","missingImage"));this._imageSource=t,this.imageSourceWasUpdated=!0}}}),i.prototype.bind=function(t){var r=t.gpuResourceCache.resourceForKey(this._imageSource);if(r&&!this.imageSourceWasUpdated)return this.bindTexture(t,r);if(r=t.gpuResourceCache.retrieveTexture(t.currentGlContext,this._imageSource),this.imageSourceWasUpdated=!1,r)return this.bindTexture(t,r)},i.prototype.bindTexture=function(t,r){var s=t.currentGlContext;return r.setTexParameter(s.TEXTURE_MAG_FILTER,this.resamplingMode===WorldWind.FILTER_NEAREST?s.NEAREST:s.LINEAR),r.bind(t)},i.prototype.applyInternalTransform=function(t,r){},i.prototype.render=function(t){if(this.enabled&&t.terrain&&this.sector.overlaps(t.terrain.sector)){if(t.pickingMode&&(this.pickColor=t.uniquePickColor()),t.surfaceTileRenderer.renderTiles(t,[this],this.opacity*t.currentLayer.opacity),t.pickingMode){var r=new n(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);t.resolvePick(r)}t.currentLayer.inCurrentFrame=!0}},i}),B("layer/BMNGOneImageLayer",["../layer/RenderableLayer","../geom/Sector","../shapes/SurfaceImage","../util/WWUtil"],function(p,l,n,e){"use strict";var i=function(){p.call(this,"Blue Marble Image");var t=new n(l.FULL_SPHERE,WorldWind.configuration.baseUrl+"images/BMNG_world.topo.bathy.200405.3.2048x1024.jpg");this.addRenderable(t),this.pickEnabled=!1,this.minActiveAltitude=3e6};return i.prototype=Object.create(p.prototype),i}),B("util/PeriodicTimeSequence",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"PeriodicTimeSequence","constructor","missingString"));var i=e.split("/");if(i.length!==3)throw new p(l.logMessage(l.LEVEL_SEVERE,"PeriodicTimeSequence","constructor","The interval string "+e+" does not contain 3 elements."));this.sequenceString=e,this.startTime=new Date(i[0]),this.endTime=new Date(i[1]),this.intervalMilliseconds=this.endTime.getTime()-this.startTime.getTime(),this._currentTime=this.startTime,this.infiniteInterval=this.startTime.getTime()==this.endTime.getTime(),this.period=n.parsePeriodString(i[2],!1)};return Object.defineProperties(n.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){this._currentTime=e}},scaleForCurrentTime:{get:function(){return this.currentTime?(this.currentTime.getTime()-this.startTime.getTime())/this.intervalMilliseconds:1}}}),n.prototype.next=function(){return this.currentTime?this.currentTime.getTime()>=this.endTime.getTime()&&!this.infiniteInterval?this.currentTime=null:this.currentTime=n.incrementTime(this.currentTime,this.period):this.currentTime=this.startTime,this.currentTime},n.prototype.previous=function(){return this.currentTime?this.currentTime.getTime()===this.startTime.getTime()?this.currentTime=null:this.currentTime=this.getTimeForScale(.9999*this.scaleForCurrentTime):this.currentTime=this.endTime,this.currentTime},n.prototype.reset=function(){this.currentTime=null},n.prototype.getTimeForScale=function(e){if(e<=0)return this.startTime;if(e>=1)return this.endTime;var i=new Date(this.startTime.getTime()),t=i,r=0;for(r=0;r<e;r=(i.getTime()-this.startTime.getTime())/this.intervalMilliseconds)t=i,i=n.incrementTime(i,this.period);return t},n.incrementTime=function(e,i){var t=new Date(e.getTime());return i[0]!=0&&t.setUTCFullYear(t.getUTCFullYear()+i[0]),i[1]!=0&&n.addMonths(t,i[1]),i[2]!=0&&t.setUTCDate(t.getUTCDate()+7*i[2]),i[3]!=0&&t.setUTCDate(t.getUTCDate()+i[3]),i[4]!=0&&t.setUTCHours(t.getUTCHours()+i[4]),i[5]!=0&&t.setUTCMinutes(t.getUTCMinutes()+i[5]),i[6]!=0&&t.setUTCSeconds(t.getUTCSeconds()+i[6]),t},n.isLeapYear=function(e){return e%4===0&&e%100!==0||e%400===0},n.getDaysInMonth=function(e,i){return[31,n.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][i]},n.addMonths=function(e,i){var t=e.getUTCDate();return e.setUTCDate(1),e.setUTCMonth(e.getUTCMonth()+i),e.setUTCDate(Math.min(t,n.getDaysInMonth(e.getUTCFullYear(),e.getUTCMonth()))),e},n.parsePeriodString=function(e,i){var t=i||!1,r=[2,3,4,5,7,8,9],s=[0,0,0,0,0,0,0],a=[0,12,4,7,24,60,60],f;if(e=e.toUpperCase().trim(),e){if(typeof e!="string")throw new p(l.logMessage(l.LEVEL_SEVERE,"PeriodicTimeSequence","parsePeriodString","Invalid ISO8601 period string '"+e+"'"))}else return s;if(f=/^P((\d+Y)?(\d+M)?(\d+W)?(\d+D)?)?(T(\d+H)?(\d+M)?(\d+S)?)?$/.exec(e))for(var o=0;o<r.length;o++){var c=r[o];s[o]=f[c]?+f[c].replace(/[A-Za-z]+/g,""):0}else throw new p(l.logMessage(l.LEVEL_SEVERE,"PeriodicTimeSequence","parsePeriodString","String '"+e+"' is not a valid ISO8601 period."));if(t)for(o=s.length-1;o>0;o--)s[o]>=a[o]&&(s[o-1]=s[o-1]+Math.floor(s[o]/a[o]),s[o]=s[o]%a[o]);return s},n}),B("util/LevelRowColumnUrlBuilder",["../error/ArgumentError","../util/Logger","../util/WWUtil"],function(p,l,n){"use strict";var e=function(i,t){this.serverAddress=i,(!i||i.length===0)&&(this.serverAddress=n.currentUrlSansFilePart()),this.pathToData=t};return e.prototype.urlForTile=function(i,t){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","missingTile"));if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsUrlBuilder","urlForTile","The image format is null or undefined."));var r=this.serverAddress;return this.pathToData&&(r=r+"/"+this.pathToData),r=r+"/"+i.level.levelNumber.toString(),r=r+"/"+i.row.toString(),r=r+"/"+i.row.toString()+"_"+i.column.toString(),r=r+"."+n.suffixForMimeType(t),r=r.replace(" ","%20"),r},e}),B("layer/RestTiledImageLayer",["../error/ArgumentError","../geom/Location","../util/Logger","../geom/Sector","../layer/TiledImageLayer","../util/LevelRowColumnUrlBuilder","../util/WWUtil"],function(p,l,n,e,i,t,r){"use strict";var s=function(a,f,o,c){var d=r.urlPath(a+"/"+f);i.call(this,c&&c.sector||e.FULL_SPHERE,c&&c.levelZeroTileDelta||new l(45,45),c&&c.numLevels||5,c&&c.imageFormat||"image/jpeg",d,c&&c.tileWidth||256,c&&c.tileHeight||256),this.displayName=o,this.pickEnabled=!1,this.urlBuilder=new t(a,f)};return s.prototype=Object.create(i.prototype),s}),B("layer/BMNGRestLayer",["../error/ArgumentError","../layer/Layer","../util/Logger","../util/PeriodicTimeSequence","../layer/RestTiledImageLayer"],function(p,l,n,e,i){"use strict";var t=function(r,s,a,f){l.call(this,a||"Blue Marble time series"),this.time=f||new Date("2004-01"),this.timeSequence=new e("2004-01-01/2004-12-01/P1M"),this.serverAddress=r,this.pathToData=s,this.layers={},this.layerNames=[{month:"BlueMarble-200401",time:t.availableTimes[0]},{month:"BlueMarble-200402",time:t.availableTimes[1]},{month:"BlueMarble-200403",time:t.availableTimes[2]},{month:"BlueMarble-200404",time:t.availableTimes[3]},{month:"BlueMarble-200405",time:t.availableTimes[4]},{month:"BlueMarble-200406",time:t.availableTimes[5]},{month:"BlueMarble-200407",time:t.availableTimes[6]},{month:"BlueMarble-200408",time:t.availableTimes[7]},{month:"BlueMarble-200409",time:t.availableTimes[8]},{month:"BlueMarble-200410",time:t.availableTimes[9]},{month:"BlueMarble-200411",time:t.availableTimes[10]},{month:"BlueMarble-200412",time:t.availableTimes[11]}],this.pickEnabled=!1};return t.prototype=Object.create(l.prototype),t.availableTimes=[new Date("2004-01"),new Date("2004-02"),new Date("2004-03"),new Date("2004-04"),new Date("2004-05"),new Date("2004-06"),new Date("2004-07"),new Date("2004-08"),new Date("2004-09"),new Date("2004-10"),new Date("2004-11"),new Date("2004-12")],t.prototype.prePopulate=function(r){if(!r)throw new p(n.logMessage(n.LEVEL_SEVERE,"BMNGRestLayer","prePopulate","missingWorldWindow"));for(var s=0;s<this.layerNames.length;s++){var a=this.layerNames[s].month;this.layers[a]||this.createSubLayer(a),this.layers[a].prePopulate(r)}},t.prototype.isPrePopulated=function(r){for(var s=0;s<this.layerNames.length;s++){var a=this.layers[this.layerNames[s].month];if(!a||!a.isPrePopulated(r))return!1}return!0},t.prototype.doRender=function(r){var s=this.nearestLayer(this.time);s.opacity=this.opacity,this.detailControl&&(s.detailControl=this.detailControl),s.doRender(r),this.inCurrentFrame=s.inCurrentFrame},t.prototype.nearestLayer=function(r){var s=this.nearestLayerName(r);return this.layers[s]||this.createSubLayer(s),this.layers[s]},t.prototype.createSubLayer=function(r){var s="";this.pathToData?s=this.pathToData+"/"+r:s=r,this.layers[r]=new i(this.serverAddress,s,this.displayName)},t.prototype.nearestLayerName=function(r){var s=r.getTime();if(s<=this.layerNames[0].time.getTime())return this.layerNames[0].month;if(s>=this.layerNames[11].time.getTime())return this.layerNames[11].month;for(var a=0;a<this.layerNames.length-1;a++){var f=this.layerNames[a].time.getTime(),o=this.layerNames[a+1].time.getTime();if(s>=f&&s<=o){var c=s-f,d=o-s;return c<d?this.layerNames[a].month:this.layerNames[a+1].month}}},t}),B("formats/collada/ColladaAsset",[],function(){"use strict";var p=function(l){this.xmlAsset=l.getElementsByTagName("asset")[0],this.asset={daeVersion:l.querySelector("COLLADA").getAttribute("version")}};return p.prototype.parse=function(){if(!this.xmlAsset)return null;for(var l=0;l<this.xmlAsset.childNodes.length;l++){var n=this.xmlAsset.childNodes.item(l);if(n.nodeType===1)switch(n.nodeName){case"contributor":var e=n.querySelector("authoring_tool");e&&(this.asset.authoring_tool=e.textContext);break;case"unit":this.asset.unit=n.getAttribute("meter");break;default:this.asset[n.localName]=n.textContent;break}}return this.xmlAsset=null,this.asset},p}),B("formats/collada/ColladaUtils",["../../util/Logger"],function(p){"use strict";var l={getRawValues:function(n){if(!n)return null;var e=n.textContent;return e=e.replace(/\n/gi," "),e=e.replace(/\s+/gi," "),e=e.trim(),e.length===0?null:e.split(" ")},bufferDataFloat32:function(n){var e=this.getRawValues(n);if(!e)return null;for(var i=e.length,t=new Float32Array(i),r=0;r<i;r++)t[r]=parseFloat(e[r]);return t},bufferDataUInt32:function(n){var e=this.getRawValues(n);if(!e)return null;for(var i=e.length,t=new Uint32Array(i),r=0;r<i;r++)t[r]=parseInt(e[r]);return t},getFirstChildElement:function(n,e){for(var i=n.childNodes,t=0;t<i.length;++t){var r=i.item(t);if(r.nodeType===1&&(r.nodeName&&!e||e&&e===r.nodeName))return r}return null},getFilename:function(n){var e=n.lastIndexOf("\\");return e!==-1&&(n=n.substr(e+1)),e=n.lastIndexOf("/"),e!==-1&&(n=n.substr(e+1)),n},replaceSpace:function(n){return n?n.replace(/ /g,"_"):""},querySelectorById:function(n,e){for(var i=0;i<n.length;i++){var t=n.item(i).getAttribute("id");if(t&&t.toString()===e)return n.item(i)}return null},getTextureType:function(n){for(var e=!0,i=0,t=n.length;i<t;i++)if(n[i]<0||n[i]>1){e=!1;break}return e},fetchFile:function(n,e){var i=new XMLHttpRequest;i.onload=function(){this.status>=200&&this.status<400?e(this.response):(p.log(p.LEVEL_SEVERE,"sever error: "+this.status),e(null))},i.onerror=function(t){p.log(p.LEVEL_SEVERE,"connection error: "+t),e(null)},i.open("get",n,!0),i.send()}};return l}),B("formats/collada/ColladaImage",["./ColladaUtils"],function(p){"use strict";var l=function(n,e){this.filename="",this.map=n,this.name=e,this.path=""};return l.prototype.parse=function(n){for(var e=0;e<n.childNodes.length;e++){var i=n.childNodes[e];if(i.nodeType===1)switch(i.nodeName){case"init_from":this.filename=p.getFilename(i.textContent),this.path=i.textContent;break;default:break}}return this},l}),B("formats/collada/ColladaMaterial",["./ColladaUtils"],function(p){"use strict";var l=function(n){this.id=n,this.newParams=[]};return l.prototype.parse=function(n){for(var e=0;e<n.childNodes.length;e++){var i=n.childNodes[e];if(i.nodeType===1)switch(i.nodeName){case"profile_COMMON":this.parseProfileCommon(i);break;default:break}}return this},l.prototype.parseProfileCommon=function(n){for(var e=0;e<n.childNodes.length;e++){var i=n.childNodes[e];if(i.nodeType===1)switch(i.nodeName){case"newparam":this.parseNewparam(i);break;case"image":break;case"technique":this.parseTechnique(i);break;default:break}}},l.prototype.parseNewparam=function(n){for(var e=n.getAttribute("sid"),i=0;i<n.childNodes.length;i++){var t=n.childNodes[i];if(t.nodeType===1)switch(t.nodeName){case"surface":var r=t.querySelector("init_from");r&&this.newParams.push({sid:e,type:"surface",initFrom:r.textContent});break;case"sampler2D":var s=t.querySelector("source");this.newParams.push({sid:e,type:"sampler2D",source:s.textContent});break;case"extra":break;default:break}}},l.prototype.parseTechnique=function(n){for(var e=0;e<n.childNodes.length;e++){var i=n.childNodes[e];if(i.nodeType===1)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.techniqueType=i.nodeName,this.parseTechniqueType(i);break;case"extra":break;default:break}}},l.prototype.parseTechniqueType=function(n){for(var e=0;e<n.childNodes.length;e++){var i=n.childNodes[e];if(!(i.nodeType!==1||!i.nodeName)){var t=i.nodeName,r=p.getFirstChildElement(i);if(r)switch(r.nodeName){case"color":this[t]=p.bufferDataFloat32(r).subarray(0,4);break;case"float":this[t]=p.bufferDataFloat32(r)[0];break;case"texture":var s=r.getAttribute("texture"),a=this.newParams.map(function(c){return c.sid}).indexOf(s),f=this.newParams[a].source;a=this.newParams.map(function(c){return c.sid}).indexOf(f);var o=this.newParams[a].initFrom;this.textures||(this.textures={}),this.textures[t]={mapId:o};break;default:break}}}},l}),B("formats/collada/ColladaMesh",["./ColladaUtils"],function(p){"use strict";var l=function(n){this.filename=n||"",this.name=n||"",this.buffers=[]};return l.prototype.parse=function(n){for(var e={},i={},t={id:"",inputs:[]},r=0;r<n.childNodes.length;r++){var s=n.childNodes[r];if(s.nodeType===1)switch(s.nodeName){case"source":if(!s.querySelector)continue;var a=s.querySelector("float_array");if(!a)continue;var f=p.bufferDataFloat32(a),o=s.querySelector("accessor"),c=parseInt(o.getAttribute("stride"));e[s.getAttribute("id")]={stride:c,data:f};break;case"vertices":this.parseVertices(s,t);break;case"triangles":i=this.parsePolygons(s,e,t,3),this.buffers.push(i);break;case"polygons":i=this.parsePolygons(s,e,t,4),this.buffers.push(i);break;case"polylist":i=this.parsePolygons(s,e,t,null),this.buffers.push(i);break;default:break}}return this},l.prototype.parseVertices=function(n,e){e.id=n.getAttribute("id");for(var i=n.querySelectorAll("input"),t=0;t<i.length;t++){var r=i[t],s=r.getAttribute("source").substr(1),a=r.getAttribute("semantic").toUpperCase();e.inputs.push({semantic:a,source:s})}},l.prototype.parsePolygons=function(n,e,i,t){var r=[];if(t==null){var s=n.querySelector("vcount");r=s.textContent.trim().split(" ")}var a=parseInt(n.getAttribute("count")),f=n.getAttribute("material"),o=this.parseInputs(n,e,i),c=o.inputs,d=o.maxOffset,h=n.querySelector("p"),u=[];h&&(u=h.textContent.trim().split(" "));for(var m=c.length,g=0,_={},y=[],v=0,b=!1,R=!1,M=0;M<a;M++){if(r.length)var P=parseInt(r[M]);else P=t;for(var T=-1,E=-1,x=-1,S=0;S<P;S++){var L=u.slice(v,v+d).join(" ");if(x=E,_.hasOwnProperty(L))E=_[L],b=!0;else{for(var C=0;C<m;C++){var F=c[C],q=F[4],it=parseInt(u[v+q]),st=F[1],pt=F[3];it*=F[2];for(var _t=0;_t<F[2];_t++)st.push(pt[it+_t])}E=g,g+=1,_[L]=E}P>3&&(S===0&&(T=E),S>2*d&&((T>65535||x>65535)&&(R=!0),y.push(T),y.push(x))),E>65535&&(R=!0),y.push(E),v+=d}}var X={vertices:new Float32Array(c[0][1]),indexedRendering:b,material:f};return X.indexedRendering&&(X.indices=R?new Uint32Array(y):new Uint16Array(y)),this.transformMeshInfo(X,c),X},l.prototype.parseInputs=function(n,e,i){for(var t=[],r=0,s=n.querySelectorAll("input"),a=0;a<s.length;a++){var f=s.item(a);if(f.getAttribute){var o=f.getAttribute("semantic").toUpperCase(),c=f.getAttribute("source").substr(1),d=parseInt(f.getAttribute("offset"));r=r<d+1?d+1:r;var h=0;if(f.getAttribute("set")&&(h=parseInt(f.getAttribute("set"))),i.id===c)for(var u=i.inputs,m=0;m<u.length;m++){var g=e[u[m].source];g&&t.push([u[m].semantic,[],g.stride,g.data,d,h])}else g=e[c],t.push([o,[],g.stride,g.data,d,h])}}return{inputs:t,maxOffset:r}},l.prototype.transformMeshInfo=function(n,e){for(var i={normal:"normals",texcoord:"uvs"},t=1;t<e.length;t++){var r=e[t][0].toLowerCase(),s=e[t][1];s.length&&(i[r]&&(r=i[r]),n[r]&&(r=r+e[t][5]),n[r]=new Float32Array(s),r==="uvs"&&(n.isClamp=p.getTextureType(s)))}return n},l}),B("formats/collada/ColladaNode",["./ColladaUtils","../../geom/Matrix","../../geom/Vec3"],function(p,l,n){"use strict";var e=function(){this.id="",this.name="",this.sid="",this.children=[],this.materials=[],this.mesh="",this.localMatrix=l.fromIdentity(),this.worldMatrix=l.fromIdentity()};return e.prototype.parse=function(i,t,r){this.id=i.getAttribute("id"),this.sid=i.getAttribute("sid"),this.name=i.getAttribute("name"),this.children=[],this.materials=[],this.mesh="",this.localMatrix=l.fromIdentity(),this.worldMatrix=l.fromIdentity(),this.setNodeTransforms(i,r);for(var s=0;s<i.childNodes.length;s++){var a=i.childNodes[s];if(a.nodeType===1)switch(a.nodeName){case"node":this.children.push(new e().parse(a,t,this.worldMatrix));break;case"instance_geometry":this.mesh=a.getAttribute("url").substr(1);for(var f=a.querySelectorAll("instance_material"),o=0;o<f.length;o++){var c=f.item(o);this.materials.push({id:c.getAttribute("target").substr(1),symbol:c.getAttribute("symbol")})}break;case"instance_node":var d=a.getAttribute("url").substr(1),h=this.getLibraryNode(t,d);h&&this.children.push(new e().parse(h,t,this.worldMatrix));break;default:break}}return this},e.prototype.setNodeTransforms=function(i,t){var r=l.fromIdentity(),s=l.fromIdentity(),a=l.fromIdentity(),f=l.fromIdentity();t||(t=l.fromIdentity());for(var o=[],c=0;c<i.childNodes.length;c++){var d=i.childNodes[c];if(d.nodeType===1)switch(d.nodeName){case"matrix":var h=p.bufferDataFloat32(d);r.copy(h),o.push(r);break;case"rotate":h=p.bufferDataFloat32(d),s.multiplyByRotation(h[0],h[1],h[2],h[3]),o.push(s);break;case"translate":h=p.bufferDataFloat32(d),a.multiplyByTranslation(h[0],h[1],h[2]),o.push(a);break;case"scale":h=p.bufferDataFloat32(d),f.multiplyByScale(h[0],h[1],h[2]),o.push(f);break;default:break}}for(c=0;c<o.length;c++)this.localMatrix.multiplyMatrix(o[c]);this.worldMatrix.setToMultiply(t,this.localMatrix),this.normalMatrix=l.fromIdentity();var u=new n(0,0,0);this.worldMatrix.extractRotationAngles(u),this.normalMatrix.multiplyByRotation(-1,0,0,u[0]),this.normalMatrix.multiplyByRotation(0,-1,0,u[1]),this.normalMatrix.multiplyByRotation(0,0,-1,u[2])},e.prototype.getLibraryNode=function(i,t){for(var r=0;r<i.length;r++){var s=i[r].attributes.getNamedItem("id");if(s&&s.value===t)return i[r]}return null},e}),B("formats/collada/ColladaScene",["../../error/ArgumentError","../../shaders/BasicTextureProgram","../../util/Color","../../util/Logger","../../geom/Matrix","../../geom/Position","../../pick/PickedObject","../../render/Renderable","../../geom/Vec3"],function(p,l,n,e,i,t,r,s,a){"use strict";var f=function(o,c){if(!o)throw new p(e.logMessage(e.LEVEL_SEVERE,"ColladaScene","constructor","missingPosition"));s.call(this),this._position=o,this._nodes=[],this._meshes={},this._materials={},this._images={},this._upAxis="",this._dirPath="",this._xRotation=0,this._yRotation=0,this._zRotation=0,this._xTranslation=0,this._yTranslation=0,this._zTranslation=0,this._scale=1,this._altitudeMode=WorldWind.ABSOLUTE,this._localTransforms=!0,this._useTexturePaths=!0,this._nodesToHide=[],this._hideNodes=!1,this._placePoint=new a(0,0,0),this._transformationMatrix=i.fromIdentity(),this._mvpMatrix=i.fromIdentity(),this._normalTransformMatrix=i.fromIdentity(),this._normalMatrix=i.fromIdentity(),this._texCoordMatrix=i.fromIdentity().setToUnitYFlip(),this._entities=[],this._activeTexture=null,this._tmpVector=new a(0,0,0),this._tmpColor=new n(1,1,1,1),this._vboCacheKey="",this._iboCacheKey="",this.setSceneData(c)};return f.prototype=Object.create(s.prototype),f.prototype.constructor=f,Object.defineProperties(f.prototype,{position:{get:function(){return this._position},set:function(o){this._position=o}},nodes:{get:function(){return this._nodes},set:function(o){this._nodes=o}},meshes:{get:function(){return this._meshes},set:function(o){this._meshes=o}},materials:{get:function(){return this._materials},set:function(o){this._materials=o}},images:{get:function(){return this._images},set:function(o){this._images=o}},upAxis:{get:function(){return this._upAxis},set:function(o){this._upAxis=o}},dirPath:{get:function(){return this._dirPath},set:function(o){this._dirPath=o}},xRotation:{get:function(){return this._xRotation},set:function(o){this._xRotation=o}},yRotation:{get:function(){return this._yRotation},set:function(o){this._yRotation=o}},zRotation:{get:function(){return this._zRotation},set:function(o){this._zRotation=o}},xTranslation:{get:function(){return this._xTranslation},set:function(o){this._xTranslation=o}},yTranslation:{get:function(){return this._yTranslation},set:function(o){this._yTranslation=o}},zTranslation:{get:function(){return this._zTranslation},set:function(o){this._zTranslation=o}},scale:{get:function(){return this._scale},set:function(o){this._scale=o}},placePoint:{get:function(){return this._placePoint},set:function(o){this._placePoint=o}},altitudeMode:{get:function(){return this._altitudeMode},set:function(o){this._altitudeMode=o}},transformationMatrix:{get:function(){return this._transformationMatrix},set:function(o){this._transformationMatrix=o}},normalMatrix:{get:function(){return this._normalMatrix},set:function(o){this._normalMatrix=o}},localTransforms:{get:function(){return this._localTransforms},set:function(o){this._localTransforms=o}},useTexturePaths:{get:function(){return this._useTexturePaths},set:function(o){this._useTexturePaths=o}},nodesToHide:{get:function(){return this._nodesToHide},set:function(o){this._nodesToHide=o}},hideNodes:{get:function(){return this._hideNodes},set:function(o){this._hideNodes=o}}}),f.prototype.setSceneData=function(o){o&&(this._nodes=o.root.children,this._meshes=o.meshes,this._materials=o.materials,this._images=o.images,this._upAxis=o.metadata.up_axis,this._dirPath=o.dirPath,this.flattenModel())},f.prototype.flattenModel=function(){for(var o=0,c=this._nodes.length;o<c;o++)this.flattenNode(this._nodes[o]);this._entities.sort(function(d,h){var u=d.imageKey===null?"":""+d,m=h.imageKey===null?"":""+h;return u>m?1:u===m?0:-1})},f.prototype.flattenNode=function(o){if(o.mesh)for(var c=o.mesh,d=this._meshes[c].buffers,h=0,u=d.length;h<u;h++){for(var m=d[h].material,g=0;g<o.materials.length;g++)if(m===o.materials[g].symbol){var _=o.materials[g].id;break}var y=this._materials[_],v=null,b=y&&y.textures&&d[h].uvs&&d[h].uvs.length>0;b&&(y.textures.diffuse?v=y.textures.diffuse.mapId:y.textures.reflective&&(v=y.textures.reflective.mapId)),this._entities.push({mesh:d[h],material:y,node:o,imageKey:v})}for(var R=0;R<o.children.length;R++)this.flattenNode(o.children[R])},f.prototype.render=function(o){var c,d=o.frustumInModelCoordinates;this.enabled&&(this.lastFrameTime!==o.timestamp&&(c=this.makeOrderedRenderable(o)),c&&d.containsPoint(this._placePoint)&&(c.layer=o.currentLayer,this.lastFrameTime=o.timestamp,o.addOrderedRenderable(c)))},f.prototype.makeOrderedRenderable=function(o){return o.surfacePointForMode(this._position.latitude,this._position.longitude,this._position.altitude,this._altitudeMode,this._placePoint),this.eyeDistance=o.eyePoint.distanceTo(this._placePoint),this},f.prototype.renderOrdered=function(o){if(this.drawOrderedScene(o),o.pickingMode){var c=new r(this.pickColor.clone(),this,this._position,this.layer,!1);o.resolvePick(c)}},f.prototype.drawOrderedScene=function(o){try{this.beginDrawing(o)}finally{this.endDrawing(o)}},f.prototype.beginDrawing=function(o){var c=o.currentGlContext,d=o.gpuResourceCache,h=d.resourceForKey(this._vboCacheKey),u=d.resourceForKey(this._iboCacheKey);h||(this.setupBuffers(o),h=d.resourceForKey(this._vboCacheKey),u=d.resourceForKey(this._iboCacheKey)),c.bindBuffer(c.ARRAY_BUFFER,h),u&&c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,u),o.findAndBindProgram(l),c.enableVertexAttribArray(0),o.pickingMode&&(this.pickColor=o.uniquePickColor()),this.computeTransformationMatrix(o.globe);for(var m=0,g=this._entities.length;m<g;m++){var _=this.mustRenderNode(this._entities[m].node.id);_&&this.draw(o,this._entities[m])}},f.prototype.setupBuffers=function(o){for(var c=o.currentGlContext,d=Float32Array.BYTES_PER_ELEMENT||4,h=Uint16Array.BYTES_PER_ELEMENT||2,u=Uint32Array.BYTES_PER_ELEMENT||4,m=!1,g=0,_=0,y=0,v=this._entities.length;y<v;y++){var b=this._entities[y].mesh;b.indexedRendering&&(g+=b.indices.length,b.indices instanceof Uint32Array&&(m=!0)),_+=b.vertices.length,this._entities[y].imageKey&&(_+=b.uvs.length),b.normals&&b.normals.length&&(_+=b.normals.length)}var R=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,R),c.bufferData(c.ARRAY_BUFFER,_*d,c.STATIC_DRAW);var M=0;for(y=0,v=this._entities.length;y<v;y++){var P=this._entities[y].mesh.vertices;this._entities[y].vertexOffset=M,c.bufferSubData(c.ARRAY_BUFFER,M*d,P),M+=P.length}for(y=0,v=this._entities.length;y<v;y++)this._entities[y].imageKey&&(P=this._entities[y].mesh.uvs,this._entities[y].uvOffset=M,c.bufferSubData(c.ARRAY_BUFFER,M*d,P),M+=P.length);for(y=0,v=this._entities.length;y<v;y++)P=P=this._entities[y].mesh.normals,P&&P.length&&(this._entities[y].normalOffset=M,c.bufferSubData(c.ARRAY_BUFFER,M*d,P),M+=P.length);var T=h,E=g*T,x;if(m&&(x=o.getExtension("OES_element_index_uint"),x?(T=u,E=g*T):e.log(e.LEVEL_SEVERE,'The 3D model is too big and might not render properly. \nYour browser does not support the "OES_element_index_uint" extension, required to render large models.')),g){var S=c.createBuffer();for(c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,S),c.bufferData(c.ELEMENT_ARRAY_BUFFER,E,c.STATIC_DRAW),M=0,y=0,v=this._entities.length;y<v;y++)b=this._entities[y].mesh,b.indexedRendering&&(P=b.indices,P instanceof Uint32Array&&!x&&(P=new Uint16Array(P)),this._entities[y].indexOffset=M,this._entities[y].indexSize=T,c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,M*T,P),M+=P.length)}this._vboCacheKey=o.gpuResourceCache.generateCacheKey(),o.gpuResourceCache.putResource(this._vboCacheKey,R,_*d),g&&(this._iboCacheKey=o.gpuResourceCache.generateCacheKey(),o.gpuResourceCache.putResource(this._iboCacheKey,S,E))},f.prototype.draw=function(o,c){var d=o.currentGlContext,h=o.currentProgram,u=o.gpuResourceCache,m=c.mesh,g=c.material,_=c.node.worldMatrix,y=c.node.normalMatrix,v=m.normals&&m.normals.length,b=c.imageKey;if(this.applyColor(o,g),b){var R=this._useTexturePaths?this._images[b].path:this._images[b].filename,M=this._dirPath+R;if(this._activeTexture=u.resourceForKey(M),!this._activeTexture){var P=m.isClamp?d.CLAMP_TO_EDGE:d.REPEAT;this._activeTexture=u.retrieveTexture(d,M,P)}var T=this._activeTexture&&this._activeTexture.bind(o);T?(h.loadTextureEnabled(d,!0),d.vertexAttribPointer(2,2,d.FLOAT,!1,8,c.uvOffset*4),d.enableVertexAttribArray(2),h.loadModulateColor(d,o.pickingMode)):(h.loadTextureEnabled(d,!1),d.disableVertexAttribArray(2))}else h.loadTextureEnabled(d,!1),d.disableVertexAttribArray(2);if(v&&!o.pickingMode?(h.loadApplyLighting(d,1),d.vertexAttribPointer(1,3,d.FLOAT,!1,12,c.normalOffset*4),d.enableVertexAttribArray(1)):(h.loadApplyLighting(d,0),d.disableVertexAttribArray(1)),this.applyMatrix(o,v,M,_,y),d.vertexAttribPointer(0,3,d.FLOAT,!1,12,c.vertexOffset*4),m.indexedRendering){var E=c.indexOffset*c.indexSize;m.indices instanceof Uint32Array&&o.getExtension("OES_element_index_uint")?d.drawElements(d.TRIANGLES,m.indices.length,d.UNSIGNED_INT,E):d.drawElements(d.TRIANGLES,m.indices.length,d.UNSIGNED_SHORT,E)}else d.drawArrays(d.TRIANGLES,0,Math.floor(m.vertices.length/3))},f.prototype.applyColor=function(o,c){var d=o.currentGlContext,h=o.currentProgram;if(c)if(c.techniqueType==="constant")var u=c.reflective;else u=c.diffuse;var m,g=1,_=1,y=1,v=1;u&&(g=u[0],_=u[1],y=u[2],v=u[3]!=null?u[3]:1),this._tmpColor.set(g,_,y,v),m=v*this.layer.opacity,d.depthMask(m>=1||o.pickingMode),h.loadColor(d,o.pickingMode?this.pickColor:this._tmpColor),h.loadOpacity(d,o.pickingMode?m>0?1:0:m)},f.prototype.applyMatrix=function(o,c,d,h,u){this._mvpMatrix.copy(o.modelviewProjection),this._mvpMatrix.multiplyMatrix(this._transformationMatrix),h&&this._localTransforms&&this._mvpMatrix.multiplyMatrix(h),c&&!o.pickingMode&&(this._normalMatrix.copy(o.modelviewNormalTransform),this._normalMatrix.multiplyMatrix(this._normalTransformMatrix),u&&this._localTransforms&&this._normalMatrix.multiplyMatrix(u),o.currentProgram.loadModelviewInverse(o.currentGlContext,this._normalMatrix)),d&&this._activeTexture&&(o.currentProgram.loadTextureMatrix(o.currentGlContext,this._texCoordMatrix),this._activeTexture=null),o.currentProgram.loadModelviewProjection(o.currentGlContext,this._mvpMatrix)},f.prototype.endDrawing=function(o){var c=o.currentGlContext,d=o.currentProgram;c.disableVertexAttribArray(1),c.disableVertexAttribArray(2),d.loadApplyLighting(c,0),d.loadTextureEnabled(c,!1)},f.prototype.computeTransformationMatrix=function(o){this._transformationMatrix.setToIdentity(),this._transformationMatrix.multiplyByLocalCoordinateTransform(this._placePoint,o),this._transformationMatrix.multiplyByRotation(1,0,0,this._xRotation),this._transformationMatrix.multiplyByRotation(0,1,0,this._yRotation),this._transformationMatrix.multiplyByRotation(0,0,1,this._zRotation),this._transformationMatrix.multiplyByScale(this._scale,this._scale,this._scale),this._transformationMatrix.multiplyByTranslation(this._xTranslation,this._yTranslation,this._zTranslation),this.computeNormalMatrix()},f.prototype.computeNormalMatrix=function(){this._transformationMatrix.extractRotationAngles(this._tmpVector),this._normalTransformMatrix.setToIdentity(),this._normalTransformMatrix.multiplyByRotation(-1,0,0,this._tmpVector[0]),this._normalTransformMatrix.multiplyByRotation(0,-1,0,this._tmpVector[1]),this._normalTransformMatrix.multiplyByRotation(0,0,-1,this._tmpVector[2])},f.prototype.mustRenderNode=function(o){var c=!0;if(this._hideNodes){var d=this._nodesToHide.indexOf(o);c=d===-1}return c},f}),B("formats/collada/ColladaLoader",["../../error/ArgumentError","./ColladaAsset","./ColladaImage","./ColladaMaterial","./ColladaMesh","./ColladaNode","./ColladaScene","./ColladaUtils","../../util/Logger"],function(p,l,n,e,i,t,r,s,a){"use strict";var f=function(o,c){if(!o)throw new p(a.logMessage(a.LEVEL_SEVERE,"ColladaLoader","constructor","missingPosition"));this.position=o,this.dirPath="/",this.init(c)};return f.prototype.init=function(o){o&&(this.dirPath=o.dirPath||"/"),this.scene={type:"SceneTree",dirPath:this.dirPath,images:{},metadata:{},materials:{},meshes:{},root:{children:[]}},this.xmlDoc=null},f.prototype.load=function(o,c){o.indexOf("://")===-1&&(o=this.dirPath+o),s.fetchFile(o,(function(d){if(d)try{h=this.parse(d)}catch(u){h=null,a.log(a.LEVEL_SEVERE,"error parsing collada file: "+u)}else var h=null;c(h)}).bind(this))},f.prototype.parse=function(o){this.init();var c=new DOMParser;this.xmlDoc=c.parseFromString(o,"text/xml");var d=this.xmlDoc.querySelectorAll("library_nodes node"),h=this.xmlDoc.querySelectorAll("library_effects effect");return this.scene.metadata=new l(this.xmlDoc).parse(),this.parseLib("visual_scene",d),this.parseLib("library_geometries"),this.parseLib("library_materials",h),this.parseLib("library_images"),this.xmlDoc=null,new r(this.position,this.scene)},f.prototype.parseLib=function(o,c){var d=this.xmlDoc.getElementsByTagName(o),h=[];d&&d.length&&(h=d[0].childNodes);for(var u=0;u<h.length;u++){var m=h[u];if(m.nodeType===1)switch(m.nodeName){case"node":var g=new t().parse(m,c);g&&this.scene.root.children.push(g);break;case"geometry":var _=m.getAttribute("id"),y=m.querySelector("mesh"),v=new i(_).parse(y);v&&(this.scene.meshes[_]=v);break;case"material":var b=m.getAttribute("id"),R=m.querySelector("instance_effect"),M=R.getAttribute("url").substr(1),P=s.querySelectorById(c,M),T=new e(b).parse(P);T&&(this.scene.materials[b]=T);break;case"image":var E=m.getAttribute("id"),x=m.getAttribute("name"),S=new n(E,x).parse(m);S&&(this.scene.images[E]=S);break;default:break}}},f}),B("shapes/Compass",["../error/ArgumentError","../util/Logger","../util/Offset","../shapes/ScreenImage"],function(p,l,n,e){"use strict";var i=function(t,r){var s=t||new n(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,1),a=r||WorldWind.configuration.baseUrl+"images/notched-compass.png";e.call(this,s,a),t||(this.imageOffset=new n(WorldWind.OFFSET_FRACTION,1.1,WorldWind.OFFSET_FRACTION,1.1)),this.size=.15};return i.prototype=Object.create(e.prototype),i.prototype.render=function(t){this.imageRotation=t.navigator.heading,this.imageTilt=t.navigator.tilt;var r=this.getActiveTexture(t);r&&(this.imageScale=this.size*t.currentGlContext.drawingBufferWidth/r.imageWidth),e.prototype.render.call(this,t)},i}),B("layer/CompassLayer",["../shapes/Compass","../layer/RenderableLayer"],function(p,l){"use strict";var n=function(){l.call(this,"Compass"),this._compass=new p(null,null),this.addRenderable(this._compass)};return n.prototype=Object.create(l.prototype),Object.defineProperties(n.prototype,{compass:{get:function(){return this._compass},set:function(e){e&&e instanceof p&&(this.removeAllRenderables(),this.addRenderable(e),this._compass=e)}}}),n}),B("shapes/Text",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Logger","../geom/Matrix","../pick/PickedObject","../render/Renderable","../shapes/TextAttributes","../error/UnsupportedOperationError","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o,c,d){"use strict";var h=function(u){if(!u)throw new p(i.logMessage(i.LEVEL_SEVERE,"Text","constructor","missingText"));s.call(this),this.attributes=new a(null),this.highlightAttributes=null,this.highlighted=!1,this.enabled=!0,this.text=u,this.altitudeMode=WorldWind.ABSOLUTE,this.pickDelegate=null,this.alwaysOnTop=!1,this.targetVisibility=1,this.currentVisibility=1,this.declutterGroup=0,this.markerImageSource=WorldWind.configuration.baseUrl+"images/white-dot.png",this.markerImageScale=.1,this.activeAttributes=null,this.activeTexture=null,this.imageTransform=t.fromIdentity(),this.imageBounds=null,this.layer=null,this.depthOffset=-.003,this.screenPoint=new c(0,0,0)};return h.matrix=t.fromIdentity(),h.glPickPoint=new c(0,0,0),h.prototype=Object.create(s.prototype),h.prototype.copy=function(u){return this.text=u.text,this.attributes=u.attributes,this.highlightAttributes=u.highlightAttributes,this.highlighted=u.highlighted,this.enabled=u.enabled,this.altitudeMode=u.altitudeMode,this.pickDelegate=u.pickDelegate,this.alwaysOnTop=u.alwaysOnTop,this.depthOffset=u.depthOffset,this.declutterGroup=u.declutterGroup,this.targetVisibility=u.targetVisibility,this.currentVisibility=u.currentVisibility,this},Object.defineProperties(h.prototype,{screenBounds:{get:function(){return this.imageBounds}}}),h.prototype.render=function(u){if(!(!this.enabled||!this.text||this.text.length===0)&&u.accumulateOrderedRenderables){var m;if(this.lastFrameTime!==u.timestamp)m=this.makeOrderedRenderable(u);else{var g=this.clone();m=g.makeOrderedRenderable(u)}m&&m.isVisible(u)&&(m.layer=u.currentLayer,this.lastFrameTime=u.timestamp,u.addOrderedRenderable(m))}},h.prototype.renderOrdered=function(u){if(!(this.currentVisibility===0&&this.targetVisibility===0&&!this.markerImageSource)&&(this.drawOrderedText(u),u.pickingMode)){var m=new r(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,this.position,this.layer,!1);u.resolvePick(m)}},h.prototype.makeOrderedRenderable=function(u){var m,g,_,y;return this.determineActiveAttributes(u),!this.activeAttributes||!this.computeScreenPointAndEyeDistance(u)?null:(this.activeTexture=u.createTextTexture(this.text,this.activeAttributes),m=this.activeTexture.imageWidth,g=this.activeTexture.imageHeight,_=this.activeAttributes.scale,y=this.activeAttributes.offset.offsetForSize(m,g),this.imageTransform.setTranslation(this.screenPoint[0]-y[0]*_,this.screenPoint[1]-y[1]*_,this.screenPoint[2]),this.imageTransform.setScale(m*_,g*_,1),this.imageBounds=d.boundingRectForUnitQuad(this.imageTransform),this)},h.prototype.computeScreenPointAndEyeDistance=function(u){throw new f(i.logMessage(i.LEVEL_SEVERE,"Renderable","render","abstractInvocation"))},h.prototype.determineActiveAttributes=function(u){this.highlighted&&this.highlightAttributes?this.activeAttributes=this.highlightAttributes:this.activeAttributes=this.attributes},h.prototype.isVisible=function(u){return u.pickingMode?u.pickRectangle&&this.imageBounds.intersects(u.pickRectangle):this.imageBounds.intersects(u.viewport)},h.prototype.drawOrderedText=function(u){this.beginDrawing(u);try{this.doDrawOrderedText(u),u.pickingMode}finally{this.endDrawing(u)}},h.prototype.drawBatchOrderedText=function(u){for(var m;(m=u.peekOrderedRenderable())&&m instanceof h;){u.popOrderedRenderable();try{m.doDrawOrderedText(u)}catch(g){i.logMessage(i.LEVEL_WARNING,"Text","drawBatchOrderedText","Error occurred while rendering text using batching: "+g.message)}}},h.prototype.beginDrawing=function(u){var m=u.currentGlContext,g;u.findAndBindProgram(l),g=u.currentProgram,m.bindBuffer(m.ARRAY_BUFFER,u.unitQuadBuffer3()),m.vertexAttribPointer(g.vertexPointLocation,3,m.FLOAT,!1,0,0),m.bindBuffer(m.ARRAY_BUFFER,u.unitQuadBuffer()),m.vertexAttribPointer(g.vertexTexCoordLocation,2,m.FLOAT,!1,0,0),m.enableVertexAttribArray(g.vertexPointLocation),m.enableVertexAttribArray(g.vertexTexCoordLocation),g.loadTextureUnit(m,m.TEXTURE0),g.loadModulateColor(m,!1),m.depthMask(!1)},h.prototype.endDrawing=function(u){var m=u.currentGlContext,g=u.currentProgram;m.disableVertexAttribArray(g.vertexPointLocation),m.disableVertexAttribArray(g.vertexTexCoordLocation),m.bindBuffer(m.ARRAY_BUFFER,null),m.bindTexture(m.TEXTURE_2D,null),m.depthMask(!0)},h.prototype.doDrawOrderedText=function(u){var m=u.currentGlContext,g=u.currentProgram;if(!u.pickingMode&&this.currentVisibility!==this.targetVisibility){var _=(u.timestamp-u.previousRedrawTimestamp)/u.fadeTime;this.currentVisibility<this.targetVisibility?this.currentVisibility=Math.min(1,this.currentVisibility+_):this.currentVisibility=Math.max(0,this.currentVisibility-_),u.redrawRequested=!0}this.activeAttributes.depthTest||m.disable(m.DEPTH_TEST),u.pickingMode?(this.pickColor=u.uniquePickColor(),g.loadColor(m,this.pickColor),g.loadOpacity(m,1),g.loadTextureEnabled(m,!1)):(g.loadColor(m,n.WHITE),g.loadOpacity(m,this.layer.opacity*this.currentVisibility)),this.currentVisibility>0&&this.drawLabel(u),this.currentVisibility<1&&this.markerImageSource&&this.drawMarker(u),this.activeAttributes.depthTest||m.enable(m.DEPTH_TEST)},h.prototype.drawLabel=function(u){var m=u.currentGlContext,g=u.currentProgram,_;!u.pickingMode&&this.activeTexture&&(h.matrix.setToIdentity(),h.matrix.multiplyByTextureTransform(this.activeTexture),_=this.activeTexture.bind(u),g.loadTextureEnabled(m,_),g.loadTextureMatrix(m,h.matrix)),h.matrix.copy(u.screenProjection),h.matrix.multiplyMatrix(this.imageTransform),g.loadModelviewProjection(m,h.matrix),m.drawArrays(m.TRIANGLE_STRIP,0,4)},h.prototype.drawMarker=function(u){var m=u.currentGlContext,g=u.currentProgram,_,y=u.gpuResourceCache.resourceForKey(this.markerImageSource);if(!y){u.gpuResourceCache.retrieveTexture(u.currentGlContext,this.markerImageSource);return}u.pickingMode||(h.matrix.setToIdentity(),h.matrix.multiplyByTextureTransform(y),_=y.bind(u),g.loadTextureEnabled(m,_),g.loadTextureMatrix(m,h.matrix),g.loadOpacity(m,this.layer.opacity*(1-this.currentVisibility)));var v=this.markerImageScale;h.matrix.copy(u.screenProjection),h.matrix.multiplyByTranslation(this.screenPoint[0]-v*y.imageWidth/2,this.screenPoint[1]-v*y.imageWidth/2,this.screenPoint[2]),h.matrix.multiplyByScale(y.imageWidth*v,y.imageHeight*v,1),g.loadModelviewProjection(m,h.matrix),m.drawArrays(m.TRIANGLE_STRIP,0,4)},h}),B("shapes/ScreenText",["../error/ArgumentError","../util/Logger","../util/Offset","../shapes/Text"],function(p,l,n,e){"use strict";var i=function(t,r){if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"Text","constructor","missingOffset"));e.call(this,r),this.screenOffset=t,this.altitudeMode=null};return i.prototype=Object.create(e.prototype),i.prototype.render=function(t){this.lastFrameTime!==t.timestamp&&e.prototype.render.call(this,t)},i.prototype.computeScreenPointAndEyeDistance=function(t){var r=t.currentGlContext,s=this.screenOffset.offsetForSize(r.drawingBufferWidth,r.drawingBufferHeight);return this.screenPoint[0]=s[0],this.screenPoint[1]=s[1],this.screenPoint[2]=0,this.eyeDistance=0,!0},i}),B("layer/CoordinatesDisplayLayer",["../error/ArgumentError","../util/Color","../util/Font","../layer/Layer","../util/Logger","../util/Offset","../geom/Position","../shapes/ScreenImage","../shapes/ScreenText","../shapes/TextAttributes","../geom/Vec2"],function(p,l,n,e,i,t,r,s,a,f,o){"use strict";var c=function(d){if(!d)throw new p(i.logMessage(i.LEVEL_SEVERE,"CoordinatesDisplayLayer","constructor","missingWorldWindow"));e.call(this,"Coordinates"),this.wwd=d,this.pickEnabled=!1,this.eventType=null,this.clientX=null,this.clientY=null,this.terrainPosition=null,this.latText=new a(new t(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.latText.attributes=new f(null),this.latText.attributes.color=l.YELLOW,this.lonText=new a(new t(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.lonText.attributes=new f(null),this.lonText.attributes.color=l.YELLOW,this.elevText=new a(new t(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.elevText.attributes=new f(null),this.elevText.attributes.color=l.YELLOW,this.eyeText=new a(new t(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0)," "),this.eyeText.attributes=new f(null),this.eyeText.attributes.color=l.YELLOW;var h=new t(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),u=WorldWind.configuration.baseUrl+"images/crosshair.png";this.crosshairImage=new s(h,u);var m=this;function g(y){m.handleUIEvent(y)}window.PointerEvent?(d.addEventListener("pointerdown",g),d.addEventListener("pointermove",g),d.addEventListener("pointerleave",g)):(d.addEventListener("mousedown",g),d.addEventListener("mousemove",g),d.addEventListener("mouseleave",g),d.addEventListener("touchstart",g),d.addEventListener("touchmove",g));function _(y,v){m.handleRedraw(v)}this.wwd.redrawCallbacks.push(_)};return c.prototype=Object.create(e.prototype),c.prototype.doRender=function(d){var h=this.terrainPosition,u=d.eyePosition,m=d.currentGlContext.canvas.clientWidth,g,_,y,v,b;m>650?(g=m/2-50,_=11,y=WorldWind.OFFSET_PIXELS,v=0):m>400?(g=60,_=5,y=WorldWind.OFFSET_INSET_PIXELS,v=1):(g=60,_=5,y=WorldWind.OFFSET_INSET_PIXELS,v=1,b=!0),this.latText.text=h?this.formatLatitude(h.latitude):null,this.latText.screenOffset=new t(WorldWind.OFFSET_PIXELS,g,y,_),this.latText.attributes.offset=new t(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,v),this.latText.render(d),g+=70,this.lonText.text=h?this.formatLongitude(h.longitude):null,this.lonText.screenOffset=new t(WorldWind.OFFSET_PIXELS,g,y,_),this.lonText.attributes.offset=new t(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,v),this.lonText.render(d),d.globe.is2D()||(g+=70,this.elevText.text=h?this.formatAltitude(h.altitude,"m"):null,this.elevText.screenOffset=new t(WorldWind.OFFSET_PIXELS,g,y,_),this.elevText.attributes.offset=new t(WorldWind.OFFSET_FRACTION,1,WorldWind.OFFSET_FRACTION,v),this.elevText.render(d)),b||(g+=40,this.eyeText.text="Eye  "+this.formatAltitude(u.altitude,u.altitude<1e3?"m":"km"),this.eyeText.screenOffset=new t(WorldWind.OFFSET_PIXELS,g,y,_),this.eyeText.attributes.offset=new t(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,v),this.eyeText.render(d)),this.eventType==="touch"&&this.crosshairImage.render(d),this.inCurrentFrame=!0},c.prototype.handleUIEvent=function(d){d.type.indexOf("pointer")!==-1?this.eventType=d.pointerType:d.type.indexOf("mouse")!==-1?this.eventType="mouse":d.type.indexOf("touch")!==-1&&(this.eventType="touch"),d.type.indexOf("leave")!==-1?(this.clientX=null,this.clientY=null):(this.clientX=d.clientX,this.clientY=d.clientY),this.wwd.redraw()},c.prototype.handleRedraw=function(d){if(d===WorldWind.BEFORE_REDRAW){var h,u;(this.eventType==="mouse"||this.eventType==="pen")&&this.clientX&&this.clientY?(h=this.wwd.canvasCoordinates(this.clientX,this.clientY),h[0]>=0&&h[0]<this.wwd.canvas.width&&h[1]>=0&&h[1]<this.wwd.canvas.height&&(u=this.wwd.pickTerrain(h).terrainObject())):this.eventType==="touch"&&(h=new o(this.wwd.canvas.width/2,this.wwd.canvas.height/2),u=this.wwd.pickTerrain(h).terrainObject()),this.terrainPosition=u?u.position:null}},c.prototype.formatLatitude=function(d){var h=d<0?"\xB0S":"\xB0N";return Math.abs(d).toFixed(2)+h},c.prototype.formatLongitude=function(d){var h=d<0?"\xB0W":"\xB0E";return Math.abs(d).toFixed(2)+h},c.prototype.formatAltitude=function(d,h){return h==="km"&&(d/=1e3),d.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")+" "+h},c}),B("util/Date",[],function(){"use strict";var p=function(l){l?this._date=new Date(l):this._date=new Date};return p.prototype=Object.create(Date.prototype),p.prototype.isAfter=function(l){return this.compare(l)==-1},p.prototype.isBefore=function(l){return this.compare(l)==1},p.prototype.valueOf=function(){return this._date.valueOf()},p.prototype.getTime=function(){return this._date.getTime()},p.prototype.compare=function(l){var n=this._date.valueOf(),e=l.valueOf();return n>e?-1:n<e?1:0},p}),B("layer/DigitalGlobeTiledImageLayer",["../geom/Angle","../error/ArgumentError","../util/Color","../geom/Location","../util/Logger","../geom/Sector","../layer/MercatorTiledImageLayer"],function(p,l,n,e,i,t,r){"use strict";var s=function(a,f,o){if(!f)throw new l(i.logMessage(i.LEVEL_SEVERE,"DigitalGlobeTiledImageLayer","constructor","The map ID is null or undefined."));if(!o)throw new l(i.logMessage(i.LEVEL_SEVERE,"DigitalGlobeTiledImageLayer","constructor","The access token is null or undefined."));this.imageSize=256,a=a||"Digital Globe",r.call(this,new t(-85.05,85.05,-180,180),new e(85.05,180),19,"image/jpeg",a,this.imageSize,this.imageSize),this.mapId=f,this.accessToken=o,this.displayName=a,this.pickEnabled=!0,this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d"),this.requestMetadata();var c=this;this.urlBuilder={urlForTile:function(d,h){return c.metadataRetrievalInProcess?null:c.urlTemplate.replace("{z}",d.level.levelNumber+1).replace("{x}",d.column).replace("{y}",d.row)}}};return s.prototype=Object.create(r.prototype),s.prototype.requestMetadata=function(){if(!this.metadataRetrievalInProcess){this.metadataRetrievalInProcess=!0;var a="https://api.mapbox.com/v4/"+this.mapId+".json?secure&access_token="+this.accessToken,f=new XMLHttpRequest,o=this;f.onreadystatechange=function(){if(f.readyState===4&&f.status===200){var c=JSON.parse(f.responseText);o.urlTemplate=c.tiles[0];var d=document.createEvent("Event");d.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(d),o.metadataRetrievalInProcess=!1}},f.open("GET",a,!0),f.send()}},s.prototype.doRender=function(a){r.prototype.doRender.call(this,a),this.inCurrentFrame&&a.screenCreditController.addCredit("\xA9 Digital Globe",n.DARK_GRAY)},s.prototype.createTopLevelTiles=function(a){this.topLevelTiles=[],this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),0,1)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,0)),this.topLevelTiles.push(this.createTile(null,this.levels.firstLevel(),1,1))},s.prototype.mapSizeForLevel=function(a){return 256<<a+1},s}),B("util/FrameStatistics",[],function(){"use strict";var p=function(){this.frameCount=0,this.frameTimeCumulative=0,this.frameTimeBase=0,this.frameTimeExtremes=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],this.frameTime=0,this.tessellationTime=0,this.layerRenderingTime=0,this.orderedRenderingTime=0,this.terrainTileCount=0,this.imageTileCount=0,this.renderedTileCount=0,this.tileUpdateCount=0,this.textureLoadCount=0,this.vboLoadCount=0,this.frameTimeAverage=0,this.frameRateAverage=0,this.frameTimeMin=0,this.frameTimeMax=0};return p.prototype.beginFrame=function(){this.frameTime=Date.now(),this.tessellationTime=0,this.layerRenderingTime=0,this.orderedRenderingTime=0,this.terrainTileCount=0,this.imageTileCount=0,this.renderedTileCount=0,this.tileUpdateCount=0,this.textureLoadCount=0,this.vboLoadCount=0,++this.frameCount},p.prototype.endFrame=function(){var l=Date.now();this.frameTime=l-this.frameTime,this.frameTimeCumulative+=this.frameTime,this.frameTimeExtremes[0]=Math.min(this.frameTimeExtremes[0],this.frameTime),this.frameTimeExtremes[1]=Math.max(this.frameTimeExtremes[1],this.frameTime),l-this.frameTimeBase>2e3&&(this.frameTimeAverage=this.frameTimeCumulative/this.frameCount,this.frameRateAverage=1e3*this.frameCount/(l-this.frameTimeBase),this.frameTimeMin=this.frameTimeExtremes[0],this.frameTimeMax=this.frameTimeExtremes[1],this.frameCount=0,this.frameTimeCumulative=0,this.frameTimeBase=l,this.frameTimeExtremes=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY])},p.prototype.incrementRenderedTileCount=function(l){this.renderedTileCount+=l},p.prototype.setTerrainTileCount=function(l){this.terrainTileCount=l},p.prototype.incrementImageTileCount=function(l){this.imageTileCount=l},p.prototype.incrementTileUpdateCount=function(l){this.tileUpdateCount+=l},p.prototype.incrementTextureLoadCount=function(l){this.textureLoadCount+=l},p.prototype.incrementVboLoadCount=function(l){this.vboLoadCount+=l},p}),B("render/FramebufferTexture",["../error/ArgumentError","../util/Logger","../util/WWMath"],function(p,l){"use strict";var n=function(e,i,t,r){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"FramebufferTexture","constructor","missingGlContext"));if(i<0||t<0)throw new p(l.logMessage(l.LEVEL_SEVERE,"FramebufferTexture","constructor","The framebuffer width or height is less than zero."));this.width=i,this.height=t,this.depth=r,this.size=i*t*4+(r?i*t*2:0),this.framebufferId=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,this.framebufferId),this.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,i,t,0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0),this.depthBuffer=null,r&&(this.depthBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.depthBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,i,t),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthBuffer));var s=e.checkFramebufferStatus(e.FRAMEBUFFER);s!=e.FRAMEBUFFER_COMPLETE&&(l.logMessage(l.LEVEL_WARNING,"FramebufferTexture","constructor","Error creating framebuffer: "+s),this.framebufferId=null,this.texture=null,this.depthBuffer=null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.bindTexture(e.TEXTURE_2D,null)};return n.prototype.bind=function(e){return this.texture&&e.currentGlContext.bindTexture(gl.TEXTURE_2D,this.texture),!!this.texture},n}),B("render/FramebufferTile",["../error/ArgumentError","../render/FramebufferTexture","../util/Logger","../geom/Matrix","../geom/Rectangle","../render/TextureTile"],function(p,l,n,e,i,t){"use strict";var r=function(s,a,f,o,c){if(!c||c.length<1)throw new p(n.logMessage(n.LEVEL_SEVERE,"FramebufferTile","constructor","The specified cache name is null, undefined or zero length."));t.call(this,s,a,f,o),this.gpuCacheKey=c,this.textureTransform=e.fromIdentity().setToUnitYFlip(),this.mustClear=!0};return r.prototype=Object.create(t.prototype),r.prototype.clearFramebuffer=function(s){this.mustClear=!0},r.prototype.bindFramebuffer=function(s){var a=s.gpuResourceCache.resourceForKey(this.gpuCacheKey);return a||(a=this.createFramebuffer(s)),s.bindFramebuffer(a),this.mustClear&&(this.doClearFramebuffer(s),this.mustClear=!1),!0},r.prototype.createFramebuffer=function(s){var a=new l(s.currentGlContext,this.tileWidth,this.tileHeight,!1);return s.gpuResourceCache.putResource(this.gpuCacheKey,a,a.size),a},r.prototype.doClearFramebuffer=function(s){var a=s.currentGlContext;a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT)},r.prototype.applyInternalTransform=function(s,a){a.multiplyMatrix(this.textureTransform)},r}),B("render/FramebufferTileController",["../error/ArgumentError","../render/FramebufferTile","../util/LevelSet","../geom/Location","../util/Logger","../cache/MemoryCache","../geom/Sector","../util/Tile"],function(p,l,n,e,i,t,r,s){"use strict";var a=function(){this.tileWidth=256,this.tileHeight=256,this.detailControl=1.75,this.levels=new n(r.FULL_SPHERE,new e(45,45),16,this.tileWidth,this.tileHeight),this.topLevelTiles=[],this.currentTiles=[],this.currentTimestamp=null,this.currentGlobeStateKey=null,this.tileCache=new t(5e5,4e5),this.key="FramebufferTileController "+ ++a.keyPool};return a.keyPool=0,a.prototype.selectTiles=function(f,o){if(!o)throw new p(i.logMessage(i.LEVEL_SEVERE,"FramebufferTileController","selectTiles","missingSector"));this.assembleTiles(f);for(var c=[],d=0,h=this.currentTiles.length;d<h;d++){var u=this.currentTiles[d];u.sector.overlaps(o)&&(u.selected=!0,c.push(u))}return c},a.prototype.render=function(f){if(this.currentTiles.length!=0){for(var o=[],c=0,d=this.currentTiles.length;c<d;c++){var h=this.currentTiles[c];h.selected&&o.push(h)}f.surfaceTileRenderer.renderTiles(f,o,1);var u=f.currentGlContext,m=f.currentFramebuffer;try{for(u.clearColor(0,0,0,0),c=0,d=o.length;c<d;c++)h=o[c],h.selected=!1,h.bindFramebuffer(f),u.clear(u.COLOR_BUFFER_BIT)}finally{f.bindFramebuffer(m)}}},a.prototype.assembleTiles=function(f){var o=f.timestamp,c=f.globeStateKey;(this.currentTimestamp!=o||this.currentGlobeStateKey!=c)&&(this.doAssembleTiles(f),this.currentTimestamp=o,this.currentGlobeStateKey=c)},a.prototype.doAssembleTiles=function(f){if(this.currentTiles=[],!!f.terrain){this.topLevelTiles.length==0&&this.createTopLevelTiles();for(var o=0,c=this.topLevelTiles.length;o<c;o++){var d=this.topLevelTiles[o];d.update(f),this.isTileVisible(f,d)&&this.addTileOrDescendants(f,d)}}},a.prototype.createTile=function(f,o,c,d){var h=this.key+" "+o.levelNumber+"."+c+"."+d;return new l(f,o,c,d,h)},a.prototype.createTopLevelTiles=function(){s.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)},a.prototype.addTileOrDescendants=function(f,o){if(this.tileMeetsRenderingCriteria(f,o)){this.addTile(o);return}for(var c=o.subdivideToCache(o.level.nextLevel(),this,this.tileCache),d=0,h=c.length;d<h;d++){var u=c[d];u.update(f),this.isTileVisible(f,u)&&this.addTileOrDescendants(f,u)}},a.prototype.addTile=function(f){this.currentTiles.push(f)},a.prototype.isTileVisible=function(f,o){return f.globe.projectionLimits&&!o.sector.overlaps(f.globe.projectionLimits)?!1:f.pickingMode?o.extent.intersectsFrustum(f.pickFrustum):o.extent.intersectsFrustum(f.frustumInModelCoordinates)},a.prototype.tileMeetsRenderingCriteria=function(f,o){var c=this.detailControl;return(o.sector.minLatitude>=75||o.sector.maxLatitude<=-75)&&(c*=1.2),o.level.isLastLevel()||!o.mustSubdivide(f,c)},a}),B("globe/ElevationModel",["../error/ArgumentError","../geom/Angle","../geom/Location","../util/Logger"],function(p,l,n,e){"use strict";var i=function(){this.id=0,this.stateKey="",this.coverages=[],this.scratchLocation=new n(0,0),this.computeStateKey()};return Object.defineProperties(i.prototype,{timestamp:{get:function(){var t=0,r,s;for(r=0,s=this.coverages.length;r<s;r++){var a=this.coverages[r];t<a.timestamp&&(t=a.timestamp)}return t}},minElevation:{get:function(){for(var t=Number.MAX_VALUE,r=0,s=this.coverages.length;r<s;r++){var a=this.coverages[r];a.enabled&&a.minElevation<t&&(t=a.minElevation)}return t!==Number.MAX_VALUE?t:0}},maxElevation:{get:function(){for(var t=-Number.MAX_VALUE,r=0,s=this.coverages.length;r<s;r++){var a=this.coverages[r];a.enabled&&a.maxElevation>t&&(t=a.maxElevation)}return t!==-Number.MAX_VALUE?t:0}}}),i.idPool=0,i.prototype.computeStateKey=function(){this.id=++i.idPool,this.stateKey="elevationModel "+this.id.toString()+" "},i.prototype.coverageComparator=function(t,r){var s=t.resolution,a=r.resolution;return s>a?-1:s===a?0:1},i.prototype.performCoverageListChangedActions=function(){this.coverages.length>1&&this.coverages.sort(this.coverageComparator),this.computeStateKey()},i.prototype.addCoverage=function(t){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"ElevationModel","addCoverage","missingCoverage"));return this.containsCoverage(t)?!1:(this.coverages.push(t),this.performCoverageListChangedActions(),!0)},i.prototype.removeAllCoverages=function(){this.coverages.length>0&&(this.coverages=[],this.performCoverageListChangedActions())},i.prototype.removeCoverage=function(t){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"ElevationModel","removeCoverage","missingCoverage"));var r=this.coverages.indexOf(t);r>=0&&(this.coverages.splice(r,1),this.performCoverageListChangedActions())},i.prototype.containsCoverage=function(t){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"ElevationModel","containsCoverage","missingCoverage"));var r=this.coverages.indexOf(t);return r>=0},i.prototype.minAndMaxElevationsForSector=function(t){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"ElevationModel","minAndMaxElevationsForSector","missingSector"));for(var r=[Number.MAX_VALUE,-Number.MAX_VALUE],s=this.coverages.length-1;s>=0;s--){var a=this.coverages[s];if(a.enabled&&a.coverageSector.intersects(t)&&a.minAndMaxElevationsForSector(t,r))break}return r[0]!==Number.MAX_VALUE?r:[0,0]},i.prototype.elevationAtLocation=function(t,r){var s,a=this.coverages.length;for(s=a-1;s>=0;s--){var f=this.coverages[s];if(f.enabled&&f.coverageSector.containsLocation(t,r)){var o=f.elevationAtLocation(t,r);if(o!==null)return o}}return 0},i.prototype.preferredCoverageIndex=function(t,r,s){var a,f=this.coverages.length,o=Number.MAX_VALUE,c=-1;for(a=0;a<f;a++){var d=this.coverages[a],h=d.enabled&&(t!==null&&d.coverageSector.intersects(t)||r!==null&&d.coverageSector.containsLocation(r.latitude,r.longitude));if(h){var u=Math.abs(d.resolution-s);if(u>o)return c;o=u,c=a}}return c},i.prototype.bestCoverageAtLocation=function(t,r,s){if(!s||s<0)throw new p(e.logMessage(e.LEVEL_SEVERE,"ElevationModel","bestCoverageAtLocation","invalidResolution"));this.scratchLocation.set(t,r);var a=this.preferredCoverageIndex(null,this.scratchLocation,s);return a>=0?this.coverages[a]:null},i.prototype.elevationsForGrid=function(t,r,s,a,f){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"ElevationModel","elevationsForGrid","missingSector"));if(!r||!s||r<1||s<1)throw new p(e.logMessage(e.LEVEL_SEVERE,"ElevationModel","elevationsForGrid","The specified number of latitudinal or longitudinal positions is less than one."));if(!a)throw new p(e.logMessage(e.LEVEL_SEVERE,"ElevationModel","elevationsForGrid","missingTargetResolution"));if(!f)throw new p(e.logMessage(e.LEVEL_SEVERE,"ElevationModel","elevationsForGrid","missingResult"));f.fill(NaN);var o=Number.MAX_VALUE,c=!1,d=this.preferredCoverageIndex(t,null,a);if(d>=0)for(var h=d;!c&&h>=0;h--){var u=this.coverages[h];u.enabled&&u.coverageSector.intersects(t)&&(c=u.elevationsForGrid(t,r,s,f),c&&(o=u.resolution))}if(!c){var m=f.length;for(h=0;h<m;h++)isNaN(f[h])&&(f[h]=0)}return o},i}),B("projections/GeographicProjection",["../error/ArgumentError","../util/Logger","../geom/Sector","../error/UnsupportedOperationError"],function(p,l,n,e){"use strict";var i=function(t,r,s){this.displayName=t||"Geographic Projection",this.continuous=r,this.projectionLimits=s,this.is2D=!0};return i.prototype.geographicToCartesian=function(t,r,s,a,f,o){throw new e(l.logMessage(l.LEVEL_SEVERE,"GeographicProjection","geographicToCartesian","abstractInvocation"))},i.prototype.geographicToCartesianGrid=function(t,r,s,a,f,o,c,d){throw new e(l.logMessage(l.LEVEL_SEVERE,"GeographicProjection","geographicToCartesianGrid","abstractInvocation"))},i.prototype.cartesianToGeographic=function(t,r,s,a,f,o){throw new e(l.logMessage(l.LEVEL_SEVERE,"GeographicProjection","cartesianToGeographic","abstractInvocation"))},i.prototype.northTangentAtLocation=function(t,r,s,a){if(!a)throw new p(l.logMessage(l.LEVEL_SEVERE,"ProjectionEquirectangular","northTangentAtLocation","missingResult"));return a[0]=0,a[1]=1,a[2]=0,a},i.prototype.northTangentAtPoint=function(t,r,s,a,f,o){if(!o)throw new p(l.logMessage(l.LEVEL_SEVERE,"ProjectionEquirectangular","northTangentAtPoint","missingResult"));return o[0]=0,o[1]=1,o[2]=0,o},i.prototype.surfaceNormalAtLocation=function(t,r,s,a){if(!a)throw new p(l.logMessage(l.LEVEL_SEVERE,"GeographicProjection","surfaceNormalAtLocation","missingResult"));return a[0]=0,a[1]=0,a[2]=1,a},i.prototype.surfaceNormalAtPoint=function(t,r,s,a,f){if(!f)throw new p(l.logMessage(l.LEVEL_SEVERE,"GeographicProjection","surfaceNormalAtPoint","missingResult"));return f[0]=0,f[1]=0,f[2]=1,f},i}),B("projections/ProjectionWgs84",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Position","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r){"use strict";var s=function(){n.call(this,"WGS84",!1,null),this.is2D=!1,this.scratchPosition=new i(0,0,0)};return s.prototype=Object.create(n.prototype),Object.defineProperties(s.prototype,{stateKey:{get:function(){return"projection wgs84 "}}}),s.prototype.geographicToCartesian=function(a,f,o,c,d,h){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesian","missingGlobe"));var u=Math.cos(f*p.DEGREES_TO_RADIANS),m=Math.sin(f*p.DEGREES_TO_RADIANS),g=Math.cos(o*p.DEGREES_TO_RADIANS),_=Math.sin(o*p.DEGREES_TO_RADIANS),y=a.equatorialRadius/Math.sqrt(1-a.eccentricitySquared*m*m);return h[0]=(y+c)*u*_,h[1]=(y*(1-a.eccentricitySquared)+c)*m,h[2]=(y+c)*u*g,h},s.prototype.geographicToCartesianGrid=function(a,f,o,c,d,h,u,m){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionWgs84","geographicToCartesianGrid","missingGlobe"));var g=f.minLatitude*p.DEGREES_TO_RADIANS,_=f.maxLatitude*p.DEGREES_TO_RADIANS,y=f.minLongitude*p.DEGREES_TO_RADIANS,v=f.maxLongitude*p.DEGREES_TO_RADIANS,b=(_-g)/(o>1?o-1:1),R=(v-y)/(c>1?c-1:1),M=h||new t(0,0,0),P,T,E=0,x=0,S,L,C,F,q,it,st=new Float64Array(c),pt=new Float64Array(c);for(T=0,L=y;T<c;T++,L+=R)T===c-1&&(L=v),st[T]=Math.cos(L),pt[T]=Math.sin(L);for(P=0,S=g;P<o;P++,S+=b)for(P===o-1&&(S=_),q=Math.cos(S),it=Math.sin(S),C=a.equatorialRadius/Math.sqrt(1-a.eccentricitySquared*it*it),T=0;T<c;T++)F=d[E++],m[x++]=(C+F)*q*pt[T]-M[0],m[x++]=(C*(1-a.eccentricitySquared)+F)*it-M[1],m[x++]=(C+F)*q*st[T]-M[2];return m},s.prototype.cartesianToGeographic=function(a,f,o,c,d,h){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionWgs84","cartesianToGeographic","missingGlobe"));var u=c,m=f,g=o,_=u*u+m*m,y=Math.sqrt(_),v=a.equatorialRadius,b=1/(v*v),R=a.eccentricitySquared,M=R*R,P=_*b,T=g*g*(1-R)*b,E=(P+T-M)/6,x,S,L,C=8*E*E*E+M*P*T,F,q,it,st,pt,_t,X,ot,Tt,Vt,Gt,qt;return C>0||T!=0?(C>0?(F=Math.sqrt(C),q=Math.sqrt(M*P*T),C>10*R?(it=r.cbrt((F+q)*(F+q)),L=E+.5*it+2*E*E/it):L=E+.5*r.cbrt((F+q)*(F+q))+.5*r.cbrt((F-q)*(F-q))):(F=Math.sqrt(-C),q=Math.sqrt(-8*E*E*E),it=Math.sqrt(M*P*T),st=2*Math.atan2(it,F+q)/3,L=-4*E*Math.sin(st)*Math.cos(Math.PI/6+st)),pt=Math.sqrt(L*L+M*T),_t=R*(L+pt-T)/(2*pt),X=(L+pt)/(Math.sqrt(_t*_t+L+pt)+_t),ot=X*y/(X+R),Tt=Math.sqrt(ot*ot+g*g),x=(X+R-1)*Tt/X,S=2*Math.atan2(g,Tt+ot)):(F=Math.sqrt(1-R),q=Math.sqrt(R-P),Vt=Math.sqrt(R),x=-v*F*q/Vt,S=q/(Vt*q+F*Math.sqrt(P))),qt=Math.sqrt(2),(qt-1)*m<y+u?Gt=2*Math.atan2(m,y+u):y+m<(qt+1)*u?Gt=-Math.PI*.5+2*Math.atan2(u,y-m):Gt=Math.PI*.5-2*Math.atan2(u,y+m),h.latitude=p.RADIANS_TO_DEGREES*S,h.longitude=p.RADIANS_TO_DEGREES*Gt,h.altitude=x,h},s.prototype.northTangentAtLocation=function(a,f,o,c){var d=Math.cos(f*p.DEGREES_TO_RADIANS),h=Math.cos(o*p.DEGREES_TO_RADIANS),u=Math.sin(f*p.DEGREES_TO_RADIANS),m=Math.sin(o*p.DEGREES_TO_RADIANS);return c[0]=-u*m,c[1]=d,c[2]=-u*h,c.normalize()},s.prototype.northTangentAtPoint=function(a,f,o,c,d,h){return this.cartesianToGeographic(a,f,o,c,t.ZERO,this.scratchPosition),this.northTangentAtLocation(a,this.scratchPosition.latitude,this.scratchPosition.longitude,h)},s.prototype.surfaceNormalAtLocation=function(a,f,o,c){var d=Math.cos(f*p.DEGREES_TO_RADIANS),h=Math.cos(o*p.DEGREES_TO_RADIANS),u=Math.sin(f*p.DEGREES_TO_RADIANS),m=Math.sin(o*p.DEGREES_TO_RADIANS);return c[0]=d*m,c[1]=u,c[2]=d*h,c.normalize()},s.prototype.surfaceNormalAtPoint=function(a,f,o,c,d){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionWgs84","surfaceNormalAtPoint","missingGlobe"));var h=a.equatorialRadius*a.equatorialRadius,u=a.polarRadius*a.polarRadius;return d[0]=f/h,d[1]=o/u,d[2]=c/h,d.normalize()},s}),B("globe/Terrain",["../error/ArgumentError","../util/Logger","../geom/Vec3"],function(p,l,n){"use strict";var e=function(i,t,r,s){this.globe=i,this.verticalExaggeration=s,this.sector=r.sector,this.tessellator=t,this.surfaceGeometry=r.tileArray,this.stateKey=i.stateKey+" ve "+s.toString()};return e.scratchPoint=new n(0,0,0),e.prototype.surfacePoint=function(i,t,r,s){if(!s)throw new p(l.logMessage(l.LEVEL_SEVERE,"Terrain","surfacePoint","missingResult"));for(var a=0,f=this.surfaceGeometry.length;a<f;a++)if(this.surfaceGeometry[a].sector.containsLocation(i,t)){if(this.surfaceGeometry[a].surfacePoint(i,t,s),r){var o=this.globe.surfaceNormalAtPoint(s[0],s[1],s[2],e.scratchPoint);s[0]+=o[0]*r,s[1]+=o[1]*r,s[2]+=o[2]*r}return s}var c=r+this.globe.elevationAtLocation(i,t)*this.verticalExaggeration;return this.globe.computePointFromPosition(i,t,c,s),s},e.prototype.surfacePointForMode=function(i,t,r,s,a){if(!a)throw new p(l.logMessage(l.LEVEL_SEVERE,"Terrain","surfacePointForMode","missingResult"));if(s||(s=WorldWind.ABSOLUTE),s===WorldWind.CLAMP_TO_GROUND)return this.surfacePoint(i,t,0,a);if(s===WorldWind.RELATIVE_TO_GROUND)return this.surfacePoint(i,t,r,a);var f=r*this.verticalExaggeration;return this.globe.computePointFromPosition(i,t,f,a),a},e.prototype.beginRendering=function(i){this.globe&&this.globe.tessellator&&this.globe.tessellator.beginRendering(i)},e.prototype.endRendering=function(i){this.globe&&this.globe.tessellator&&this.globe.tessellator.endRendering(i)},e.prototype.beginRenderingTile=function(i,t){if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"Terrain","beginRenderingTile","missingTile"));this.globe&&this.globe.tessellator&&this.globe.tessellator.beginRenderingTile(i,t)},e.prototype.endRenderingTile=function(i,t){},e.prototype.renderTile=function(i,t){if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"Terrain","renderTile","missingTile"));this.globe&&this.globe.tessellator&&this.globe.tessellator.renderTile(i,t)},e.prototype.pick=function(i){this.globe&&this.globe.tessellator&&this.globe.tessellator.pick(i,this.surfaceGeometry,this)},e}),B("globe/TerrainTile",["../error/ArgumentError","../util/Logger","../geom/Matrix","../util/Tile"],function(p,l,n,e){"use strict";var i=function(t,r,s,a){e.call(this,t,r,s,a),this.transformationMatrix=n.fromIdentity(),this.points=null,this.pointsStateKey=null,this.pointsVboStateKey=null,this.neighborMap={},this.neighborMap[WorldWind.NORTH]=null,this.neighborMap[WorldWind.SOUTH]=null,this.neighborMap[WorldWind.EAST]=null,this.neighborMap[WorldWind.WEST]=null,this._stateKey=null,this._elevationTimestamp=null,this.scratchArray=[]};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{stateKey:{get:function(){return this._stateKey||(this._stateKey=this.computeStateKey()),this._stateKey}}}),i.prototype.neighborLevel=function(t){return this.neighborMap[t]},i.prototype.setNeighborLevel=function(t,r){this.neighborMap[t]=r,this._stateKey=null},i.prototype.surfacePoint=function(t,r,s){if(!s)throw new p(l.logMessage(l.LEVEL_SEVERE,"TerrainTile","surfacePoint","missingResult"));var a=this.sector,f=a.minLatitude,o=a.maxLatitude,c=a.minLongitude,d=a.maxLongitude,h=this.tileWidth,u=this.tileHeight,m,g,_,y,v,b,R,M,P,T,E,x,S;m=(r-c)/(d-c)*h,g=(t-f)/(o-f)*u,_=m<h?Math.floor(m):h-1,y=g<u?Math.floor(g):u-1,v=h+1,b=this.points,R=this.scratchArray,M=3*(_+y*v);for(var L=0;L<6;L++)R[L]=b[M+L];M=3*(_+(y+1)*v);for(var C=6;C<12;C++)R[C]=b[M+(C-6)];return P=m<h?m-Math.floor(m):1,T=g<u?g-Math.floor(g):1,P>T?(s[0]=R[0]+P*(R[3]-R[0])+T*(R[6]-R[0]),s[1]=R[1]+P*(R[4]-R[1])+T*(R[7]-R[1]),s[2]=R[2]+P*(R[5]-R[2])+T*(R[8]-R[2])):(s[0]=R[9]+(1-P)*(R[6]-R[9])+(1-T)*(R[3]-R[9]),s[1]=R[10]+(1-P)*(R[7]-R[10])+(1-T)*(R[4]-R[10]),s[2]=R[11]+(1-P)*(R[8]-R[11])+(1-T)*(R[5]-R[11])),s[0]+=this.referencePoint[0],s[1]+=this.referencePoint[1],s[2]+=this.referencePoint[2],s},i.prototype.update=function(t){e.prototype.update.call(this,t);var r=t.globe.elevationTimestamp();this._elevationTimestamp!=r&&(this._elevationTimestamp=r,this._stateKey=null)},i.prototype.computeStateKey=function(){var t=[];return t.push(this._elevationTimestamp),t.push(this.neighborMap[WorldWind.NORTH]?this.neighborMap[WorldWind.NORTH].compare(this.level):0),t.push(this.neighborMap[WorldWind.SOUTH]?this.neighborMap[WorldWind.SOUTH].compare(this.level):0),t.push(this.neighborMap[WorldWind.EAST]?this.neighborMap[WorldWind.EAST].compare(this.level):0),t.push(this.neighborMap[WorldWind.WEST]?this.neighborMap[WorldWind.WEST].compare(this.level):0),t.join(".")},i}),B("globe/TerrainTileList",["../error/ArgumentError","../util/Logger","../geom/Sector"],function(p,l,n){"use strict";var e=function(t){if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"TerrainTileList","TerrainTileList","missingTessellator"));this.tessellator=t,this.sector=null,this.tileArray=[]};return Object.defineProperties(e.prototype,{length:{get:function(){return this.tileArray.length}}}),e.prototype.addTile=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"TerrainTileList","addTile","missingTile"));this.tileArray.indexOf(i)==-1&&(this.tileArray.push(i),this.sector?this.sector.union(i.sector):(this.sector=new n(0,0,0,0),this.sector.copy(i.sector)))},e.prototype.removeAllTiles=function(){this.tileArray=[],this.sector=null},e}),B("globe/Tessellator",["../geom/Angle","../error/ArgumentError","../shaders/BasicProgram","../globe/Globe","../shaders/GpuProgram","../util/Level","../util/LevelSet","../geom/Location","../util/Logger","../geom/Matrix","../cache/MemoryCache","../error/NotYetImplementedError","../pick/PickedObject","../geom/Position","../geom/Rectangle","../geom/Sector","../globe/Terrain","../globe/TerrainTile","../globe/TerrainTileList","../util/Tile","../util/WWMath","../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m,g,_,y,v,b,R){"use strict";var M=function(){this.numRowsTilesInTopLevel=4,this.numColumnsTilesInTopLevel=8,this.maximumSubdivisionDepth=15,this.tileWidth=32,this.tileHeight=32,this.detailControl=40,this.levels=new r(m.FULL_SPHERE,new s(180/this.numRowsTilesInTopLevel,360/this.numColumnsTilesInTopLevel),this.maximumSubdivisionDepth,this.tileWidth,this.tileHeight),this.topLevelTiles={},this.currentTiles=new y(this),this.tileCache=new o(5e6,4e6),this.elevationTimestamp=void 0,this.lastModelViewProjection=f.fromIdentity(),this.vertexPointLocation=-1,this.vertexTexCoordLocation=-1,this.texCoords=null,this.texCoordVboCacheKey="global_tex_coords",this.indices=null,this.indicesVboCacheKey="global_indices",this.baseIndices=null,this.baseIndicesOffset=null,this.numBaseIndices=null,this.indicesNorth=null,this.indicesNorthOffset=null,this.numIndicesNorth=null,this.indicesSouth=null,this.indicesSouthOffset=null,this.numIndicesSouth=null,this.indicesWest=null,this.indicesWestOffset=null,this.numIndicesWest=null,this.indicesEast=null,this.indicesEastOffset=null,this.numIndicesEast=null,this.indicesLoresNorth=null,this.indicesLoresNorthOffset=null,this.numIndicesLoresNorth=null,this.indicesLoresSouth=null,this.indicesLoresSouthOffset=null,this.numIndicesLoresSouth=null,this.indicesLoresWest=null,this.indicesLoresWestOffset=null,this.numIndicesLoresWest=null,this.indicesLoresEast=null,this.indicesLoresEastOffset=null,this.numIndicesLoresEast=null,this.outlineIndicesOffset=null,this.numOutlineIndices=null,this.wireframeIndicesOffset=null,this.numWireframeIndices=null,this.scratchMatrix=f.fromIdentity(),this.scratchElevations=null,this.scratchPrevElevations=null,this.corners={},this.tiles=[]};return M.prototype.tessellate=function(P){if(!P)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tessellator","tessellate","missingDC"));var T=P.globe.elevationTimestamp();if(this.lastGlobeStateKey===P.globeStateKey&&this.lastVerticalExaggeration===P.verticalExaggeration&&this.elevationTimestamp===T&&P.modelviewProjection.equals(this.lastModelViewProjection))return this.lastTerrain;this.lastModelViewProjection.copy(P.modelviewProjection),this.lastGlobeStateKey=P.globeStateKey,this.elevationTimestamp=T,this.lastVerticalExaggeration=P.verticalExaggeration,this.currentTiles.removeAllTiles(),(!this.topLevelTiles[P.globeStateKey]||this.topLevelTiles[P.globeStateKey].length==0)&&this.createTopLevelTiles(P),this.corners={},this.tiles=[];for(var E=0,x=this.topLevelTiles[P.globeStateKey].length;E<x;E+=1){var S=this.topLevelTiles[P.globeStateKey][E];S.update(P),this.isTileVisible(P,S)&&this.addTileOrDescendants(P,S)}return this.refineNeighbors(P),this.finishTessellating(P),this.lastTerrain=this.currentTiles.length===0?null:new g(P.globe,this,this.currentTiles,P.verticalExaggeration),this.lastTerrain},M.prototype.createTile=function(P,T,E,x){if(!P)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tile","constructor","missingSector"));if(!T)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tile","constructor","The specified level is null or undefined."));if(E<0||x<0)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tile","constructor","The specified row or column is less than zero."));return new _(P,T,E,x)},M.prototype.beginRendering=function(P){var T=P.currentProgram;if(!T){a.logMessage(a.LEVEL_INFO,"Tessellator","beginRendering","Current Program is empty");return}this.buildSharedGeometry(),this.cacheSharedGeometryVBOs(P);var E=P.currentGlContext,x=P.gpuResourceCache;if(this.vertexPointLocation=T.attributeLocation(E,"vertexPoint"),this.vertexTexCoordLocation=T.attributeLocation(E,"vertexTexCoord"),E.enableVertexAttribArray(this.vertexPointLocation),this.vertexTexCoordLocation>=0){var S=x.resourceForKey(this.texCoordVboCacheKey);E.bindBuffer(E.ARRAY_BUFFER,S),E.vertexAttribPointer(this.vertexTexCoordLocation,2,E.FLOAT,!1,0,0),E.enableVertexAttribArray(this.vertexTexCoordLocation)}var L=x.resourceForKey(this.indicesVboCacheKey);E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,L)},M.prototype.endRendering=function(P){var T=P.currentGlContext;T.bindBuffer(T.ARRAY_BUFFER,null),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,null),this.vertexPointLocation>=0&&T.disableVertexAttribArray(this.vertexPointLocation),this.vertexTexCoordLocation>=0&&T.disableVertexAttribArray(this.vertexTexCoordLocation)},M.prototype.beginRenderingTile=function(P,T){if(!T)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tessellator","beginRenderingTile","missingTile"));var E=P.currentGlContext,x=P.gpuResourceCache;this.scratchMatrix.setToMultiply(P.modelviewProjection,T.transformationMatrix),P.currentProgram.loadModelviewProjection(E,this.scratchMatrix);var S=P.globeStateKey+T.tileKey,L=x.resourceForKey(S);L?T.pointsVboStateKey!=T.pointsStateKey?(E.bindBuffer(E.ARRAY_BUFFER,L),E.bufferSubData(E.ARRAY_BUFFER,0,T.points),T.pointsVboStateKey=T.pointsStateKey):P.currentGlContext.bindBuffer(E.ARRAY_BUFFER,L):(L=E.createBuffer(),E.bindBuffer(E.ARRAY_BUFFER,L),E.bufferData(E.ARRAY_BUFFER,T.points,E.STATIC_DRAW),P.frameStatistics.incrementVboLoadCount(1),x.putResource(S,L,T.points.length*4),T.pointsVboStateKey=T.pointsStateKey),E.vertexAttribPointer(this.vertexPointLocation,3,E.FLOAT,!1,0,0)},M.prototype.endRenderingTile=function(P,T){},M.prototype.renderTile=function(P,T){if(!T)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tessellator","renderTile","missingTile"));var E=P.currentGlContext,x=E.TRIANGLE_STRIP;E.drawElements(x,this.numBaseIndices,E.UNSIGNED_SHORT,this.baseIndicesOffset*2);var S=T.level,L;L=T.neighborLevel(WorldWind.NORTH),L&&L.compare(S)<0?E.drawElements(x,this.numIndicesLoresNorth,E.UNSIGNED_SHORT,this.indicesLoresNorthOffset*2):E.drawElements(x,this.numIndicesNorth,E.UNSIGNED_SHORT,this.indicesNorthOffset*2),L=T.neighborLevel(WorldWind.SOUTH),L&&L.compare(S)<0?E.drawElements(x,this.numIndicesLoresSouth,E.UNSIGNED_SHORT,this.indicesLoresSouthOffset*2):E.drawElements(x,this.numIndicesSouth,E.UNSIGNED_SHORT,this.indicesSouthOffset*2),L=T.neighborLevel(WorldWind.WEST),L&&L.compare(S)<0?E.drawElements(x,this.numIndicesLoresWest,E.UNSIGNED_SHORT,this.indicesLoresWestOffset*2):E.drawElements(x,this.numIndicesWest,E.UNSIGNED_SHORT,this.indicesWestOffset*2),L=T.neighborLevel(WorldWind.EAST),L&&L.compare(S)<0?E.drawElements(x,this.numIndicesLoresEast,E.UNSIGNED_SHORT,this.indicesLoresEastOffset*2):E.drawElements(x,this.numIndicesEast,E.UNSIGNED_SHORT,this.indicesEastOffset*2)},M.prototype.renderWireframeTile=function(P,T){if(!T)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tessellator","renderWireframeTile","missingTile"));var E=P.currentGlContext;this.vertexTexCoordLocation>=0&&E.disableVertexAttribArray(this.vertexTexCoordLocation),E.drawElements(E.LINES,this.numWireframeIndices,E.UNSIGNED_SHORT,this.wireframeIndicesOffset*2)},M.prototype.renderTileOutline=function(P,T){if(!T)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tessellator","renderTileOutline","missingTile"));var E=P.currentGlContext;this.vertexTexCoordLocation>=0&&E.disableVertexAttribArray(this.vertexTexCoordLocation),E.drawElements(E.LINE_LOOP,this.numOutlineIndices,E.UNSIGNED_SHORT,this.outlineIndicesOffset*2)},M.prototype.pick=function(P,T,E){if(!P)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tessellator","pick","missingDc"));if(!T)throw new l(a.logMessage(a.LEVEL_SEVERE,"Tessellator","pick","missingList"));for(var x=null,S=E||this,L=new h(0,0,0),C=[],F=0,q=T.length;F<q;F++){var it=T[F];it.extent.intersectsFrustum(P.pickFrustum)&&C.push(it)}if(P.pickTerrainOnly||(x=P.uniquePickColor(),this.drawPickTiles(P,C,x)),!P.regionPicking){var st=P.pickRay.clone(),pt=this.computeNearestIntersection(st,C);pt&&(P.globe.computePositionFromPoint(pt[0],pt[1],pt[2],L),L.altitude=P.globe.elevationAtLocation(L.latitude,L.longitude),P.addPickedObject(new d(x,S,L,null,!0)))}},M.prototype.drawPickTiles=function(P,T,E){var x=P.currentGlContext;try{P.findAndBindProgram(n),P.currentProgram.loadColor(x,E),this.beginRendering(P);for(var S=0,L=T.length;S<L;S++){var C=T[S];this.beginRenderingTile(P,C),this.renderTile(P,C),this.endRenderingTile(P,C)}}finally{this.endRendering(P)}},M.prototype.computeNearestIntersection=function(P,T){for(var E=[],x=0,S=T.length;x<S;x++)this.computeIntersections(P,T[x],E);if(E.length==0)return null;var L=Number.POSITIVE_INFINITY,C;for(x=0,S=E.length;x<S;x++){var F=P.origin.distanceToSquared(E[x]);L>F&&(L=F,C=x)}return E[C]},M.prototype.computeIntersections=function(P,T,E){var x=T.level,S,L=T.points,C,F=E.length;P.origin.subtract(T.referencePoint),this.buildSharedGeometry(T),C=this.baseIndices,b.computeTriStripIntersections(P,L,C,E),S=T.neighborLevel(WorldWind.SOUTH),C=S&&S.compare(x)<0?this.indicesLoresSouth:this.indicesSouth,b.computeTriStripIntersections(P,L,C,E),S=T.neighborLevel(WorldWind.WEST),C=S&&S.compare(x)<0?this.indicesLoresWest:this.indicesWest,b.computeTriStripIntersections(P,L,C,E),S=T.neighborLevel(WorldWind.EAST),C=S&&S.compare(x)<0?this.indicesLoresEast:this.indicesEast,b.computeTriStripIntersections(P,L,C,E),S=T.neighborLevel(WorldWind.NORTH),C=S&&S.compare(x)<0?this.indicesLoresNorth:this.indicesNorth,b.computeTriStripIntersections(P,L,C,E),P.origin.add(T.referencePoint);for(var q=F,it=E.length;q<it;q++)E[q].add(T.referencePoint)},M.prototype.createTopLevelTiles=function(P){this.topLevelTiles[P.globeStateKey]=[],v.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles[P.globeStateKey])},M.prototype.addTileOrDescendants=function(P,T){if(this.tileMeetsRenderCriteria(P,T)){this.addTile(P,T);return}this.addTileDescendants(P,T)},M.prototype.addTileDescendants=function(P,T){for(var E=T.level.nextLevel(),x=T.subdivideToCache(E,this,this.tileCache),S=0;S<x.length;S+=1){var L=x[S];L.update(P),this.levels.sector.intersects(L.sector)&&this.isTileVisible(P,L)&&this.addTileOrDescendants(P,L)}},M.prototype.addTile=function(P,T){var E=this.tiles.length;this.tiles.push(T);var x=T.sector,S=[x.maxLatitude,x.maxLongitude].toString(),L=[x.minLatitude,x.maxLongitude].toString(),C=[x.maxLatitude,x.minLongitude].toString(),F=[x.minLatitude,x.minLongitude].toString(),q;q=this.corners[F],q?q.sw=E:this.corners[F]={sw:E},q=this.corners[C],q?q.nw=E:this.corners[C]={nw:E},q=this.corners[L],q?q.se=E:this.corners[L]={se:E},q=this.corners[S],q?q.ne=E:this.corners[S]={ne:E}},M.prototype.refineNeighbors=function(P){for(var T={},E=0,x=this.tiles.length;E<x;E+=1){var S=this.tiles[E],L=S.level.levelNumber,C=S.sector,F,q,E,x,it=[C.maxLatitude,C.maxLongitude].toString(),st=[C.minLatitude,C.maxLongitude].toString(),pt=[C.maxLatitude,C.minLongitude].toString(),_t=[C.minLatitude,C.minLongitude].toString();F=this.corners[it],F.hasOwnProperty("se")&&(q=F.se,this.tiles[q].level.levelNumber<L-1&&(T[q]||(T[q]=!0))),F.hasOwnProperty("nw")&&(q=F.nw,this.tiles[q].level.levelNumber<L-1&&(T[q]||(T[q]=!0))),F=this.corners[st],F.hasOwnProperty("ne")&&(q=F.ne,this.tiles[q].level.levelNumber<L-1&&(T[q]||(T[q]=!0))),F.hasOwnProperty("sw")&&(q=F.sw,this.tiles[q].level.levelNumber<L-1&&(T[q]||(T[q]=!0))),F=this.corners[pt],F.hasOwnProperty("ne")&&(q=F.ne,this.tiles[q].level.levelNumber<L-1&&(T[q]||(T[q]=!0))),F.hasOwnProperty("sw")&&(q=F.sw,this.tiles[q].level.levelNumber<L-1&&(T[q]||(T[q]=!0))),F=this.corners[_t],F.hasOwnProperty("se")&&(q=F.se,this.tiles[q].level.levelNumber<L-1&&(T[q]||(T[q]=!0))),F.hasOwnProperty("nw")&&(q=F.nw,this.tiles[q].level.levelNumber<L-1&&(T[q]||(T[q]=!0)))}var X=[],ot=[];for(E=0,x=this.tiles.length;E<x;E+=1)S=this.tiles[E],T[E]?X.push(S):ot.push(S);if(X.length>0){for(this.tiles=[],this.corners={},E=0,x=ot.length;E<x;E+=1)S=ot[E],this.addTile(P,S);for(E=0,x=X.length;E<x;E+=1){var S=X[E];this.addTileDescendants(P,S)}this.refineNeighbors(P)}},M.prototype.finishTessellating=function(P){for(var T=0,E=this.tiles.length;T<E;T+=1){var x=this.tiles[T];this.setNeighbors(x),this.regenerateTileGeometryIfNeeded(P,x),this.currentTiles.addTile(x)}},M.prototype.setNeighbors=function(P){var T=P.sector,E=[T.maxLatitude,T.maxLongitude].toString(),x=[T.minLatitude,T.maxLongitude].toString(),S=[T.maxLatitude,T.minLongitude].toString(),L=[T.minLatitude,T.minLongitude].toString(),C=this.corners[E],F=this.corners[x],q=this.corners[S],it=this.corners[L],st=-1,pt=-1,_t=-1,X=-1;C.hasOwnProperty("se")?st=C.se:q.hasOwnProperty("sw")&&(st=q.sw),F.hasOwnProperty("ne")?pt=F.ne:it.hasOwnProperty("nw")&&(pt=it.nw),C.hasOwnProperty("nw")?_t=C.nw:F.hasOwnProperty("sw")&&(_t=F.sw),q.hasOwnProperty("ne")?X=q.ne:it.hasOwnProperty("se")&&(X=it.se),P.setNeighborLevel(WorldWind.NORTH,st>=0?this.tiles[st].level:null),P.setNeighborLevel(WorldWind.SOUTH,pt>=0?this.tiles[pt].level:null),P.setNeighborLevel(WorldWind.EAST,_t>=0?this.tiles[_t].level:null),P.setNeighborLevel(WorldWind.WEST,X>=0?this.tiles[X].level:null)},M.prototype.isTileVisible=function(P,T){return P.globe.projectionLimits&&!T.sector.overlaps(P.globe.projectionLimits)?!1:T.extent.intersectsFrustum(P.frustumInModelCoordinates)},M.prototype.tileMeetsRenderCriteria=function(P,T){var E=this.detailControl;return(T.sector.minLatitude>=75||T.sector.maxLatitude<=-75)&&(E*=2),T.level.isLastLevel()||!T.mustSubdivide(P,E)},M.prototype.regenerateTileGeometryIfNeeded=function(P,T){var E=P.globeStateKey+T.stateKey+P.verticalExaggeration;(!T.points||T.pointsStateKey!=E)&&(this.regenerateTileGeometry(P,T),T.pointsStateKey=E)},M.prototype.coverageTargetResolution=function(P){return P/8*p.RADIANS_TO_DEGREES},M.prototype.regenerateTileGeometry=function(P,T){var E=T.tileHeight+1,x=T.tileWidth+1,S=T.referencePoint,L=this.scratchElevations;L||(L=new Float64Array(E*x),this.scratchElevations=L),T.points||(T.points=new Float32Array(E*x*3)),R.fillArray(L,0),P.globe.elevationsForGrid(T.sector,E,x,this.coverageTargetResolution(T.texelSize),L),this.mustAlignNeighborElevations(P,T)&&this.alignNeighborElevations(P,T,L),R.multiplyArray(L,P.verticalExaggeration),P.globe.computePointsForGrid(T.sector,E,x,L,S,T.points),T.transformationMatrix.setTranslation(S[0],S[1],S[2])},M.prototype.mustAlignNeighborElevations=function(P,T){var E=T.level,x=T.neighborLevel(WorldWind.NORTH),S=T.neighborLevel(WorldWind.SOUTH),L=T.neighborLevel(WorldWind.EAST),C=T.neighborLevel(WorldWind.WEST);return x&&x.compare(E)<0||S&&S.compare(E)<0||L&&L.compare(E)<0||C&&C.compare(E)<0},M.prototype.alignNeighborElevations=function(P,T,E){var x=T.tileHeight+1,S=T.tileWidth+1,L=T.level,C=Math.floor(x/2)+1,F=Math.floor(S/2)+1,q=L.previousLevel(),it=this.scratchPrevElevations,st,pt,_t,X;if(it||(it=new Float64Array(C*F),this.scratchPrevElevations=it),R.fillArray(it,0),P.globe.elevationsForGrid(T.sector,C,F,this.coverageTargetResolution(q.texelSize),it),st=T.neighborLevel(WorldWind.NORTH),st&&st.compare(L)<0)for(_t=(x-1)*S,X=(C-1)*F,pt=0;pt<F;pt++,_t+=2,X+=1)E[_t]=it[X],pt<F-1&&(E[_t+1]=.5*(it[X]+it[X+1]));if(st=T.neighborLevel(WorldWind.SOUTH),st&&st.compare(L)<0)for(_t=0,X=0,pt=0;pt<F;pt++,_t+=2,X+=1)E[_t]=it[X],pt<F-1&&(E[_t+1]=.5*(it[X]+it[X+1]));if(st=T.neighborLevel(WorldWind.EAST),st&&st.compare(L)<0)for(_t=S-1,X=F-1,pt=0;pt<C;pt++,_t+=2*S,X+=F)E[_t]=it[X],pt<C-1&&(E[_t+S]=.5*(it[X]+it[X+F]));if(st=T.neighborLevel(WorldWind.WEST),st&&st.compare(L)<0)for(_t=0,X=0,pt=0;pt<C;pt++,_t+=2*S,X+=F)E[_t]=it[X],pt<C-1&&(E[_t+S]=.5*(it[X]+it[X+F]))},M.prototype.buildSharedGeometry=function(){var P=this.levels.tileWidth,T=this.levels.tileHeight;this.texCoords||this.buildTexCoords(P,T),this.indices||this.buildIndices(P,T)},M.prototype.buildTexCoords=function(P,T){for(var E=P+1,x=T+1,S=1/P,L=1/T,C=new Float32Array(E*x*2),F=0,q=0,it=0;q<x;q++,it+=L){q==x-1&&(it=1);for(var st=0,pt=0;st<E;st++,pt+=S)st==E-1&&(pt=1),C[F++]=pt,C[F++]=it}this.texCoords=C},M.prototype.buildIndices=function(P,T){for(var E,x=T+1,S=P+1,L=T/2,C=P/2,F=2*(x-3)*(S-2)+2*(x-3),q=[],it=0,st=1;st<S-2;st+=1){for(var pt=1;pt<x-1;pt+=1)E=st+pt*S,q[it++]=E,q[it++]=E+1;q[it++]=E+1,E=st+1+1*S,q[it++]=E}for(this.baseIndicesOffset=q.length-F,this.baseIndices=new Uint16Array(q.slice(this.baseIndicesOffset)),this.numBaseIndices=F,F=2*S-2,pt=x-1,st=S-1,E=st+pt*S,q[it++]=E,st=S-2;st>0;st-=1)E=st+pt*S,q[it++]=E,q[it++]=E-S;for(st=0,E=st+pt*S,q[it++]=E,this.indicesNorthOffset=q.length-F,this.indicesNorth=new Uint16Array(q.slice(this.indicesNorthOffset)),this.numIndicesNorth=F,F=2*S-2,pt=0,st=0,E=st+pt*S,q[it++]=E,st=1;st<S-1;st+=1)E=st+pt*S,q[it++]=E,q[it++]=E+S;for(st=S-1,E=st+pt*S,q[it++]=E,this.indicesSouthOffset=q.length-F,this.indicesSouth=new Uint16Array(q.slice(this.indicesSouthOffset)),this.numIndicesSouth=F,F=2*x-2,st=0,pt=x-1,E=st+pt*S,q[it++]=E,pt=x-2;pt>0;pt-=1)E=st+pt*S,q[it++]=E,q[it++]=E+1;for(pt=0,E=st+pt*S,q[it++]=E,this.indicesWestOffset=q.length-F,this.indicesWest=new Uint16Array(q.slice(this.indicesWestOffset)),this.numIndicesWest=F,F=2*x-2,st=S-1,pt=0,E=st+pt*S,q[it++]=E,pt=1;pt<x-1;pt+=1)E=st+pt*S,q[it++]=E,q[it++]=E-1;for(pt=x-1,E=st+pt*S,q[it++]=E,this.indicesEastOffset=q.length-F,this.indicesEast=new Uint16Array(q.slice(this.indicesEastOffset)),this.numIndicesEast=F,F=2*S-2,pt=x-1,st=S-1,E=st+pt*S,q[it++]=E,st=S-2;st>0;st-=1)E=(st+1&-2)+pt*S,q[it++]=E,E=st+(pt-1)*S,q[it++]=E;for(st=0,E=st+pt*S,q[it++]=E,this.indicesLoresNorthOffset=q.length-F,this.indicesLoresNorth=new Uint16Array(q.slice(this.indicesLoresNorthOffset)),this.numIndicesLoresNorth=F,F=2*S-2,pt=0,st=0,E=st+pt*S,q[it++]=E,st=1;st<S-1;st+=1)E=(st&-2)+pt*S,q[it++]=E,E=st+(pt+1)*S,q[it++]=E;for(st=S-1,E=st+pt*S,q[it++]=E,this.indicesLoresSouthOffset=q.length-F,this.indicesLoresSouth=new Uint16Array(q.slice(this.indicesLoresSouthOffset)),this.numIndicesLoresSouth=F,F=2*x-2,st=0,pt=x-1,E=st+pt*S,q[it++]=E,pt=x-2;pt>0;pt-=1)E=st+(pt+1&-2)*S,q[it++]=E,E=st+1+pt*S,q[it++]=E;for(pt=0,E=st+pt*S,q[it++]=E,this.indicesLoresWestOffset=q.length-F,this.indicesLoresWest=new Uint16Array(q.slice(this.indicesLoresWestOffset)),this.numIndicesLoresWest=F,F=2*x-2,st=S-1,pt=0,E=st+pt*S,q[it++]=E,pt=1;pt<x-1;pt+=1)E=st+(pt&-2)*S,q[it++]=E,E=st-1+pt*S,q[it++]=E;pt=x-1,E=st+pt*S,q[it++]=E,this.indicesLoresEastOffset=q.length-F,this.indicesLoresEast=new Uint16Array(q.slice(this.indicesLoresEastOffset)),this.numIndicesLoresEast=F;var _t=this.buildWireframeIndices(P,T),X=this.buildOutlineIndices(P,T);q=q.concat(_t),this.wireframeIndicesOffset=q.length-this.numWireframeIndices,q=q.concat(X),this.outlineIndicesOffset=q.length-this.numOutlineIndices,this.indices=new Uint16Array(q)},M.prototype.buildWireframeIndices=function(P,T){var E=T+1,x=P+1,S=2*P*E+2*T*x,L=[],C=x,F=0,q,it,st;for(it=0;it<E;it+=1)for(q=0;q<P;q+=1)st=q+it*C,L[F]=st,L[F+1]=st+1,F+=2;for(q=0;q<x;q+=1)for(it=0;it<T;it+=1)st=q+it*C,L[F]=st,L[F+1]=st+C,F+=2;return this.numWireframeIndices=S,L},M.prototype.buildOutlineIndices=function(P,T){var E=T+1,x=P+1,S=2*(E-2)+2*x+1,L=[],C=E,F=0,q,it,st;for(it=0,q=0;q<x;q+=1)st=q+it*x,L[F]=st,F+=1;for(q=x-1,it=1;it<E;it+=1)st=q+it*x,L[F]=st,F+=1;for(it=E-1,q=x-1;q>=0;q-=1)st=q+it*x,L[F]=st,F+=1;for(q=0,it=E-1;it>=0;it-=1)st=q+it*x,L[F]=st,F+=1;return this.numOutlineIndices=S,L},M.prototype.cacheSharedGeometryVBOs=function(P){var T=P.currentGlContext,E=P.gpuResourceCache,x=E.resourceForKey(this.texCoordVboCacheKey);x||(x=T.createBuffer(),T.bindBuffer(T.ARRAY_BUFFER,x),T.bufferData(T.ARRAY_BUFFER,this.texCoords,T.STATIC_DRAW),P.frameStatistics.incrementVboLoadCount(1),E.putResource(this.texCoordVboCacheKey,x,this.texCoords.length*4/2));var S=E.resourceForKey(this.indicesVboCacheKey);S||(S=T.createBuffer(),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,S),T.bufferData(T.ELEMENT_ARRAY_BUFFER,this.indices,T.STATIC_DRAW),P.frameStatistics.incrementVboLoadCount(1),E.putResource(this.indicesVboCacheKey,S,this.indices.length*2))},M}),B("globe/Globe",["../geom/Angle","../error/ArgumentError","../geom/BoundingBox","../globe/ElevationModel","../geom/Line","../geom/Location","../util/Logger","../geom/Position","../projections/ProjectionWgs84","../geom/Sector","../globe/Tessellator","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o,c,d){"use strict";var h=function(u,m){if(!u)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","constructor","Elevation model is null or undefined."));this.elevationModel=u,this.equatorialRadius=WorldWind.WGS84_SEMI_MAJOR_AXIS;var g=1/WorldWind.WGS84_INVERSE_FLATTENING;this.polarRadius=this.equatorialRadius*(1-g),this.eccentricitySquared=2*g-g*g,this.tessellator=new o,this._projection=m||new a,this._offset=0,this.offsetVector=new c(0,0,0),this.id=++h.idPool,this._stateKey="globe "+this.id.toString()+" "};return h.idPool=0,Object.defineProperties(h.prototype,{stateKey:{get:function(){return this._stateKey+this.elevationModel.stateKey+"offset "+this.offset.toString()+" "+this.projection.stateKey}},continuous:{get:function(){return this.projection.continuous}},projection:{get:function(){return this._projection},set:function(u){if(!u)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","projection","missingProjection"));this.projection!=u&&(this.tessellator=new o),this._projection=u}},projectionLimits:{get:function(){return this._projection.projectionLimits}},offset:{get:function(){return this._offset},set:function(u){this._offset=u,this.offsetVector[0]=u*2*Math.PI*this.equatorialRadius}}}),h.prototype.is2D=function(){return this.projection.is2D},h.prototype.computePointFromPosition=function(u,m,g,_){if(!_)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","computePointFromPosition","missingResult"));return this.projection.geographicToCartesian(this,u,m,g,this.offsetVector,_)},h.prototype.computePointFromLocation=function(u,m,g){if(!g)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","computePointFromLocation","missingResult"));return this.computePointFromPosition(u,m,0,g)},h.prototype.computePointsForGrid=function(u,m,g,_,y,v){if(!u)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","computePointsFromPositions","missingSector"));if(m<1||g<1)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","computePointsFromPositions","Number of latitude or longitude locations is less than one."));var b=m*g;if(!_||_.length<b)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","computePointsFromPositions","Elevations array is null, undefined or insufficient length."));if(!v||v.length<b)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","computePointsFromPositions","Result array is null, undefined or insufficient length."));return this.projection.geographicToCartesianGrid(this,u,m,g,_,y,this.offsetVector,v)},h.prototype.computePositionFromPoint=function(u,m,g,_){if(!_)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","computePositionFromPoint","missingResult"));return this.projection.cartesianToGeographic(this,u,m,g,this.offsetVector,_),this.continuous&&(_.longitude<-180?_.longitude+=360:_.longitude>180&&(_.longitude-=360)),_},h.prototype.radiusAt=function(u,m){var g=Math.sin(u*p.DEGREES_TO_RADIANS),_=this.equatorialRadius/Math.sqrt(1-this.eccentricitySquared*g*g);return _*Math.sqrt(1+(this.eccentricitySquared*this.eccentricitySquared-2*this.eccentricitySquared)*g*g)},h.prototype.surfaceNormalAtLocation=function(u,m,g){if(!g)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","surfaceNormalAtLocation","missingResult"));if(this.projection.surfaceNormalAtLocation)return this.projection.surfaceNormalAtLocation(this,u,m,g);if(this.is2D())return g[0]=0,g[1]=0,g[2]=1,g;var _=Math.cos(u*p.DEGREES_TO_RADIANS),y=Math.cos(m*p.DEGREES_TO_RADIANS),v=Math.sin(u*p.DEGREES_TO_RADIANS),b=Math.sin(m*p.DEGREES_TO_RADIANS);return g[0]=_*b,g[1]=v,g[2]=_*y,g.normalize()},h.prototype.surfaceNormalAtPoint=function(u,m,g,_){if(!_)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","surfaceNormalAtPoint","missingResult"));if(this.projection.surfaceNormalAtPoint)return this.projection.surfaceNormalAtPoint(this,u,m,g,_);if(this.is2D())return _[0]=0,_[1]=0,_[2]=1,_;var y=this.equatorialRadius*this.equatorialRadius,v=this.polarRadius*this.polarRadius;return _[0]=u/y,_[1]=m/v,_[2]=g/y,_.normalize()},h.prototype.northTangentAtLocation=function(u,m,g){if(!g)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","northTangentAtLocation","missingResult"));return this.projection.northTangentAtLocation(this,u,m,g)},h.prototype.northTangentAtPoint=function(u,m,g,_){if(!_)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","northTangentAtPoint","missingResult"));return this.projection.northTangentAtPoint(this,u,m,g,this.offsetVector,_)},h.prototype.intersectsFrustum=function(u){if(!u)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","intersectsFrustum","missingFrustum"));if(this.is2D()){var m=new n;return m.setToSector(f.FULL_SPHERE,this,this.elevationModel.minElevation,this.elevationModel.maxElevation),m.intersectsFrustum(u)}return!(u.far.distance<=this.equatorialRadius||u.left.distance<=this.equatorialRadius||u.right.distance<=this.equatorialRadius||u.top.distance<=this.equatorialRadius||u.bottom.distance<=this.equatorialRadius||u.near.distance<=this.equatorialRadius)},h.prototype.intersectsLine=function(u,m){if(!u)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","intersectWithRay","missingLine"));if(!m)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","intersectsLine","missingResult"));var g=u.direction[0],_=u.direction[1],y=u.direction[2],v=u.origin[0],b=u.origin[1],R=u.origin[2],M;if(this.is2D())return y==0&&R!=0||(M=-R/y,M<0)?!1:(m[0]=v+g*M,m[1]=b+_*M,m[2]=R+y*M,!0);var P=this.equatorialRadius,T=P*P,E=P/this.polarRadius,x=E*E,S,L,C,F;return S=g*g+x*_*_+y*y,L=2*(v*g+x*b*_+R*y),C=v*v+x*b*b+R*R-T,F=L*L-4*S*C,F<0?!1:(M=(-L-Math.sqrt(F))/(2*S),M>0||(M=(-L+Math.sqrt(F))/(2*S),M>0)?(m[0]=v+g*M,m[1]=b+_*M,m[2]=R+y*M,!0):!1)},h.prototype.elevationTimestamp=function(){return this.elevationModel.timestamp},h.prototype.minElevation=function(){return this.elevationModel.minElevation},h.prototype.maxElevation=function(){return this.elevationModel.maxElevation},h.prototype.minAndMaxElevationsForSector=function(u){if(!u)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","minAndMaxElevationsForSector","missingSector"));return this.elevationModel.minAndMaxElevationsForSector(u)},h.prototype.elevationAtLocation=function(u,m){return this.elevationModel.elevationAtLocation(u,m)},h.prototype.elevationsForGrid=function(u,m,g,_,y){if(!u)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","elevationsForSector","missingSector"));if(m<=0||g<=0)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","elevationsForSector","numLat or numLon is less than 1"));if(!y||y.length<m*g)throw new l(r.logMessage(r.LEVEL_SEVERE,"Globe","elevationsForSector","missingArray"));return this.elevationModel.elevationsForGrid(u,m,g,_,y)},h}),B("cache/GpuResourceCache",["../util/AbsentResourceList","../error/ArgumentError","../util/ImageSource","../util/Logger","../cache/MemoryCache","../render/Texture"],function(p,l,n,e,i,t){"use strict";var r=function(s,a){if(!s||s<1)throw new l(e.logMessage(e.LEVEL_SEVERE,"GpuResourceCache","constructor","Specified cache capacity is undefined, 0 or negative."));if(!a||a<0||a>=s)throw new l(e.logMessage(e.LEVEL_SEVERE,"GpuResourceCache","constructor","Specified cache low-water value is undefined, negative or not less than the capacity."));this.entries=new i(s,a),this.cacheKeyPool=0,this.currentRetrievals={},this.absentResourceList=new p(3,6e4)};return Object.defineProperties(r.prototype,{capacity:{get:function(){return this.entries.capacity}},lowWater:{get:function(){return this.entries.lowWater}},usedCapacity:{get:function(){return this.entries.usedCapacity}},freeCapacity:{get:function(){return this.entries.freeCapacity}}}),r.prototype.generateCacheKey=function(){return"GpuResourceCache "+ ++this.cacheKeyPool},r.prototype.putResource=function(s,a,f){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"GpuResourceCache","putResource","missingKey."));if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"GpuResourceCache","putResource","missingResource."));if(!f||f<1)throw new l(e.logMessage(e.LEVEL_SEVERE,"GpuResourceCache","putResource","The specified resource size is undefined or less than 1."));var o={resource:a};this.entries.putEntry(s instanceof n?s.key:s,o,f)},r.prototype.resourceForKey=function(s){var a=s instanceof n?this.entries.entryForKey(s.key):this.entries.entryForKey(s),f=a?a.resource:null;return f!==null&&typeof f.clearTexParameters=="function"&&f.clearTexParameters(),f},r.prototype.setResourceAgingFactor=function(s,a){this.entries.setEntryAgingFactor(s,a)},r.prototype.containsResource=function(s){return this.entries.containsKey(s instanceof n?s.key:s)},r.prototype.removeResource=function(s){this.entries.removeEntry(s instanceof n?s.key:s)},r.prototype.clear=function(){this.entries.clear(!1)},r.prototype.retrieveTexture=function(s,a,f){if(!a)return null;if(a instanceof n){var o=new t(s,a.image,f);return this.putResource(a.key,o,o.size),o}if(this.currentRetrievals[a]||this.absentResourceList.isResourceAbsent(a))return null;var c=this,d=new Image;return d.onload=function(){e.log(e.LEVEL_INFO,"Image retrieval succeeded: "+a);var h=new t(s,d,f);c.putResource(a,h,h.size),delete c.currentRetrievals[a],c.absentResourceList.unmarkResourceAbsent(a);var u=document.createEvent("Event");u.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(u)},d.onerror=function(){delete c.currentRetrievals[a],c.absentResourceList.markResourceAbsent(a),e.log(e.LEVEL_WARNING,"Image retrieval failed: "+a)},this.currentRetrievals[a]=a,d.crossOrigin="anonymous",d.src=a,null},r}),B("pick/PickedObjectList",[],function(){"use strict";var p=function(){this.objects=[]};return p.prototype.hasNonTerrainObjects=function(){return this.objects.length>1||this.objects.length===1&&this.terrainObject()==null},p.prototype.terrainObject=function(){for(var l=0,n=this.objects.length;l<n;l++)if(this.objects[l].isTerrain)return this.objects[l];return null},p.prototype.add=function(l){if(l)if(l.isTerrain){for(var n=this.objects.length,e=0,i=this.objects.length;e<i;e++)if(this.objects[e].isTerrain){n=e;break}this.objects[n]=l}else this.objects.push(l)},p.prototype.clear=function(){this.objects=[]},p.prototype.topPickedObject=function(){var l=this.objects.length;if(l>1){for(var n=0;n<l;n++)if(this.objects[n].isOnTop)return this.objects[n]}return l>0?this.objects[0]:null},p}),B("render/ScreenCreditController",["../error/ArgumentError","../util/Color","../util/Font","../layer/Layer","../util/Logger","../util/Offset","../shapes/ScreenText"],function(p,l,n,e,i,t,r){"use strict";var s=function(){e.call(this,"ScreenCreditController"),this.creditPlacement=new t(WorldWind.OFFSET_PIXELS,11,WorldWind.OFFSET_PIXELS,2),this.creditMargin=11,this.opacity=.5,this.credits=[]};return s.prototype=Object.create(e.prototype),s.prototype.clear=function(){this.credits=[]},s.prototype.addCredit=function(a,f,o){if(!a)throw new p(i.logMessage(i.LEVEL_SEVERE,"ScreenCreditController","addCredit","missingText"));if(!f)throw new p(i.logMessage(i.LEVEL_SEVERE,"ScreenCreditController","addCredit","missingColor"));for(var c=0,d=this.credits.length;c<d;c++)if(this.credits[c].text===a)return;var h=new r(new t(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0),a);h.attributes.font=new n(10),h.attributes.color=f,h.attributes.enableOutline=!1,h.attributes.offset=new t(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0),o&&(h.userProperties.url=o),this.credits.push(h)},s.prototype.doRender=function(a){for(var f=this.creditPlacement.offsetForSize(a.viewport.width,a.viewport.height),o=0,c=this.credits.length;o<c;o++)this.credits[o].screenOffset.x=f[0],this.credits[o].screenOffset.y=f[1],this.credits[o].render(a),a.textRenderer.typeFace=this.credits[o].attributes.font,a.textRenderer.outlineWidth=this.credits[o].attributes.outlineWidth,a.textRenderer.enableOutline=this.credits[o].attributes.enableOutline,f[0]+=a.textRenderer.textSize(this.credits[o].text)[0],f[0]+=this.creditMargin},s}),B("util/HashMap",[],function(){"use strict";var p=function(){this._entries=Object.create(null)};return p.prototype.get=function(l){return this._entries[l]},p.prototype.set=function(l,n){this._entries[l]=n},p.prototype.remove=function(l){delete this._entries[l]},p.prototype.contains=function(l){return l in this._entries},p.reIndex=function(l,n,e){var i=new p;for(var t in l._entries){var r=parseInt(t);r>=n&&(r+=e);var s=l.get(t);s.index=r,i.set(r,s)}return i},p}),B("util/PolygonSplitter",["./HashMap","../geom/Location","../geom/Position","./WWMath"],function(p,l,n,e){"use strict";var i={addedIndex:-1,poleIndexOffset:-1,splitContours:function(t,r){for(var s=!1,a=0,f=t.length;a<f;a++){var o=this.splitContour(t[a]);o.polygons.length>1&&(s=!0),r.push(o)}return s},splitContour:function(t){var r=new p,s=[],a=[],f=[],o=[],c=-1,d=this.findIntersectionAndPole(t,s,a,r);return a.length===0?(f.push(s),o.push(r),this.formatContourOutput(f,d,c,o)):(a.length>2&&a.sort(function(h,u){return u.latitude-h.latitude}),d!==l.poles.NONE&&(s=this.handleOnePole(s,a,r,d),r=this.reindexIntersections(a,r,this.poleIndexOffset)),a.length===0?(f.push(s),o.push(r),c=0,this.formatContourOutput(f,d,c,o)):(this.linkIntersections(a,r),c=this.makePolygons(s,a,r,f,o),this.formatContourOutput(f,d,c,o)))},findIntersectionAndPole:function(t,r,s,a){var f=!1,o=90,c=-90;this.addedIndex=-1;for(var d=0,h=t.length;d<h;d++){var u=t[d],m=t[(d+1)%h];o=Math.min(o,u.latitude),c=Math.max(c,u.latitude);var g=l.locationsCrossDateLine([u,m]);if(g){f=!f;var _=l.meridianIntersection(u,m,180);_===null&&(_=(u.latitude+m.latitude)/2);var y=e.signum(u.longitude)*180||180,v=this.createPoint(_,y,u.altitude),b=this.createPoint(_,-y,m.altitude);this.safeAdd(r,u,d,h);var R=r.length;a.set(R,this.makeIntersectionEntry(R)),a.set(R+1,this.makeIntersectionEntry(R+1)),s.push({indexEnd:R,indexStart:R+1,latitude:_}),r.push(v),r.push(b),this.safeAdd(r,m,d+1,h)}else this.safeAdd(r,u,d,h),this.safeAdd(r,m,d+1,h)}var M=l.poles.NONE;return f&&(M=this.determinePole(o,c)),M},determinePole:function(t,r){var s;return t>0?s=l.poles.NORTH:r<0?s=l.poles.SOUTH:Math.abs(r)>=Math.abs(t)?s=l.poles.NORTH:s=l.poles.SOUTH,s},handleOnePole:function(t,r,s,a){var f;if(a===l.poles.NORTH)var o=r.shift(),c=90;else a===l.poles.SOUTH&&(o=r.pop(),c=-90);var d=s.get(o.indexEnd),h=s.get(o.indexStart);d.forPole=!0,h.forPole=!0,this.poleIndexOffset=o.indexStart,f=t.slice(0,o.indexEnd+1);var u=this.createPoint(c,t[d.index].longitude,t[d.index].altitude),m=this.createPoint(c,t[h.index].longitude,t[h.index].altitude);return f.push(u,m),f=f.concat(t.slice(this.poleIndexOffset)),f},linkIntersections:function(t,r){for(var s=0;s<t.length-1;s+=2){var a=t[s],f=t[s+1],o=r.get(a.indexEnd),c=r.get(a.indexStart),d=r.get(f.indexEnd),h=r.get(f.indexStart);o.linkTo=f.indexStart,c.linkTo=f.indexEnd,d.linkTo=a.indexStart,h.linkTo=a.indexEnd}},reindexIntersections:function(t,r,s){r=p.reIndex(r,s,2);for(var a=0,f=t.length;a<f;a++)t[a].indexEnd>=s&&(t[a].indexEnd+=2),t[a].indexStart>=s&&(t[a].indexStart+=2);return r},makePolygons:function(t,r,s,a,f){for(var o=-1,c=0;c<r.length-1;c+=2){var d=r[c],h=r[c+1],u=d.indexStart,m=h.indexEnd,g=[],_=new p,y=this.makePolygon(u,m,t,s,g,_);g.length&&(a.push(g),f.push(_),y&&(o=a.length-1)),u=h.indexStart,m=d.indexEnd,g=[],_=new p,y=this.makePolygon(u,m,t,s,g,_),g.length&&(a.push(g),f.push(_),y&&(o=a.length-1))}return o},makePolygon:function(t,r,s,a,f,o){var c=!1,d=s.length,h=!1;r<t&&(r+=d);for(var u=t;u<=r;u++){var m=u%d,g=s[m],_=a.get(m);if(_){if(_.visited)break;if(f.push(g),o.set(f.length-1,_),_.forPole)h=!0;else{if(c&&(u=_.linkTo-1,u+1===t))break;c=!c,_.visited=!0}}else f.push(g)}return h},safeAdd:function(t,r,s,a){this.addedIndex<s&&this.addedIndex<a-1&&(t.push(r),this.addedIndex=s)},createPoint:function(t,r,s){return s==null?new l(t,r):new n(t,r,s)},formatContourOutput:function(t,r,s,a){return{polygons:t,pole:r,poleIndex:s,iMap:a}},makeIntersectionEntry:function(t){return t==null&&(t=-1),{visited:!1,forPole:!1,index:t,linkTo:-1}}};return i}),B("shapes/ShapeAttributes",["../util/Color","../util/ImageSource"],function(p,l){"use strict";var n=function(e){this._drawInterior=e?e._drawInterior:!0,this._drawOutline=e?e._drawOutline:!0,this._enableLighting=e?e._enableLighting:!1,this._interiorColor=e?e._interiorColor.clone():p.WHITE.clone(),this._outlineColor=e?e._outlineColor.clone():p.RED.clone(),this._outlineWidth=e?e._outlineWidth:1,this._outlineStippleFactor=e?e._outlineStippleFactor:0,this._outlineStipplePattern=e?e._outlineStipplePattern:61680,this._imageSource=e?e._imageSource:null,this._depthTest=e?e._depthTest:!0,this._drawVerticals=e?e._drawVerticals:!1,this._applyLighting=e?e._applyLighting:!1,this.stateKeyInvalid=!0};return n.prototype.computeStateKey=function(){return"di "+this._drawInterior+" do "+this._drawOutline+" el "+this._enableLighting+" ic "+this._interiorColor.toHexString(!0)+" oc "+this._outlineColor.toHexString(!0)+" ow "+this._outlineWidth+" osf "+this._outlineStippleFactor+" osp "+this._outlineStipplePattern+" is "+(this._imageSource?this.imageSource instanceof l?this.imageSource.key:this.imageSource:"null")+" dt "+this._depthTest+" dv "+this._drawVerticals+" li "+this._applyLighting},Object.defineProperties(n.prototype,{stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}},drawInterior:{get:function(){return this._drawInterior},set:function(e){this._drawInterior=e,this.stateKeyInvalid=!0}},drawOutline:{get:function(){return this._drawOutline},set:function(e){this._drawOutline=e,this.stateKeyInvalid=!0}},enableLighting:{get:function(){return this._enableLighting},set:function(e){this._enableLighting=e,this.stateKeyInvalid=!0}},interiorColor:{get:function(){return this._interiorColor},set:function(e){this._interiorColor=e,this.stateKeyInvalid=!0}},outlineColor:{get:function(){return this._outlineColor},set:function(e){this._outlineColor=e,this.stateKeyInvalid=!0}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth=e,this.stateKeyInvalid=!0}},outlineStipplePattern:{get:function(){return this._outlineStipplePattern},set:function(e){this._outlineStipplePattern=e,this.stateKeyInvalid=!0}},outlineStippleFactor:{get:function(){return this._outlineStippleFactor},set:function(e){this._outlineStippleFactor=e,this.stateKeyInvalid=!0}},imageSource:{get:function(){return this._imageSource},set:function(e){this._imageSource=e,this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(e){this._depthTest=e,this.stateKeyInvalid=!0}},drawVerticals:{get:function(){return this._drawVerticals},set:function(e){this._drawVerticals=e,this.stateKeyInvalid=!0}},applyLighting:{get:function(){return this._applyLighting},set:function(e){this._applyLighting=e,this.stateKeyInvalid=!0}}}),n}),B("shapes/SurfaceShape",["../error/AbstractError","../geom/Angle","../error/ArgumentError","../geom/BoundingBox","../util/Color","../geom/Location","../util/Logger","../cache/MemoryCache","../error/NotYetImplementedError","../pick/PickedObject","../util/PolygonSplitter","../render/Renderable","../geom/Sector","../shapes/ShapeAttributes","../error/UnsupportedOperationError","../geom/Vec3"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m){"use strict";var g=function(_){c.call(this),this._displayName="Surface Shape",this._attributes=_||new h(null),this._highlightAttributes=null,this._highlighted=!1,this._enabled=!0,this._pathType=WorldWind.GREAT_CIRCLE,this._maximumNumEdgeIntervals=g.DEFAULT_NUM_EDGE_INTERVALS,this._polarThrottle=g.DEFAULT_POLAR_THROTTLE,this._boundingSector=null,this.pickDelegate=null,this._boundingSectors=[],this._locations=null,this._boundaries=null,this._interiorGeometry=null,this._outlineGeometry=null,this._isInteriorInhibited=!1,this.stateKeyInvalid=!0,this._attributesStateKey=null,this.boundariesArePrepared=!1,this.layer=null,this.pickColor=null,this.contours=[],this.containsPole=!1,this.crossesAntiMeridian=!1,this.expirationInterval=2e3,this.shapeDataCache=new s(3,2),this.currentData=null};return g.prototype=Object.create(c.prototype),Object.defineProperties(g.prototype,{stateKey:{get:function(){if(!this._attributesStateKey)this._highlighted?this._highlightAttributes&&(this._attributesStateKey=this._highlightAttributes.stateKey):this._attributes&&(this._attributesStateKey=this._attributes.stateKey),this._attributesStateKey&&(this.stateKeyInvalid=!0);else{var _=null;this._highlighted?this._highlightAttributes&&(_=this._highlightAttributes.stateKey):this._attributes&&(_=this._attributes.stateKey),_!=this._attributesStateKey&&(this._attributesStateKey=_,this.stateKeyInvalid=!0)}return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey()),this._stateKey}},displayName:{get:function(){return this._displayName},set:function(_){this.stateKeyInvalid=!0,this._displayName=_}},attributes:{get:function(){return this._attributes},set:function(_){this.stateKeyInvalid=!0,this._attributes=_,this._attributesStateKey=_.stateKey}},highlightAttributes:{get:function(){return this._highlightAttributes},set:function(_){this.stateKeyInvalid=!0,this._highlightAttributes=_}},highlighted:{get:function(){return this._highlighted},set:function(_){this.stateKeyInvalid=!0,this._highlighted=_}},enabled:{get:function(){return this._enabled},set:function(_){this.stateKeyInvalid=!0,this._enabled=_}},pathType:{get:function(){return this._pathType},set:function(_){this.stateKeyInvalid=!0,this.resetBoundaries(),this._pathType=_}},maximumNumEdgeIntervals:{get:function(){return this._maximumNumEdgeIntervals},set:function(_){this.stateKeyInvalid=!0,this.resetBoundaries(),this._maximumNumEdgeIntervals=_}},polarThrottle:{get:function(){return this._polarThrottle},set:function(_){this.stateKeyInvalid=!0,this.resetBoundaries(),this._polarThrottle=_}},boundingSector:{get:function(){return this._boundingSector}}}),g.staticStateKey=function(_){return _.stateKeyInvalid=!1,_.highlighted&&_._highlightAttributes?_._attributesStateKey=_._highlightAttributes.stateKey:_._attributes?_._attributesStateKey=_._attributes.stateKey:_._attributesStateKey=null,"dn "+_.displayName+" at "+(_._attributesStateKey?_._attributesStateKey:"null")+" hi "+_.highlighted+" en "+_.enabled+" pt "+_.pathType+" ne "+_.maximumNumEdgeIntervals+" po "+_.polarThrottle+" se ["+_.boundingSector.minLatitude+","+_.boundingSector.maxLatitude+","+_.boundingSector.minLongitude+","+_.boundingSector.maxLongitude+"]"},g.prototype.computeStateKey=function(){return g.staticStateKey(this)},g.prototype.area=function(_,y){throw new a(r.logMessage(r.LEVEL_SEVERE,"SurfaceShape","area","notYetImplemented"))},g.prototype.computeBoundaries=function(_){throw new p(r.logMessage(r.LEVEL_SEVERE,"SurfaceShape","computeBoundaries","abstractInvocation"))},g.prototype.intersectsFrustum=function(_){return this.currentData&&this.currentData.extent?_.pickingMode?this.currentData.extent.intersectsFrustum(_.pickFrustum):this.currentData.extent.intersectsFrustum(_.frustumInModelCoordinates):!0},g.prototype.isShapeDataCurrent=function(_,y){return y.verticalExaggeration===_.verticalExaggeration&&y.expiryTime>Date.now()},g.prototype.createShapeDataObject=function(){return{}},g.prototype.resetExpiration=function(_){_.expiryTime=Date.now()+this.expirationInterval+1e3*Math.random()},g.prototype.establishCurrentData=function(_){this.currentData=this.shapeDataCache.entryForKey(_.globeStateKey),this.currentData||(this.currentData=this.createShapeDataObject(),this.resetExpiration(this.currentData),this.shapeDataCache.putEntry(_.globeStateKey,this.currentData,1)),this.currentData.isExpired=!this.isShapeDataCurrent(_,this.currentData)},g.prototype.render=function(_){this.enabled&&(this.layer=_.currentLayer,this.prepareBoundaries(_),this.establishCurrentData(_),(this.currentData.isExpired||!this.currentData.extent)&&(this.computeExtent(_),this.currentData.verticalExaggeration=_.verticalExaggeration,this.resetExpiration(this.currentData)),!(this.currentData&&this.currentData.extent&&!this.intersectsFrustum(_))&&_.surfaceShapeTileBuilder.insertSurfaceShape(this))},g.prototype.interpolateLocations=function(_){var y=_[0],v=y,b,R=!0,M=!0,P=0,T=!0,E,x;for(this._locations=[y],E=1,x=_.length;E<x;E+=1)b=v,M=R,v=_[E],R=v.latitude==y.latitude&&v.longitude==y.longitude,T=!0,(R||M)&&(P+=1,P>2&&(T=!1)),T&&this.interpolateEdge(b,v,this._locations),this._locations.push(v),b=v;this._isInteriorInhibited||(b.latitude!=y.latitude||b.longitude!=y.longitude)&&(this.interpolateEdge(b,y,this._locations),this._locations.push(y))},g.prototype.interpolateEdge=function(_,y,v){var b=t.greatCircleDistance(_,y),R=Math.round(this._maximumNumEdgeIntervals*b/Math.PI),M,P;if(R>0){M=1/R,P=_;for(var T=this.throttledStep(M,P);T<1;T+=this.throttledStep(M,P))P=new t(0,0),t.interpolateAlongPath(this._pathType,T,_,y,P),_.longitude===180&&y.longitude===180?P.longitude=180:_.longitude===-180&&y.longitude===-180&&(P.longitude=-180),v.push(P)}},g.prototype.throttledStep=function(_,y){var v=Math.cos(y.latitude*l.DEGREES_TO_RADIANS);v*=v;var b=this._polarThrottle/(1+this._polarThrottle);return _*(1-b+b*v)},g.prototype.prepareBoundaries=function(_){if(!this.boundariesArePrepared){this.computeBoundaries(_);var y=this.formatBoundaries();this.normalizeAngles(y),y=this.interpolateBoundaries(y);var v=[],b=o.splitContours(y,v);this.contours=v,this.crossesAntiMeridian=b,this.prepareGeometry(_,v),this.prepareSectors(),this.boundariesArePrepared=!0}},g.prototype.formatBoundaries=function(){var _=[];return this._boundaries.length&&(this._boundaries[0].latitude!=null?_.push(this._boundaries):_=this._boundaries),_},g.prototype.resetBoundaries=function(){this.boundariesArePrepared=!1,this.shapeDataCache.clear(!1)},g.prototype.normalizeAngles=function(_){for(var y=0,v=_.length;y<v;y++)for(var b=_[y],R=0,M=b.length;R<M;R++){var P=b[R];(P.longitude<-180||P.longitude>180)&&(P.longitude=l.normalizedDegreesLongitude(P.longitude)),(P.latitude<-90||P.latitude>90)&&(P.latitude=l.normalizedDegreesLatitude(P.latitude))}},g.prototype.interpolateBoundaries=function(_){for(var y=[],v=0,b=_.length;v<b;v++){var R=_[v];this.interpolateLocations(R),y.push(this._locations.slice()),this._locations.length=0}return y},g.prototype.computeSectors=function(_){return this._boundingSectors&&this._boundingSectors.length>0?this._boundingSectors:(this.prepareBoundaries(_),this._boundingSectors)},g.prototype.computeExtent=function(_){if(!this._boundingSectors||this._boundingSectors.length===0||!this.currentData)return null;this.currentData.extent||(this.currentData.extent=new e);var y;if(this._boundingSectors.length===1)y=this._boundingSectors[0].computeBoundingPoints(_.globe,_.verticalExaggeration),this.currentData.extent.setToVec3Points(y);else{for(var v=[],b=0;b<this._boundingSectors.length;b++){y=this._boundingSectors[b].computeBoundingPoints(_.globe,_.verticalExaggeration);var R=new e;R.setToVec3Points(y);for(var M=R.getCorners(),P=0;P<M.length;P++)v.push(M[P])}this.currentData.extent.setToVec3Points(v)}return this.currentData.extent},g.prototype.computeShiftedLocations=function(_,y,v,b){for(var R=[],M=new m(0,0,0),P=new WorldWind.Position(0,0,0),T=_.computePointFromLocation(y.latitude,y.longitude,new m(0,0,0)),E=_.computePointFromLocation(v.latitude,v.longitude,new m(0,0,0)),x=E.subtract(T),S=0,L=b.length;S<L;S++)_.computePointFromLocation(b[S].latitude,b[S].longitude,M),M.add(x),_.computePositionFromPoint(M[0],M[1],M[2],P),R.push(new t(P.latitude,P.longitude));return R},g.prototype.prepareSectors=function(){this.determineSectors(),this.crossesAntiMeridian?this.sectorsOverAntiMeridian():this.sectorsNotOverAntiMeridian()},g.prototype.determineSectors=function(){for(var _=0,y=this.contours.length;_<y;_++){var v=this.contours[_],b=v.polygons;v.sectors=[];for(var R=0,M=b.length;R<M;R++){var P=b[R],T=new d(0,0,0,0);if(T.setToBoundingSector(P),this._pathType===WorldWind.GREAT_CIRCLE){var E=t.greatCircleArcExtremeLocations(P),x=Math.min(T.minLatitude,E[0].latitude),S=Math.max(T.maxLatitude,E[1].latitude);T.minLatitude=x,T.maxLatitude=S}v.sectors.push(T)}}},g.prototype.sectorsOverAntiMeridian=function(){for(var _=new d(90,-90,180,-180),y=new d(90,-90,180,-180),v=0,b=this.contours.length;v<b;v++)for(var R=this.contours[v].sectors,M=0,P=R.length;M<P;M++){var T=R[M];T.minLongitude<0&&T.maxLongitude>0?(y.union(T),_.union(T)):T.minLongitude<0?y.union(T):_.union(T)}var E=Math.min(_.minLatitude,y.minLatitude),x=Math.max(_.maxLatitude,_.maxLatitude);this._boundingSector=new d(E,x,-180,180),this._boundingSectors=[_,y]},g.prototype.sectorsNotOverAntiMeridian=function(){this._boundingSector=new d(90,-90,180,-180);for(var _=0,y=this.contours.length;_<y;_++)for(var v=this.contours[_].sectors,b=0,R=v.length;b<R;b++)this._boundingSector.union(v[b]);this._boundingSectors=[this._boundingSector]},g.prototype.prepareGeometry=function(_,y){for(var v=[],b=[],R=0,M=y.length;R<M;R++)for(var P=y[R],T=P.poleIndex,E=0,x=P.polygons.length;E<x;E++){var S=P.polygons[E],L=P.iMap[E];v.push(S),P.pole!==t.poles.NONE&&x>1?E===T?this.outlineForPole(S,L,b):this.outlineForSplit(S,L,b):P.pole!==t.poles.NONE&&x===1?this.outlineForPole(S,L,b):P.pole===t.poles.NONE&&x>1?this.outlineForSplit(S,L,b):P.pole===t.poles.NONE&&x===1&&b.push(S)}this._interiorGeometry=v,this._outlineGeometry=b},g.prototype.outlineForPole=function(_,y,v){this.containsPole=!0;for(var b=[],R=0,M=0,P=_.length;M<P;M++){var T=_[M],E=y.get(M);E&&E.forPole&&(R++,R%2===1&&(b.push(T),v.push(b),b=[])),R%2===0&&b.push(T)}b.length&&v.push(b)},g.prototype.outlineForSplit=function(_,y,v){for(var b=[],R=0,M=0,P=_.length;M<P;M++){var T=_[M],E=y.get(M);E&&!E.forPole&&(R++,R%2===0&&(b.push(T),v.push(b),b=[])),R%2===1&&b.push(T)}},g.prototype.resetPickColor=function(){this.pickColor=null},g.prototype.renderToTexture=function(_,y,v,b,R,M){var P=this._highlighted?this._highlightAttributes||this._attributes:this._attributes;if(P){var T=!this._isInteriorInhibited&&P.drawInterior,E=P.drawOutline&&P.outlineWidth>0;if(!(!T&&!E)){if(_.pickingMode)this.pickColor||(this.pickColor=_.uniquePickColor()),y.fillStyle=this.pickColor.toCssColorString(),y.strokeStyle=y.fillStyle,y.lineWidth=P.outlineWidth;else{var x=P.interiorColor,S=P.outlineColor;y.fillStyle=new i(x.red,x.green,x.blue,x.alpha*this.layer.opacity).toCssColorString(),y.strokeStyle=new i(S.red,S.green,S.blue,S.alpha*this.layer.opacity).toCssColorString(),y.lineWidth=P.outlineWidth}if(this.crossesAntiMeridian||this.containsPole?(T&&(this.draw(this._interiorGeometry,y,v,b,R,M),y.fill()),E&&(this.draw(this._outlineGeometry,y,v,b,R,M),y.stroke())):(this.draw(this._interiorGeometry,y,v,b,R,M),T&&y.fill(),E&&y.stroke()),_.pickingMode){var L=new f(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);_.resolvePick(L)}}}},g.prototype.draw=function(_,y,v,b,R,M){y.beginPath();for(var P=0,T=_.length;P<T;P++){var E=_[P],x=E[0],S=x.longitude*v+R,L=x.latitude*b+M;y.moveTo(S,L);for(var C=1,F=E.length;C<F;C++)x=E[C],S=x.longitude*v+R,L=x.latitude*b+M,y.lineTo(S,L)}},g.DEFAULT_NUM_EDGE_INTERVALS=128,g.DEFAULT_POLAR_THROTTLE=10,g}),B("shapes/SurfaceShapeTile",["../geom/Angle","../error/ArgumentError","../util/Level","../util/Logger","../geom/Sector","../render/Texture","../render/TextureTile"],function(p,l,n,e,i,t,r){"use strict";var s=function(a,f,o,c){r.call(this,a,f,o,c),this.surfaceShapes=[],this.surfaceShapeStateKeys=[],this.asRenderedSurfaceShapeStateKeys=[],this.sector=a,this.cacheKey=null,this.pickSequence=0,this.createCtx2D()};return s.prototype=Object.create(r.prototype),s.prototype.clearShapes=function(){this.surfaceShapes=[],this.surfaceShapeStateKeys=[]},s.prototype.hasShapes=function(){return this.surfaceShapes.length>0},s.prototype.getShapes=function(){return this.surfaceShapes},s.prototype.setShapes=function(a){this.surfaceShapes=a},s.prototype.getSector=function(){return this.sector},s.prototype.addSurfaceShape=function(a){this.surfaceShapes.push(a),this.surfaceShapeStateKeys.push(a.stateKey+" lo "+a.layer.opacity)},s.prototype.needsUpdate=function(a){var f,o,c,d;if(this.surfaceShapes.length!=this.asRenderedSurfaceShapeStateKeys.length)return!0;for(f=0,o=this.surfaceShapes.length;f<o;f+=1)if(this.surfaceShapeStateKeys[f]!==this.asRenderedSurfaceShapeStateKeys[f])return!0;return!this.hasTexture(a)},s.prototype.hasTexture=function(a){return a.pickingMode?!1:(this.gpuCacheKey||(this.gpuCacheKey=this.getCacheKey()),a.gpuResourceCache.containsResource(this.gpuCacheKey))},s.prototype.updateTexture=function(a){var f=a.currentGlContext,o=s.canvas,c=s.ctx2D;o.width=this.tileWidth,o.height=this.tileHeight;var d=this.tileWidth/this.sector.deltaLongitude(),h=-this.tileHeight/this.sector.deltaLatitude(),u=-this.sector.minLongitude*d,m=-this.sector.maxLatitude*h;this.asRenderedSurfaceShapeStateKeys=[];for(var g=0,_=this.surfaceShapes.length;g<_;g+=1){var y=this.surfaceShapes[g];this.asRenderedSurfaceShapeStateKeys.push(this.surfaceShapeStateKeys[g]),y.renderToTexture(a,c,d,h,u,m)}this.gpuCacheKey=this.getCacheKey();var v=a.gpuResourceCache,b=new t(f,o);return v.putResource(this.gpuCacheKey,b,b.size),v.setResourceAgingFactor(this.gpuCacheKey,10),b},s.prototype.getCacheKey=function(){return this.cacheKey||(this.cacheKey="SurfaceShapeTile:"+this.tileKey+","+this.pickSequence.toString()),this.cacheKey},s.prototype.createCtx2D=function(){s.ctx2D||(s.canvas=document.createElement("canvas"),s.ctx2D=s.canvas.getContext("2d"))},s.canvas=null,s.ctx2D=null,s}),B("shapes/SurfaceShapeTileBuilder",["../error/ArgumentError","../render/DrawContext","../globe/Globe","../shaders/GpuProgram","../util/Level","../util/LevelSet","../geom/Location","../util/Logger","../geom/Matrix","../cache/MemoryCache","../error/NotYetImplementedError","../pick/PickedObject","../geom/Rectangle","../geom/Sector","../shapes/SurfaceShape","../shapes/SurfaceShapeTile","../globe/Terrain","../globe/TerrainTile","../globe/TerrainTileList","../render/TextureTile","../util/Tile"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m,g,_,y,v,b){"use strict";var R=function(){this.numRowsTilesInTopLevel=4,this.numColumnsTilesInTopLevel=8,this.maximumSubdivisionDepth=15,this.tileWidth=256,this.tileHeight=256,this.levels=new t(h.FULL_SPHERE,new r(180/this.numRowsTilesInTopLevel,360/this.numColumnsTilesInTopLevel),this.maximumSubdivisionDepth,this.tileWidth,this.tileHeight),this.surfaceShapes=[],this.surfaceShapeTiles=[],this.topLevelTiles=[],this.sector=new h(-90,90,-180,180),this.detailControl=1.25,this.tileCache=new f(5e5,4e5)};return R.prototype.clear=function(){this.surfaceShapeTiles.splice(0,this.surfaceShapeTiles.length),this.surfaceShapes.splice(0,this.surfaceShapes.length)},R.prototype.insertSurfaceShape=function(M){this.surfaceShapes.push(M)},R.prototype.doRender=function(M){if(M.pickingMode){for(var P=0,T=this.surfaceShapes.length;P<T;P+=1)this.surfaceShapes[P].resetPickColor();R.pickSequence+=1;var E=this.surfaceShapeTiles,x=this.topLevelTiles;this.surfaceShapeTiles=[],this.topLevelTiles=[],this.buildTiles(M),M.deepPicking?this.doDeepPickingRender(M):M.surfaceTileRenderer.renderTiles(M,this.surfaceShapeTiles,1),this.surfaceShapeTiles=E,this.topLevelTiles=x}else this.buildTiles(M),M.surfaceTileRenderer.renderTiles(M,this.surfaceShapeTiles,1)},R.prototype.doDeepPickingRender=function(M){var P,T,E,x,S,L,C,F,q,it=[];for(S=0,L=M.objectsAtPickPoint.objects.length;S<L;S+=1)C=M.objectsAtPickPoint.objects[S],C.userObject instanceof u&&(F=C.userObject,it.indexOf(F)<0&&(it.push(F),M.objectsAtPickPoint.objects.splice(S,1),S-=1,L-=1));if(!(it.length<=0)){var st=[];for(E=0,x=it.length;E<x;E+=1){for(F=it[E],P=0,T=this.surfaceShapeTiles.length;P<T;P+=1)q=this.surfaceShapeTiles[P],q.setShapes([F]),q.updateTexture(M);M.surfaceTileRenderer.renderTiles(M,this.surfaceShapeTiles,1);var pt=M.readPickColor(M.pickPoint);pt&&F.pickColor.equals(pt)&&(C=new c(F.pickColor.clone(),F.pickDelegate?F.pickDelegate:F,null,F.layer,!1),st.push(C))}for(S=0,L=M.objectsAtPickPoint.objects.length;S<L;S+=1)C=M.objectsAtPickPoint.objects[S],C.userObject instanceof u&&(M.objectsAtPickPoint.objects.splice(S,1),S-=1,L-=1);for(S=0,L=st.length;S<L;S+=1)C=st[S],M.objectsAtPickPoint.objects.push(C)}},R.prototype.buildTiles=function(M){if(!M)throw new p(s.logMessage(s.LEVEL_SEVERE,"SurfaceShapeTileBuilder","buildTiles","missingDc"));if(!(!this.surfaceShapes||this.surfaceShapes.length<1)){this.assembleTiles(M),this.surfaceShapes.splice(0,this.surfaceShapes.length);for(var P=0,T=this.surfaceShapeTiles.length;P<T;P+=1){var E=this.surfaceShapeTiles[P];E.clearShapes()}}},R.prototype.assembleTiles=function(M){var P,T,E,x,S,L,C;this.topLevelTiles.length<1&&this.createTopLevelTiles();var F={};for(T=0,E=this.surfaceShapes.length;T<E;T+=1){var q=this.surfaceShapes[T],it=q.computeSectors(M);if(it)for(L=0,C=it.length;L<C;L+=1){var st=it[L];for(x=0,S=this.topLevelTiles.length;x<S;x+=1)if(P=this.topLevelTiles[x],P.sector.intersects(st)){var pt=P.tileKey;F[pt]=P,P.addSurfaceShape(q)}}}for(var _t in F)F.hasOwnProperty(_t)&&(P=F[_t],this.addTileOrDescendants(M,this.levels,null,P))},R.prototype.addTileOrDescendants=function(M,P,T,E){if(!this.intersectsFrustum(M,E)){E.clearShapes();return}if(T!=null&&this.addIntersectingShapes(M,T,E),!!E.hasShapes()){if(this.meetsRenderCriteria(M,P,E)){this.addTile(M,E);return}for(var x=P.level(E.level.levelNumber+1),S=M.pickingMode?E.subdivide(x,this):E.subdivideToCache(x,this,this.tileCache),L=0,C=S.length;L<C;L+=1){var F=S[L];this.addTileOrDescendants(M,P,E,F)}E.clearShapes()}},R.prototype.addIntersectingShapes=function(M,P,T){for(var E=P.getShapes(),x=0,S=E.length;x<S;x+=1){var L=E[x],C=L.computeSectors(M);if(C)for(var F=0,q=C.length;F<q;F+=1){var it=C[F];if(T.getSector().intersects(it)){T.addSurfaceShape(L);break}}}},R.prototype.addTile=function(M,P){M.pickingMode&&(P.pickSequence=R.pickSequence),P.needsUpdate(M)&&P.updateTexture(M),this.surfaceShapeTiles.push(P)},R.prototype.createTile=function(M,P,T,E){return new m(M,P,T,E)},R.prototype.createTopLevelTiles=function(){b.createTilesForLevel(this.levels.firstLevel(),this,this.topLevelTiles)},R.prototype.intersectsFrustum=function(M,P){return M.globe.projectionLimits&&!P.sector.overlaps(M.globe.projectionLimits)?!1:(P.update(M),P.extent.intersectsFrustum(M.pickingMode?M.pickFrustum:M.frustumInModelCoordinates))},R.prototype.meetsRenderCriteria=function(M,P,T){return T.level.levelNumber==P.lastLevel().levelNumber||!T.mustSubdivide(M,this.detailControl)},R.pickSequence=0,R}),B("shaders/SurfaceTileRendererProgram",["../error/ArgumentError","../util/Color","../shaders/GpuProgram","../util/Logger"],function(p,l,n,e){"use strict";var i=function(t){var r="attribute vec4 vertexPoint;\nattribute vec4 vertexTexCoord;\nuniform mat4 mvpMatrix;\nuniform mat4 texSamplerMatrix;\nuniform mat4 texMaskMatrix;\nvarying vec2 texSamplerCoord;\nvarying vec2 texMaskCoord;\nvoid main() {\ngl_Position = mvpMatrix * vertexPoint;\ntexSamplerCoord = (texSamplerMatrix * vertexTexCoord).st;\ntexMaskCoord = (texMaskMatrix * vertexTexCoord).st;\n}",s="precision mediump float;\nuniform sampler2D texSampler;\nuniform float opacity;\nuniform vec4 color;\nuniform bool modulateColor;\nvarying vec2 texSamplerCoord;\nvarying vec2 texMaskCoord;\nbool isInsideTextureImage(const vec2 coord) {\n    return coord.x >= 0.0 && coord.x <= 1.0 && coord.y >= 0.0 && coord.y <= 1.0;\n}\nvoid main(void) {\nfloat mask = float(isInsideTextureImage(texMaskCoord));if (modulateColor) {\n    gl_FragColor = color * mask * floor(texture2D(texSampler, texSamplerCoord).a + 0.5);\n} else {\n    gl_FragColor = texture2D(texSampler, texSamplerCoord) * mask * opacity;\n}\n}";n.call(this,t,r,s),this.vertexPointLocation=this.attributeLocation(t,"vertexPoint"),this.vertexTexCoordLocation=this.attributeLocation(t,"vertexTexCoord"),this.mvpMatrixLocation=this.uniformLocation(t,"mvpMatrix"),this.colorLocation=this.uniformLocation(t,"color"),this.modulateColorLocation=this.uniformLocation(t,"modulateColor"),this.texSamplerMatrixLocation=this.uniformLocation(t,"texSamplerMatrix"),this.texMaskMatrixLocation=this.uniformLocation(t,"texMaskMatrix"),this.texSamplerLocation=this.uniformLocation(t,"texSampler"),this.opacityLocation=this.uniformLocation(t,"opacity"),this.vertexPointLocation=-1};return i.key="WorldWindGpuSurfaceTileRenderingProgram",i.prototype=Object.create(n.prototype),i.prototype.loadModelviewProjection=function(t,r){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(t,r,this.mvpMatrixLocation)},i.prototype.loadTexSamplerMatrix=function(t,r){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadTexSamplerMatrix","missingMatrix"));this.loadUniformMatrix(t,r,this.texSamplerMatrixLocation)},i.prototype.loadTexMaskMatrix=function(t,r){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadTexMaskMatrix","missingMatrix"));this.loadUniformMatrix(t,r,this.texMaskMatrixLocation)},i.prototype.loadTexSampler=function(t,r){t.uniform1i(this.texSamplerLocation,r-WebGLRenderingContext.TEXTURE0)},i.prototype.loadOpacity=function(t,r){t.uniform1f(this.opacityLocation,r)},i.prototype.loadColor=function(t,r){if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"SurfaceTileRendererProgram","loadColor","missingColor"));this.loadUniformColor(t,r,this.colorLocation)},i.prototype.loadModulateColor=function(t,r){t.uniform1i(this.modulateColorLocation,r?1:0)},i}),B("render/SurfaceTileRenderer",["../error/ArgumentError","../util/Logger","../geom/Matrix","../shapes/SurfaceShapeTile","../shaders/SurfaceTileRendererProgram"],function(p,l,n,e,i){"use strict";var t=function(){this.texMaskMatrix=n.fromIdentity(),this.texSamplerMatrix=n.fromIdentity(),this.isSurfaceShapeTileRendering=!1};return t.prototype.renderTiles=function(r,s,a,f){if(!s)throw new p(l.logMessage(l.LEVEL_SEVERE,"SurfaceTileRenderer","renderTiles","Specified surface tiles array is null or undefined."));if(!(s.length<1)){var o=r.terrain,c=r.currentGlContext,d=0,h,u,m,g,_=1;if(o){this.isSurfaceShapeTileRendering=s[0]instanceof e,a*=r.surfaceOpacity,h=this.beginRendering(r,a),o.beginRendering(r);try{for(var y=0,v=o.surfaceGeometry.length;y<v;y++){u=o.surfaceGeometry[y],m=u.sector,o.beginRenderingTile(r,u);try{for(var b=0,R=s.length;b<R;b++)g=s[b],g.sector.overlaps(m)&&g.bind(r)&&(r.pickingMode?g.pickColor&&h.loadColor(c,g.pickColor):f&&g.opacity!=_&&(h.loadOpacity(c,a*g.opacity),_=g.opacity),this.applyTileState(r,u,g),o.renderTile(r,u),++d)}catch(M){console.log(M)}finally{o.endRenderingTile(r,u)}}}catch(M){console.log(M)}finally{o.endRendering(r),this.endRendering(r),r.frameStatistics.incrementRenderedTileCount(d)}}}},t.prototype.beginRendering=function(r,s){var a=r.currentGlContext,f=r.findAndBindProgram(i);return f.loadTexSampler(a,a.TEXTURE0),r.pickingMode&&!this.isSurfaceShapeTileRendering?f.loadModulateColor(a,!0):(f.loadModulateColor(a,!1),f.loadOpacity(a,s)),f},t.prototype.endRendering=function(r){var s=r.currentGlContext;s.bindTexture(s.TEXTURE_2D,null)},t.prototype.applyTileState=function(r,s,a){var f=r.currentGlContext,o=r.currentProgram,c=s.sector,d=c.deltaLatitude(),h=c.deltaLongitude(),u=a.sector,m=u.deltaLatitude(),g=u.deltaLongitude(),_=m>0?m:1,y=g>0?g:1,v=h/y,b=d/_,R=-(u.minLongitude-c.minLongitude)/y,M=-(u.minLatitude-c.minLatitude)/_;this.texMaskMatrix.set(v,0,0,R,0,b,0,M,0,0,1,0,0,0,0,1),this.texSamplerMatrix.setToUnitYFlip(),a.applyInternalTransform(r,this.texSamplerMatrix),this.texSamplerMatrix.multiplyMatrix(this.texMaskMatrix),o.loadTexSamplerMatrix(f,this.texSamplerMatrix),o.loadTexMaskMatrix(f,this.texMaskMatrix)},t}),B("render/TextRenderer",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Logger","../geom/Matrix","../render/Texture","../geom/Vec2"],function(p,l,n,e,i,t,r,s){"use strict";var a=function(f){if(!f)throw new p(i.logMessage(i.LEVEL_SEVERE,"TextRenderer","constructor","missingDc"));this.canvas2D=document.createElement("canvas"),this.ctx2D=this.canvas2D.getContext("2d"),this.dc=f,this.enableOutline=!0,this.lineSpacing=.15,this.outlineColor=new n(0,0,0,.5),this.outlineWidth=4,this.textColor=new n(1,1,1,1),this.typeFace=new e(14)};return a.prototype.textSize=function(f){if(f.length===0)return new s(0,0);this.ctx2D.font=this.typeFace.fontString;for(var o=f.split("\n"),c=o.length*(this.typeFace.size*(1+this.lineSpacing)),d=0,h=0;h<o.length;h++)d=Math.max(d,this.ctx2D.measureText(o[h]).width);return this.enableOutline&&(d+=this.outlineWidth,c+=this.outlineWidth),new s(d,c)},a.prototype.renderText=function(f){if(f&&f.length>0){var o=this.drawText(f);return new r(this.dc.currentGlContext,o)}else return null},a.prototype.drawText=function(f){var o=this.ctx2D,c=this.canvas2D,d=this.textSize(f),h=f.split("\n"),u=this.enableOutline?this.outlineWidth/2:0,m=this.dc.pixelScale;c.width=Math.ceil(d[0])*m,c.height=Math.ceil(d[1])*m,o.scale(m,m),o.font=this.typeFace.fontString,o.textBaseline="bottom",o.textAlign=this.typeFace.horizontalAlignment,o.fillStyle=this.textColor.toCssColorString(),o.strokeStyle=this.outlineColor.toCssColorString(),o.lineWidth=this.outlineWidth,o.lineCap="round",o.lineJoin="round",this.typeFace.horizontalAlignment==="left"?o.translate(u,0):this.typeFace.horizontalAlignment==="right"?o.translate(d[0]-u,0):o.translate(d[0]/2,0);for(var g=0;g<h.length;g++)o.translate(0,this.typeFace.size*(1+this.lineSpacing)+u),this.enableOutline&&o.strokeText(h[g],0,0),o.fillText(h[g],0,0);return c},a.prototype.getMaxLineHeight=function(){return this.textSize("_\xC9")[1]},a.prototype.wrap=function(f,o,c){if(!f)throw new p(i.logMessage(i.WARNING,"TextRenderer","wrap","missing text"));var d,h=f.split("\n"),u="";for(d=0;d<h.length;d++)h[d]=this.wrapLine(h[d],o);var m=0,g=!1,_=this.getMaxLineHeight();for(d=0;d<h.length&&!g;d++){for(var y=h[d].split("\n"),v=0;v<y.length&&!g;v++)c<=0||m+_<=c?(u+=y[v],m+=_+this.lineSpacing,v<y.length-1&&(u+="\n")):g=!0;d<h.length-1&&!g&&(u+="\n")}return g&&(u.length>0&&(u=u.substring(0,u.length-1)),u+="..."),u},a.prototype.wrapLine=function(f,o){var c="",d=f.trim(),h=this.textSize(d);if(h[0]>o){for(var u="",m=0,g=d.indexOf(" ",m+1);m<d.length;){g===-1&&(g=d.length);var _=d.substring(m,g),y=u+_;this.textSize(y)[0]<=o?u+=_:(u.length!==0&&(c+=u,c+="\n",u=""),u+=_.trim()),m=g,m<d.length-1&&(g=d.indexOf(" ",m+1))}c+=u}else c+=d;return c},a}),B("render/DrawContext",["../error/ArgumentError","../util/Color","../util/FrameStatistics","../render/FramebufferTexture","../render/FramebufferTileController","../geom/Frustum","../globe/Globe","../shaders/GpuProgram","../cache/GpuResourceCache","../layer/Layer","../geom/Line","../util/Logger","../geom/Matrix","../pick/PickedObjectList","../geom/Plane","../geom/Position","../geom/Rectangle","../render/ScreenCreditController","../geom/Sector","../shapes/SurfaceShape","../shapes/SurfaceShapeTileBuilder","../render/SurfaceTileRenderer","../render/TextRenderer","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m,g,_,y,v,b,R,M,P,T,E){"use strict";var x=function(S){if(!S)throw new p(c.logMessage(c.LEVEL_SEVERE,"Texture","constructor","missingGlContext"));this.currentGlContext=S,this.canvas2D=document.createElement("canvas"),this.ctx2D=this.canvas2D.getContext("2d"),this.clearColor=l.TRANSPARENT,this.gpuResourceCache=new a(WorldWind.configuration.gpuCacheSize,.8*WorldWind.configuration.gpuCacheSize),this.surfaceTileRenderer=new R,this.surfaceShapeTileBuilder=new b,this.surfaceShapeTileController=new i,this.screenCreditController=new _,this.textRenderer=new M(this),this.currentFramebuffer=null,this.currentProgram=null,this.surfaceRenderables=[],this.orderedRenderingMode=!1,this.orderedRenderables=[],this.orderedRenderablesCounter=0,this.timestamp=Date.now(),this.previousRedrawTimestamp=this.timestamp,this.redrawRequested=!1,this.globe=null,this.globeStateKey=null,this.layers=null,this.currentLayer=null,this.eyePosition=new m(0,0,0),this.eyePoint=new T(0,0,0),this.screenProjection=d.fromIdentity(),this.terrain=null,this.verticalExaggeration=1,this.fadeTime=500,this.surfaceOpacity=1,this.frameStatistics=null,this.pickingMode=!1,this.pickTerrainOnly=!1,this.deepPicking=!1,this.regionPicking=!1,this.pickPoint=null,this.pickRay=null,this.pickRectangle=null,this.pickFramebuffer=null,this.pickFrustum=null,this.pickColor=new l(0,0,0,1),this.objectsAtPickPoint=new h,this.pixelScale=1,this.navigator=null,this.modelview=d.fromIdentity(),this.projection=d.fromIdentity(),this.modelviewProjection=d.fromIdentity(),this.frustumInModelCoordinates=null,this.modelviewNormalTransform=d.fromIdentity(),this.viewport=new g(0,0,0,0),this.pixelSizeFactor=0,this.pixelSizeOffset=0,this.glExtensionsCache={}};return x.unitCubeKey="DrawContextUnitCubeKey",x.unitCubeElementsKey="DrawContextUnitCubeElementsKey",x.unitQuadKey="DrawContextUnitQuadKey",x.unitQuadKey3="DrawContextUnitQuadKey3",x.prototype.reset=function(){this.screenCreditController.clear(),this.surfaceRenderables=[],this.orderedRenderingMode=!1,this.orderedRenderables=[],this.screenRenderables=[],this.orderedRenderablesCounter=0;var S=this.timestamp;this.timestamp=Date.now(),this.timestamp===S&&++this.timestamp,this.redrawRequested=!1,this.globe=null,this.globeStateKey=null,this.layers=null,this.currentLayer=null,this.terrain=null,this.verticalExaggeration=1,this.frameStatistics=null,this.accumulateOrderedRenderables=!0,this.pickingMode=!1,this.pickTerrainOnly=!1,this.deepPicking=!1,this.regionPicking=!1,this.pickPoint=null,this.pickRay=null,this.pickRectangle=null,this.pickFrustum=null,this.pickColor=new l(0,0,0,1),this.objectsAtPickPoint.clear(),this.eyePoint.set(0,0,0),this.modelview.setToIdentity(),this.projection.setToIdentity(),this.modelviewProjection.setToIdentity(),this.frustumInModelCoordinates=null,this.modelviewNormalTransform.setToIdentity()},x.prototype.update=function(){var S=this.currentGlContext,L=this.eyePoint;this.globeStateKey=this.globe.stateKey,this.globe.computePositionFromPoint(L[0],L[1],L[2],this.eyePosition),this.screenProjection.setToScreenProjection(S.drawingBufferWidth,S.drawingBufferHeight)},x.prototype.contextLost=function(){this.gpuResourceCache.clear(),this.pickFramebuffer=null,this.currentFramebuffer=null,this.currentProgram=null,this.glExtensionsCache={}},x.prototype.contextRestored=function(){this.gpuResourceCache.clear(),this.glExtensionsCache={}},x.prototype.bindFramebuffer=function(S){this.currentFramebuffer!=S&&(this.currentGlContext.bindFramebuffer(this.currentGlContext.FRAMEBUFFER,S?S.framebufferId:null),this.currentFramebuffer=S)},x.prototype.bindProgram=function(S){this.currentProgram!=S&&(this.currentGlContext.useProgram(S?S.programId:null),this.currentProgram=S)},x.prototype.findAndBindProgram=function(S){if(!S)throw new p(c.logMessage(c.LEVEL_SEVERE,"DrawContext","findAndBindProgram","The specified program constructor is null or undefined."));var L=this.gpuResourceCache.resourceForKey(S.key);if(L)this.bindProgram(L);else try{L=new S(this.currentGlContext),this.bindProgram(L),this.gpuResourceCache.putResource(S.key,L,L.size)}catch(C){c.log(c.LEVEL_SEVERE,"Error attempting to create GPU program.")}return L},x.prototype.addSurfaceRenderable=function(S){S&&this.surfaceRenderables.push(S)},x.prototype.peekSurfaceRenderable=function(){return this.surfaceRenderables.length>0?this.surfaceRenderables[this.surfaceRenderables.length-1]:null},x.prototype.popSurfaceRenderable=function(){return this.surfaceRenderables.length>0?this.surfaceRenderables.pop():null},x.prototype.reverseSurfaceRenderables=function(){this.surfaceRenderables.reverse()},x.prototype.addOrderedRenderable=function(S,L){if(S){var C={orderedRenderable:S,insertionOrder:this.orderedRenderablesCounter++,eyeDistance:L||S.eyeDistance,globeStateKey:this.globeStateKey};this.globe.continuous&&(C.globeOffset=this.globe.offset),C.eyeDistance===0?this.screenRenderables.push(C):this.orderedRenderables.push(C)}},x.prototype.addOrderedRenderableToBack=function(S){if(S){var L={orderedRenderable:S,insertionOrder:this.orderedRenderablesCounter++,eyeDistance:Number.MAX_VALUE,globeStateKey:this.globeStateKey};this.globe.continuous&&(L.globeOffset=this.globe.offset),this.orderedRenderables.push(L)}},x.prototype.peekOrderedRenderable=function(){return this.orderedRenderables.length>0?this.orderedRenderables[this.orderedRenderables.length-1].orderedRenderable:null},x.prototype.popOrderedRenderable=function(){if(this.orderedRenderables.length>0){var S=this.orderedRenderables.pop();return this.globeStateKey=S.globeStateKey,this.globe.continuous&&(this.globe.offset=S.globeOffset),S.orderedRenderable}else return null},x.prototype.nextScreenRenderable=function(){if(this.screenRenderables.length>0){var S=this.screenRenderables.shift();return this.globeStateKey=S.globeStateKey,this.globe.continuous&&(this.globe.offset=S.globeOffset),S.orderedRenderable}else return null},x.prototype.sortOrderedRenderables=function(){this.orderedRenderables.sort(function(S,L){var C=S.eyeDistance,F=L.eyeDistance;if(C<F)return-1;if(C>F)return 1;var q=S.insertionOrder,it=L.insertionOrder;return q>it?-1:q<it?1:0})},x.prototype.readPickColor=function(S){var L=this.convertPointToViewport(S,new P(0,0)),C=new Uint8Array(4);return this.currentGlContext.readPixels(L[0],L[1],1,1,this.currentGlContext.RGBA,this.currentGlContext.UNSIGNED_BYTE,C),this.clearColor.equalsBytes(C)?null:l.colorFromByteArray(C)},x.prototype.readPickColors=function(S){var L=this.currentGlContext,C=new Uint8Array(S.width*S.height*4),F={},q,it=new l(0,0,0,0),st=L.getParameter(L.PACK_ALIGNMENT);L.pixelStorei(L.PACK_ALIGNMENT,1),this.currentGlContext.readPixels(S.x,S.y,S.width,S.height,L.RGBA,L.UNSIGNED_BYTE,C),L.pixelStorei(L.PACK_ALIGNMENT,st);for(var pt=0,_t=S.width*S.height;pt<_t;pt++){var X=pt*4;q=l.colorFromBytes(C[X],C[X+1],C[X+2],C[X+3]),!(q.equals(this.clearColor)||q.equals(it))&&(F[q.toByteString()]=q)}return F},x.prototype.resolvePick=function(S){if(!(S.userObject instanceof v)&&this.deepPicking&&!this.regionPicking){var L=this.readPickColor(this.pickPoint);if(!L)return null;S.color.equals(L)&&this.addPickedObject(S)}else this.addPickedObject(S)},x.prototype.addPickedObject=function(S){S&&this.objectsAtPickPoint.add(S)},x.prototype.uniquePickColor=function(){var S=this.pickColor.nextColor().clone();return S.equals(this.clearColor)?S.nextColor():S},x.prototype.makePickFramebuffer=function(){var S=this.currentGlContext,L=S.drawingBufferWidth,C=S.drawingBufferHeight;return(!this.pickFramebuffer||this.pickFramebuffer.width!=L||this.pickFramebuffer.height!=C)&&(this.pickFramebuffer=new e(S,L,C,!0)),this.pickFramebuffer},x.prototype.makePickFrustum=function(){if(!this.pickPoint&&!this.pickRectangle)return!1;var S,L,C,F,q,it,st,pt,_t,X,ot,Tt,Vt,Gt,qt,Qt,ne,j,J,at,xt,Rt=new T(0,0,0),Lt=2,te=new T(0,0,0),zt,ee=this.pickRectangle,$=this.viewport;ee||(zt=this.convertPointToViewport(this.pickPoint,new P(0,0)),ee=new g(zt[0]-Lt,zt[1]-Lt,2*Lt,2*Lt));var N=ee.x,K=ee.x+ee.width,k=ee.y,Y=ee.y+ee.height;if(K<0||Y<0||N>$.x+$.width||k>$.y+$.height)return!1;ee.x=E.clamp(N,$.x,$.x+$.width),ee.y=E.clamp(k,$.y,$.y+$.height),ee.width=E.clamp(K,$.x,$.x+$.width)-ee.x,ee.height=E.clamp(Y,$.y,$.y+$.height)-ee.y,this.pickRectangle=ee;var ht=d.fromIdentity();return ht.invertMatrix(this.modelviewProjection),te[0]=ee.x,te[1]=ee.y,te[2]=0,ht.unProject(te,$,S=new T(0,0,0)),te[0]=ee.x,te[1]=ee.y,te[2]=1,ht.unProject(te,$,L=new T(0,0,0)),te[0]=ee.x+ee.width,te[1]=ee.y,te[2]=0,ht.unProject(te,$,C=new T(0,0,0)),te[0]=ee.x+ee.width,te[1]=ee.y,te[2]=1,ht.unProject(te,$,F=new T(0,0,0)),te[0]=ee.x,te[1]=ee.y+ee.height,te[2]=0,ht.unProject(te,$,q=new T(0,0,0)),te[0]=ee.x,te[1]=ee.y+ee.height,te[2]=1,ht.unProject(te,$,it=new T(0,0,0)),te[0]=ee.x+ee.width,te[1]=ee.y+ee.height,te[2]=0,ht.unProject(te,$,st=new T(0,0,0)),te[0]=ee.x+ee.width,te[1]=ee.y+ee.height,te[2]=1,ht.unProject(te,$,pt=new T(0,0,0)),xt=new T(it[0]-S[0],it[1]-S[1],it[2]-S[2]),Rt.set(q[0]-L[0],q[1]-L[1],q[2]-L[2]),_t=xt.cross(Rt),qt=new u(_t[0],_t[1],_t[2],-_t.dot(S)),qt.normalize(),xt=new T(st[0]-F[0],st[1]-F[1],st[2]-F[2]),Rt.set(pt[0]-C[0],pt[1]-C[1],pt[2]-C[2]),X=xt.cross(Rt),Qt=new u(X[0],X[1],X[2],-X.dot(C)),Qt.normalize(),xt=new T(it[0]-st[0],it[1]-st[1],it[2]-st[2]),Rt.set(pt[0]-q[0],pt[1]-q[1],pt[2]-q[2]),ot=xt.cross(Rt),ne=new u(ot[0],ot[1],ot[2],-ot.dot(q)),ne.normalize(),xt=new T(F[0]-S[0],F[1]-S[1],F[2]-S[2]),Rt.set(L[0]-C[0],L[1]-C[1],L[2]-C[2]),Tt=xt.cross(Rt),j=new u(Tt[0],Tt[1],Tt[2],-Tt.dot(C)),j.normalize(),xt=new T(q[0]-C[0],q[1]-C[1],q[2]-C[2]),Rt.set(st[0]-S[0],st[1]-S[1],st[2]-S[2]),Vt=xt.cross(Rt),J=new u(Vt[0],Vt[1],Vt[2],-Vt.dot(S)),J.normalize(),xt=new T(pt[0]-L[0],pt[1]-L[1],pt[2]-L[2]),Rt.set(it[0]-F[0],it[1]-F[1],it[2]-F[2]),Gt=xt.cross(Rt),at=new u(Gt[0],Gt[1],Gt[2],-Gt.dot(L)),at.normalize(),this.pickFrustum=new t(qt,Qt,j,ne,J,at),!0},x.prototype.isSmall=function(S,L){if(!S)return!1;var C=this.eyePoint.distanceTo(S.center),F=this.pixelSizeAtDistance(C);return 2*S.radius<L*F},x.prototype.unitCubeBuffer=function(){var S=this.gpuResourceCache.resourceForKey(x.unitCubeKey);if(!S){var L=this.currentGlContext,C=new Float32Array(24),F=0;C[F++]=0,C[F++]=1,C[F++]=0,C[F++]=0,C[F++]=0,C[F++]=0,C[F++]=1,C[F++]=1,C[F++]=0,C[F++]=1,C[F++]=0,C[F++]=0,C[F++]=0,C[F++]=1,C[F++]=1,C[F++]=0,C[F++]=0,C[F++]=1,C[F++]=1,C[F++]=1,C[F++]=1,C[F++]=1,C[F++]=0,C[F]=1,S=L.createBuffer(),L.bindBuffer(L.ARRAY_BUFFER,S),L.bufferData(L.ARRAY_BUFFER,C,L.STATIC_DRAW),L.bindBuffer(L.ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(x.unitCubeKey,S,C.length*4)}return S},x.prototype.unitCubeElements=function(){var S=this.gpuResourceCache.resourceForKey(x.unitCubeElementsKey);if(!S){var L=this.currentGlContext,C=new Int16Array(60),F=0;C[F++]=1,C[F++]=0,C[F++]=3,C[F++]=3,C[F++]=0,C[F++]=2,C[F++]=4,C[F++]=5,C[F++]=6,C[F++]=6,C[F++]=5,C[F++]=7,C[F++]=5,C[F++]=1,C[F++]=7,C[F++]=7,C[F++]=1,C[F++]=3,C[F++]=6,C[F++]=2,C[F++]=4,C[F++]=4,C[F++]=2,C[F++]=0,C[F++]=4,C[F++]=0,C[F++]=5,C[F++]=5,C[F++]=0,C[F++]=1,C[F++]=7,C[F++]=3,C[F++]=6,C[F++]=6,C[F++]=3,C[F++]=2,C[F++]=0,C[F++]=1,C[F++]=1,C[F++]=3,C[F++]=3,C[F++]=2,C[F++]=2,C[F++]=0,C[F++]=4,C[F++]=5,C[F++]=5,C[F++]=7,C[F++]=7,C[F++]=6,C[F++]=6,C[F++]=4,C[F++]=0,C[F++]=4,C[F++]=5,C[F++]=1,C[F++]=2,C[F++]=6,C[F++]=7,C[F]=3,S=L.createBuffer(),L.bindBuffer(L.ELEMENT_ARRAY_BUFFER,S),L.bufferData(L.ELEMENT_ARRAY_BUFFER,C,L.STATIC_DRAW),L.bindBuffer(L.ELEMENT_ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(x.unitCubeElementsKey,S,C.length*2)}return S},x.prototype.unitQuadBuffer=function(){var S=this.gpuResourceCache.resourceForKey(x.unitQuadKey);if(!S){var L=this.currentGlContext,C=new Float32Array(8);C[0]=0,C[1]=1,C[2]=0,C[3]=0,C[4]=1,C[5]=1,C[6]=1,C[7]=0,S=L.createBuffer(),L.bindBuffer(L.ARRAY_BUFFER,S),L.bufferData(L.ARRAY_BUFFER,C,L.STATIC_DRAW),L.bindBuffer(L.ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(x.unitQuadKey,S,C.length*4)}return S},x.prototype.unitQuadBuffer3=function(){var S=this.gpuResourceCache.resourceForKey(x.unitQuadKey3);if(!S){var L=this.currentGlContext,C=new Float32Array(12);C[0]=0,C[1]=1,C[2]=0,C[3]=0,C[4]=0,C[5]=0,C[6]=1,C[7]=1,C[8]=0,C[9]=1,C[10]=0,C[11]=0,S=L.createBuffer(),L.bindBuffer(L.ARRAY_BUFFER,S),L.bufferData(L.ARRAY_BUFFER,C,L.STATIC_DRAW),L.bindBuffer(L.ARRAY_BUFFER,null),this.frameStatistics.incrementVboLoadCount(1),this.gpuResourceCache.putResource(x.unitQuadKey3,S,C.length*4)}return S},x.prototype.surfacePointForMode=function(S,L,C,F,q){if(!q)throw new p(c.logMessage(c.LEVEL_SEVERE,"DrawContext","surfacePointForMode","missingResult"));if(this.terrain)this.terrain.surfacePointForMode(S,L,C,F,q);else{var it=C+this.globe.elevationAtLocation(S,L)*this.verticalExaggeration;this.globe.computePointFromPosition(S,L,it,q)}return q},x.prototype.project=function(S,L){if(!S)throw new p(c.logMessage(c.LEVEL_SEVERE,"DrawContext","project","missingPoint"));if(!L)throw new p(c.logMessage(c.LEVEL_SEVERE,"DrawContext","project","missingResult"));var C=S[0],F=S[1],q=S[2],it=this.modelviewProjection,st=it[0]*C+it[1]*F+it[2]*q+it[3],pt=it[4]*C+it[5]*F+it[6]*q+it[7],_t=it[8]*C+it[9]*F+it[10]*q+it[11],X=it[12]*C+it[13]*F+it[14]*q+it[15];return X===0||(st/=X,pt/=X,_t/=X,_t<-1||_t>1)?!1:(st=st*.5+.5,pt=pt*.5+.5,_t=_t*.5+.5,st=st*this.viewport.width+this.viewport.x,pt=pt*this.viewport.height+this.viewport.y,L[0]=st,L[1]=pt,L[2]=_t,!0)},x.prototype.projectWithDepth=function(S,L,C){if(!S)throw new p(c.logMessage(c.LEVEL_SEVERE,"DrawContext","projectWithDepth","missingPoint"));if(!C)throw new p(c.logMessage(c.LEVEL_SEVERE,"DrawContext","projectWithDepth","missingResult"));var F=S[0],q=S[1],it=S[2],st=this.modelview,pt=st[0]*F+st[1]*q+st[2]*it+st[3],_t=st[4]*F+st[5]*q+st[6]*it+st[7],X=st[8]*F+st[9]*q+st[10]*it+st[11],ot=st[12]*F+st[13]*q+st[14]*it+st[15],Tt=this.projection,Vt=Tt[0]*pt+Tt[1]*_t+Tt[2]*X+Tt[3]*ot,Gt=Tt[4]*pt+Tt[5]*_t+Tt[6]*X+Tt[7]*ot,qt=Tt[8]*pt+Tt[9]*_t+Tt[10]*X+Tt[11]*ot,Qt=Tt[12]*pt+Tt[13]*_t+Tt[14]*X+Tt[15]*ot;return Qt===0||(Vt/=Qt,Gt/=Qt,qt/=Qt,qt<-1||qt>1)?!1:(qt=Tt[8]*pt+Tt[9]*_t+Tt[10]*X*(1+L)+Tt[11]*ot,qt/=Qt,qt=E.clamp(qt,-1,1),Vt=Vt*.5+.5,Gt=Gt*.5+.5,qt=qt*.5+.5,Vt=Vt*this.viewport.width+this.viewport.x,Gt=Gt*this.viewport.height+this.viewport.y,C[0]=Vt,C[1]=Gt,C[2]=qt,!0)},x.prototype.convertPointToViewport=function(S,L){if(!S)throw new p(c.logMessage(c.LEVEL_SEVERE,"DrawContext","convertPointToViewport","missingPoint"));if(!L)throw new p(c.logMessage(c.LEVEL_SEVERE,"DrawContext","convertPointToViewport","missingResult"));return L[0]=S[0],L[1]=this.viewport.height-S[1],L},x.prototype.pixelSizeAtDistance=function(S){return this.pixelSizeFactor*S+this.pixelSizeOffset},x.prototype.createTextTexture=function(S,L){if(!S||!L)return null;var C=this.computeTextTextureStateKey(S,L),F=this.gpuResourceCache.resourceForKey(C);return F||(this.textRenderer.textColor=L.color,this.textRenderer.typeFace=L.font,this.textRenderer.enableOutline=L.enableOutline,this.textRenderer.outlineColor=L.outlineColor,this.textRenderer.outlineWidth=L.outlineWidth,F=this.textRenderer.renderText(S),this.gpuResourceCache.putResource(C,F,F.size),this.gpuResourceCache.setResourceAgingFactor(C,100)),F},x.prototype.computeTextTextureStateKey=function(S,L){return!S||!L?null:S+"c "+L.color.toHexString(!0)+" f "+L.font.toString()+" eo "+L.enableOutline+" ow "+L.outlineWidth+" oc "+L.outlineColor.toHexString(!0)},x.prototype.getExtension=function(S){if(!S)throw new p(c.logMessage(c.LEVEL_SEVERE,"DrawContext","getExtension","missingExtensionName"));return S in this.glExtensionsCache||(this.glExtensionsCache[S]=this.currentGlContext.getExtension(S)||null),this.glExtensionsCache[S]},x}),B("globe/GebcoElevationCoverage",["../geom/Location","../geom/Sector","../globe/TiledElevationCoverage","../util/WmsUrlBuilder"],function(p,l,n,e){"use strict";var i=function(){n.call(this,{coverageSector:l.FULL_SPHERE,resolution:.008333333333333,retrievalImageFormat:"application/bil16",minElevation:-11e3,maxElevation:8850,urlBuilder:new e("worldwind26.arc.nasa.gov/elev","GEBCO","","1.3.0")}),this.displayName="GEBCO Earth Elevation Coverage"};return i.prototype=Object.create(n.prototype),i}),B("globe/UsgsNedElevationCoverage",["../geom/Location","../geom/Sector","../globe/TiledElevationCoverage","../util/WmsUrlBuilder"],function(p,l,n,e){"use strict";var i=function(){n.call(this,{coverageSector:new l(24.396308,49.384358,-124.848974,-66.885444),resolution:92592592593e-15,retrievalImageFormat:"application/bil16",minElevation:-11e3,maxElevation:8850,urlBuilder:new e("worldwind26.arc.nasa.gov/elev","USGS-NED","","1.3.0")}),this.displayName="USGS NED Earth Elevation Coverage"};return i.prototype=Object.create(n.prototype),i}),B("globe/UsgsNedHiElevationCoverage",["../geom/Location","../geom/Sector","../globe/TiledElevationCoverage","../util/WmsUrlBuilder"],function(p,l,n,e){"use strict";var i=function(){n.call(this,{coverageSector:new l(18.86546,28.517269,-178.443593,-154.755792),resolution:92592592593e-15,retrievalImageFormat:"application/bil16",minElevation:-11e3,maxElevation:8850,urlBuilder:new e("worldwind26.arc.nasa.gov/elev","USGS-NED","","1.3.0")}),this.displayName="USGS NED Hawaii Elevation Coverage"};return i.prototype=Object.create(n.prototype),i}),B("globe/EarthElevationModel",["../globe/AsterV2ElevationCoverage","../globe/ElevationModel","../globe/GebcoElevationCoverage","../globe/UsgsNedElevationCoverage","../globe/UsgsNedHiElevationCoverage"],function(p,l,n,e,i){"use strict";var t=function(){l.call(this),this.addCoverage(new n),this.addCoverage(new p),this.addCoverage(new e),this.addCoverage(new i)};return t.prototype=Object.create(l.prototype),t}),B("globe/EarthRestElevationCoverage",["../util/LevelSet","../geom/Location","../geom/Sector","../util/LevelRowColumnUrlBuilder","../globe/TiledElevationCoverage"],function(p,l,n,e,i){"use strict";var t=function(r,s,a){i.call(this,{coverageSector:n.FULL_SPHERE,resolution:.00732421875,retrievalImageFormat:"application/bil16",minElevation:-11e3,maxElevation:8850,urlBuilder:new e(r,s)}),this.displayName=a||"Earth Elevations",this.levels=new p(n.FULL_SPHERE,new l(60,60),5,512,512)};return t.prototype=Object.create(i.prototype),t}),B("layer/FrameStatisticsLayer",["../error/ArgumentError","../util/Color","../util/Font","../layer/Layer","../util/Logger","../util/Offset","../shapes/ScreenText","../shapes/TextAttributes"],function(p,l,n,e,i,t,r,s){"use strict";var a=function(f){if(!f)throw new p(i.logMessage(i.LEVEL_SEVERE,"FrameStatisticsLayer","constructor","missingWorldWindow"));e.call(this,"Frame Statistics"),this.pickEnabled=!1;var o=new s(null);o.color=l.GREEN,o.font=new n(12),o.offset=new t(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,1),this.frameTime=new r(new t(WorldWind.OFFSET_PIXELS,5,WorldWind.OFFSET_INSET_PIXELS,5)," "),this.frameTime.attributes=o,this.frameRate=new r(new t(WorldWind.OFFSET_PIXELS,5,WorldWind.OFFSET_INSET_PIXELS,25)," "),this.frameRate.attributes=o;var c=this;function d(h,u){c.handleRedraw(h,u)}f.redrawCallbacks.push(d)};return a.prototype=Object.create(e.prototype),a.prototype.doRender=function(f){this.frameRate.render(f),this.frameTime.render(f),this.inCurrentFrame=!0},a.prototype.handleRedraw=function(f,o){if(o===WorldWind.BEFORE_REDRAW){var c=f.frameStatistics;this.frameTime.text="Frame time  "+c.frameTimeAverage.toFixed(0)+" ms  ("+c.frameTimeMin.toFixed(0)+" - "+c.frameTimeMax.toFixed(0)+")",this.frameRate.text="Frame rate  "+c.frameRateAverage.toFixed(0)+" fps"}},a}),B("shapes/AbstractShape",["../error/ArgumentError","../util/Logger","../geom/Matrix","../cache/MemoryCache","../render/Renderable","../shapes/ShapeAttributes","../error/UnsupportedOperationError","../geom/Vec3"],function(p,l,n,e,i,t,r,s){"use strict";var a=function(f){i.call(this),this._attributes=f||new t(null),this._highlightAttributes=null,this.highlighted=!1,this._altitudeMode=WorldWind.ABSOLUTE,this.referencePosition=null,this.shapeDataCache=new e(3,2),this.currentData=null,this.activeAttributes=null,this.expirationInterval=2e3,this.useSurfaceShapeFor2D=!1,this.scratchMatrix=n.fromIdentity()};return a.prototype=Object.create(i.prototype),Object.defineProperties(a.prototype,{attributes:{get:function(){return this._attributes},set:function(f){this._attributes=f,this.surfaceShape&&(this.surfaceShape.attributes=this._attributes)}},highlightAttributes:{get:function(){return this._highlightAttributes},set:function(f){this._highlightAttributes=f,this.surfaceShape&&(this.surfaceShape.highlightAttributes=this._highlightAttributes)}},altitudeMode:{get:function(){return this._altitudeMode},set:function(f){if(!f)throw new p(l.logMessage(l.LEVEL_SEVERE,"AbstractShape","altitudeMode","missingAltitudeMode"));this._altitudeMode=f,this.reset()}}}),a.prototype.reset=function(){this.shapeDataCache.clear(!1),this.surfaceShape=null},a.prototype.updateSurfaceShape=function(){this.surfaceShape.displayName=this.displayName,this.surfaceShape.highlighted=this.highlighted,this.surfaceShape.enabled=this.enabled,this.surfaceShape.pathType=this.pathType,this.surfaceShape.pickDelegate=this.pickDelegate?this.pickDelegate:this},a.prototype.createSurfaceShape=function(){return null},a.prototype.render=function(f){if(this.enabled&&f.accumulateOrderedRenderables){if(f.globe.is2D()&&this.useSurfaceShapeFor2D&&(this.surfaceShape||(this.surfaceShape=this.createSurfaceShape(),this.surfaceShape&&(this.surfaceShape.attributes=this._attributes,this.surfaceShape.highlightAttributes=this._highlightAttributes)),this.surfaceShape)){this.updateSurfaceShape(),this.surfaceShape.render(f);return}if(!(!f.terrain&&this.altitudeMode!=WorldWind.ABSOLUTE)&&(this.establishCurrentData(f),!(f.globe.projectionLimits&&!this.isWithinProjectionLimits(f))&&!(this.currentData.extent&&!this.intersectsFrustum(f))&&(this.determineActiveAttributes(f),!!this.activeAttributes))){var o=this.makeOrderedRenderable(f);if(o){if(!this.intersectsFrustum(f)||f.isSmall(this.currentData.extent,1))return;o.layer=f.currentLayer,f.addOrderedRenderable(o,this.currentData.eyeDistance)}}}},a.prototype.renderOrdered=function(f){this.currentData=this.shapeDataCache.entryForKey(f.globeStateKey),this.beginDrawing(f);try{this.doRenderOrdered(f)}finally{this.endDrawing(f)}},a.prototype.makeOrderedRenderable=function(f){var o=this.doMakeOrderedRenderable(f);return this.currentData.verticalExaggeration=f.verticalExaggeration,o},a.prototype.doMakeOrderedRenderable=function(f){throw new r(l.logMessage(l.LEVEL_SEVERE,"AbstractShape","makeOrderedRenderable","abstractInvocation"))},a.prototype.doRenderOrdered=function(f){throw new r(l.logMessage(l.LEVEL_SEVERE,"AbstractShape","doRenderOrdered","abstractInvocation"))},a.prototype.beginDrawing=function(f){},a.prototype.endDrawing=function(f){},a.prototype.intersectsFrustum=function(f){return this.currentData&&this.currentData.extent?f.pickingMode?this.currentData.extent.intersectsFrustum(f.pickFrustum):this.currentData.extent.intersectsFrustum(f.frustumInModelCoordinates):!0},a.prototype.establishCurrentData=function(f){this.currentData=this.shapeDataCache.entryForKey(f.globeStateKey),this.currentData||(this.currentData=this.createShapeDataObject(),this.resetExpiration(this.currentData),this.shapeDataCache.putEntry(f.globeStateKey,this.currentData,1)),this.currentData.isExpired=!this.isShapeDataCurrent(f,this.currentData)},a.prototype.createShapeDataObject=function(){return{transformationMatrix:n.fromIdentity(),referencePoint:new s(0,0,0)}},a.prototype.resetExpiration=function(f){f.expiryTime=Date.now()+this.expirationInterval+1e3*Math.random()},a.prototype.isShapeDataCurrent=function(f,o){return o.verticalExaggeration===f.verticalExaggeration&&o.expiryTime>Date.now()},a.prototype.determineActiveAttributes=function(f){this.highlighted&&this._highlightAttributes?this.activeAttributes=this.highlightAttributes:this.activeAttributes=this._attributes},a.prototype.isWithinProjectionLimits=function(f){return!0},a.prototype.applyMvpMatrix=function(f){this.scratchMatrix.copy(f.modelviewProjection),this.scratchMatrix.multiplyMatrix(this.currentData.transformationMatrix),f.currentProgram.loadModelviewProjection(f.currentGlContext,this.scratchMatrix)},a.prototype.applyMvpMatrixForOutline=function(f){this.scratchMatrix.copy(f.projection),this.scratchMatrix.offsetProjectionDepth(-.001),this.scratchMatrix.multiplyMatrix(f.modelview),this.scratchMatrix.multiplyMatrix(this.currentData.transformationMatrix),f.currentProgram.loadModelviewProjection(f.currentGlContext,this.scratchMatrix)},a}),B("shapes/AbstractMesh",["../shapes/AbstractShape","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Line","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m){"use strict";var g=function(_){p.call(this,_),this.pickTransparentImagePixels=!0,this._altitudeScale=1};return g.prototype=Object.create(p.prototype),Object.defineProperties(g.prototype,{altitudeScale:{get:function(){return this._altitudeScale},set:function(_){this._altitudeScale=_,this.reset()}}}),g.prototype.mustGenerateGeometry=function(_){return!this.currentData.meshPoints||this.currentData.drawInterior!==this.activeAttributes.drawInterior||this.activeAttributes.applyLighting&&!this.currentData.normals?!0:this.altitudeMode===WorldWind.ABSOLUTE?!1:this.currentData.isExpired},g.prototype.doMakeOrderedRenderable=function(_){if(!this.activeAttributes.drawInterior&&!this.activeAttributes.drawOutline)return null;if(!this.mustGenerateGeometry(_))return this;var y=this.currentData,v=y.referencePoint;return _.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude*this._altitudeScale,this._altitudeMode,v),y.transformationMatrix.setToTranslation(v[0],v[1],v[2]),y.meshPoints=this.computeMeshPoints(_,y),y.refreshVertexBuffer=!0,this.activeAttributes.imageSource&&!this.texCoords&&(this.texCoords=this.computeTexCoords(),this.texCoords&&(y.refreshTexCoordBuffer=!0)),this.meshIndices||(this.meshIndices=this.computeMeshIndices(),y.refreshMeshIndices=!0),this.meshOutlineIndices||(this.meshOutlineIndices=this.computeOutlineIndices(),this.meshOutlineIndices&&(y.refreshOutlineIndices=!0)),this.activeAttributes.applyLighting&&this.computeNormals(y),y.drawInterior=this.activeAttributes.drawInterior,this.resetExpiration(y),y.extent||(y.extent=new e),y.extent.setToPoints(y.meshPoints),y.extent.translate(y.referencePoint),this},g.prototype.computeMeshPoints=function(_,y){throw new UnsupportedOperationError(a.logMessage(a.LEVEL_SEVERE,"AbstractMesh","computeMeshPoints","abstractInvocation"))},g.prototype.computeTexCoords=function(){return null},g.prototype.computeMeshIndices=function(_){throw new UnsupportedOperationError(a.logMessage(a.LEVEL_SEVERE,"AbstractMesh","computeMeshIndices","abstractInvocation"))},g.prototype.computeOutlineIndices=function(_){},g.prototype.computeNormals=function(_){for(var y=new Float32Array(_.meshPoints.length),v=this.meshIndices,b=_.meshPoints,R=[],M=[new u(0,0,0),new u(0,0,0),new u(0,0,0)],P,T=0;T<v.length;T+=3){for(var E=0;E<3;E++)P=v[T+E],M[E].set(b[3*P],b[3*P+1],b[3*P+2]);var x=u.computeTriangleNormal(M[0],M[1],M[2]);for(E=0;E<3;E++)P=v[T+E],R[P]||(R[P]=[]),R[P].push(x)}for(x=new u(0,0,0),T=0;T<R.length;T++)R[T]?(u.average(R[T],x),x.normalize(),y[T*3]=x[0],y[T*3+1]=x[1],y[T*3+2]=x[2]):(y[T*3]=0,y[T*3+1]=0,y[T*3+2]=0);_.normals=y,_.refreshNormalsBuffer=!0},g.prototype.doRenderOrdered=function(_){var y=_.currentGlContext,v=_.currentProgram,b=this.currentData,R=this.texCoords&&!!this.activeAttributes.imageSource,M,P,T,E;if(_.pickingMode&&(T=_.uniquePickColor()),b.pointsVboCacheKey||(b.pointsVboCacheKey=_.gpuResourceCache.generateCacheKey()),M=_.gpuResourceCache.resourceForKey(b.pointsVboCacheKey),M||(M=y.createBuffer(),_.gpuResourceCache.putResource(b.pointsVboCacheKey,M,b.meshPoints.length*4),b.refreshVertexBuffer=!0),y.bindBuffer(y.ARRAY_BUFFER,M),b.refreshVertexBuffer&&(y.bufferData(y.ARRAY_BUFFER,b.meshPoints,y.STATIC_DRAW),_.frameStatistics.incrementVboLoadCount(1),b.refreshVertexBuffer=!1),y.vertexAttribPointer(v.vertexPointLocation,3,y.FLOAT,!1,0,0),v.loadTextureEnabled(y,!1),this.activeAttributes.drawInterior){var x=!_.pickingMode&&b.normals&&this.activeAttributes.applyLighting;this.applyMvpMatrix(_),b.meshIndicesVboCacheKey||(b.meshIndicesVboCacheKey=_.gpuResourceCache.generateCacheKey()),M=_.gpuResourceCache.resourceForKey(b.meshIndicesVboCacheKey),M||(M=y.createBuffer(),_.gpuResourceCache.putResource(b.meshIndicesVboCacheKey,M,this.meshIndices.length*2),b.refreshMeshIndices=!0),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,M),b.refreshMeshIndices&&(y.bufferData(y.ELEMENT_ARRAY_BUFFER,this.meshIndices,y.STATIC_DRAW),_.frameStatistics.incrementVboLoadCount(1),b.refreshMeshIndices=!1),P=this.activeAttributes.interiorColor,y.depthMask(P.alpha*this.layer.opacity>=1||_.pickingMode),v.loadColor(y,_.pickingMode?T:P),v.loadOpacity(y,_.pickingMode?1:this.layer.opacity),R&&(!_.pickingMode||!this.pickTransparentImagePixels)&&(this.activeTexture=_.gpuResourceCache.resourceForKey(this.activeAttributes.imageSource),this.activeTexture||(this.activeTexture=_.gpuResourceCache.retrieveTexture(_.currentGlContext,this.activeAttributes.imageSource)),E=this.activeTexture&&this.activeTexture.bind(_),E&&(b.texCoordsVboCacheKey||(b.texCoordsVboCacheKey=_.gpuResourceCache.generateCacheKey()),M=_.gpuResourceCache.resourceForKey(b.texCoordsVboCacheKey),M||(M=y.createBuffer(),_.gpuResourceCache.putResource(b.texCoordsVboCacheKey,M,this.texCoords.length*4),b.refreshTexCoordBuffer=!0),y.bindBuffer(y.ARRAY_BUFFER,M),b.refreshTexCoordBuffer&&(y.bufferData(y.ARRAY_BUFFER,this.texCoords,y.STATIC_DRAW),_.frameStatistics.incrementVboLoadCount(1),b.refreshTexCoordBuffer=!1),y.enableVertexAttribArray(v.vertexTexCoordLocation),y.vertexAttribPointer(v.vertexTexCoordLocation,2,y.FLOAT,!1,0,0),this.scratchMatrix.setToIdentity(),this.scratchMatrix.multiplyByTextureTransform(this.activeTexture),v.loadTextureEnabled(y,!0),v.loadTextureUnit(y,y.TEXTURE0),v.loadTextureMatrix(y,this.scratchMatrix),v.loadModulateColor(y,_.pickingMode))),x&&(v.loadApplyLighting(y,!0),b.normalsVboCacheKey||(b.normalsVboCacheKey=_.gpuResourceCache.generateCacheKey()),M=_.gpuResourceCache.resourceForKey(b.normalsVboCacheKey),M||(M=y.createBuffer(),_.gpuResourceCache.putResource(b.normalsVboCacheKey,M,b.normals.length*4),b.refreshNormalsBuffer=!0),y.bindBuffer(y.ARRAY_BUFFER,M),b.refreshNormalsBuffer&&(y.bufferData(y.ARRAY_BUFFER,b.normals,y.STATIC_DRAW),_.frameStatistics.incrementVboLoadCount(1),b.refreshNormalsBuffer=!1),y.enableVertexAttribArray(v.normalVectorLocation),y.vertexAttribPointer(v.normalVectorLocation,3,y.FLOAT,!1,0,0)),y.drawElements(y.TRIANGLES,this.meshIndices.length,y.UNSIGNED_SHORT,0),R&&y.disableVertexAttribArray(v.vertexTexCoordLocation),x&&(v.loadApplyLighting(y,!1),y.disableVertexAttribArray(v.normalVectorLocation))}if(this.activeAttributes.drawOutline&&this.meshOutlineIndices&&(v.loadTextureEnabled(y,!1),y.disableVertexAttribArray(v.vertexTexCoordLocation),this.applyMvpMatrixForOutline(_),P=this.activeAttributes.outlineColor,y.depthMask(P.alpha*this.layer.opacity>=1||_.pickingMode),v.loadColor(y,_.pickingMode?T:P),v.loadOpacity(y,_.pickingMode?1:this.layer.opacity),y.lineWidth(this.activeAttributes.outlineWidth),b.outlineIndicesVboCacheKey||(b.outlineIndicesVboCacheKey=_.gpuResourceCache.generateCacheKey()),M=_.gpuResourceCache.resourceForKey(b.outlineIndicesVboCacheKey),M||(M=y.createBuffer(),_.gpuResourceCache.putResource(b.outlineIndicesVboCacheKey,M,this.meshOutlineIndices.length*2),b.refreshOutlineIndices=!0),y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,M),b.refreshOutlineIndices&&(y.bufferData(y.ELEMENT_ARRAY_BUFFER,this.meshOutlineIndices,y.STATIC_DRAW),_.frameStatistics.incrementVboLoadCount(1),b.refreshOutlineIndices=!1),y.drawElements(y.LINE_STRIP,this.meshOutlineIndices.length,y.UNSIGNED_SHORT,0)),_.pickingMode){var S=this.computePickPosition(_),L=new o(T,this.pickDelegate?this.pickDelegate:this,S,this.layer,!1);_.resolvePick(L)}},g.prototype.computePickPosition=function(_){var y=this.currentData,v=_.pickRay,b=new u(v.origin[0],v.origin[1],v.origin[2]).subtract(y.referencePoint),R=new r(b,v.direction),M=[];if(m.computeIndexedTrianglesIntersection(R,y.meshPoints,this.meshIndices,M)){var P=M[0];if(M.length>1)for(var T=P.distanceToSquared(_.eyePoint),E=1;E<M.length;E++){var x=M[E].distanceToSquared(_.eyePoint);x<T&&(T=x,P=M[E])}var S=new c(0,0,0);return _.globe.computePositionFromPoint(P[0]+y.referencePoint[0],P[1]+y.referencePoint[1],P[2]+y.referencePoint[2],S),S.altitude/=this._altitudeScale,S}return null},g.prototype.beginDrawing=function(_){var y=_.currentGlContext;if(this.activeAttributes.drawInterior){y.disable(y.CULL_FACE),_.findAndBindProgram(n);var v=!_.pickMode&&this.currentData.normals&&this.activeAttributes.applyLighting;v&&_.currentProgram.loadModelviewInverse(y,_.modelviewNormalTransform)}y.enableVertexAttribArray(_.currentProgram.vertexPointLocation)},g.prototype.endDrawing=function(_){var y=_.currentGlContext;y.disableVertexAttribArray(_.currentProgram.vertexPointLocation),y.depthMask(!0),y.lineWidth(1),y.enable(y.CULL_FACE)},g}),B("shapes/SurfacePolygon",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(p,l,n,e){"use strict";var i=function(t,r){if(!Array.isArray(t))throw new p(l.logMessage(l.LEVEL_SEVERE,"SurfacePolygon","constructor","The specified boundary is not an array."));e.call(this,r),this._boundaries=t,this._stateId=i.stateId++};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{boundaries:{get:function(){return this._boundaries},set:function(t){if(!Array.isArray(t))throw new p(l.logMessage(l.LEVEL_SEVERE,"SurfacePolygon","set boundaries","The specified value is not an array."));this.resetBoundaries(),this._boundaries=t,this._stateId=i.stateId++,this.stateKeyInvalid=!0}}}),i.stateId=Number.MIN_SAFE_INTEGER,i.staticStateKey=function(t){var r=e.staticStateKey(t);return r+" pg "+t._stateId},i.prototype.computeStateKey=function(){return i.staticStateKey(this)},i.prototype.computeBoundaries=function(t){},i.prototype.getReferencePosition=function(){return this.boundaries.length>0&&this.boundaries[0].length>2?this.boundaries[0][0]:this.boundaries.length>2?this.boundaries[0]:null},i.prototype.moveTo=function(t,r){if(this.boundaries.length>0&&this.boundaries[0].length>2){for(var s=[],a=0,f=this._boundaries.length;a<f;a++){var o=this.computeShiftedLocations(t,this.getReferencePosition(),r,this._boundaries[a]);s.push(o)}this.boundaries=s}else this.boundaries.length>2&&(this.boundaries=this.computeShiftedLocations(t,this.getReferencePosition(),r,this._boundaries))},i}),B("shapes/GeographicMesh",["../shapes/AbstractMesh","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolygon","../geom/Vec2","../geom/Vec3"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u){"use strict";var m=function(g,_){if(!g)throw new l(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","missingPositions"));if(g.length<2||g[0].length<2)throw new l(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","Number of positions is insufficient."));if(g.length*g[0].length>65536)throw new l(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","Too many positions. Must be fewer than 65536. Try using multiple meshes."));for(var y=g[0].length,v=1;v<g.length;v++)if(g[v].length!==y)throw new l(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","constructor","Array lengths are inconsistent."));var b=g.length,R=g[0].length;p.call(this,_),this.pickTransparentImagePixels=!0,this._positions=g,this._altitudeScale=1,this.numRows=b,this.numColumns=R,this._textureCoordinates=null,this.referencePosition=this.determineReferencePosition(this._positions)};return m.prototype=Object.create(p.prototype),Object.defineProperties(m.prototype,{positions:{get:function(){return this._positions},set:function(g){if(!g)throw new l(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","positions","missingPositions"));if(g.length<2||g[0].length<2)throw new l(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","positions","Number of positions is insufficient."));for(var _=g[0].length,y=1;y<g.length;y++)if(g[y].length!==_)throw new l(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","positions","Array lengths are inconsistent."));this.numRows=g.length,this.numColumns=g[0].length,this._positions=g,this.referencePosition=this.determineReferencePosition(this._positions),this.reset(),this.meshIndices=null,this.outlineIndices=null}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(g){if(g&&g.length!=this.numRows)throw new l(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","textureCoordinates","Number of texture coordinate rows is inconsistent with the currently specified positions."));for(var _=0;_<this.numRows;_++)if(g[_].length!==this.numColumns)throw new l(s.logMessage(s.LEVEL_SEVERE,"GeographicMesh","textureCoordinates","Texture coordinate row lengths are inconsistent with the currently specified positions."));this._textureCoordinates=g,this.reset(),this.texCoords=null}}}),m.makeGridIndices=function(g,_){for(var y=[],v=0,b=0;b<g-1;b++)for(var R=0;R<_-1;R++){var M=b*_+R;y[v++]=M,y[v++]=M+1,y[v++]=M+_,y[v++]=M+1,y[v++]=M+1+_,y[v++]=M+_}return y},m.prototype.determineReferencePosition=function(g){return g[0][0]},m.prototype.createSurfaceShape=function(){for(var g=[],_=0;_<this.numColumns;_++)g.push(this._positions[0][_]);for(var y=1;y<this.numRows;y++)g.push(this._positions[y][this.numColumns-1]);for(_=this.numColumns-2;_>=0;_--)g.push(this._positions[this.numRows-1][_]);for(y=this.numRows-2;y>0;y--)g.push(this._positions[y][0]);return new d(g,null)},m.prototype.computeMeshPoints=function(g,_){for(var y=Number.MAX_VALUE,v=g.eyePoint,b=new Float32Array(this.numRows*this.numColumns*3),R=new u(0,0,0),M=0,P,T,E=0;E<this._positions.length;E++)for(var x=0,S=this._positions[E].length;x<S;x++)P=this._positions[E][x],g.surfacePointForMode(P.latitude,P.longitude,P.altitude*this._altitudeScale,this.altitudeMode,R),T=R.distanceToSquared(v),T<y&&(y=T),R.subtract(this.currentData.referencePoint),b[M++]=R[0],b[M++]=R[1],b[M++]=R[2];return _.eyeDistance=Math.sqrt(y),b},m.prototype.computeTexCoords=function(){return this._textureCoordinates?this.computeExplicitTexCoords():this.computeImplicitTexCoords()},m.prototype.computeExplicitTexCoords=function(){for(var g=new Float32Array(2*this.numRows*this.numColumns),_=0,y=0;y<this._textureCoordinates.length;y++)for(var v=0,b=this._textureCoordinates[y].length;v<b;v++){var R=this._textureCoordinates[y][v];g[_++]=R[0],g[_++]=R[1]}return g},m.prototype.computeImplicitTexCoords=function(){for(var g=new Float32Array(2*this.numRows*this.numColumns),_=1/(this.numRows-1),y=1/(this.numColumns-1),v=0,b=0;b<this._positions.length;b++)for(var R=b===this.numRows-1?1:b*_,M=0,P=this._positions[b].length;M<P;M++)g[v++]=M===this.numColumns-1?1:M*y,g[v++]=R;return g},m.prototype.computeMeshIndices=function(){for(var g=new Uint16Array((this.numRows-1)*(this.numColumns-1)*6),_=0,y=0;y<this.numRows-1;y++)for(var v=0;v<this.numColumns-1;v++){var b=y*this.numColumns+v;g[_++]=b,g[_++]=b+1,g[_++]=b+this.numColumns,g[_++]=b+1,g[_++]=b+1+this.numColumns,g[_++]=b+this.numColumns}return g},m.prototype.computeOutlineIndices=function(){for(var g=new Uint16Array(2*this.numRows+2*this.numColumns),_=0,y=0;y<this.numColumns;y++)g[_++]=y;for(var v=1;v<this.numRows;v++)g[_++]=(v+1)*this.numColumns-1;for(y=this.numRows*this.numColumns-2;y>=(this.numRows-1)*this.numColumns;y--)g[_++]=y;for(v=this.numRows-2;v>=0;v--)g[_++]=v*this.numColumns;return g},m}),B("shapes/GeographicText",["../error/ArgumentError","../util/Logger","../shapes/Text","../geom/Vec3"],function(p,l,n,e){"use strict";var i=function(t,r){if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"Text","constructor","missingPosition"));n.call(this,r),this.position=t,this.declutterGroup=1};return i.placePoint=new e(0,0,0),i.prototype=Object.create(n.prototype),i.prototype.clone=function(){var t=new i(this.position,this.text);return t.copy(this),t.pickDelegate=this.pickDelegate?this.pickDelegate:this,t},i.prototype.render=function(t){t.globe.projectionLimits&&!t.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude)||n.prototype.render.call(this,t)},i.prototype.computeScreenPointAndEyeDistance=function(t){return t.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,i.placePoint),!(!t.frustumInModelCoordinates.containsPoint(i.placePoint)||(this.eyeDistance=this.alwaysOnTop?0:t.eyePoint.distanceTo(i.placePoint),!t.projectWithDepth(i.placePoint,this.depthOffset,this.screenPoint)))},i}),B("formats/geojson/GeoJSONConstants",[],function(){"use strict";var p=function(){};return p.FIELD_TYPE="type",p.FIELD_CRS="crs",p.FIELD_NAME="name",p.FIELD_BBOX="bbox",p.FIELD_COORDINATES="coordinates",p.FIELD_GEOMETRIES="geometries",p.FIELD_GEOMETRY="geometry",p.FIELD_PROPERTIES="properties",p.FIELD_FEATURES="features",p.FIELD_ID="id",p.TYPE_POINT="Point",p.TYPE_MULTI_POINT="MultiPoint",p.TYPE_LINE_STRING="LineString",p.TYPE_MULTI_LINE_STRING="MultiLineString",p.TYPE_POLYGON="Polygon",p.TYPE_MULTI_POLYGON="MultiPolygon",p.TYPE_GEOMETRY_COLLECTION="GeometryCollection",p.TYPE_FEATURE="Feature",p.TYPE_FEATURE_COLLECTION="FeatureCollection",p.FIELD_CRS_NAME="name",p.FIELD_CRS_LINK="link",p.WGS84_CRS="urn:ogc:def:crs:OGC:1.3:CRS84",p.EPSG4326_CRS="EPSG:4326",p}),B("formats/geojson/GeoJSONExporter",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(p,l,n){"use strict";var e={exportRenderable:function(i){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportRenderable","missingRenderable"));return i instanceof WorldWind.Placemark?this.exportPlacemark(i):i instanceof WorldWind.SurfacePolyline?this.exportSurfacePolyline(i):i instanceof WorldWind.SurfacePolygon?this.exportSurfacePolygon(i):i instanceof WorldWind.SurfaceEllipse?this.exportSurfaceEllipse(i):i instanceof WorldWind.SurfaceCircle?this.exportSurfaceCircle(i):i instanceof WorldWind.SurfaceRectangle?this.exportSurfaceRectangle(i):i instanceof WorldWind.SurfaceSector?this.exportSurfaceSector(i):i instanceof WorldWind.Path?this.exportPath(i):i instanceof WorldWind.Polygon?this.exportPolygon(i):(n.log(n.LEVEL_WARNING,"Export renderable not implemented: "+i),null)},exportRenderables:function(i){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportRenderables","missingRenderables"));if(i.length!=0)if(i.length>1){var t="{";t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_GEOMETRY_COLLECTION+'"',t=t+',"'+l.FIELD_GEOMETRIES+'":[';for(var r=0;r<i.length;r++){var s=this.exportRenderable(i[r]);s&&(t=t+s,t=t+",")}return t.slice(-1)===","&&(t=t.substring(0,t.length-1)),t=t+"]",t=t+"}",t}else return this.exportRenderable(i[0])},exportLayer:function(i){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportLayer","missingLayer"));return this.exportRenderables(i.renderables)},exportPlacemark:function(i){if(!(i instanceof WorldWind.Placemark))throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportPlacemark","invalidTypeOfRenderable"));var t="{";return t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_POINT+'",',t=t+'"'+l.FIELD_COORDINATES+'":',t=t+"["+i.position.longitude+","+i.position.latitude+"]",t=t+"}",t},exportSurfacePolyline:function(i){if(!(i instanceof WorldWind.SurfacePolyline))throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportSurfacePolyline","invalidTypeOfRenderable"));var t="{";t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_LINE_STRING+'",',t=t+'"'+l.FIELD_COORDINATES+'":[';for(var r=0;r<i.boundaries.length;r++)t=t+"["+i.boundaries[r].longitude+","+i.boundaries[r].latitude+"]",r!==i.boundaries.length-1&&(t=t+",");return t=t+"]",t=t+"}",t},exportSurfacePolygon:function(i){if(!(i instanceof WorldWind.SurfacePolygon))throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportSurfacePolygon","invalidTypeOfRenderable"));var t="{";if(t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_POLYGON+'",',t=t+'"'+l.FIELD_COORDINATES+'":[',i.boundaries.length>0&&i.boundaries[0].length>2)for(var r=0;r<i.boundaries.length;r++){t=t+"[";for(var s=0;s<i.boundaries[r].length;s++)t=t+"["+i.boundaries[r][s].longitude+","+i.boundaries[r][s].latitude+"]",t=t+",",s===i.boundaries[r].length-1&&(t=t+"["+i.boundaries[r][0].longitude+","+i.boundaries[r][0].latitude+"]");t=t+"]",r!==i.boundaries.length-1&&(t=t+",")}else{t=t+"[";for(var r=0;r<i.boundaries.length;r++)t=t+"["+i.boundaries[r].longitude+","+i.boundaries[r].latitude+"]",t=t+",",r===i.boundaries.length-1&&(t=t+"["+i.boundaries[0].longitude+","+i.boundaries[0].latitude+"]");t=t+"]"}return t=t+"]",t=t+"}",t},exportSurfaceEllipse:function(i){if(!(i instanceof WorldWind.SurfaceEllipse))throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportSurfaceEllipse","invalidTypeOfRenderable"));var t="{";t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_POLYGON+'",',t=t+'"'+l.FIELD_COORDINATES+'":[',t=t+"[";for(var r=0;r<i._boundaries.length;r++)t=t+"["+i._boundaries[r].longitude+","+i._boundaries[r].latitude+"]",t=t+",",r===i._boundaries.length-1&&(t=t+"["+i._boundaries[0].longitude+","+i._boundaries[0].latitude+"]");return t=t+"]",t=t+"]",t=t+"}",t},exportSurfaceCircle:function(i){if(!(i instanceof WorldWind.SurfaceCircle))throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportSurfaceCircle","invalidTypeOfRenderable"));var t="{";t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_POLYGON+'",',t=t+'"'+l.FIELD_COORDINATES+'":[',t=t+"[";for(var r=i._boundaries.length-1;r>=0;r--)t=t+"["+i._boundaries[r].longitude+","+i._boundaries[r].latitude+"]",t=t+",",r===0&&(t=t+"["+i._boundaries[i._boundaries.length-1].longitude+","+i._boundaries[i._boundaries.length-1].latitude+"]");return t=t+"]",t=t+"]",t=t+"}",t},exportSurfaceRectangle:function(i){if(!(i instanceof WorldWind.SurfaceRectangle))throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportSurfaceRectangle","invalidTypeOfRenderable"));var t="{";t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_POLYGON+'",',t=t+'"'+l.FIELD_COORDINATES+'":[',t=t+"[";for(var r=0;r<i._boundaries.length;r++)t=t+"["+i._boundaries[r].longitude+","+i._boundaries[r].latitude+"]",t=t+",",r===i._boundaries.length-1&&(t=t+"["+i._boundaries[0].longitude+","+i._boundaries[0].latitude+"]");return t=t+"]",t=t+"]",t=t+"}",t},exportSurfaceSector:function(i){if(!(i instanceof WorldWind.SurfaceSector))throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportSurfaceSector","invalidTypeOfRenderable"));var t="{";t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_POLYGON+'",',t=t+'"'+l.FIELD_COORDINATES+'":[',t=t+"[",i._boundaries.reverse();for(var r=0;r<i._boundaries.length;r++)t=t+"["+i._boundaries[r].longitude+","+i._boundaries[r].latitude+"]",t=t+",",r===i._boundaries.length-1&&(t=t+"["+i._boundaries[0].longitude+","+i._boundaries[0].latitude+"]");return t=t+"]",t=t+"]",t=t+"}",t},exportPath:function(i){if(!(i instanceof WorldWind.Path))throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportPath","invalidTypeOfRenderable"));var t="{";t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_LINE_STRING+'",',t=t+'"'+l.FIELD_COORDINATES+'":[';for(var r=0;r<i.positions.length;r++)t=t+"["+i.positions[r].longitude+","+i.positions[r].latitude+","+i.positions[r].altitude+"]",r!==i.positions.length-1&&(t=t+",");return t=t+"]",t=t+"}",t},exportPolygon:function(i){if(!(i instanceof WorldWind.Polygon))throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONExporter","exportPolygon","invalidTypeOfRenderable"));var t="{";if(t=t+'"'+l.FIELD_TYPE+'":"'+l.TYPE_POLYGON+'",',t=t+'"'+l.FIELD_COORDINATES+'":[',i.boundaries.length>0&&i.boundaries[0].length>2)for(var r=0;r<i.boundaries.length;r++){t=t+"[";for(var s=0;s<i.boundaries[r].length;s++)t=t+"["+i.boundaries[r][s].longitude+","+i.boundaries[r][s].latitude+","+i.boundaries[r][s].altitude+"]",t=t+",",s===i.boundaries[r].length-1&&(t=t+"["+i.boundaries[r][0].longitude+","+i.boundaries[r][0].latitude+","+i.boundaries[r][0].altitude+"]");t=t+"]",r!==i.boundaries.length-1&&(t=t+",")}else{t=t+"[";for(var r=0;r<i.boundaries.length;r++)t=t+"["+i.boundaries[r].longitude+","+i.boundaries[r].latitude+","+i.boundaries[r].altitude+"]",t=t+",",r===i.boundaries.length-1&&(t=t+"["+i.boundaries[0].longitude+","+i.boundaries[0].latitude+","+i.boundaries[0].altitude+"]");t=t+"]"}return t=t+"]",t=t+"}",t}};return e}),B("formats/geojson/GeoJSONGeometry",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometry","constructor","missingCoordinates"));if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometry","constructor","missingType"));this._coordinates=i,this._type=t,this._bbox=r||null};return Object.defineProperties(e.prototype,{coordinates:{get:function(){return this._coordinates}},type:{get:function(){return this._type}},bbox:{get:function(){return this._bbox}}}),e.prototype.isPointType=function(){return this.type===l.TYPE_POINT},e.prototype.isMultiPointType=function(){return this.type===l.TYPE_MULTI_POINT},e.prototype.isLineStringType=function(){return this.type===l.TYPE_LINE_STRING},e.prototype.isMultiLineStringType=function(){return this.type===l.TYPE_MULTI_LINE_STRING},e.prototype.isPolygonType=function(){return this.type===l.TYPE_POLYGON},e.prototype.isMultiPolygonType=function(){return this.type===l.TYPE_MULTI_POLYGON},e}),B("formats/geojson/GeoJSONGeometryCollection",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryCollection","constructor","missingGeometries"));if(Object.prototype.toString.call(i)!=="[object Array]")throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryCollection","constructor","invalidGeometries"));this._geometries=i,this._bbox=t};return Object.defineProperties(e.prototype,{geometries:{get:function(){return this._geometries}},bbox:{get:function(){return this._bbox}}}),e}),B("formats/geojson/GeoJSONGeometryLineString",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingCoordinates"));if(i.length<2||i[0].length<2)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","invalidNumberOfCoordinates"));if(Object.prototype.toString.call(i[0])!=="[object Array]"||Object.prototype.toString.call(i[0][0])!=="[object Number]")throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","invalidCoordinatesType"));if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingType"));l.call(this,i,t,r)};return e.prototype=Object.create(l.prototype),e}),B("formats/geojson/GeoJSONGeometryMultiLineString",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","missingCoordinates"));if(i[0].length<2||i[0][0].length<2)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","invalidNumberOfCoordinates"));if(Object.prototype.toString.call(i[0])!=="[object Array]"||Object.prototype.toString.call(i[0][0])!=="[object Array]"||Object.prototype.toString.call(i[0][0][0])!=="[object Number]")throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryMultiLineString","constructor","invalidCoordinatesType"));if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryLineString","constructor","missingType"));l.call(this,i,t,r)};return e.prototype=Object.create(l.prototype),e}),B("formats/geojson/GeoJSONGeometryMultiPoint",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","missingCoordinates"));if(i[0].length<2)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","invalidNumberOfCoordinates"));if(Object.prototype.toString.call(i[0])!=="[object Array]"||Object.prototype.toString.call(i[0][0])!=="[object Number]")throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryMultiPoint","constructor","invalidCoordinatesType"));if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingType"));l.call(this,i,t,r)};return e.prototype=Object.create(l.prototype),e}),B("formats/geojson/GeoJSONGeometryMultiPolygon",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryMultiPolygon","constructor","missingCoordinates"));if(Object.prototype.toString.call(i[0])!=="[object Array]"||Object.prototype.toString.call(i[0][0])!=="[object Array]"||Object.prototype.toString.call(i[0][0][0])!=="[object Array]"||Object.prototype.toString.call(i[0][0][0][0])!=="[object Number]")throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidCoordinatesType"));if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingType"));l.call(this,i,t,r)};return e.prototype=Object.create(l.prototype),e}),B("formats/geojson/GeoJSONGeometryPoint",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingCoordinates"));if(i.length<2)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","invalidNumberOfCoordinates"));if(Object.prototype.toString.call(i)!=="[object Array]"||Object.prototype.toString.call(i[0])!=="[object Number]")throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","invalidCoordinatesType"));if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPoint","constructor","missingType"));l.call(this,i,t,r)};return e.prototype=Object.create(l.prototype),e}),B("formats/geojson/GeoJSONGeometryPolygon",["../../error/ArgumentError","./GeoJSONGeometry","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingCoordinates"));if(i[0].length<2||i[0][0].length<2)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidNumberOfCoordinates"));if(Object.prototype.toString.call(i[0])!=="[object Array]"||Object.prototype.toString.call(i[0][0])!=="[object Array]"||Object.prototype.toString.call(i[0][0][0])!=="[object Number]")throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidCoordinatesType"));for(var s=0;s<i.length;s++)if(i[s][0][0]!==i[s][i[s].length-1][0]||i[s][0][1]!==i[s][i[s].length-1][1])throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","invalidLinearRing"));if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONGeometryPolygon","constructor","missingType"));l.call(this,i,t,r)};return e.prototype=Object.create(l.prototype),e}),B("formats/geojson/GeoJSONCRS",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger","../../util/proj4-src"],function(p,l,n,e){"use strict";var i=function(t,r){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONCRS","constructor","missingType"));if(!r)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONCRS","constructor","missingProperties"));this._type=t,this._properties=r,this._projectionString=null};return Object.defineProperties(i.prototype,{type:{get:function(){return this._type}},properties:{get:function(){return this._properties}},projectionString:{get:function(){return this._projectionString}}}),i.prototype.isDefault=function(){return!!(this.isNamed()&&(this._projectionString===l.EPSG4326_CRS||this._projectionString===l.WGS84_CRS))},i.prototype.isNamed=function(){return this._type===l.FIELD_CRS_NAME},i.prototype.isLinked=function(){return this._type===l.FIELD_CRS_LINK},i.prototype.isCRSSupported=function(){try{e(this._projectionString,l.EPSG4326_CRS)}catch(t){return n.log(n.LEVEL_WARNING,"Unknown GeoJSON coordinate reference system ("+t+"): "+this._properties.name),!1}return!0},i.prototype.getLinkedCRSString=function(t,r){var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="text",s.onreadystatechange=(function(){s.readyState===4&&(s.status===200?(this._projectionString=s.response,r()):n.log(n.LEVEL_WARNING,"GeoJSON Linked CRS retrieval failed ("+s.statusText+"): "+t))}).bind(this),s.onerror=function(){n.log(n.LEVEL_WARNING,"GeoJSON Linked CRS retrieval failed: "+t)},s.ontimeout=function(){n.log(n.LEVEL_WARNING,"GeoJSON Linked CRS retrieval timed out: "+t)},s.send(null)},i.prototype.setCRSString=function(t){this.isNamed()?(this._projectionString=this._properties.name,t()):this.isLinked()&&this.getLinkedCRSString(this._properties.href,t)},i}),B("formats/geojson/GeoJSONFeature",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t,r,s){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingGeometry"));if(!i[l.FIELD_TYPE])throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingFeatureGeometryType"));if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONFeature","constructor","missingProperties"));this._geometry=i,this._properties=t,this._id=r,this._bbox=s};return Object.defineProperties(e.prototype,{geometry:{get:function(){return this._geometry}},properties:{get:function(){return this._properties}},id:{get:function(){return this._id}},bbox:{get:function(){return this._bbox}}}),e}),B("formats/geojson/GeoJSONFeatureCollection",["../../error/ArgumentError","./GeoJSONConstants","../../util/Logger"],function(p,l,n){"use strict";var e=function(i,t){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONFeatureCollection","constructor","missingFeatures"));if(Object.prototype.toString.call(i)!=="[object Array]")throw new p(n.logMessage(n.LEVEL_SEVERE,"GeoJSONFeatureCollection","constructor","invalidFeatures"));this._features=i,this._bbox=t};return Object.defineProperties(e.prototype,{features:{get:function(){return this._features}},bbox:{get:function(){return this._bbox}}}),e}),B("shapes/PlacemarkAttributes",["../util/Color","../util/Font","../util/Offset","../shapes/ShapeAttributes","../shapes/TextAttributes"],function(p,l,n,e,i){"use strict";var t=function(r){this._imageColor=r?r._imageColor.clone():p.WHITE.clone(),this._imageOffset=r?r._imageOffset:new n(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),this._imageScale=r?r._imageScale:1,this._imageSource=r?r._imageSource:null,this._depthTest=r?r._depthTest:!0,this._labelAttributes=r?r._labelAttributes:new i(null),this._drawLeaderLine=r?r._drawLeaderLine:!1,this._leaderLineAttributes=r?r._leaderLineAttributes:new e(null),this.stateKeyInvalid=!0};return t.prototype.computeStateKey=function(){return"ic "+this._imageColor.toHexString(!0)+" io "+this._imageOffset.toString()+" is "+this._imageScale+" ip "+this._imageSource+" dt "+this._depthTest+" la "+this._labelAttributes.stateKey+" dll "+this._drawLeaderLine+" lla "+this._leaderLineAttributes.stateKey},Object.defineProperties(t.prototype,{stateKey:{get:function(){return this.stateKeyInvalid&&(this._stateKey=this.computeStateKey(),this.stateKeyInvalid=!1),this._stateKey}},imageColor:{get:function(){return this._imageColor},set:function(r){this._imageColor=r,this.stateKeyInvalid=!0}},imageOffset:{get:function(){return this._imageOffset},set:function(r){this._imageOffset=r,this.stateKeyInvalid=!0}},imageScale:{get:function(){return this._imageScale},set:function(r){this._imageScale=r,this.stateKeyInvalid=!0}},imageSource:{get:function(){return this._imageSource},set:function(r){this._imageSource=r,this.stateKeyInvalid=!0}},depthTest:{get:function(){return this._depthTest},set:function(r){this._depthTest=r,this.stateKeyInvalid=!0}},labelAttributes:{get:function(){return this._labelAttributes},set:function(r){this._labelAttributes=r,this.stateKeyInvalid=!0}},drawLeaderLine:{get:function(){return this._drawLeaderLine},set:function(r){this._drawLeaderLine=r,this.stateKeyInvalid=!0}},leaderLineAttributes:{get:function(){return this._leaderLineAttributes},set:function(r){this._leaderLineAttributes=r,this.stateKeyInvalid=!0}}}),t}),B("shapes/Placemark",["../error/ArgumentError","../shaders/BasicTextureProgram","../util/Color","../util/Font","../util/Logger","../geom/Matrix","../pick/PickedObject","../shapes/PlacemarkAttributes","../render/Renderable","../geom/Vec2","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o,c){"use strict";var d=function(h,u,m){if(!h)throw new p(i.logMessage(i.LEVEL_SEVERE,"Placemark","constructor","missingPosition"));a.call(this),this.attributes=m||new s(null),this.highlightAttributes=null,this.highlighted=!1,this.position=h,this.eyeDistanceScaling=u,this.eyeDistanceScalingThreshold=1e6,this.eyeDistanceScalingLabelThreshold=1.5*this.eyeDistanceScalingThreshold,this.label=null,this.altitudeMode=WorldWind.ABSOLUTE,this.alwaysOnTop=!1,this.enableLeaderLinePicking=!1,this.updateImage=!0,this.declutterGroup=2,this.targetVisibility=1,this.currentVisibility=1,this.imageRotation=0,this.imageTilt=0,this.imageRotationReference=WorldWind.RELATIVE_TO_SCREEN,this.imageTiltReference=WorldWind.RELATIVE_TO_SCREEN,this.activeAttributes=null,this.activeTexture=null,this.labelTexture=null,this.placePoint=new o(0,0,0),this.groundPoint=new o(0,0,0),this.imageTransform=t.fromIdentity(),this.labelTransform=t.fromIdentity(),this.texCoordMatrix=t.fromIdentity(),this.imageBounds=null,this.layer=null,this.depthOffset=-.003};return d.screenPoint=new o(0,0,0),d.matrix=t.fromIdentity(),d.scratchPoint=new o(0,0,0),d.prototype=Object.create(a.prototype),Object.defineProperties(d.prototype,{screenBounds:{get:function(){return this.labelBounds}}}),d.prototype.copy=function(h){return this.position=h.position,this.attributes=h.attributes,this.highlightAttributes=h.highlightAttributes,this.highlighted=h.highlighted,this.enabled=h.enabled,this.label=h.label,this.altitudeMode=h.altitudeMode,this.pickDelegate=h.pickDelegate,this.alwaysOnTop=h.alwaysOnTop,this.depthOffset=h.depthOffset,this.targetVisibility=h.targetVisibility,this.currentVisibility=h.currentVisibility,this.imageRotation=h.imageRotation,this.imageTilt=h.imageTilt,this.imageRotationReference=h.imageRotationReference,this.imageTiltReference=h.imageTiltReference,this},d.prototype.clone=function(){var h=new d(this.position);return h.copy(this),h.pickDelegate=this.pickDelegate?this.pickDelegate:this,h},d.prototype.render=function(h){if(this.enabled&&h.accumulateOrderedRenderables&&!(h.globe.projectionLimits&&!h.globe.projectionLimits.containsLocation(this.position.latitude,this.position.longitude))){var u;if(this.lastFrameTime!==h.timestamp)u=this.makeOrderedRenderable(h);else{var m=this.clone();u=m.makeOrderedRenderable(h)}u&&u.isVisible(h)&&(u.layer=h.currentLayer,this.lastFrameTime=h.timestamp,h.addOrderedRenderable(u))}},d.prototype.renderOrdered=function(h){if(this.drawOrderedPlacemark(h),h.pickingMode){var u=new r(this.pickColor.clone(),this.pickDelegate?this.pickDelegate:this,this.position,this.layer,!1);h.pickPoint&&this.mustDrawLabel()&&this.labelBounds.containsPoint(h.convertPointToViewport(h.pickPoint,d.scratchPoint))&&(u.labelPicked=!0),h.resolvePick(u)}},d.prototype.makeOrderedRenderable=function(h){var u,m,g,_;if(this.determineActiveAttributes(h),!this.activeAttributes||(h.surfacePointForMode(this.position.latitude,this.position.longitude,this.position.altitude,this.altitudeMode,this.placePoint),this.eyeDistance=this.alwaysOnTop?0:h.eyePoint.distanceTo(this.placePoint),this.mustDrawLeaderLine(h)&&h.surfacePointForMode(this.position.latitude,this.position.longitude,0,this.altitudeMode,this.groundPoint),!h.projectWithDepth(this.placePoint,this.depthOffset,d.screenPoint)))return null;var y=this.eyeDistanceScaling?Math.max(0,Math.min(1,this.eyeDistanceScalingThreshold/this.eyeDistance)):1;return this.activeTexture?(u=this.activeTexture.originalImageWidth,m=this.activeTexture.originalImageHeight,g=this.activeAttributes.imageScale*y,_=this.activeAttributes.imageOffset.offsetForSize(u,m),this.imageTransform.setTranslation(d.screenPoint[0]-_[0]*g,d.screenPoint[1]-_[1]*g,d.screenPoint[2]),this.imageTransform.setScale(u*g,m*g,1)):(g=this.activeAttributes.imageScale*y,_=this.activeAttributes.imageOffset.offsetForSize(g,g),this.imageTransform.setTranslation(d.screenPoint[0]-_[0],d.screenPoint[1]-_[1],d.screenPoint[2]),this.imageTransform.setScale(g,g,1)),this.imageBounds=c.boundingRectForUnitQuad(this.imageTransform),this.mustDrawLabel()&&(this.labelTexture=h.createTextTexture(this.label,this.activeAttributes.labelAttributes),u=this.labelTexture.imageWidth,m=this.labelTexture.imageHeight,g=this.activeAttributes.labelAttributes.scale*y,_=this.activeAttributes.labelAttributes.offset.offsetForSize(u,m),this.labelTransform.setTranslation(d.screenPoint[0]-_[0]*g,d.screenPoint[1]-_[1]*g,d.screenPoint[2]),this.labelTransform.setScale(u*g,m*g,1),this.labelBounds=c.boundingRectForUnitQuad(this.labelTransform)),this},d.prototype.determineActiveAttributes=function(h){this.highlighted&&this.highlightAttributes?this.activeAttributes=this.highlightAttributes:this.activeAttributes=this.attributes,this.activeAttributes&&this.activeAttributes.imageSource&&(this.activeTexture=h.gpuResourceCache.resourceForKey(this.activeAttributes.imageSource),(!this.activeTexture||this.updateImage)&&(this.activeTexture=h.gpuResourceCache.retrieveTexture(h.currentGlContext,this.activeAttributes.imageSource),this.updateImage=!1))},d.prototype.isVisible=function(h){return h.pickingMode?h.pickRectangle&&(this.imageBounds.intersects(h.pickRectangle)||this.mustDrawLabel()&&this.labelBounds.intersects(h.pickRectangle)||this.mustDrawLeaderLine(h)&&h.pickFrustum.intersectsSegment(this.groundPoint,this.placePoint)):this.imageBounds.intersects(h.viewport)||this.mustDrawLabel()&&this.labelBounds.intersects(h.viewport)||this.mustDrawLeaderLine(h)&&h.frustumInModelCoordinates.intersectsSegment(this.groundPoint,this.placePoint)},d.prototype.drawOrderedPlacemark=function(h){this.beginDrawing(h);try{this.doDrawOrderedPlacemark(h),h.pickingMode||this.drawBatchOrderedPlacemarks(h)}finally{this.endDrawing(h)}},d.prototype.drawBatchOrderedPlacemarks=function(h){for(var u;(u=h.peekOrderedRenderable())&&u.doDrawOrderedPlacemark;){h.popOrderedRenderable();try{u.doDrawOrderedPlacemark(h)}catch(m){i.logMessage(i.LEVEL_WARNING,"Placemark","drawBatchOrderedPlacemarks","Error occurred while rendering placemark using batching: "+m.message)}}},d.prototype.beginDrawing=function(h){var u=h.currentGlContext,m;h.findAndBindProgram(l),m=h.currentProgram,u.bindBuffer(u.ARRAY_BUFFER,h.unitQuadBuffer()),u.vertexAttribPointer(m.vertexTexCoordLocation,2,u.FLOAT,!1,0,0),u.enableVertexAttribArray(m.vertexPointLocation),u.enableVertexAttribArray(m.vertexTexCoordLocation),m.loadTextureUnit(u,u.TEXTURE0),m.loadModulateColor(u,h.pickingMode)},d.prototype.endDrawing=function(h){var u=h.currentGlContext,m=h.currentProgram;u.disableVertexAttribArray(m.vertexPointLocation),u.disableVertexAttribArray(m.vertexTexCoordLocation),u.bindBuffer(u.ARRAY_BUFFER,null),u.bindTexture(u.TEXTURE_2D,null)},d.prototype.doDrawOrderedPlacemark=function(h){var u=h.currentGlContext,m=h.currentProgram,g=!0,_;if(h.pickingMode&&(this.pickColor=h.uniquePickColor()),this.eyeDistanceScaling&&this.eyeDistance>this.eyeDistanceScalingLabelThreshold&&(this.targetVisibility=0),!h.pickingMode&&this.mustDrawLabel()&&this.currentVisibility!=this.targetVisibility){var y=(h.timestamp-h.previousRedrawTimestamp)/h.fadeTime;this.currentVisibility<this.targetVisibility?this.currentVisibility=Math.min(1,this.currentVisibility+y):this.currentVisibility=Math.max(0,this.currentVisibility-y),h.redrawRequested=!0}if(m.loadOpacity(u,h.pickingMode?1:this.layer.opacity),this.mustDrawLeaderLine(h)){this.leaderLinePoints||(this.leaderLinePoints=new Float32Array(6)),this.leaderLinePoints[0]=this.groundPoint[0],this.leaderLinePoints[1]=this.groundPoint[1],this.leaderLinePoints[2]=this.groundPoint[2],this.leaderLinePoints[3]=this.placePoint[0],this.leaderLinePoints[4]=this.placePoint[1],this.leaderLinePoints[5]=this.placePoint[2],this.leaderLineCacheKey||(this.leaderLineCacheKey=h.gpuResourceCache.generateCacheKey());var v=h.gpuResourceCache.resourceForKey(this.leaderLineCacheKey);v||(v=u.createBuffer(),h.gpuResourceCache.putResource(this.leaderLineCacheKey,v,this.leaderLinePoints.length*4)),m.loadTextureEnabled(u,!1),m.loadColor(u,h.pickingMode?this.pickColor:this.activeAttributes.leaderLineAttributes.outlineColor),d.matrix.copy(h.modelviewProjection),m.loadModelviewProjection(u,d.matrix),this.activeAttributes.leaderLineAttributes.depthTest||u.disable(u.DEPTH_TEST),u.lineWidth(this.activeAttributes.leaderLineAttributes.outlineWidth),u.bindBuffer(u.ARRAY_BUFFER,v),u.bufferData(u.ARRAY_BUFFER,this.leaderLinePoints,u.STATIC_DRAW),h.frameStatistics.incrementVboLoadCount(1),u.vertexAttribPointer(m.vertexPointLocation,3,u.FLOAT,!1,0,0),u.drawArrays(u.LINES,0,2)}this.activeAttributes.depthTest||(g=!1,u.disable(u.DEPTH_TEST)),u.bindBuffer(u.ARRAY_BUFFER,h.unitQuadBuffer3()),u.vertexAttribPointer(m.vertexPointLocation,3,u.FLOAT,!1,0,0),d.matrix.copy(h.screenProjection),d.matrix.multiplyMatrix(this.imageTransform);var b=this.imageRotationReference===WorldWind.RELATIVE_TO_GLOBE?h.navigator.heading-this.imageRotation:-this.imageRotation;d.matrix.multiplyByTranslation(.5,.5,0),d.matrix.multiplyByRotation(0,0,1,b),d.matrix.multiplyByTranslation(-.5,-.5,0);var R=this.imageTiltReference===WorldWind.RELATIVE_TO_GLOBE?h.navigator.tilt+this.imageTilt:this.imageTilt;d.matrix.multiplyByRotation(-1,0,0,R),m.loadModelviewProjection(u,d.matrix),m.loadTextureEnabled(u,!0),h.pickingMode?m.loadColor(u,this.pickColor):m.loadColor(u,this.activeAttributes.imageColor),this.texCoordMatrix.setToIdentity(),this.activeTexture&&this.texCoordMatrix.multiplyByTextureTransform(this.activeTexture),m.loadTextureMatrix(u,this.texCoordMatrix),this.activeTexture?(_=this.activeTexture.bind(h),m.loadTextureEnabled(u,_)):m.loadTextureEnabled(u,!1),u.drawArrays(u.TRIANGLE_STRIP,0,4),this.mustDrawLabel()&&this.currentVisibility>0&&(m.loadOpacity(u,h.pickingMode?1:this.layer.opacity*this.currentVisibility),d.matrix.copy(h.screenProjection),d.matrix.multiplyMatrix(this.labelTransform),m.loadModelviewProjection(u,d.matrix),!h.pickingMode&&this.labelTexture?(this.texCoordMatrix.setToIdentity(),this.texCoordMatrix.multiplyByTextureTransform(this.labelTexture),m.loadTextureMatrix(u,this.texCoordMatrix),m.loadColor(u,n.WHITE),_=this.labelTexture.bind(h),m.loadTextureEnabled(u,_)):(m.loadTextureEnabled(u,!1),m.loadColor(u,this.pickColor)),this.activeAttributes.labelAttributes.depthTest?g||(g=!0,u.enable(u.DEPTH_TEST)):(g=!1,u.disable(u.DEPTH_TEST)),u.drawArrays(u.TRIANGLE_STRIP,0,4)),g||u.enable(u.DEPTH_TEST)},d.prototype.mustDrawLabel=function(){return this.label&&this.label.length>0&&this.activeAttributes.labelAttributes},d.prototype.mustDrawLeaderLine=function(h){return this.activeAttributes.drawLeaderLine&&this.activeAttributes.leaderLineAttributes&&(!h.pickingMode||this.enableLeaderLinePicking)},d.prototype.getReferencePosition=function(){return this.position},d.prototype.moveTo=function(h,u){this.position=u},d}),B("shapes/Polygon",["../shapes/AbstractShape","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolygon","../geom/Vec2","../geom/Vec3","../util/libtess"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m){"use strict";var g=function(_,y){if(!_)throw new l(s.logMessage(s.LEVEL_SEVERE,"Polygon","constructor","missingBoundaries"));p.call(this,y),_.length>0&&_[0].latitude&&(_=[_],this._boundariesSpecifiedSimply=!0),this._boundaries=_,this._textureCoordinates=null,this.referencePosition=this.determineReferencePosition(this._boundaries),this._extrude=!1,this.scratchPoint=new u(0,0,0)};return g.prototype=Object.create(p.prototype),Object.defineProperties(g.prototype,{boundaries:{get:function(){return this._boundariesSpecifiedSimply?this._boundaries[0]:this._boundaries},set:function(_){if(!_)throw new l(s.logMessage(s.LEVEL_SEVERE,"Polygon","boundaries","missingBoundaries"));_.length>0&&_[0].latitude&&(_=[_],this._boundariesSpecifiedSimply=!0),this._boundaries=_,this.referencePosition=this.determineReferencePosition(this._boundaries),this.reset()}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(_){this._textureCoordinates=_,this.reset()}},extrude:{get:function(){return this._extrude},set:function(_){this._extrude=_,this.reset()}}}),g.prototype.determineReferencePosition=function(_){return _.length>0&&_[0].length>2?_[0][0]:null},g.prototype.mustGenerateGeometry=function(_){return!this.currentData.boundaryPoints||this.currentData.drawInterior!==this.activeAttributes.drawInterior?!0:this.altitudeMode===WorldWind.ABSOLUTE?!1:this.currentData.isExpired},g.prototype.hasCapTexture=function(){return this.textureCoordinates&&this.capImageSource()},g.prototype.capImageSource=function(){return this.activeAttributes.imageSource?typeof this.activeAttributes.imageSource=="string"||this.activeAttributes.imageSource instanceof t?this.activeAttributes.imageSource:Array.isArray(this.activeAttributes.imageSource)&&this.activeAttributes.imageSource[0]&&(typeof this.activeAttributes.imageSource[0]=="string"||this.activeAttributes.imageSource instanceof t)?this.activeAttributes.imageSource[0]:null:null},g.prototype.hasSideTextures=function(){return this.activeAttributes.imageSource&&Array.isArray(this.activeAttributes.imageSource)&&this.activeAttributes.imageSource.length>1},g.prototype.sideImageSource=function(_){if(_===0||this.activeAttributes.imageSource.length===2)return this.activeAttributes.imageSource[1];var y=this.activeAttributes.imageSource.length-1;return _=Math.min(_+1,y),this.activeAttributes.imageSource[_]},g.prototype.createSurfaceShape=function(){return new d(this.boundaries,null)},g.prototype.doMakeOrderedRenderable=function(_){if(!this.referencePosition||!this.activeAttributes.drawInterior&&!this.activeAttributes.drawOutline)return null;if(!this.mustGenerateGeometry(_))return this;var y=this.currentData,v=y.referencePoint;_.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude,this._altitudeMode,v),y.transformationMatrix.setToTranslation(v[0],v[1],v[2]);for(var b=[],R=0;R<this._boundaries.length;R++)b[R]=this._boundaries[R].slice(0),b[R].push(this._boundaries[R][0]);var M=this.computeBoundaryPoints(_,b);if(this.activeAttributes.drawInterior){var P=this.tessellatePolygon(_,M);if(P){y.capTriangles=new Float32Array(P.length);for(var T=0,E=P.length;T<E;T++)y.capTriangles[T]=P[T]}}if(y.boundaryPoints=M,y.drawInterior=this.activeAttributes.drawInterior,this.resetExpiration(y),y.refreshBuffers=!0,y.extent||(y.extent=new e),M.length===1)y.extent.setToPoints(M[0]);else{var x=[];for(R=0;R<M.length;R++)for(var S=0;S<M[R].length;S++)x.push(M[R][S]);y.extent.setToPoints(x)}return y.extent.translate(y.referencePoint),this},g.prototype.computeBoundaryPoints=function(_,y){for(var v=Number.MAX_VALUE,b=_.eyePoint,R=[],M=this._extrude?6:3,P=new u(0,0,0),T,E,x,S,L=0;L<y.length;L++){T=(this._extrude?2:1)*y[L].length,R[L]=new Float32Array(T*3);for(var C=0,F=y[L].length;C<F;C++)E=y[L][C],_.surfacePointForMode(E.latitude,E.longitude,E.altitude,this.altitudeMode,P),S=P.distanceToSquared(b),S<v&&(v=S),P.subtract(this.currentData.referencePoint),x=M*C,R[L][x]=P[0],R[L][x+1]=P[1],R[L][x+2]=P[2],this._extrude&&(_.surfacePointForMode(E.latitude,E.longitude,0,WorldWind.CLAMP_TO_GROUND,P),S=P.distanceToSquared(b),S<v&&(v=S),P.subtract(this.currentData.referencePoint),R[L][x+3]=P[0],R[L][x+4]=P[1],R[L][x+5]=P[2])}return this.currentData.eyeDistance=0,R},g.prototype.tessellatePolygon=function(_,y){var v=[],b=0,R=this._extrude?6:3,M=this.hasCapTexture(),P,T;this.polygonTessellator||(this.polygonTessellator=new D.GluTesselator,this.polygonTessellator.gluTessCallback(D.gluEnum.GLU_TESS_VERTEX_DATA,function(C,F){F[F.length]=C[0],F[F.length]=C[1],F[F.length]=C[2],M&&(F[F.length]=C[3],F[F.length]=C[4])}),this.polygonTessellator.gluTessCallback(D.gluEnum.GLU_TESS_COMBINE,function(C,F,q){var it=[C[0],C[1],C[2]];if(M)for(var st=3;st<=4;st++){for(var pt=0,_t=0;_t<4;_t++)q[_t]>0&&(pt+=q[_t]*F[_t][st]);it[st]=pt}return it}),this.polygonTessellator.gluTessCallback(D.gluEnum.GLU_TESS_ERROR,function(C){b=C,s.logMessage(s.LEVEL_WARNING,"Polygon","tessellatePolygon","Tessellation error "+C+".")})),T=u.computeBufferNormal(y[0],R),T||(T=new u(0,0,0),_.globe.surfaceNormalAtLocation(this.referencePosition.latitude,this.referencePosition.longitude,T)),this.polygonTessellator.gluTessNormal(T[0],T[1],T[2]),this.currentData.capNormal=T,this.polygonTessellator.gluTessBeginPolygon(v);for(var E=0;E<y.length;E++){var x=0;this.polygonTessellator.gluTessBeginContour();for(var S=y[E],L=0;L<S.length;L+=R)P=[S[L],S[L+1],S[L+2]],M&&(x<this.textureCoordinates[E].length?(P[3]=this.textureCoordinates[E][x][0],P[4]=this.textureCoordinates[E][x][1]):(P[3]=this.textureCoordinates[E][0][0],P[4]=this.textureCoordinates[E][1][1]),++x),this.polygonTessellator.gluTessVertex(P,P);this.polygonTessellator.gluTessEndContour()}return this.polygonTessellator.gluTessEndPolygon(),b===0?v:null},g.prototype.mustDrawVerticals=function(_){return this._extrude&&this.activeAttributes.drawOutline&&this.activeAttributes.drawVerticals&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND},g.prototype.doRenderOrdered=function(_){var y=this.currentData,v;if(_.pickingMode&&(v=_.uniquePickColor()),this.activeAttributes.drawInterior&&y.capTriangles&&y.capTriangles.length>0&&this.drawCap(_,v),this._extrude&&this.activeAttributes.drawInterior&&this.drawSides(_,v),this.activeAttributes.drawOutline&&this.drawOutline(_,v),y.refreshBuffers=!1,_.pickingMode){var b=new f(v,this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);_.resolvePick(b)}},g.prototype.drawCap=function(_,y){var v=_.currentGlContext,b=_.currentProgram,R=this.currentData,M=R.refreshBuffers,P=!!this.hasCapTexture(),T=this.activeAttributes.applyLighting,E=R.capTriangles.length/(P?5:3),x,S,L,C,F;b.loadTextureEnabled(v,!1),this.applyMvpMatrix(_),R.capVboCacheKey||(R.capVboCacheKey=_.gpuResourceCache.generateCacheKey()),x=_.gpuResourceCache.resourceForKey(R.capVboCacheKey),x||(x=v.createBuffer(),_.gpuResourceCache.putResource(R.capVboCacheKey,x,R.capTriangles.length*4),M=!0),v.bindBuffer(v.ARRAY_BUFFER,x),M&&(F=T?this.makeCapBufferWithNormals():R.capTriangles,v.bufferData(v.ARRAY_BUFFER,F,v.STATIC_DRAW),_.frameStatistics.incrementVboLoadCount(1)),S=this.activeAttributes.interiorColor,v.depthMask(S.alpha*this.layer.opacity>=1||_.pickingMode),b.loadColor(v,_.pickingMode?y:S),b.loadOpacity(v,_.pickingMode?1:this.layer.opacity),L=12+(P?8:0)+(T?12:0),P&&!_.pickingMode&&(this.activeTexture=_.gpuResourceCache.resourceForKey(this.capImageSource()),this.activeTexture||(this.activeTexture=_.gpuResourceCache.retrieveTexture(_.currentGlContext,this.capImageSource())),C=this.activeTexture&&this.activeTexture.bind(_),C&&(v.enableVertexAttribArray(b.vertexTexCoordLocation),v.vertexAttribPointer(b.vertexTexCoordLocation,2,v.FLOAT,!1,L,12),this.scratchMatrix.setToIdentity(),this.scratchMatrix.multiplyByTextureTransform(this.activeTexture),b.loadTextureEnabled(v,!0),b.loadTextureUnit(v,v.TEXTURE0),b.loadTextureMatrix(v,this.scratchMatrix),b.loadModulateColor(v,_.pickingMode))),T&&!_.pickingMode&&(b.loadApplyLighting(v,!0),v.enableVertexAttribArray(b.normalVectorLocation),v.vertexAttribPointer(b.normalVectorLocation,3,v.FLOAT,!1,L,L-12)),v.vertexAttribPointer(b.vertexPointLocation,3,v.FLOAT,!1,L,0),v.drawArrays(v.TRIANGLES,0,E)},g.prototype.makeCapBufferWithNormals=function(){for(var _=this.currentData,y=_.capNormal,v=this.hasCapTexture()?5:3,b=v+3,R=_.capTriangles.length/v,M=_.capTriangles,P=new Float32Array(R*b),T=0,E=0;E<R;E++){for(var x=0;x<v;x++)P[T++]=M[E*v+x];P[T++]=y[0],P[T++]=y[1],P[T++]=y[2]}return P},g.prototype.drawSides=function(_,y){var v=_.currentGlContext,b=_.currentProgram,R=this.currentData,M=R.refreshBuffers,P=this.hasSideTextures(),T=this.activeAttributes.applyLighting,E=3+(P?2:0)+(T?3:0),x=4*E,S,L,C,F,q,it;it=0;for(var st=0;st<R.boundaryPoints.length;st++)it+=R.boundaryPoints[st].length/6-1;if(R.sidesVboCacheKey||(R.sidesVboCacheKey=_.gpuResourceCache.generateCacheKey()),S=_.gpuResourceCache.resourceForKey(R.sidesVboCacheKey),!S||M?(q=this.makeSidesBuffer(it),R.numSideVertices=q.length/E,S||(S=v.createBuffer()),_.gpuResourceCache.putResource(R.sidesVboCacheKey,S,q.length*4),v.bindBuffer(v.ARRAY_BUFFER,S),v.bufferData(v.ARRAY_BUFFER,q,v.STATIC_DRAW),_.frameStatistics.incrementVboLoadCount(1)):v.bindBuffer(v.ARRAY_BUFFER,S),C=this.activeAttributes.interiorColor,v.depthMask(C.alpha*this.layer.opacity>=1||_.pickingMode),b.loadColor(v,_.pickingMode?y:C),b.loadOpacity(v,_.pickingMode?1:this.layer.opacity),P&&!_.pickingMode){T?(b.loadApplyLighting(v,!0),v.enableVertexAttribArray(b.normalVectorLocation)):b.loadApplyLighting(v,!1);for(var pt=0;pt<it;pt++){var _t=this.sideImageSource(pt),X=_.gpuResourceCache.resourceForKey(_t),ot=pt*6*x;_t&&!X&&(X=_.gpuResourceCache.retrieveTexture(_.currentGlContext,_t)),F=X&&X.bind(_),F?(v.enableVertexAttribArray(b.vertexTexCoordLocation),v.vertexAttribPointer(b.vertexTexCoordLocation,2,v.FLOAT,!1,x,ot+12),this.scratchMatrix.setToIdentity(),this.scratchMatrix.multiplyByTextureTransform(X),b.loadTextureEnabled(v,!0),b.loadTextureUnit(v,v.TEXTURE0),b.loadTextureMatrix(v,this.scratchMatrix)):(b.loadTextureEnabled(v,!1),v.disableVertexAttribArray(b.vertexTexCoordLocation)),T&&v.vertexAttribPointer(b.normalVectorLocation,3,v.FLOAT,!1,x,ot+20),v.vertexAttribPointer(b.vertexPointLocation,3,v.FLOAT,!1,x,ot),v.drawArrays(v.TRIANGLES,0,6)}}else b.loadTextureEnabled(v,!1),T&&!_.pickingMode?(b.loadApplyLighting(v,!0),v.enableVertexAttribArray(b.normalVectorLocation),v.vertexAttribPointer(b.normalVectorLocation,3,v.FLOAT,!1,x,x-12)):b.loadApplyLighting(v,!1),v.vertexAttribPointer(b.vertexPointLocation,3,v.FLOAT,!1,x,0),v.drawArrays(v.TRIANGLES,0,R.numSideVertices)},g.prototype.makeSidesBuffer=function(_){var y=this.currentData,v=this.hasSideTextures(),b=this.activeAttributes.applyLighting,R=3+(v?2:0)+(b?3:0),M,P,T,E,x,S,L,C,F,q,it;T=_*2*3*R,M=new Float32Array(T),P=0,E=new u(0,0,0),x=new u(0,0,0),S=new u(0,0,0),L=new u(0,0,0),v?(C=new h(0,1),F=new h(0,0),q=new h(1,1),it=new h(1,0)):C=F=q=it=null;for(var st=0;st<y.boundaryPoints.length;st++)for(var pt=y.boundaryPoints[st],_t,X=0;X<pt.length-6;X+=6)E[0]=pt[X],E[1]=pt[X+1],E[2]=pt[X+2],x[0]=pt[X+3],x[1]=pt[X+4],x[2]=pt[X+5],S[0]=pt[X+6],S[1]=pt[X+7],S[2]=pt[X+8],L[0]=pt[X+9],L[1]=pt[X+10],L[2]=pt[X+11],_t=b?u.computeTriangleNormal(E,x,S):null,this.addVertexToBuffer(E,C,_t,M,P),P+=R,this.addVertexToBuffer(x,F,_t,M,P),P+=R,this.addVertexToBuffer(S,q,_t,M,P),P+=R,this.addVertexToBuffer(x,F,_t,M,P),P+=R,this.addVertexToBuffer(L,it,_t,M,P),P+=R,this.addVertexToBuffer(S,q,_t,M,P),P+=R;return M},g.prototype.addVertexToBuffer=function(_,y,v,b,R){b[R++]=_[0],b[R++]=_[1],b[R++]=_[2],y&&(b[R++]=y[0],b[R++]=y[1]),v&&(b[R++]=v[0],b[R++]=v[1],b[R]=v[2])},g.prototype.drawOutline=function(_,y){var v=_.currentGlContext,b=_.currentProgram,R=this.currentData,M=R.refreshBuffers,P,T,E,x,S,L,C;b.loadTextureEnabled(v,!1),b.loadApplyLighting(v,!1),this.hasCapTexture()&&v.disableVertexAttribArray(b.vertexTexCoordLocation),this.activeAttributes.applyLighting&&v.disableVertexAttribArray(b.normalVectorLocation),R.boundaryVboCacheKeys||(this.currentData.boundaryVboCacheKeys=[]),this.applyMvpMatrixForOutline(_),b.loadTextureEnabled(v,!1),v.disableVertexAttribArray(b.vertexTexCoordLocation);for(var F=0;F<R.boundaryPoints.length;F++)P=R.boundaryPoints[F].length/3,R.boundaryVboCacheKeys[F]||(R.boundaryVboCacheKeys[F]=_.gpuResourceCache.generateCacheKey()),T=_.gpuResourceCache.resourceForKey(R.boundaryVboCacheKeys[F]),T||(T=v.createBuffer(),_.gpuResourceCache.putResource(R.boundaryVboCacheKeys[F],T,P*12),M=!0),v.bindBuffer(v.ARRAY_BUFFER,T),M&&(v.bufferData(v.ARRAY_BUFFER,R.boundaryPoints[F],v.STATIC_DRAW),_.frameStatistics.incrementVboLoadCount(1)),x=this.activeAttributes.outlineColor,v.depthMask(x.alpha*this.layer.opacity>=1||_.pickingMode),b.loadColor(v,_.pickingMode?y:x),b.loadOpacity(v,_.pickingMode?1:this.layer.opacity),v.lineWidth(this.activeAttributes.outlineWidth),this._extrude?(S=24,L=P/2):(S=12,L=P),v.vertexAttribPointer(b.vertexPointLocation,3,v.FLOAT,!1,S,0),v.drawArrays(v.LINE_STRIP,0,L),this.mustDrawVerticals(_)&&(v.vertexAttribPointer(b.vertexPointLocation,3,v.FLOAT,!1,0,0),v.drawArrays(v.LINES,0,P-2))},g.prototype.beginDrawing=function(_){var y=_.currentGlContext;this.activeAttributes.drawInterior&&y.disable(y.CULL_FACE),_.findAndBindProgram(n),y.enableVertexAttribArray(_.currentProgram.vertexPointLocation);var v=!_.pickMode&&this.activeAttributes.applyLighting;v&&_.currentProgram.loadModelviewInverse(y,_.modelviewNormalTransform)},g.prototype.endDrawing=function(_){var y=_.currentGlContext;y.disableVertexAttribArray(_.currentProgram.vertexPointLocation),y.disableVertexAttribArray(_.currentProgram.normalVectorLocation),y.depthMask(!0),y.lineWidth(1),y.enable(y.CULL_FACE)},g}),B("shapes/SurfacePolyline",["../error/ArgumentError","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(p,l,n,e){"use strict";var i=function(t,r){if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"SurfacePolyline","constructor","The specified locations array is null or undefined."));e.call(this,r),this._boundaries=t,this._stateId=i.stateId++,this._isInteriorInhibited=!0};return i.prototype=Object.create(e.prototype),Object.defineProperties(i.prototype,{boundaries:{get:function(){return this._boundaries},set:function(t){if(!Array.isArray(t))throw new p(l.logMessage(l.LEVEL_SEVERE,"SurfacePolyline","set boundaries","The specified value is not an array."));this.resetBoundaries(),this._boundaries=t,this._stateId=i.stateId++,this.stateKeyInvalid=!0}}}),i.stateId=Number.MIN_SAFE_INTEGER,i.staticStateKey=function(t){var r=e.staticStateKey(t);return r+" pl "+t._stateId},i.prototype.computeStateKey=function(){return i.staticStateKey(this)},i.prototype.computeBoundaries=function(t){},i.prototype.getReferencePosition=function(){return this.boundaries.length>1?this.boundaries[0]:null},i.prototype.moveTo=function(t,r){this.boundaries=this.computeShiftedLocations(t,this.getReferencePosition(),r,this._boundaries)},i}),B("formats/geojson/GeoJSONParser",["../../error/ArgumentError","../../util/Color","./GeoJSONConstants","./GeoJSONCRS","./GeoJSONFeature","./GeoJSONFeatureCollection","./GeoJSONGeometry","./GeoJSONGeometryCollection","./GeoJSONGeometryLineString","./GeoJSONGeometryMultiLineString","./GeoJSONGeometryMultiPoint","./GeoJSONGeometryMultiPolygon","./GeoJSONGeometryPoint","./GeoJSONGeometryPolygon","../../geom/Location","../../util/Logger","../../shapes/Placemark","../../shapes/PlacemarkAttributes","../../shapes/Polygon","../../geom/Position","../../util/proj4-src","../../layer/RenderableLayer","../../shapes/ShapeAttributes","../../shapes/SurfacePolygon","../../shapes/SurfacePolyline"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m,g,_,y,v,b,R,M,P,T){"use strict";var E=function(x){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","constructor","missingDataSource"));this._dataSource=x,this._geoJSONObject=null,this._geoJSONType=null,this._crs=null,this._layer=null,this._parserCompletionCallback=null,this._shapeConfigurationCallback=this.defaultShapeConfigurationCallback,this.defaultPlacemarkAttributes=new _(null),this.defaultShapeAttributes=new M(null),this.setProj4jsAliases()};return Object.defineProperties(E.prototype,{dataSource:{get:function(){return this._dataSource}},geoJSONObject:{get:function(){return this._geoJSONObject}},geoJSONType:{get:function(){return this._geoJSONType}},crs:{get:function(){return this._crs}},layer:{get:function(){return this._layer}},parserCompletionCallback:{get:function(){return this._parserCompletionCallback}},shapeConfigurationCallback:{get:function(){return this._shapeConfigurationCallback}}}),E.prototype.load=function(x,S,L){x&&(this._parserCompletionCallback=x),S&&(this._shapeConfigurationCallback=S),this._layer=L||new R;var C=typeof this.dataSource;if(C==="string"){var F=E.tryParseJSONString(this.dataSource);F!==null?this.handle(F):this.requestUrl(this.dataSource)}else C==="object"?this.handle(this.dataSource):m.logMessage(m.LEVEL_SEVERE,"GeoJSON","load","Unsupported data source type: "+C)},E.prototype.defaultShapeConfigurationCallback=function(x,S){var L={},C=S.name||S.Name||S.NAME;return C&&(L.name=C),x.isPointType()||x.isMultiPointType()?L.attributes=this.defaultPlacemarkAttributes:x.isLineStringType()||x.isMultiLineStringType()?L.attributes=this.defaultShapeAttributes:(x.isPolygonType()||x.isMultiPolygonType())&&(L.attributes=this.defaultShapeAttributes),L},E.prototype.requestUrl=function(x){var S=new XMLHttpRequest;S.open("GET",x,!0),S.responseType="text",S.onreadystatechange=(function(){S.readyState===4&&(S.status===200?this.handle(E.tryParseJSONString(S.response)):m.log(m.LEVEL_WARNING,"GeoJSON retrieval failed ("+S.statusText+"): "+x))}).bind(this),S.onerror=function(){m.log(m.LEVEL_WARNING,"GeoJSON retrieval failed: "+x)},S.ontimeout=function(){m.log(m.LEVEL_WARNING,"GeoJSON retrieval timed out: "+x)},S.send(null)},E.prototype.handle=function(x){if(x||m.logMessage(m.LEVEL_SEVERE,"GeoJSON","handle","Invalid GeoJSON object"),this._geoJSONObject=x,Object.prototype.toString.call(this.geoJSONObject)==="[object Array]")throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","handle","invalidGeoJSONObjectLength"));if(this.geoJSONObject.hasOwnProperty(n.FIELD_TYPE))this.setGeoJSONType(),this.setGeoJSONCRS();else throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","handle","missingGeoJSONType"));this._parserCompletionCallback&&typeof this._parserCompletionCallback=="function"&&this._parserCompletionCallback(this.layer)},E.prototype.setGeoJSONCRS=function(){if(this.geoJSONObject[n.FIELD_CRS]){this._crs=new e(this.geoJSONObject[n.FIELD_CRS][n.FIELD_TYPE],this.geoJSONObject[n.FIELD_CRS][n.FIELD_PROPERTIES]);var x=(function(){this.addRenderablesForGeoJSON(this.layer)}).bind(this);this.crs.setCRSString(x)}else this.addRenderablesForGeoJSON(this.layer)},E.prototype.addRenderablesForGeoJSON=function(x){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeoJSON","missingLayer"));switch(this.geoJSONType){case n.TYPE_FEATURE:var S=new i(this.geoJSONObject[n.FIELD_GEOMETRY],this.geoJSONObject[n.FIELD_PROPERTIES],this.geoJSONObject[n.FIELD_ID],this.geoJSONObject[n.FIELD_BBOX]);this.addRenderablesForFeature(x,S);break;case n.TYPE_FEATURE_COLLECTION:var L=new t(this.geoJSONObject[n.FIELD_FEATURES],this.geoJSONObject[n.FIELD_BBOX]);this.addRenderablesForFeatureCollection(x,L);break;case n.TYPE_GEOMETRY_COLLECTION:var C=new s(this.geoJSONObject[n.FIELD_GEOMETRIES],this.geoJSONObject[n.FIELD_BBOX]);this.addRenderablesForGeometryCollection(x,C,null);break;default:this.addRenderablesForGeometry(x,this.geoJSONObject,null);break}},E.prototype.addRenderablesForGeometry=function(x,S,L){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometry","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometry","missingGeometry"));switch(S[n.FIELD_TYPE]){case n.TYPE_POINT:var C=new d(S[n.FIELD_COORDINATES],S[n.FIELD_TYPE],S[n.FIELD_BBOX]);this.addRenderablesForPoint(x,C,L||null);break;case n.TYPE_MULTI_POINT:var F=new o(S[n.FIELD_COORDINATES],S[n.FIELD_TYPE],S[n.FIELD_BBOX]);this.addRenderablesForMultiPoint(x,F,L||null);break;case n.TYPE_LINE_STRING:var q=new a(S[n.FIELD_COORDINATES],S[n.FIELD_TYPE],S[n.FIELD_BBOX]);this.addRenderablesForLineString(x,q,L||null);break;case n.TYPE_MULTI_LINE_STRING:var it=new f(S[n.FIELD_COORDINATES],S[n.FIELD_TYPE],S[n.FIELD_BBOX]);this.addRenderablesForMultiLineString(x,it,L||null);break;case n.TYPE_POLYGON:var st=new h(S[n.FIELD_COORDINATES],S[n.FIELD_TYPE],S[n.FIELD_BBOX]);this.addRenderablesForPolygon(x,st,L||null);break;case n.TYPE_MULTI_POLYGON:var pt=new c(S[n.FIELD_COORDINATES],S[n.FIELD_TYPE],S[n.FIELD_BBOX]);this.addRenderablesForMultiPolygon(x,pt,L||null);break;default:break}},E.prototype.addRenderablesForPoint=function(x,S,L){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForPoint","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForPoint","missingGeometry"));var C=this.shapeConfigurationCallback(S,L);if(!this.crs||this.crs.isCRSSupported()){var F=S.coordinates[0],q=S.coordinates[1],it=S.coordinates[2]?S.coordinates[2]:0,st=this.getReprojectedIfRequired(q,F,this.crs),pt=new v(st[1],st[0],it),_t=new g(pt,!1,C&&C.attributes?C.attributes:null);_t.altitudeMode=WorldWind.RELATIVE_TO_GROUND,C&&C.name&&(_t.label=C.name),C.highlightAttributes&&(_t.highlightAttributes=C.highlightAttributes),C&&C.pickDelegate&&(_t.pickDelegate=C.pickDelegate),C&&C.userProperties&&(_t.userProperties=C.userProperties),x.addRenderable(_t)}},E.prototype.addRenderablesForMultiPoint=function(x,S,L){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPoint","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPoint","missingGeometry"));var C=this.shapeConfigurationCallback(S,L);if(!this.crs||this.crs.isCRSSupported())for(var F=0,q=S.coordinates.length;F<q;F+=1){var it=S.coordinates[F][0],st=S.coordinates[F][1],pt=S.coordinates[F][2]?S.coordinates[F][2]:0,_t=this.getReprojectedIfRequired(st,it,this.crs),X=new v(_t[1],_t[0],pt),ot=new g(X,!1,C&&C.attributes?C.attributes:null);ot.altitudeMode=WorldWind.RELATIVE_TO_GROUND,C&&C.name&&(ot.label=C.name),C.highlightAttributes&&(ot.highlightAttributes=C.highlightAttributes),C&&C.pickDelegate&&(ot.pickDelegate=C.pickDelegate),C&&C.userProperties&&(ot.userProperties=C.userProperties),x.addRenderable(ot)}},E.prototype.addRenderablesForLineString=function(x,S,L){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForLineString","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForLineString","missingGeometry"));var C=this.shapeConfigurationCallback(S,L);if(!this.crs||this.crs.isCRSSupported()){for(var F=[],q=0,it=S.coordinates;q<it.length;q++){var st=it[q][0],pt=it[q][1],_t=this.getReprojectedIfRequired(pt,st,this.crs),X=new u(_t[1],_t[0]);F.push(X)}var ot;ot=new T(F,C&&C.attributes?C.attributes:null),C.highlightAttributes&&(ot.highlightAttributes=C.highlightAttributes),C&&C.pickDelegate&&(ot.pickDelegate=C.pickDelegate),C&&C.userProperties&&(ot.userProperties=C.userProperties),x.addRenderable(ot)}},E.prototype.addRenderablesForMultiLineString=function(x,S,L){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiLineString","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiLineString","missingGeometry"));var C=this.shapeConfigurationCallback(S,L);if(!this.crs||this.crs.isCRSSupported())for(var F=0,q=S.coordinates;F<q.length;F++){for(var it=[],st=0,pt=q[F];st<pt.length;st++){var _t=pt[st][0],X=pt[st][1],ot=this.getReprojectedIfRequired(X,_t,this.crs),Tt=new u(ot[1],ot[0]);it.push(Tt)}var Vt;Vt=new T(it,C&&C.attributes?C.attributes:null),C.highlightAttributes&&(Vt.highlightAttributes=C.highlightAttributes),C&&C.pickDelegate&&(Vt.pickDelegate=C.pickDelegate),C&&C.userProperties&&(Vt.userProperties=C.userProperties),x.addRenderable(Vt)}},E.prototype.addRenderablesForPolygon=function(x,S,L){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForPolygon","missingGeometry"));var C=this.shapeConfigurationCallback(S,L);if(!this.crs||this.crs.isCRSSupported()){for(var F=[],q=0,it=S.coordinates;q<it.length;q++){for(var st=[],pt=0,_t=it[q];pt<_t.length;pt++){var X=_t[pt][0],ot=_t[pt][1],Tt=this.getReprojectedIfRequired(ot,X,this.crs),Vt=new u(Tt[1],Tt[0]);st.push(Vt)}F.push(st)}var Gt;Gt=new P(F,C&&C.attributes?C.attributes:null),C.highlightAttributes&&(Gt.highlightAttributes=C.highlightAttributes),C&&C.pickDelegate&&(Gt.pickDelegate=C.pickDelegate),C&&C.userProperties&&(Gt.userProperties=C.userProperties),x.addRenderable(Gt)}},E.prototype.addRenderablesForMultiPolygon=function(x,S,L){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForMultiPolygon","missingGeometry"));var C=this.shapeConfigurationCallback(S,L);if(!this.crs||this.crs.isCRSSupported())for(var F=0,q=S.coordinates;F<q.length;F++){for(var it=[],st=0;st<q[F].length;st++){for(var pt=[],_t=0,X=q[F][st];_t<X.length;_t++){var ot=X[_t][0],Tt=X[_t][1],Vt=this.getReprojectedIfRequired(Tt,ot,this.crs),Gt=new u(Vt[1],Vt[0]);pt.push(Gt)}it.push(pt)}var qt;qt=new P(it,C&&C.attributes?C.attributes:null),C.highlightAttributes&&(qt.highlightAttributes=C.highlightAttributes),C&&C.pickDelegate&&(qt.pickDelegate=C.pickDelegate),C&&C.userProperties&&(qt.userProperties=C.userProperties),x.addRenderable(qt)}},E.prototype.addRenderablesForGeometryCollection=function(x,S,L){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometryCollection","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForGeometryCollection","missingGeometryCollection"));for(var C=0,F=S.geometries;C<F.length;C++)F[C].hasOwnProperty(n.FIELD_TYPE)&&this.addRenderablesForGeometry(x,F[C],L)},E.prototype.addRenderablesForFeature=function(x,S){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeature","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeature","missingFeature"));if(S.geometry.type===n.TYPE_GEOMETRY_COLLECTION){var L=new s(S.geometry.geometries,S.bbox);this.addRenderablesForGeometryCollection(x,L,S.properties)}else this.addRenderablesForGeometry(x,S.geometry,S.properties)},E.prototype.addRenderablesForFeatureCollection=function(x,S){if(!x)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeatureCollection","missingLayer"));if(!S)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","addRenderablesForFeatureCollection","missingFeatureCollection"));if(S.features.length>0)for(var L=0;L<S.features.length;L++){var C=new i(S.features[L][n.FIELD_GEOMETRY],S.features[L][n.FIELD_PROPERTIES],S.features[L][n.FIELD_ID],S.features[L][n.FIELD_BBOX]);this.addRenderablesForFeature(x,C)}},E.prototype.setGeoJSONType=function(){switch(this.geoJSONObject[n.FIELD_TYPE]){case n.TYPE_POINT:this._geoJSONType=n.TYPE_POINT;break;case n.TYPE_MULTI_POINT:this._geoJSONType=n.TYPE_MULTI_POINT;break;case n.TYPE_LINE_STRING:this._geoJSONType=n.TYPE_LINE_STRING;break;case n.TYPE_MULTI_LINE_STRING:this._geoJSONType=n.TYPE_MULTI_LINE_STRING;break;case n.TYPE_POLYGON:this._geoJSONType=n.TYPE_POLYGON;break;case n.TYPE_MULTI_POLYGON:this._geoJSONType=n.TYPE_MULTI_POLYGON;break;case n.TYPE_GEOMETRY_COLLECTION:this._geoJSONType=n.TYPE_GEOMETRY_COLLECTION;break;case n.TYPE_FEATURE:this._geoJSONType=n.TYPE_FEATURE;break;case n.TYPE_FEATURE_COLLECTION:this._geoJSONType=n.TYPE_FEATURE_COLLECTION;break;default:throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","setGeoJSONType","invalidGeoJSONType"))}},E.prototype.getReprojectedIfRequired=function(x,S,L){if(!x&&x!==0)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","getReprojectedIfRequired","missingLatitude"));if(!S&&S!==0)throw new p(m.logMessage(m.LEVEL_SEVERE,"GeoJSON","getReprojectedIfRequired","missingLongitude"));return!L||L.isDefault()?[S,x]:b(L.projectionString,n.EPSG4326_CRS,[S,x])},E.prototype.setProj4jsAliases=function(){b.defs([["urn:ogc:def:crs:EPSG::4326",b.defs("EPSG:4326")],["urn:ogc:def:crs:OGC:1.3:CRS84",b.defs("EPSG:4326")],["urn:ogc:def:crs:EPSG::3857",b.defs("EPSG:3857")]])},E.tryParseJSONString=function(x){try{return JSON.parse(x)}catch(S){return null}},E}),B("projections/ProjectionEquirectangular",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Vec3"],function(p,l,n,e,i){"use strict";var t=function(){n.call(this,"Equirectangular",!0,null)};return t.prototype=Object.create(n.prototype),Object.defineProperties(t.prototype,{stateKey:{get:function(){return"projection equirectangular "}}}),t.prototype.geographicToCartesian=function(r,s,a,f,o,c){if(!r)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesian","missingGlobe"));if(!c)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesian","missingResult"));return c[0]=r.equatorialRadius*a*p.DEGREES_TO_RADIANS+(o?o[0]:0),c[1]=r.equatorialRadius*s*p.DEGREES_TO_RADIANS,c[2]=f,c},t.prototype.geographicToCartesianGrid=function(r,s,a,f,o,c,d,h){if(!r)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingGlobe"));if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingSector"));if(!o||o.length<a*f)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!h)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","geographicToCartesianGrid","missingResult"));var u=r.equatorialRadius,m=s.minLatitude*p.DEGREES_TO_RADIANS,g=s.maxLatitude*p.DEGREES_TO_RADIANS,_=s.minLongitude*p.DEGREES_TO_RADIANS,y=s.maxLongitude*p.DEGREES_TO_RADIANS,v=(g-m)/(a>1?a-1:1),b=(y-_)/(f>1?f-1:1),R=c||new i(0,0,0),M=d?d[0]:0,P,T,E=0,x=0,S,L,C;for(P=0,S=m;P<a;P++,S+=v)for(P===a-1&&(S=g),C=u*S-R[1],T=0,L=_;T<f;T++,L+=b)T===f-1&&(L=y),h[x++]=u*L-R[0]+M,h[x++]=C,h[x++]=o[E++]-R[2];return h},t.prototype.cartesianToGeographic=function(r,s,a,f,o,c){if(!r)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","cartesianToGeographic","missingGlobe"));if(!c)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionEquirectangular","cartesianToGeographic","missingResult"));return c.latitude=a/r.equatorialRadius*p.RADIANS_TO_DEGREES,c.longitude=(s-(o?o[0]:0))/r.equatorialRadius*p.RADIANS_TO_DEGREES,c.altitude=f,c},t}),B("globe/Globe2D",["../globe/ElevationModel","../globe/Globe","../projections/ProjectionEquirectangular"],function(p,l,n){"use strict";var e=function(){l.call(this,new p,new n)};return e.prototype=Object.create(l.prototype),e}),B("util/GoToAnimator",["../geom/Location","../util/Logger","../geom/Position","../geom/Vec3"],function(p,l,n,e){"use strict";var i=function(t){if(!t)throw new ArgumentError(l.logMessage(l.LEVEL_SEVERE,"GoToAnimator","constructor","missingWorldWindow"));this.wwd=t,this.animationFrequency=20,this.travelTime=3e3,this.cancelled=!1};return i.prototype.cancel=function(){this.cancelled=!0},i.prototype.goTo=function(t,r){if(!t)throw new ArgumentError(l.logMessage(l.LEVEL_SEVERE,"GoToAnimator","goTo","missingPosition"));this.completionCallback=r,this.cancelled=!1,this.targetPosition=new n(t.latitude,t.longitude,t.altitude||this.wwd.navigator.range),this.startPosition=new n(this.wwd.navigator.lookAtLocation.latitude,this.wwd.navigator.lookAtLocation.longitude,this.wwd.navigator.range),this.startTime=Date.now();var s=this.travelTime,a=p.greatCircleDistance(this.startPosition,this.targetPosition),f,o=this.wwd.globe.computePointFromLocation(this.startPosition.latitude,this.startPosition.longitude,new e(0,0,0)),c=this.wwd.globe.computePointFromLocation(this.targetPosition.latitude,this.targetPosition.longitude,new e(0,0,0));this.maxAltitude=o.distanceTo(c);var d=this.wwd.pixelSizeAtDistance(this.startPosition.altitude)*this.wwd.canvas.clientWidth/this.wwd.globe.equatorialRadius;a<=2*d&&(this.maxAltitude=this.startPosition.altitude),this.maxAltitudeReachedTime=this.maxAltitude<=this.wwd.navigator.range?Date.now():null,this.maxAltitude>this.startPosition.altitude?(f=Math.max(0,this.maxAltitude-this.startPosition.altitude),f+=Math.abs(this.targetPosition.altitude-this.maxAltitude)):f=Math.abs(this.targetPosition.altitude-this.startPosition.altitude);var h=Math.max(a,f/this.wwd.globe.equatorialRadius);if(h!==0){h<2*d&&(s=Math.min(h/d*this.travelTime,this.travelTime)),s=Math.max(1,s),this.panVelocity=a/s,this.rangeVelocity=f/s;var u=this,m=function(){if(u.cancelled){u.completionCallback&&u.completionCallback(u);return}u.update()?setTimeout(m,u.animationFrequency):u.completionCallback&&u.completionCallback(u)};setTimeout(m,this.animationFrequency)}},i.prototype.update=function(){var t=new n(this.wwd.navigator.lookAtLocation.latitude,this.wwd.navigator.lookAtLocation.longitude,this.wwd.navigator.range),r=this.updateRange(t);return r=this.updateLocation(t)||r,this.wwd.redraw(),r},i.prototype.updateRange=function(t){var r=!1,s,a;return this.maxAltitudeReachedTime?(a=Date.now()-this.maxAltitudeReachedTime,this.maxAltitude>this.targetPosition.altitude?(s=this.maxAltitude-this.rangeVelocity*a,s=Math.max(s,this.targetPosition.altitude)):(s=this.maxAltitude+this.rangeVelocity*a,s=Math.min(s,this.targetPosition.altitude)),this.wwd.navigator.range=s,r=Math.abs(this.wwd.navigator.range-this.targetPosition.altitude)>1):(a=Date.now()-this.startTime,s=Math.min(this.startPosition.altitude+this.rangeVelocity*a,this.maxAltitude),Math.abs(this.wwd.navigator.range-s)<1&&(this.maxAltitudeReachedTime=Date.now()),this.wwd.navigator.range=s,r=!0),r},i.prototype.updateLocation=function(t){var r=Date.now()-this.startTime,s=p.greatCircleDistance(this.startPosition,t),a=p.greatCircleDistance(t,this.targetPosition),f=p.greatCircleAzimuth(t,this.targetPosition),o=this.panVelocity*r,c=Math.min(o-s,a),d=p.greatCircleLocation(t,f,c,new p(0,0)),h=!1;return this.wwd.navigator.lookAtLocation.latitude=d.latitude,this.wwd.navigator.lookAtLocation.longitude=d.longitude,c<1/this.wwd.globe.equatorialRadius&&(h=!0),!h},i}),B("layer/heatmap/HeatMapTile",[],function(){var p=function(l,n){this._data=l,this._sector=n.sector,this._canvas=this.createCanvas(n.width,n.height),this._width=n.width,this._height=n.height,this._intensityGradient=n.intensityGradient,this._radius=n.radius,this._incrementPerIntensity=n.incrementPerIntensity};return p.prototype.url=function(){return this.draw().toDataURL()},p.prototype.canvas=function(){return this.draw()},p.prototype.draw=function(){var l=[];for(var n in this._intensityGradient)this._intensityGradient.hasOwnProperty(n)&&l.push({shape:this.shape(n),min:n});for(var e=this._canvas.getContext("2d"),i,t=null,r=0;r<this._data.length;r++){var s=this._data[r];i=s.measure*this._incrementPerIntensity,e.globalAlpha=i,l.forEach(function(a){i>a.min&&(t=a.shape)}),e.drawImage(t,this.longitudeInSector(s,this._sector,this._width)-t.width/2,this._height-this.latitudeInSector(s,this._sector,this._height)-t.height/2)}return this._canvas},p.prototype.createCanvas=function(l,n){var e=document.createElement("canvas");return e.width=l,e.height=n,e},p.prototype.shape=function(l){var n=this.createCanvas(this._radius*2,this._radius*2),e=n.getContext("2d"),i=e.createRadialGradient(this._radius,this._radius,0,this._radius,this._radius,this._radius);return i.addColorStop(0,"rgba(0,0,0,"+l+")"),i.addColorStop(1,"rgba(0,0,0,0)"),e.beginPath(),e.arc(this._radius,this._radius,this._radius,0,Math.PI*2,!0),e.fillStyle=i,e.fill(),e.closePath(),n},p.prototype.latitudeInSector=function(l,n,e){var i=n.maxLatitude-n.minLatitude,t=l.latitude-n.minLatitude;return Math.ceil(t/i*e)},p.prototype.longitudeInSector=function(l,n,e){var i=n.maxLongitude-n.minLongitude,t=l.longitude-n.minLongitude;return Math.ceil(t/i*e)},p}),B("layer/heatmap/HeatMapColoredTile",["./HeatMapTile"],function(p){var l=function(n,e){p.call(this,n,e),this._extendedWidth=e.extendedWidth,this._extendedHeight=e.extendedHeight,this._gradient=this.gradient(e.intensityGradient)};return l.prototype=Object.create(p.prototype),l.prototype.draw=function(){var n=p.prototype.draw.call(this),e=n.getContext("2d"),i=0,t=0,r=this._width,s=this._height;this._extendedHeight&&(i=this._extendedHeight,s=this._height-2*this._extendedHeight),this._extendedWidth&&(t=this._extendedWidth,r=this._width-2*this._extendedWidth);var a=e.getImageData(i,t,r,s);return this.colorize(a.data,this._gradient),e.putImageData(a,i,t),n},l.prototype.gradient=function(n){var e=this.createCanvas(1,256),i=e.getContext("2d"),t=i.createLinearGradient(0,0,0,256);for(var r in n)t.addColorStop(+r,n[r]);return i.fillStyle=t,i.fillRect(0,0,1,256),i.getImageData(0,0,1,256).data},l.prototype.colorize=function(n,e){for(var i=0,t=n.length,r;i<t;i+=4)r=n[i+3]*4,r&&(n[i]=e[r],n[i+1]=e[r+1],n[i+2]=e[r+2])},l}),B("layer/heatmap/HeatMapIntervalType",[],function(){"use strict";var p={CONTINUOUS:0,QUANTILES:1};return p}),B("geom/MeasuredLocation",["./Angle","./Location"],function(p,l){"use strict";var n=function(e,i,t){l.call(this,e,i),this.measure=t};return n.prototype=Object.create(l.prototype),n.fromRadians=function(e,i,t){return new n(e*p.RADIANS_TO_DEGREES,i*p.RADIANS_TO_DEGREES,t)},n.prototype.copy=function(e){return l.prototype.copy.call(this,e),this.measure=e.measure,this},n.prototype.set=function(e,i,t){return l.prototype.set.call(this,e,i),this.measure=t,this},n.prototype.equals=function(e){return l.prototype.equals.call(this,e)&&this.measure===e.measure},n}),B("layer/heatmap/HeatMapLayer",["../../error/ArgumentError","./HeatMapColoredTile","./HeatMapIntervalType","./HeatMapTile","../../util/ImageSource","../../geom/Location","../../util/Logger","../../geom/MeasuredLocation","../TiledImageLayer","../../geom/Sector","../../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o){"use strict";var c=function(d,h){this.tileWidth=256,this.tileHeight=256,a.call(this,new f(-90,90,-180,180),new t(45,45),18,"image/png","HeatMap"+o.guid(),this.tileWidth,this.tileHeight),this.displayName=d;for(var u={},m=-90;m<=90;m++){u[m]={};for(var g=-180;g<=180;g++)u[m][g]=[]}var _,y,v=Number.MIN_VALUE;h.forEach(function(b){_=Math.floor(b.latitude),y=Math.floor(b.longitude),u[_][y].push(b),b.measure>v&&(v=b.measure)}),this._data=u,this._measuredLocations=h,this._intervalType=n.CONTINUOUS,this._scale=["blue","cyan","lime","yellow","red"],this._radius=12.5,this._incrementPerIntensity=1/v,this.setGradient(h)};return c.prototype=Object.create(a.prototype),Object.defineProperties(c.prototype,{intervalType:{get:function(){return this._intervalType},set:function(d){this._intervalType=d,this.setGradient()}},scale:{get:function(){return this._scale},set:function(d){this._scale=d,this.setGradient()}},gradient:{get:function(){return this._gradient}},radius:{get:function(){return this._radius},set:function(d){this._radius=d}}}),c.prototype.filterGeographically=function(d,h){var u=Math.floor(h.minLatitude),m=Math.floor(h.maxLatitude),g=Math.floor(h.minLongitude),_=Math.floor(h.maxLongitude),y=0,v=0;u<=-90&&(u=-90),m>=90&&(m=90),g<=-180&&(y=Math.abs(g- -180),g=-180),_>=180&&(v=Math.abs(_-180),_=180);var b=[];if(this.gatherGeographical(d,b,h,u,m,g,_),y!==0){var R=new f(u,m,180-y,180);this.gatherGeographical(d,b,R,u,m,180-y,180,-360)}if(v!==0){var M=new f(u,m,-180,-180+v);this.gatherGeographical(d,b,M,u,m,-180,-180+v,360)}return b},c.prototype.gatherGeographical=function(d,h,u,m,g,_,y,v){var b,R;for(b=m;b<=g;b++)for(R=_;R<=y;R++)d[b][R].forEach(function(M){u.containsLocation(M.latitude,M.longitude)&&(v?h.push(new s(M.latitude,v+M.longitude,M.measure)):h.push(M))})},c.prototype.setGradient=function(){var d=this.intervalType,h=this.scale,u={};if(d===n.CONTINUOUS)h.forEach(function(_,y){u[y/h.length]=_});else if(d===n.QUANTILES){var m=this._measuredLocations;m.sort(function(_,y){return _.measure<y.measure?-1:_.measure>y.measure?1:0});var g=m[m.length-1].measure;m.length>=h.length?h.forEach(function(_,y){y===0?u[0]=_:u[m[Math.floor(y/h.length*m.length)].measure/g]=_}):h.forEach(function(_,y){u[y/h.length]=_})}this._gradient=u},c.prototype.retrieveTileImage=function(d,h,u){if(this.currentRetrievals.indexOf(h.imagePath)<0){if(this.absentResourceList.isResourceAbsent(h.imagePath))return;var m=h.imagePath,g=d.gpuResourceCache,_=this,y=this.radius,v=this.calculateExtendedSector(h.sector,2*(y/this.tileWidth),2*(y/this.tileHeight)),b=Math.ceil(v.extensionFactorWidth*this.tileWidth),R=Math.ceil(v.extensionFactorHeight*this.tileHeight),M=this.filterGeographically(this._data,v.sector),P=this.createHeatMapTile(M,{sector:v.sector,width:this.tileWidth+2*b,height:this.tileHeight+2*R,radius:y,intensityGradient:this.gradient,incrementPerIntensity:this._incrementPerIntensity,extendedWidth:b,extendedHeight:R}).canvas(),T=document.createElement("canvas");T.height=this.tileHeight,T.width=this.tileWidth,T.getContext("2d").putImageData(P.getContext("2d").getImageData(b,R,this.tileWidth,this.tileHeight),0,0);var E=_.createTexture(d,h,T);if(_.removeFromCurrentRetrievals(m),E&&(g.putResource(m,E,E.size),_.currentTilesInvalid=!0,_.absentResourceList.unmarkResourceAbsent(m),!u)){var x=document.createEvent("Event");x.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(x)}}},c.prototype.calculateExtendedSector=function(d,h,u){var m=(d.maxLatitude-d.minLatitude)*u,g=(d.maxLongitude-d.minLongitude)*h;return{sector:new f(d.minLatitude-m,d.maxLatitude+m,d.minLongitude-g,d.maxLongitude+g),extensionFactorHeight:u,extensionFactorWidth:h}},c.prototype.createHeatMapTile=function(d,h){return new l(d,h)},c}),B("util/HighlightController",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"HighlightController","constructor","missingWorldWindow"));this.worldWindow=e;var i=[],t=function(s){for(var a=s.clientX,f=s.clientY,o=i.length>0,c=0;c<i.length;c++)i[c].highlighted=!1;i=[];var d=e.pick(e.canvasCoordinates(a,f));if(d.objects.length>0&&(o=!0),d.objects.length>0)for(var h=0;h<d.objects.length;h++)d.objects[h].isTerrain||(d.objects[h].userObject.highlighted=!0,i.push(d.objects[h].userObject));o&&e.redraw()};this.worldWindow.addEventListener("mousemove",t);var r=new WorldWind.TapRecognizer(this.worldWindow,t)};return n}),B("formats/kml/util/KmlAttribute",[],function(){"use strict";var p=function(l,n){this.node=l,this.name=n};return p.prototype.value=function(){return this.node.attributes&&this.node.attributes.getNamedItem(this.name)&&this.node.attributes.getNamedItem(this.name).value||null},p.prototype.exists=function(){return this.value()!=null},p.prototype.save=function(l){this.node.setAttribute(this.name,l)},p}),B("formats/kml/KmlElements",[],function(){"use strict";var p={keys:{},addKey:function(l,n){this.keys[l]=n},getKey:function(l){return this.keys[l]}};return p}),B("formats/kml/util/KmlNodeTransformers",["./KmlAttribute","../KmlElements","../../../geom/Position","../../../util/WWUtil"],function(p,l,n,e){var i=function(){};i.string=function(r){return String(t(r))},i.number=function(r){return Number(t(r))},i.boolean=function(r){return e.transformToBoolean(t(r))},i.date=function(r){return e.date(t(r))};function t(r){var s;return r!=null&&r.childNodes[0]?s=r.childNodes[0].nodeValue:r!=null&&(s=""),s}return i.kmlObject=function(r,s,a){var f=r.nodeName,o=l.getKey(f);return o?new o({objectNode:r,parent:s,controls:a}):null},i.linearRing=function(r,s,a){var f=l.getKey("LinearRing");if(!f)return null;var o=null;return Array.prototype.forEach.call(r.childNodes,function(c){c.nodeName.toUpperCase()=="LinearRing".toUpperCase()&&(o=c)}),new f({objectNode:o,parent:s,controls:a})},i.positions=function(r){var s=[],a=t(r).trim().replace(/\s+/g," ").split(" ");return a.forEach(function(f){f=f.split(","),s.push(new n(Number(f[1]),Number(f[0]),Number(f[2]||0)))}),s},i.attribute=function(r){return function(s){return new p(s,r).value()}},i}),B("formats/kml/util/KmlElementsFactory",["./KmlNodeTransformers"],function(p){"use strict";var l=function(e){this.options=e||{},this.options.controls=this.options.controls||[]};l.prototype.specific=function(e,i){var t=e.node,r=null,s=this;return[].forEach.call(t.childNodes,function(a){a.nodeName==i.name&&(r=i.transformer(a,e,s.options.controls))}),r},l.prototype.any=function(e,i){var t=e.node,r=null,s=this;return[].forEach.call(t.childNodes,function(a){i.name.indexOf(a.nodeName)!=-1&&(r=p.kmlObject(a,e,s.options.controls))}),r},l.prototype.all=function(e){var i=e.node,t=[],r=this;return[].forEach.call(i.childNodes,function(s){var a=p.kmlObject(s,e,r.options.controls);a&&t.push(a)}),t};var n=new l;return l.applicationWide=function(){return n},l}),B("formats/kml/util/KmlTreeKeyValueCache",["../../../util/WWUtil"],function(p){"use strict";var l=function(){this.map={}};l.prototype.add=function(e,i,t){this.map[e]||(this.map[e]={}),this.map[e][i]=t},l.prototype.value=function(e,i){if(!this.map[e])return null;if(i.indexOf("#")==-1){var t=this.level(e);for(var r in t)if(t.hasOwnProperty(r)&&p.startsWith(r,i))return t[r]}return this.map[e][i]||null},l.prototype.level=function(e){return this.map[e]},l.prototype.remove=function(e,i){delete this.map[e][i]};var n=new l;return l.applicationLevelCache=function(){return n},l}),B("formats/kml/util/KmlElementsFactoryCached",["./KmlAttribute","./KmlElementsFactory","./KmlTreeKeyValueCache","../../../util/WWUtil"],function(p,l,n,e){"use strict";var i=function(r){this.internalFactory=new l(r),this.cache=n.applicationLevelCache()};i.prototype.all=function(r){var s=r.node,a=this.cache.level(this.cacheKey(r.node,"All"));if(a){var f=[];for(var o in a)a.hasOwnProperty(o)&&f.push(a[o]);return f}var c=this.internalFactory.all(r);if(c&&c.length){var d=this;c.forEach(function(h){d.cache.add(d.cacheKey(s,"All"),d.cacheKey(h.node),h)})}return c},i.prototype.specific=function(r,s){var a=r.node,f=s.name;s.attribute&&(f=s.attribute+f);var o=this.cache.value(this.cacheKey(a),f);if(o)return o;var c=this.internalFactory.specific(r,s);return c&&c.node?this.cache.add(this.cacheKey(a),this.cacheKey(c.node),c):c&&this.cache.add(this.cacheKey(a),f,c),c},i.prototype.any=function(r,s){var a=r.node,f=this,o=null,c;if(s.name.forEach(function(h){c=f.cache.value(f.cacheKey(a),h),c&&(o=c)}),o)return o;var d=this.internalFactory.any(r,s);return d&&this.cache.add(f.cacheKey(a),f.cacheKey(d.node),d),d},i.prototype.cacheKey=function(r,s){var a=new p(r,"id");a.exists()||a.save(e.guid());var f=r.nodeName+"#"+a.value();return s&&(f=s+f),f};var t=new i;return i.applicationWide=function(){return t},i});return(function(){"use strict";function p(ct){return typeof ct=="function"||typeof ct=="object"&&ct!==null}function l(ct){return typeof ct=="function"}function n(ct){return typeof ct=="object"&&ct!==null}var e;Array.isArray?e=Array.isArray:e=function(ct){return Object.prototype.toString.call(ct)==="[object Array]"};var i=e,t=0,r={}.toString,s,a,f=function(z,nt){M[t]=z,M[t+1]=nt,t+=2,t===2&&(a?a(P):E())};function o(ct){a=ct}function c(ct){f=ct}var d=typeof window<"u"?window:void 0,h=d||{},u=h.MutationObserver||h.WebKitMutationObserver,m=typeof process<"u"&&{}.toString.call(process)==="[object process]",g=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function _(){return function(){process.nextTick(P)}}function y(){return function(){s(P)}}function v(){var ct=0,z=new u(P),nt=document.createTextNode("");return z.observe(nt,{characterData:!0}),function(){nt.data=ct=++ct%2}}function b(){var ct=new MessageChannel;return ct.port1.onmessage=P,function(){ct.port2.postMessage(0)}}function R(){return function(){setTimeout(P,1)}}var M=new Array(1e3);function P(){for(var ct=0;ct<t;ct+=2){var z=M[ct],nt=M[ct+1];z(nt),M[ct]=void 0,M[ct+1]=void 0}t=0}function T(){try{var ct=vt,z=ct("vertx");return s=z.runOnLoop||z.runOnContext,y()}catch(nt){return R()}}var E;m?E=_():u?E=v():g?E=b():d===void 0&&typeof vt=="function"?E=T():E=R();function x(){}var S=void 0,L=1,C=2,F=new j;function q(){return new TypeError("You cannot resolve a promise with itself")}function it(){return new TypeError("A promises callback cannot return that same promise.")}function st(ct){try{return ct.then}catch(z){return F.error=z,F}}function pt(ct,z,nt,Ht){try{ct.call(z,nt,Ht)}catch(Kt){return Kt}}function _t(ct,z,nt){f(function(Ht){var Kt=!1,fe=pt(nt,z,function(Ft){Kt||(Kt=!0,z!==Ft?Tt(Ht,Ft):Gt(Ht,Ft))},function(Ft){Kt||(Kt=!0,qt(Ht,Ft))},"Settle: "+(Ht._label||" unknown promise"));!Kt&&fe&&(Kt=!0,qt(Ht,fe))},ct)}function X(ct,z){z._state===L?Gt(ct,z._result):z._state===C?qt(ct,z._result):Qt(z,void 0,function(nt){Tt(ct,nt)},function(nt){qt(ct,nt)})}function ot(ct,z){if(z.constructor===ct.constructor)X(ct,z);else{var nt=st(z);nt===F?qt(ct,F.error):nt===void 0?Gt(ct,z):l(nt)?_t(ct,z,nt):Gt(ct,z)}}function Tt(ct,z){ct===z?qt(ct,q()):p(z)?ot(ct,z):Gt(ct,z)}function Vt(ct){ct._onerror&&ct._onerror(ct._result),ne(ct)}function Gt(ct,z){ct._state===S&&(ct._result=z,ct._state=L,ct._subscribers.length!==0&&f(ne,ct))}function qt(ct,z){ct._state===S&&(ct._state=C,ct._result=z,f(Vt,ct))}function Qt(ct,z,nt,Ht){var Kt=ct._subscribers,fe=Kt.length;ct._onerror=null,Kt[fe]=z,Kt[fe+L]=nt,Kt[fe+C]=Ht,fe===0&&ct._state&&f(ne,ct)}function ne(ct){var z=ct._subscribers,nt=ct._state;if(z.length!==0){for(var Ht,Kt,fe=ct._result,Ft=0;Ft<z.length;Ft+=3)Ht=z[Ft],Kt=z[Ft+nt],Ht?xt(nt,Ht,Kt,fe):Kt(fe);ct._subscribers.length=0}}function j(){this.error=null}var J=new j;function at(ct,z){try{return ct(z)}catch(nt){return J.error=nt,J}}function xt(ct,z,nt,Ht){var Kt=l(nt),fe,Ft,he,Bt;if(Kt){if(fe=at(nt,Ht),fe===J?(Bt=!0,Ft=fe.error,fe=null):he=!0,z===fe){qt(z,it());return}}else fe=Ht,he=!0;z._state!==S||(Kt&&he?Tt(z,fe):Bt?qt(z,Ft):ct===L?Gt(z,fe):ct===C&&qt(z,fe))}function Rt(ct,z){try{z(function(Ht){Tt(ct,Ht)},function(Ht){qt(ct,Ht)})}catch(nt){qt(ct,nt)}}function Lt(ct,z){var nt=this;nt._instanceConstructor=ct,nt.promise=new ct(x),nt._validateInput(z)?(nt._input=z,nt.length=z.length,nt._remaining=z.length,nt._init(),nt.length===0?Gt(nt.promise,nt._result):(nt.length=nt.length||0,nt._enumerate(),nt._remaining===0&&Gt(nt.promise,nt._result))):qt(nt.promise,nt._validationError())}Lt.prototype._validateInput=function(ct){return i(ct)},Lt.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},Lt.prototype._init=function(){this._result=new Array(this.length)};var te=Lt;Lt.prototype._enumerate=function(){for(var ct=this,z=ct.length,nt=ct.promise,Ht=ct._input,Kt=0;nt._state===S&&Kt<z;Kt++)ct._eachEntry(Ht[Kt],Kt)},Lt.prototype._eachEntry=function(ct,z){var nt=this,Ht=nt._instanceConstructor;n(ct)?ct.constructor===Ht&&ct._state!==S?(ct._onerror=null,nt._settledAt(ct._state,z,ct._result)):nt._willSettleAt(Ht.resolve(ct),z):(nt._remaining--,nt._result[z]=ct)},Lt.prototype._settledAt=function(ct,z,nt){var Ht=this,Kt=Ht.promise;Kt._state===S&&(Ht._remaining--,ct===C?qt(Kt,nt):Ht._result[z]=nt),Ht._remaining===0&&Gt(Kt,Ht._result)},Lt.prototype._willSettleAt=function(ct,z){var nt=this;Qt(ct,void 0,function(Ht){nt._settledAt(L,z,Ht)},function(Ht){nt._settledAt(C,z,Ht)})};function zt(ct){return new te(this,ct).promise}var ee=zt;function $(ct){var z=this,nt=new z(x);if(!i(ct))return qt(nt,new TypeError("You must pass an array to race.")),nt;var Ht=ct.length;function Kt(he){Tt(nt,he)}function fe(he){qt(nt,he)}for(var Ft=0;nt._state===S&&Ft<Ht;Ft++)Qt(z.resolve(ct[Ft]),void 0,Kt,fe);return nt}var N=$;function K(ct){var z=this;if(ct&&typeof ct=="object"&&ct.constructor===z)return ct;var nt=new z(x);return Tt(nt,ct),nt}var k=K;function Y(ct){var z=this,nt=new z(x);return qt(nt,ct),nt}var ht=Y,wt=0;function Et(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function Mt(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Dt=At;function At(ct){this._id=wt++,this._state=void 0,this._result=void 0,this._subscribers=[],x!==ct&&(l(ct)||Et(),this instanceof At||Mt(),Rt(this,ct))}At.all=ee,At.race=N,At.resolve=k,At.reject=ht,At._setScheduler=o,At._setAsap=c,At._asap=f,At.prototype={constructor:At,then:function(ct,z){var nt=this,Ht=nt._state;if(Ht===L&&!ct||Ht===C&&!z)return this;var Kt=new this.constructor(x),fe=nt._result;if(Ht){var Ft=arguments[Ht-1];f(function(){xt(Ht,Kt,Ft,fe)})}else Qt(nt,Kt,ct,z);return Kt},catch:function(ct){return this.then(null,ct)}};function Xt(){var ct;if(typeof W<"u")ct=W;else if(typeof self<"u")ct=self;else try{ct=Function("return this")()}catch(nt){throw new Error("polyfill failed because global object is unavailable in this environment")}var z=ct.Promise;z&&Object.prototype.toString.call(z.resolve())==="[object Promise]"&&!z.cast||(ct.Promise=Dt)}var ie=Xt,le={Promise:Dt,polyfill:ie};typeof B=="function"&&B.amd?B("util/es6-promise",[],function(){return le}):typeof ji<"u"&&ji.exports?ji.exports=le:typeof this<"u"&&(this.ES6Promise=le);var W={};ie()}).call(this),B("util/Promise",["./es6-promise"],function(p){"use strict";return window.Promise?window.Promise:p.Promise}),B("formats/kml/KmlObject",["../../error/ArgumentError","./util/KmlAttribute","./KmlElements","./util/KmlElementsFactoryCached","../../util/Logger","../../util/Promise","../../render/Renderable"],function(p,l,n,e,i,t,r){"use strict";var s=function(a){if(r.call(this),a=a||{},!a.objectNode)throw new p(i.logMessage(i.LEVEL_SEVERE,"KmlObject","constructor","Passed node isn't defined."));this._node=a.objectNode,this._cache={},this._controls=a.controls||[],this._factory=new e({controls:this._controls}),this.hook(this._controls,a)};return s.prototype=Object.create(r.prototype),Object.defineProperties(s.prototype,{id:{get:function(){return new l(this.node,"id").value()}},node:{get:function(){return this._node}}}),s.prototype.hook=function(a,f){var o=this;a.forEach(function(c){c.hook(o,f)})},s.prototype.render=function(a){},s.prototype.getTagNames=function(){return[]},s}),B("formats/kml/KmlTimePrimitive",["./KmlObject"],function(p){"use strict";var l=function(n){p.call(this,n)};return l.prototype=Object.create(p.prototype),l.prototype.timeRange=function(){var n,e;return this.kmlBegin&&(e=n=this.kmlBegin.valueOf()),this.kmlEnd&&(e=this.kmlEnd.valueOf(),n||(n=e)),this.kmlWhen&&(e=n=this.kmlWhen.valueOf()),{from:n,to:e}},l.prototype.getTagNames=function(){return["TimeSpan","TimeStamp"]},l}),B("formats/kml/KmlAbstractView",["./KmlObject","./KmlElements","./KmlTimePrimitive"],function(p,l,n){"use strict";var e=function(i){p.call(this,i)};return e.prototype=Object.create(p.prototype),Object.defineProperties(e.prototype,{kmlTimePrimitive:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}}}),e.prototype.getTagNames=function(){return["Camera","LookAt"]},e}),B("formats/kml/styles/KmlSubStyle",["./../KmlObject"],function(p){"use strict";var l=function(n){p.call(this,n)};return l.prototype=Object.create(p.prototype),l.prototype.getTagNames=function(){return["LineStyle","PolyStyle","IconStyle","LabelStyle","BalloonStyle","ListStyle"]},l}),B("formats/kml/styles/KmlBalloonStyle",["../KmlElements","./KmlSubStyle","../util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlBgColor:{get:function(){return this._factory.specific(this,{name:"bgColor",transformer:n.string})}},kmlTextColor:{get:function(){return this._factory.specific(this,{name:"textColor",transformer:n.string})}},kmlText:{get:function(){return this._factory.specific(this,{name:"text",transformer:n.string})}},kmlDisplayMode:{get:function(){return this._factory.specific(this,{name:"displayMode",transformer:n.string})}}}),e.update=function(){},e.prototype.getTagNames=function(){return["BalloonStyle"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/KmlCamera",["./KmlElements","./KmlAbstractView","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:n.string})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:n.string})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:n.string})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:n.string})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:n.string})}},kmlRoll:{get:function(){return this._factory.specific(this,{name:"roll",transformer:n.string})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:n.string})}}}),e.prototype.getTagNames=function(){return["Camera"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/util/KmlChange",["../KmlElements","../KmlObject"],function(p,l){var n=function(e){l.call(this,e)};return n.prototype=Object.create(l.prototype),Object.defineProperties(n.prototype,{shapes:{get:function(){return this._factory.all(this)}}}),n.prototype.getTagNames=function(){return["Change"]},p.addKey(n.prototype.getTagNames()[0],n),n}),B("formats/kml/styles/KmlColorStyle",["./KmlSubStyle","../util/KmlNodeTransformers"],function(p,l){"use strict";var n=function(e){p.call(this,e)};return n.prototype=Object.create(p.prototype),Object.defineProperties(n.prototype,{kmlColor:{get:function(){return this._factory.specific(this,{name:"color",transformer:l.string})}},kmlColorMode:{get:function(){return this._factory.specific(this,{name:"colorMode",transformer:l.string})}}}),n.prototype.getTagNames=function(){return["LineStyle","PolyStyle","IconStyle","LabelStyle"]},n}),B("formats/kml/KmlFileCache",[],function(){"use strict";var p=function(){this._rootFile=null,this._map={}};return p.prototype.retrieve=function(l){if(l.indexOf("kmz;")!=0&&l.indexOf("href;")!=0&&(l.indexOf("#")==0||l==null||l.indexOf("http")!=0))return this._rootFile;var n=l;return l.indexOf("#")!=-1&&(n=l.substr(0,l.indexOf("#")-1)),this._map[n]?this._map[n]:null},p.prototype.add=function(l,n,e){e?this._rootFile=n:this._map[l]=n},p}),B("formats/kml/styles/KmlStyleSelector",["./../KmlObject"],function(p){"use strict";var l=function(n){p.call(this,n)};return l.prototype=Object.create(p.prototype),l.prototype.getTagNames=function(){return["Style","StyleMap"]},l}),B("formats/kml/styles/KmlPolyStyle",["../../../util/Color","./KmlColorStyle","./../KmlElements","../util/KmlNodeTransformers"],function(p,l,n,e){"use strict";var i=function(t){l.call(this,t)};return i.prototype=Object.create(l.prototype),Object.defineProperties(i.prototype,{kmlFill:{get:function(){return this._factory.specific(this,{name:"fill",transformer:e.boolean})}},kmlOutline:{get:function(){return this._factory.specific(this,{name:"outline",transformer:e.boolean})}}}),i.update=function(t,r){t=t||{};var s=r||{};return s._drawInterior=t.kmlFill||!0,s._drawOutline=t.kmlOutline||!1,s._outlineColor=r._outlineColor||p.WHITE,s._interiorColor=t.kmlColor&&p.colorFromKmlHex(t.kmlColor)||p.WHITE,s._colorMode=t.kmlColorMode||"normal",s},i.prototype.getTagNames=function(){return["PolyStyle"]},n.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/util/KmlHrefResolver",["../../../util/Promise","../../../util/WWUtil"],function(p,l){var n=function(e,i){this._url=e,this._fileCache=i};return n.prototype.url=function(){if(l.startsWith(this._url,"http://")||l.startsWith(this._url,"https://"))return this._url;var e=this._fileCache.retrieve("kmz;"+this._url);return e||(e=this._fileCache.retrieve("href;"+this._url),e||this._url)},n}),B("formats/kml/KmlLink",["./util/KmlHrefResolver","./KmlElements","./KmlObject","./util/KmlNodeTransformers"],function(p,l,n,e){"use strict";var i=function(t){n.call(this,t),this.onChangeListeners=[]};return i.prototype=Object.create(n.prototype),Object.defineProperties(i.prototype,{kmlRefreshMode:{get:function(){return this._factory.specific(this,{name:"refreshMode",transformer:e.string})}},kmlRefreshInterval:{get:function(){return this._factory.specific(this,{name:"refreshInterval",transformer:e.number})}},kmlViewRefreshMode:{get:function(){return this._factory.specific(this,{name:"viewRefreshMode",transformer:e.string})}},kmlViewRefreshTime:{get:function(){return this._factory.specific(this,{name:"viewRefreshTime",transformer:e.number})}},kmlViewBoundScale:{get:function(){return this._factory.specific(this,{name:"viewBoundScale",transformer:e.number})}},kmlViewFormat:{get:function(){return this._factory.specific(this,{name:"viewFormat",transformer:e.string})}},kmlHttpQuery:{get:function(){return this._factory.specific(this,{name:"httpQuery",transformer:e.string})}}}),i.prototype.kmlHref=function(t){return new p(this._factory.specific(this,{name:"href",transformer:e.string}),t).url()},i.prototype.getTagNames=function(){return["Link"]},l.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/KmlIcon",["./KmlLink","./KmlElements","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){p.call(this,i)};return e.prototype=Object.create(p.prototype),Object.defineProperties(e.prototype,{kmlX:{get:function(){return this._factory.specific(this,{name:"gx:x",transformer:n.number})}},kmlY:{get:function(){return this._factory.specific(this,{name:"gx:y",transformer:n.number})}},kmlW:{get:function(){return this._factory.specific(this,{name:"gx:w",transformer:n.number})}},kmlH:{get:function(){return this._factory.specific(this,{name:"gx:h",transformer:n.number})}}}),e.prototype.getTagNames=function(){return["Icon"]},l.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/styles/KmlIconStyle",["./KmlColorStyle","./../KmlElements","../KmlIcon","../util/KmlNodeTransformers"],function(p,l,n,e){"use strict";var i=function(t){p.call(this,t)};return i.prototype=Object.create(p.prototype),Object.defineProperties(i.prototype,{kmlScale:{get:function(){return this._factory.specific(this,{name:"scale",transformer:e.number})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:e.number})}},kmlIcon:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}},kmlHotSpotX:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:e.attribute("x")})}},kmlHotSpotY:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:e.attribute("y")})}},kmlHotSpotXUnits:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:e.attribute("xunits")})}},kmlHotSpotYUnits:{get:function(){return this._factory.specific(this,{name:"hotSpot",transformer:e.attribute("yunits")})}}}),i.update=function(t,r,s){t=t||{};var a=r||{};return a._imageScale=t.kmlScale||1,a._imageSource=t.kmlIcon&&t.kmlIcon.kmlHref(s)||null,a},i.prototype.getTagNames=function(){return["IconStyle"]},l.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/styles/KmlLabelStyle",["../../../util/Color","./KmlColorStyle","../KmlElements","../util/KmlNodeTransformers"],function(p,l,n,e){"use strict";var i=function(t){l.call(this,t)};return i.prototype=Object.create(l.prototype),Object.defineProperties(i.prototype,{kmlScale:{get:function(){return this._factory.specific(this,{name:"scale",transformer:e.number})}}}),i.update=function(t,r){var s=r||{};return t=t||{},s._labelAttributes={_color:t.kmlColor&&p.colorFromKmlHex(t.kmlColor)||p.YELLOW,_scale:typeof t.kmlScale=="number"?t.kmlScale:null},s},i.prototype.getTagNames=function(){return["LabelStyle"]},n.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/styles/KmlLineStyle",["../../../util/Color","./KmlColorStyle","./../KmlElements","../util/KmlNodeTransformers"],function(p,l,n,e){"use strict";var i=function(t){l.call(this,t)};return i.prototype=Object.create(l.prototype),Object.defineProperties(i.prototype,{kmlWidth:{get:function(){return this._factory.specific(this,{name:"width",transformer:e.number})}},kmlOuterColor:{get:function(){return this._factory.specific(this,{name:"gx:outerColor",transformer:e.string})}},kmlOuterWidth:{get:function(){return this._factory.specific(this,{name:"gx:outerWidth",transformer:e.number})}},kmlPhysicalWidth:{get:function(){return this._factory.specific(this,{name:"gx:physicalWidth",transformer:e.number})}},kmlLabelVisibility:{get:function(){return this._factory.specific(this,{name:"gx:labelVisibility",transformer:e.boolean})}}}),i.update=function(t,r){var s=r||{};return t=t||{},s._outlineColor=t.kmlColor&&p.colorFromKmlHex(t.kmlColor)||p.WHITE,s._outlineWidth=t.kmlWidth||10,s},i.prototype.getTagNames=function(){return["LineStyle"]},n.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/util/KmlItemIcon",["./KmlHrefResolver","./../KmlElements","../KmlObject","./KmlNodeTransformers"],function(p,l,n,e){"use strict";var i=function(t){n.call(this,t)};return i.prototype=Object.create(n.prototype),Object.defineProperties(i.prototype,{kmlState:{get:function(){return this._factory.specific(this,{name:"state",transformer:e.string})}}}),i.prototype.kmlHref=function(t){return new p(this._factory.specific(this,{name:"href",transformer:e.string}),t).url()},i.prototype.getTagNames=function(){return["ItemIcon"]},l.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/styles/KmlListStyle",["../util/KmlItemIcon","../KmlElements","./KmlSubStyle","../util/KmlNodeTransformers"],function(p,l,n,e){"use strict";var i=function(t){n.call(this,t)};return i.prototype=Object.create(n.prototype),Object.defineProperties(i.prototype,{kmlBgColor:{get:function(){return this._factory.specific(this,{name:"bgColor",transformer:e.string})}},kmlListItemType:{get:function(){return this._factory.specific(this,{name:"listItemType",transformer:e.string})}},kmlItemIcon:{get:function(){return this._factory.any(this,{name:p.prototype.getTagNames()})}}}),i.update=function(){},i.prototype.getTagNames=function(){return["ListStyle"]},l.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/styles/KmlStyle",["../../../util/Color","../../../util/Font","./KmlStyleSelector","./../KmlElements","./KmlPolyStyle","./KmlIconStyle","./KmlLabelStyle","./KmlLineStyle","./KmlListStyle","./KmlBalloonStyle","../../../util/Offset","../../../util/Promise","../../../shapes/ShapeAttributes","../../../shapes/TextAttributes"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h){"use strict";var u=function(m){n.call(this,m)};return u.prototype=Object.create(n.prototype),Object.defineProperties(u.prototype,{kmlIconStyle:{get:function(){return this._factory.any(this,{name:t.prototype.getTagNames()})}},kmlLabelStyle:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}},kmlLineStyle:{get:function(){return this._factory.any(this,{name:s.prototype.getTagNames()})}},kmlPolyStyle:{get:function(){return this._factory.any(this,{name:i.prototype.getTagNames()})}},kmlBalloonStyle:{get:function(){return this._factory.any(this,{name:f.prototype.getTagNames()})}},kmlListStyle:{get:function(){return this._factory.any(this,{name:a.prototype.getTagNames()})}}}),u.prototype.generate=function(m,g){m=m||{};var _=this||{};return _.kmlIconStyle&&t.update(_.kmlIconStyle,m,g),_.kmlListStyle&&a.update(_.kmlListStyle,m),_.kmlBalloonStyle&&f.update(_.kmlBalloonStyle,m),_.kmlLabelStyle&&r.update(_.kmlLabelStyle,m),_.kmlPolyStyle&&i.update(_.kmlPolyStyle,m),_.kmlLineStyle&&s.update(_.kmlLineStyle,m),m},u.prototype.getStyle=function(){var m=this;return new c(function(g){window.setTimeout(function(){g(m)},0)})},u.prototype.getTagNames=function(){return["Style"]},e.addKey(u.prototype.getTagNames()[0],u),u.placemarkAttributes=function(m){return m=m||{},m._imageColor=m._imageColor||new p(1,1,1,1),m._imageOffset=m._imageOffset||new o(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,.5),m._imageScale=m._imageScale||1,m._imageSource=m._imageSource||null,m._depthTest=m._depthTest||!0,m._labelAttributes=m._labelAttributes||new h(u.textAttributes()),m._drawLeaderLine=m._drawLeaderLine||!1,m._leaderLineAttributes=m._leaderLineAttributes||new d(u.shapeAttributes()),m},u.textAttributes=function(m){return m=m||{},m._color=m._color||new p(1,1,1,1),m._font=m._font||new l(14),m._offset=m._offset||new o(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,0),m._scale=typeof m._scale=="number"?m._scale:1,m._depthTest=m._depthTest||!1,m._outlineColor=m._outlineColor||p.RED,m},u.shapeAttributes=function(m){return m=m||{},m._drawInterior=m._drawInterior||!0,m._drawOutline=m._drawOutline||!0,m._enableLighting=m._enableLighting||!1,m._interiorColor=m._interiorColor||p.WHITE,m._outlineColor=m._outlineColor||p.RED,m._outlineWidth=m._outlineWidth||1,m._outlineStippleFactor=m._outlineStippleFactor||0,m._outlineStipplePattern=m._outlineStipplePattern||61680,m._imageSource=m._imageSource||null,m._depthTest=m._depthTest||!0,m._drawVerticals=m._drawVerticals||!1,m._applyLighting=m._applyLighting||!1,m},u.default=function(){return new u({objectNode:document.createElement("Style")})},u}),B("formats/kml/util/KmlPair",["./../KmlElements","../KmlObject","../styles/KmlStyleSelector","./KmlNodeTransformers"],function(p,l,n,e){"use strict";var i=function(t){l.call(this,t)};return i.prototype=Object.create(l.prototype),Object.defineProperties(i.prototype,{kmlKey:{get:function(){return this._factory.specific(this,{name:"key",transformer:e.string})}},kmlStyleUrl:{get:function(){return this._factory.specific(this,{name:"styleUrl",transformer:e.string})}},kmlStyleSelector:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}}}),i.prototype.getTagNames=function(){return["Pair"]},i.prototype.getStyle=function(t){return t.handleRemoteStyle(this.kmlStyleUrl,this.kmlStyleSelector)},p.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/styles/KmlStyleMap",["../KmlElements","./KmlSubStyle","../util/KmlPair","../../../util/Promise"],function(p,l,n,e){"use strict";var i=function(t){l.call(this,t)};return i.prototype=Object.create(l.prototype),Object.defineProperties(i.prototype,{kmlPairs:{get:function(){return this._factory.all(this)}},isMap:{get:function(){return!0}}}),i.prototype.resolve=function(t){var r={},s=this.kmlPairs.map(function(a){var f=a.kmlKey;return a.getStyle(t).then(function(o){r[f]=o.normal})});return e.all(s).then(function(){return r.normal||(r.normal=null),r.highlight||(r.highlight=null),r})},i.prototype.getTagNames=function(){return["StyleMap"]},p.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/KmlTimeSpan",["./KmlElements","./KmlTimePrimitive","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){i.isTimeSpan=!0,l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlBegin:{get:function(){return this._factory.specific(this,{name:"begin",transformer:n.date})}},kmlEnd:{get:function(){return this._factory.specific(this,{name:"end",transformer:n.date})}}}),e.prototype.getTagNames=function(){return["TimeSpan"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/KmlTimeStamp",["./KmlElements","./KmlTimePrimitive","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){i.isTimeStamp=!0,l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlWhen:{get:function(){return this._factory.specific(this,{name:"when",transformer:n.date})}}}),e.prototype.getTagNames=function(){return["TimeStamp"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("util/jszip",[],function(){return function(p){var l={};function n(e){if(l[e])return l[e].exports;var i=l[e]={i:e,l:!1,exports:{}};return p[e].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=p,n.c=l,n.d=function(e,i,t){n.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:t})},n.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,i){if(1&i&&(e=n(e)),8&i||4&i&&typeof e=="object"&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&i&&typeof e!="string")for(var r in e)n.d(t,r,(function(s){return e[s]}).bind(null,r));return t},n.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(i,"a",i),i},n.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},n.p="",n(n.s=104)}([function(p,l,n){"use strict";var e=n(3),i=n(44),t=n(12),r=n(88),s=n(8);function a(u){return u}function f(u,m){for(var g=0;g<u.length;++g)m[g]=255&u.charCodeAt(g);return m}l.newBlob=function(u,m){l.checkSupport("blob");try{return new Blob([u],{type:m})}catch(_){try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(u),g.getBlob(m)}catch(y){throw new Error("Bug : can't construct the Blob.")}}};var o={stringifyByChunk:function(u,m,g){var _=[],y=0,v=u.length;if(v<=g)return String.fromCharCode.apply(null,u);for(;y<v;)m==="array"||m==="nodebuffer"?_.push(String.fromCharCode.apply(null,u.slice(y,Math.min(y+g,v)))):_.push(String.fromCharCode.apply(null,u.subarray(y,Math.min(y+g,v)))),y+=g;return _.join("")},stringifyByChar:function(u){for(var m="",g=0;g<u.length;g++)m+=String.fromCharCode(u[g]);return m},applyCanBeUsed:{uint8array:function(){try{return e.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(u){return!1}}(),nodebuffer:function(){try{return e.nodebuffer&&String.fromCharCode.apply(null,t.allocBuffer(1)).length===1}catch(u){return!1}}()}};function c(u){var m=65536,g=l.getTypeOf(u),_=!0;if(g==="uint8array"?_=o.applyCanBeUsed.uint8array:g==="nodebuffer"&&(_=o.applyCanBeUsed.nodebuffer),_)for(;m>1;)try{return o.stringifyByChunk(u,g,m)}catch(y){m=Math.floor(m/2)}return o.stringifyByChar(u)}function d(u,m){for(var g=0;g<u.length;g++)m[g]=u[g];return m}l.applyFromCharCode=c;var h={};h.string={string:a,array:function(u){return f(u,new Array(u.length))},arraybuffer:function(u){return h.string.uint8array(u).buffer},uint8array:function(u){return f(u,new Uint8Array(u.length))},nodebuffer:function(u){return f(u,t.allocBuffer(u.length))}},h.array={string:c,array:a,arraybuffer:function(u){return new Uint8Array(u).buffer},uint8array:function(u){return new Uint8Array(u)},nodebuffer:function(u){return t.newBufferFrom(u)}},h.arraybuffer={string:function(u){return c(new Uint8Array(u))},array:function(u){return d(new Uint8Array(u),new Array(u.byteLength))},arraybuffer:a,uint8array:function(u){return new Uint8Array(u)},nodebuffer:function(u){return t.newBufferFrom(new Uint8Array(u))}},h.uint8array={string:c,array:function(u){return d(u,new Array(u.length))},arraybuffer:function(u){return u.buffer},uint8array:a,nodebuffer:function(u){return t.newBufferFrom(u)}},h.nodebuffer={string:c,array:function(u){return d(u,new Array(u.length))},arraybuffer:function(u){return h.nodebuffer.uint8array(u).buffer},uint8array:function(u){return d(u,new Uint8Array(u.length))},nodebuffer:a},l.transformTo=function(u,m){if(m||(m=""),!u)return m;l.checkSupport(u);var g=l.getTypeOf(m);return h[g][u](m)},l.getTypeOf=function(u){return typeof u=="string"?"string":Object.prototype.toString.call(u)==="[object Array]"?"array":e.nodebuffer&&t.isBuffer(u)?"nodebuffer":e.uint8array&&u instanceof Uint8Array?"uint8array":e.arraybuffer&&u instanceof ArrayBuffer?"arraybuffer":void 0},l.checkSupport=function(u){if(!e[u.toLowerCase()])throw new Error(u+" is not supported by this platform")},l.MAX_VALUE_16BITS=65535,l.MAX_VALUE_32BITS=-1,l.pretty=function(u){var m,g,_="";for(g=0;g<(u||"").length;g++)_+="\\x"+((m=u.charCodeAt(g))<16?"0":"")+m.toString(16).toUpperCase();return _},l.delay=function(u,m,g){r(function(){u.apply(g||null,m||[])})},l.inherits=function(u,m){var g=function(){};g.prototype=m.prototype,u.prototype=new g},l.extend=function(){var u,m,g={};for(u=0;u<arguments.length;u++)for(m in arguments[u])arguments[u].hasOwnProperty(m)&&g[m]===void 0&&(g[m]=arguments[u][m]);return g},l.prepareContent=function(u,m,g,_,y){return s.Promise.resolve(m).then(function(v){return e.blob&&(v instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(v))!==-1)&&typeof FileReader<"u"?new s.Promise(function(b,R){var M=new FileReader;M.onload=function(P){b(P.target.result)},M.onerror=function(P){R(P.target.error)},M.readAsArrayBuffer(v)}):v}).then(function(v){var b=l.getTypeOf(v);return b?(b==="arraybuffer"?v=l.transformTo("uint8array",v):b==="string"&&(y?v=i.decode(v):g&&_!==!0&&(v=function(R){return f(R,e.uint8array?new Uint8Array(R.length):new Array(R.length))}(v))),v):s.Promise.reject(new Error("Can't read the data of '"+u+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},function(p,l,n){"use strict";function e(i){this.name=i||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}e.prototype={push:function(i){this.emit("data",i)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(i){this.emit("error",i)}return!0},error:function(i){return!this.isFinished&&(this.isPaused?this.generatedError=i:(this.isFinished=!0,this.emit("error",i),this.previous&&this.previous.error(i),this.cleanUp()),!0)},on:function(i,t){return this._listeners[i].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(i,t){if(this._listeners[i])for(var r=0;r<this._listeners[i].length;r++)this._listeners[i][r].call(this,t)},pipe:function(i){return i.registerPrevious(this)},registerPrevious:function(i){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=i.streamInfo,this.mergeStreamInfo(),this.previous=i;var t=this;return i.on("data",function(r){t.processChunk(r)}),i.on("end",function(){t.end()}),i.on("error",function(r){t.error(r)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var i=!1;return this.generatedError&&(this.error(this.generatedError),i=!0),this.previous&&this.previous.resume(),!i},flush:function(){},processChunk:function(i){this.push(i)},withStreamInfo:function(i,t){return this.extraStreamInfo[i]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var i in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(i)&&(this.streamInfo[i]=this.extraStreamInfo[i])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var i="Worker "+this.name;return this.previous?this.previous+" -> "+i:i}},p.exports=e},function(p,l,n){"use strict";var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";l.assign=function(r){for(var s=Array.prototype.slice.call(arguments,1);s.length;){var a=s.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(var f in a)a.hasOwnProperty(f)&&(r[f]=a[f])}}return r},l.shrinkBuf=function(r,s){return r.length===s?r:r.subarray?r.subarray(0,s):(r.length=s,r)};var i={arraySet:function(r,s,a,f,o){if(s.subarray&&r.subarray)r.set(s.subarray(a,a+f),o);else for(var c=0;c<f;c++)r[o+c]=s[a+c]},flattenChunks:function(r){var s,a,f,o,c,d;for(f=0,s=0,a=r.length;s<a;s++)f+=r[s].length;for(d=new Uint8Array(f),o=0,s=0,a=r.length;s<a;s++)c=r[s],d.set(c,o),o+=c.length;return d}},t={arraySet:function(r,s,a,f,o){for(var c=0;c<f;c++)r[o+c]=s[a+c]},flattenChunks:function(r){return[].concat.apply([],r)}};l.setTyped=function(r){r?(l.Buf8=Uint8Array,l.Buf16=Uint16Array,l.Buf32=Int32Array,l.assign(l,i)):(l.Buf8=Array,l.Buf16=Array,l.Buf32=Array,l.assign(l,t))},l.setTyped(e)},function(p,l,n){"use strict";(function(e){if(l.base64=!0,l.array=!0,l.string=!0,l.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",l.nodebuffer=e!==void 0,l.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")l.blob=!1;else{var i=new ArrayBuffer(0);try{l.blob=new Blob([i],{type:"application/zip"}).size===0}catch(r){try{var t=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);t.append(i),l.blob=t.getBlob("application/zip").size===0}catch(s){l.blob=!1}}}try{l.nodestream=!!n(50).Readable}catch(r){l.nodestream=!1}}).call(this,n(10).Buffer)},function(p,l,n){"use strict";var e=n(14),i=Object.keys||function(u){var m=[];for(var g in u)m.push(g);return m};p.exports=c;var t=n(9);t.inherits=n(6);var r=n(49),s=n(21);t.inherits(c,r);for(var a=i(s.prototype),f=0;f<a.length;f++){var o=a[f];c.prototype[o]||(c.prototype[o]=s.prototype[o])}function c(u){if(!(this instanceof c))return new c(u);r.call(this,u),s.call(this,u),u&&u.readable===!1&&(this.readable=!1),u&&u.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,u&&u.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||e.nextTick(h,this)}function h(u){u.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(u){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}),c.prototype._destroy=function(u,m){this.push(null),this.end(),e.nextTick(m,u)}},function(p,l){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){typeof window=="object"&&(n=window)}p.exports=n},function(p,l){typeof Object.create=="function"?p.exports=function(n,e){n.super_=e,n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}:p.exports=function(n,e){n.super_=e;var i=function(){};i.prototype=e.prototype,n.prototype=new i,n.prototype.constructor=n}},function(p,l,n){"use strict";for(var e=n(0),i=n(3),t=n(12),r=n(1),s=new Array(256),a=0;a<256;a++)s[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;s[254]=s[254]=1;function f(){r.call(this,"utf-8 decode"),this.leftOver=null}function o(){r.call(this,"utf-8 encode")}l.utf8encode=function(c){return i.nodebuffer?t.newBufferFrom(c,"utf-8"):function(d){var h,u,m,g,_,y=d.length,v=0;for(g=0;g<y;g++)(64512&(u=d.charCodeAt(g)))==55296&&g+1<y&&(64512&(m=d.charCodeAt(g+1)))==56320&&(u=65536+(u-55296<<10)+(m-56320),g++),v+=u<128?1:u<2048?2:u<65536?3:4;for(h=i.uint8array?new Uint8Array(v):new Array(v),_=0,g=0;_<v;g++)(64512&(u=d.charCodeAt(g)))==55296&&g+1<y&&(64512&(m=d.charCodeAt(g+1)))==56320&&(u=65536+(u-55296<<10)+(m-56320),g++),u<128?h[_++]=u:u<2048?(h[_++]=192|u>>>6,h[_++]=128|63&u):u<65536?(h[_++]=224|u>>>12,h[_++]=128|u>>>6&63,h[_++]=128|63&u):(h[_++]=240|u>>>18,h[_++]=128|u>>>12&63,h[_++]=128|u>>>6&63,h[_++]=128|63&u);return h}(c)},l.utf8decode=function(c){return i.nodebuffer?e.transformTo("nodebuffer",c).toString("utf-8"):function(d){var h,u,m,g,_=d.length,y=new Array(2*_);for(u=0,h=0;h<_;)if((m=d[h++])<128)y[u++]=m;else if((g=s[m])>4)y[u++]=65533,h+=g-1;else{for(m&=g===2?31:g===3?15:7;g>1&&h<_;)m=m<<6|63&d[h++],g--;g>1?y[u++]=65533:m<65536?y[u++]=m:(m-=65536,y[u++]=55296|m>>10&1023,y[u++]=56320|1023&m)}return y.length!==u&&(y.subarray?y=y.subarray(0,u):y.length=u),e.applyFromCharCode(y)}(c=e.transformTo(i.uint8array?"uint8array":"array",c))},e.inherits(f,r),f.prototype.processChunk=function(c){var d=e.transformTo(i.uint8array?"uint8array":"array",c.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var h=d;(d=new Uint8Array(h.length+this.leftOver.length)).set(this.leftOver,0),d.set(h,this.leftOver.length)}else d=this.leftOver.concat(d);this.leftOver=null}var u=function(g,_){var y;for((_=_||g.length)>g.length&&(_=g.length),y=_-1;y>=0&&(192&g[y])==128;)y--;return y<0||y===0?_:y+s[g[y]]>_?y:_}(d),m=d;u!==d.length&&(i.uint8array?(m=d.subarray(0,u),this.leftOver=d.subarray(u,d.length)):(m=d.slice(0,u),this.leftOver=d.slice(u,d.length))),this.push({data:l.utf8decode(m),meta:c.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:l.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},l.Utf8DecodeWorker=f,e.inherits(o,r),o.prototype.processChunk=function(c){this.push({data:l.utf8encode(c.data),meta:c.meta})},l.Utf8EncodeWorker=o},function(p,l,n){"use strict";var e=null;e=typeof Promise<"u"?Promise:n(74),p.exports={Promise:e}},function(p,l,n){(function(e){function i(t){return Object.prototype.toString.call(t)}l.isArray=function(t){return Array.isArray?Array.isArray(t):i(t)==="[object Array]"},l.isBoolean=function(t){return typeof t=="boolean"},l.isNull=function(t){return t===null},l.isNullOrUndefined=function(t){return t==null},l.isNumber=function(t){return typeof t=="number"},l.isString=function(t){return typeof t=="string"},l.isSymbol=function(t){return typeof t=="symbol"},l.isUndefined=function(t){return t===void 0},l.isRegExp=function(t){return i(t)==="[object RegExp]"},l.isObject=function(t){return typeof t=="object"&&t!==null},l.isDate=function(t){return i(t)==="[object Date]"},l.isError=function(t){return i(t)==="[object Error]"||t instanceof Error},l.isFunction=function(t){return typeof t=="function"},l.isPrimitive=function(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||t===void 0},l.isBuffer=e.isBuffer}).call(this,n(10).Buffer)},function(p,l,n){"use strict";(function(e){var i=n(102),t=n(101),r=n(51);function s(){return f.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(j,J){if(s()<J)throw new RangeError("Invalid typed array length");return f.TYPED_ARRAY_SUPPORT?(j=new Uint8Array(J)).__proto__=f.prototype:(j===null&&(j=new f(J)),j.length=J),j}function f(j,J,at){if(!(f.TYPED_ARRAY_SUPPORT||this instanceof f))return new f(j,J,at);if(typeof j=="number"){if(typeof J=="string")throw new Error("If encoding is specified then the first argument must be a string");return d(this,j)}return o(this,j,J,at)}function o(j,J,at,xt){if(typeof J=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&J instanceof ArrayBuffer?function(Rt,Lt,te,zt){if(Lt.byteLength,te<0||Lt.byteLength<te)throw new RangeError("'offset' is out of bounds");if(Lt.byteLength<te+(zt||0))throw new RangeError("'length' is out of bounds");return Lt=te===void 0&&zt===void 0?new Uint8Array(Lt):zt===void 0?new Uint8Array(Lt,te):new Uint8Array(Lt,te,zt),f.TYPED_ARRAY_SUPPORT?(Rt=Lt).__proto__=f.prototype:Rt=h(Rt,Lt),Rt}(j,J,at,xt):typeof J=="string"?function(Rt,Lt,te){if(typeof te=="string"&&te!==""||(te="utf8"),!f.isEncoding(te))throw new TypeError('"encoding" must be a valid string encoding');var zt=0|m(Lt,te),ee=(Rt=a(Rt,zt)).write(Lt,te);return ee!==zt&&(Rt=Rt.slice(0,ee)),Rt}(j,J,at):function(Rt,Lt){if(f.isBuffer(Lt)){var te=0|u(Lt.length);return(Rt=a(Rt,te)).length===0||Lt.copy(Rt,0,0,te),Rt}if(Lt){if(typeof ArrayBuffer<"u"&&Lt.buffer instanceof ArrayBuffer||"length"in Lt)return typeof Lt.length!="number"||function(zt){return zt!=zt}(Lt.length)?a(Rt,0):h(Rt,Lt);if(Lt.type==="Buffer"&&r(Lt.data))return h(Rt,Lt.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(j,J)}function c(j){if(typeof j!="number")throw new TypeError('"size" argument must be a number');if(j<0)throw new RangeError('"size" argument must not be negative')}function d(j,J){if(c(J),j=a(j,J<0?0:0|u(J)),!f.TYPED_ARRAY_SUPPORT)for(var at=0;at<J;++at)j[at]=0;return j}function h(j,J){var at=J.length<0?0:0|u(J.length);j=a(j,at);for(var xt=0;xt<at;xt+=1)j[xt]=255&J[xt];return j}function u(j){if(j>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|j}function m(j,J){if(f.isBuffer(j))return j.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(j)||j instanceof ArrayBuffer))return j.byteLength;typeof j!="string"&&(j=""+j);var at=j.length;if(at===0)return 0;for(var xt=!1;;)switch(J){case"ascii":case"latin1":case"binary":return at;case"utf8":case"utf-8":case void 0:return qt(j).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*at;case"hex":return at>>>1;case"base64":return Qt(j).length;default:if(xt)return qt(j).length;J=(""+J).toLowerCase(),xt=!0}}function g(j,J,at){var xt=j[J];j[J]=j[at],j[at]=xt}function _(j,J,at,xt,Rt){if(j.length===0)return-1;if(typeof at=="string"?(xt=at,at=0):at>2147483647?at=2147483647:at<-2147483648&&(at=-2147483648),at=+at,isNaN(at)&&(at=Rt?0:j.length-1),at<0&&(at=j.length+at),at>=j.length){if(Rt)return-1;at=j.length-1}else if(at<0){if(!Rt)return-1;at=0}if(typeof J=="string"&&(J=f.from(J,xt)),f.isBuffer(J))return J.length===0?-1:y(j,J,at,xt,Rt);if(typeof J=="number")return J&=255,f.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?Rt?Uint8Array.prototype.indexOf.call(j,J,at):Uint8Array.prototype.lastIndexOf.call(j,J,at):y(j,[J],at,xt,Rt);throw new TypeError("val must be string, number or Buffer")}function y(j,J,at,xt,Rt){var Lt,te=1,zt=j.length,ee=J.length;if(xt!==void 0&&((xt=String(xt).toLowerCase())==="ucs2"||xt==="ucs-2"||xt==="utf16le"||xt==="utf-16le")){if(j.length<2||J.length<2)return-1;te=2,zt/=2,ee/=2,at/=2}function $(Y,ht){return te===1?Y[ht]:Y.readUInt16BE(ht*te)}if(Rt){var N=-1;for(Lt=at;Lt<zt;Lt++)if($(j,Lt)===$(J,N===-1?0:Lt-N)){if(N===-1&&(N=Lt),Lt-N+1===ee)return N*te}else N!==-1&&(Lt-=Lt-N),N=-1}else for(at+ee>zt&&(at=zt-ee),Lt=at;Lt>=0;Lt--){for(var K=!0,k=0;k<ee;k++)if($(j,Lt+k)!==$(J,k)){K=!1;break}if(K)return Lt}return-1}function v(j,J,at,xt){at=Number(at)||0;var Rt=j.length-at;xt?(xt=Number(xt))>Rt&&(xt=Rt):xt=Rt;var Lt=J.length;if(Lt%2!=0)throw new TypeError("Invalid hex string");xt>Lt/2&&(xt=Lt/2);for(var te=0;te<xt;++te){var zt=parseInt(J.substr(2*te,2),16);if(isNaN(zt))return te;j[at+te]=zt}return te}function b(j,J,at,xt){return ne(qt(J,j.length-at),j,at,xt)}function R(j,J,at,xt){return ne(function(Rt){for(var Lt=[],te=0;te<Rt.length;++te)Lt.push(255&Rt.charCodeAt(te));return Lt}(J),j,at,xt)}function M(j,J,at,xt){return R(j,J,at,xt)}function P(j,J,at,xt){return ne(Qt(J),j,at,xt)}function T(j,J,at,xt){return ne(function(Rt,Lt){for(var te,zt,ee,$=[],N=0;N<Rt.length&&!((Lt-=2)<0);++N)te=Rt.charCodeAt(N),zt=te>>8,ee=te%256,$.push(ee),$.push(zt);return $}(J,j.length-at),j,at,xt)}function E(j,J,at){return J===0&&at===j.length?i.fromByteArray(j):i.fromByteArray(j.slice(J,at))}function x(j,J,at){at=Math.min(j.length,at);for(var xt=[],Rt=J;Rt<at;){var Lt,te,zt,ee,$=j[Rt],N=null,K=$>239?4:$>223?3:$>191?2:1;if(Rt+K<=at)switch(K){case 1:$<128&&(N=$);break;case 2:(192&(Lt=j[Rt+1]))==128&&(ee=(31&$)<<6|63&Lt)>127&&(N=ee);break;case 3:Lt=j[Rt+1],te=j[Rt+2],(192&Lt)==128&&(192&te)==128&&(ee=(15&$)<<12|(63&Lt)<<6|63&te)>2047&&(ee<55296||ee>57343)&&(N=ee);break;case 4:Lt=j[Rt+1],te=j[Rt+2],zt=j[Rt+3],(192&Lt)==128&&(192&te)==128&&(192&zt)==128&&(ee=(15&$)<<18|(63&Lt)<<12|(63&te)<<6|63&zt)>65535&&ee<1114112&&(N=ee)}N===null?(N=65533,K=1):N>65535&&(N-=65536,xt.push(N>>>10&1023|55296),N=56320|1023&N),xt.push(N),Rt+=K}return function(k){var Y=k.length;if(Y<=S)return String.fromCharCode.apply(String,k);for(var ht="",wt=0;wt<Y;)ht+=String.fromCharCode.apply(String,k.slice(wt,wt+=S));return ht}(xt)}l.Buffer=f,l.SlowBuffer=function(j){return+j!=j&&(j=0),f.alloc(+j)},l.INSPECT_MAX_BYTES=50,f.TYPED_ARRAY_SUPPORT=e.TYPED_ARRAY_SUPPORT!==void 0?e.TYPED_ARRAY_SUPPORT:function(){try{var j=new Uint8Array(1);return j.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},j.foo()===42&&typeof j.subarray=="function"&&j.subarray(1,1).byteLength===0}catch(J){return!1}}(),l.kMaxLength=s(),f.poolSize=8192,f._augment=function(j){return j.__proto__=f.prototype,j},f.from=function(j,J,at){return o(null,j,J,at)},f.TYPED_ARRAY_SUPPORT&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0})),f.alloc=function(j,J,at){return function(xt,Rt,Lt,te){return c(Rt),Rt<=0?a(xt,Rt):Lt!==void 0?typeof te=="string"?a(xt,Rt).fill(Lt,te):a(xt,Rt).fill(Lt):a(xt,Rt)}(null,j,J,at)},f.allocUnsafe=function(j){return d(null,j)},f.allocUnsafeSlow=function(j){return d(null,j)},f.isBuffer=function(j){return!(j==null||!j._isBuffer)},f.compare=function(j,J){if(!f.isBuffer(j)||!f.isBuffer(J))throw new TypeError("Arguments must be Buffers");if(j===J)return 0;for(var at=j.length,xt=J.length,Rt=0,Lt=Math.min(at,xt);Rt<Lt;++Rt)if(j[Rt]!==J[Rt]){at=j[Rt],xt=J[Rt];break}return at<xt?-1:xt<at?1:0},f.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(j,J){if(!r(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return f.alloc(0);var at;if(J===void 0)for(J=0,at=0;at<j.length;++at)J+=j[at].length;var xt=f.allocUnsafe(J),Rt=0;for(at=0;at<j.length;++at){var Lt=j[at];if(!f.isBuffer(Lt))throw new TypeError('"list" argument must be an Array of Buffers');Lt.copy(xt,Rt),Rt+=Lt.length}return xt},f.byteLength=m,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var j=this.length;if(j%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var J=0;J<j;J+=2)g(this,J,J+1);return this},f.prototype.swap32=function(){var j=this.length;if(j%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var J=0;J<j;J+=4)g(this,J,J+3),g(this,J+1,J+2);return this},f.prototype.swap64=function(){var j=this.length;if(j%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var J=0;J<j;J+=8)g(this,J,J+7),g(this,J+1,J+6),g(this,J+2,J+5),g(this,J+3,J+4);return this},f.prototype.toString=function(){var j=0|this.length;return j===0?"":arguments.length===0?x(this,0,j):(function(J,at,xt){var Rt=!1;if((at===void 0||at<0)&&(at=0),at>this.length||((xt===void 0||xt>this.length)&&(xt=this.length),xt<=0)||(xt>>>=0)<=(at>>>=0))return"";for(J||(J="utf8");;)switch(J){case"hex":return F(this,at,xt);case"utf8":case"utf-8":return x(this,at,xt);case"ascii":return L(this,at,xt);case"latin1":case"binary":return C(this,at,xt);case"base64":return E(this,at,xt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,at,xt);default:if(Rt)throw new TypeError("Unknown encoding: "+J);J=(J+"").toLowerCase(),Rt=!0}}).apply(this,arguments)},f.prototype.equals=function(j){if(!f.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j||f.compare(this,j)===0},f.prototype.inspect=function(){var j="",J=l.INSPECT_MAX_BYTES;return this.length>0&&(j=this.toString("hex",0,J).match(/.{2}/g).join(" "),this.length>J&&(j+=" ... ")),"<Buffer "+j+">"},f.prototype.compare=function(j,J,at,xt,Rt){if(!f.isBuffer(j))throw new TypeError("Argument must be a Buffer");if(J===void 0&&(J=0),at===void 0&&(at=j?j.length:0),xt===void 0&&(xt=0),Rt===void 0&&(Rt=this.length),J<0||at>j.length||xt<0||Rt>this.length)throw new RangeError("out of range index");if(xt>=Rt&&J>=at)return 0;if(xt>=Rt)return-1;if(J>=at)return 1;if(J>>>=0,at>>>=0,xt>>>=0,Rt>>>=0,this===j)return 0;for(var Lt=Rt-xt,te=at-J,zt=Math.min(Lt,te),ee=this.slice(xt,Rt),$=j.slice(J,at),N=0;N<zt;++N)if(ee[N]!==$[N]){Lt=ee[N],te=$[N];break}return Lt<te?-1:te<Lt?1:0},f.prototype.includes=function(j,J,at){return this.indexOf(j,J,at)!==-1},f.prototype.indexOf=function(j,J,at){return _(this,j,J,at,!0)},f.prototype.lastIndexOf=function(j,J,at){return _(this,j,J,at,!1)},f.prototype.write=function(j,J,at,xt){if(J===void 0)xt="utf8",at=this.length,J=0;else if(at===void 0&&typeof J=="string")xt=J,at=this.length,J=0;else{if(!isFinite(J))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");J|=0,isFinite(at)?(at|=0,xt===void 0&&(xt="utf8")):(xt=at,at=void 0)}var Rt=this.length-J;if((at===void 0||at>Rt)&&(at=Rt),j.length>0&&(at<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");xt||(xt="utf8");for(var Lt=!1;;)switch(xt){case"hex":return v(this,j,J,at);case"utf8":case"utf-8":return b(this,j,J,at);case"ascii":return R(this,j,J,at);case"latin1":case"binary":return M(this,j,J,at);case"base64":return P(this,j,J,at);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,j,J,at);default:if(Lt)throw new TypeError("Unknown encoding: "+xt);xt=(""+xt).toLowerCase(),Lt=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function L(j,J,at){var xt="";at=Math.min(j.length,at);for(var Rt=J;Rt<at;++Rt)xt+=String.fromCharCode(127&j[Rt]);return xt}function C(j,J,at){var xt="";at=Math.min(j.length,at);for(var Rt=J;Rt<at;++Rt)xt+=String.fromCharCode(j[Rt]);return xt}function F(j,J,at){var xt=j.length;(!J||J<0)&&(J=0),(!at||at<0||at>xt)&&(at=xt);for(var Rt="",Lt=J;Lt<at;++Lt)Rt+=Gt(j[Lt]);return Rt}function q(j,J,at){for(var xt=j.slice(J,at),Rt="",Lt=0;Lt<xt.length;Lt+=2)Rt+=String.fromCharCode(xt[Lt]+256*xt[Lt+1]);return Rt}function it(j,J,at){if(j%1!=0||j<0)throw new RangeError("offset is not uint");if(j+J>at)throw new RangeError("Trying to access beyond buffer length")}function st(j,J,at,xt,Rt,Lt){if(!f.isBuffer(j))throw new TypeError('"buffer" argument must be a Buffer instance');if(J>Rt||J<Lt)throw new RangeError('"value" argument is out of bounds');if(at+xt>j.length)throw new RangeError("Index out of range")}function pt(j,J,at,xt){J<0&&(J=65535+J+1);for(var Rt=0,Lt=Math.min(j.length-at,2);Rt<Lt;++Rt)j[at+Rt]=(J&255<<8*(xt?Rt:1-Rt))>>>8*(xt?Rt:1-Rt)}function _t(j,J,at,xt){J<0&&(J=4294967295+J+1);for(var Rt=0,Lt=Math.min(j.length-at,4);Rt<Lt;++Rt)j[at+Rt]=J>>>8*(xt?Rt:3-Rt)&255}function X(j,J,at,xt,Rt,Lt){if(at+xt>j.length)throw new RangeError("Index out of range");if(at<0)throw new RangeError("Index out of range")}function ot(j,J,at,xt,Rt){return Rt||X(j,0,at,4),t.write(j,J,at,xt,23,4),at+4}function Tt(j,J,at,xt,Rt){return Rt||X(j,0,at,8),t.write(j,J,at,xt,52,8),at+8}f.prototype.slice=function(j,J){var at,xt=this.length;if(j=~~j,J=J===void 0?xt:~~J,j<0?(j+=xt)<0&&(j=0):j>xt&&(j=xt),J<0?(J+=xt)<0&&(J=0):J>xt&&(J=xt),J<j&&(J=j),f.TYPED_ARRAY_SUPPORT)(at=this.subarray(j,J)).__proto__=f.prototype;else{var Rt=J-j;at=new f(Rt,void 0);for(var Lt=0;Lt<Rt;++Lt)at[Lt]=this[Lt+j]}return at},f.prototype.readUIntLE=function(j,J,at){j|=0,J|=0,at||it(j,J,this.length);for(var xt=this[j],Rt=1,Lt=0;++Lt<J&&(Rt*=256);)xt+=this[j+Lt]*Rt;return xt},f.prototype.readUIntBE=function(j,J,at){j|=0,J|=0,at||it(j,J,this.length);for(var xt=this[j+--J],Rt=1;J>0&&(Rt*=256);)xt+=this[j+--J]*Rt;return xt},f.prototype.readUInt8=function(j,J){return J||it(j,1,this.length),this[j]},f.prototype.readUInt16LE=function(j,J){return J||it(j,2,this.length),this[j]|this[j+1]<<8},f.prototype.readUInt16BE=function(j,J){return J||it(j,2,this.length),this[j]<<8|this[j+1]},f.prototype.readUInt32LE=function(j,J){return J||it(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+16777216*this[j+3]},f.prototype.readUInt32BE=function(j,J){return J||it(j,4,this.length),16777216*this[j]+(this[j+1]<<16|this[j+2]<<8|this[j+3])},f.prototype.readIntLE=function(j,J,at){j|=0,J|=0,at||it(j,J,this.length);for(var xt=this[j],Rt=1,Lt=0;++Lt<J&&(Rt*=256);)xt+=this[j+Lt]*Rt;return xt>=(Rt*=128)&&(xt-=Math.pow(2,8*J)),xt},f.prototype.readIntBE=function(j,J,at){j|=0,J|=0,at||it(j,J,this.length);for(var xt=J,Rt=1,Lt=this[j+--xt];xt>0&&(Rt*=256);)Lt+=this[j+--xt]*Rt;return Lt>=(Rt*=128)&&(Lt-=Math.pow(2,8*J)),Lt},f.prototype.readInt8=function(j,J){return J||it(j,1,this.length),128&this[j]?-1*(255-this[j]+1):this[j]},f.prototype.readInt16LE=function(j,J){J||it(j,2,this.length);var at=this[j]|this[j+1]<<8;return 32768&at?4294901760|at:at},f.prototype.readInt16BE=function(j,J){J||it(j,2,this.length);var at=this[j+1]|this[j]<<8;return 32768&at?4294901760|at:at},f.prototype.readInt32LE=function(j,J){return J||it(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},f.prototype.readInt32BE=function(j,J){return J||it(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},f.prototype.readFloatLE=function(j,J){return J||it(j,4,this.length),t.read(this,j,!0,23,4)},f.prototype.readFloatBE=function(j,J){return J||it(j,4,this.length),t.read(this,j,!1,23,4)},f.prototype.readDoubleLE=function(j,J){return J||it(j,8,this.length),t.read(this,j,!0,52,8)},f.prototype.readDoubleBE=function(j,J){return J||it(j,8,this.length),t.read(this,j,!1,52,8)},f.prototype.writeUIntLE=function(j,J,at,xt){j=+j,J|=0,at|=0,xt||st(this,j,J,at,Math.pow(2,8*at)-1,0);var Rt=1,Lt=0;for(this[J]=255&j;++Lt<at&&(Rt*=256);)this[J+Lt]=j/Rt&255;return J+at},f.prototype.writeUIntBE=function(j,J,at,xt){j=+j,J|=0,at|=0,xt||st(this,j,J,at,Math.pow(2,8*at)-1,0);var Rt=at-1,Lt=1;for(this[J+Rt]=255&j;--Rt>=0&&(Lt*=256);)this[J+Rt]=j/Lt&255;return J+at},f.prototype.writeUInt8=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,1,255,0),f.TYPED_ARRAY_SUPPORT||(j=Math.floor(j)),this[J]=255&j,J+1},f.prototype.writeUInt16LE=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[J]=255&j,this[J+1]=j>>>8):pt(this,j,J,!0),J+2},f.prototype.writeUInt16BE=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,2,65535,0),f.TYPED_ARRAY_SUPPORT?(this[J]=j>>>8,this[J+1]=255&j):pt(this,j,J,!1),J+2},f.prototype.writeUInt32LE=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[J+3]=j>>>24,this[J+2]=j>>>16,this[J+1]=j>>>8,this[J]=255&j):_t(this,j,J,!0),J+4},f.prototype.writeUInt32BE=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,4,4294967295,0),f.TYPED_ARRAY_SUPPORT?(this[J]=j>>>24,this[J+1]=j>>>16,this[J+2]=j>>>8,this[J+3]=255&j):_t(this,j,J,!1),J+4},f.prototype.writeIntLE=function(j,J,at,xt){if(j=+j,J|=0,!xt){var Rt=Math.pow(2,8*at-1);st(this,j,J,at,Rt-1,-Rt)}var Lt=0,te=1,zt=0;for(this[J]=255&j;++Lt<at&&(te*=256);)j<0&&zt===0&&this[J+Lt-1]!==0&&(zt=1),this[J+Lt]=(j/te>>0)-zt&255;return J+at},f.prototype.writeIntBE=function(j,J,at,xt){if(j=+j,J|=0,!xt){var Rt=Math.pow(2,8*at-1);st(this,j,J,at,Rt-1,-Rt)}var Lt=at-1,te=1,zt=0;for(this[J+Lt]=255&j;--Lt>=0&&(te*=256);)j<0&&zt===0&&this[J+Lt+1]!==0&&(zt=1),this[J+Lt]=(j/te>>0)-zt&255;return J+at},f.prototype.writeInt8=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,1,127,-128),f.TYPED_ARRAY_SUPPORT||(j=Math.floor(j)),j<0&&(j=255+j+1),this[J]=255&j,J+1},f.prototype.writeInt16LE=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[J]=255&j,this[J+1]=j>>>8):pt(this,j,J,!0),J+2},f.prototype.writeInt16BE=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,2,32767,-32768),f.TYPED_ARRAY_SUPPORT?(this[J]=j>>>8,this[J+1]=255&j):pt(this,j,J,!1),J+2},f.prototype.writeInt32LE=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,4,2147483647,-2147483648),f.TYPED_ARRAY_SUPPORT?(this[J]=255&j,this[J+1]=j>>>8,this[J+2]=j>>>16,this[J+3]=j>>>24):_t(this,j,J,!0),J+4},f.prototype.writeInt32BE=function(j,J,at){return j=+j,J|=0,at||st(this,j,J,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),f.TYPED_ARRAY_SUPPORT?(this[J]=j>>>24,this[J+1]=j>>>16,this[J+2]=j>>>8,this[J+3]=255&j):_t(this,j,J,!1),J+4},f.prototype.writeFloatLE=function(j,J,at){return ot(this,j,J,!0,at)},f.prototype.writeFloatBE=function(j,J,at){return ot(this,j,J,!1,at)},f.prototype.writeDoubleLE=function(j,J,at){return Tt(this,j,J,!0,at)},f.prototype.writeDoubleBE=function(j,J,at){return Tt(this,j,J,!1,at)},f.prototype.copy=function(j,J,at,xt){if(at||(at=0),xt||xt===0||(xt=this.length),J>=j.length&&(J=j.length),J||(J=0),xt>0&&xt<at&&(xt=at),xt===at||j.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(at<0||at>=this.length)throw new RangeError("sourceStart out of bounds");if(xt<0)throw new RangeError("sourceEnd out of bounds");xt>this.length&&(xt=this.length),j.length-J<xt-at&&(xt=j.length-J+at);var Rt,Lt=xt-at;if(this===j&&at<J&&J<xt)for(Rt=Lt-1;Rt>=0;--Rt)j[Rt+J]=this[Rt+at];else if(Lt<1e3||!f.TYPED_ARRAY_SUPPORT)for(Rt=0;Rt<Lt;++Rt)j[Rt+J]=this[Rt+at];else Uint8Array.prototype.set.call(j,this.subarray(at,at+Lt),J);return Lt},f.prototype.fill=function(j,J,at,xt){if(typeof j=="string"){if(typeof J=="string"?(xt=J,J=0,at=this.length):typeof at=="string"&&(xt=at,at=this.length),j.length===1){var Rt=j.charCodeAt(0);Rt<256&&(j=Rt)}if(xt!==void 0&&typeof xt!="string")throw new TypeError("encoding must be a string");if(typeof xt=="string"&&!f.isEncoding(xt))throw new TypeError("Unknown encoding: "+xt)}else typeof j=="number"&&(j&=255);if(J<0||this.length<J||this.length<at)throw new RangeError("Out of range index");if(at<=J)return this;var Lt;if(J>>>=0,at=at===void 0?this.length:at>>>0,j||(j=0),typeof j=="number")for(Lt=J;Lt<at;++Lt)this[Lt]=j;else{var te=f.isBuffer(j)?j:qt(new f(j,xt).toString()),zt=te.length;for(Lt=0;Lt<at-J;++Lt)this[Lt+J]=te[Lt%zt]}return this};var Vt=/[^+\/0-9A-Za-z-_]/g;function Gt(j){return j<16?"0"+j.toString(16):j.toString(16)}function qt(j,J){var at;J=J||1/0;for(var xt=j.length,Rt=null,Lt=[],te=0;te<xt;++te){if((at=j.charCodeAt(te))>55295&&at<57344){if(!Rt){if(at>56319){(J-=3)>-1&&Lt.push(239,191,189);continue}if(te+1===xt){(J-=3)>-1&&Lt.push(239,191,189);continue}Rt=at;continue}if(at<56320){(J-=3)>-1&&Lt.push(239,191,189),Rt=at;continue}at=65536+(Rt-55296<<10|at-56320)}else Rt&&(J-=3)>-1&&Lt.push(239,191,189);if(Rt=null,at<128){if((J-=1)<0)break;Lt.push(at)}else if(at<2048){if((J-=2)<0)break;Lt.push(at>>6|192,63&at|128)}else if(at<65536){if((J-=3)<0)break;Lt.push(at>>12|224,at>>6&63|128,63&at|128)}else{if(!(at<1114112))throw new Error("Invalid code point");if((J-=4)<0)break;Lt.push(at>>18|240,at>>12&63|128,at>>6&63|128,63&at|128)}}return Lt}function Qt(j){return i.toByteArray(function(J){if((J=function(at){return at.trim?at.trim():at.replace(/^\s+|\s+$/g,"")}(J).replace(Vt,"")).length<2)return"";for(;J.length%4!=0;)J+="=";return J}(j))}function ne(j,J,at,xt){for(var Rt=0;Rt<xt&&!(Rt+at>=J.length||Rt>=j.length);++Rt)J[Rt+at]=j[Rt];return Rt}}).call(this,n(5))},function(p,l){var n=p.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=n)},function(p,l,n){"use strict";(function(e){p.exports={isNode:e!==void 0,newBufferFrom:function(i,t){return new e(i,t)},allocBuffer:function(i){return e.alloc?e.alloc(i):new e(i)},isBuffer:function(i){return e.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}}).call(this,n(10).Buffer)},function(p,l,n){var e=n(10),i=e.Buffer;function t(s,a){for(var f in s)a[f]=s[f]}function r(s,a,f){return i(s,a,f)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?p.exports=e:(t(e,l),l.Buffer=r),t(i,r),r.from=function(s,a,f){if(typeof s=="number")throw new TypeError("Argument must not be a number");return i(s,a,f)},r.alloc=function(s,a,f){if(typeof s!="number")throw new TypeError("Argument must be a number");var o=i(s);return a!==void 0?typeof f=="string"?o.fill(a,f):o.fill(a):o.fill(0),o},r.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return i(s)},r.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return e.SlowBuffer(s)}},function(p,l,n){"use strict";(function(e){!e.version||e.version.indexOf("v0.")===0||e.version.indexOf("v1.")===0&&e.version.indexOf("v1.8.")!==0?p.exports={nextTick:function(i,t,r,s){if(typeof i!="function")throw new TypeError('"callback" argument must be a function');var a,f,o=arguments.length;switch(o){case 0:case 1:return e.nextTick(i);case 2:return e.nextTick(function(){i.call(null,t)});case 3:return e.nextTick(function(){i.call(null,t,r)});case 4:return e.nextTick(function(){i.call(null,t,r,s)});default:for(a=new Array(o-1),f=0;f<a.length;)a[f++]=arguments[f];return e.nextTick(function(){i.apply(null,a)})}}}:p.exports=e}).call(this,n(15))},function(p,l){var n,e,i=p.exports={};function t(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function s(g){if(n===setTimeout)return setTimeout(g,0);if((n===t||!n)&&setTimeout)return n=setTimeout,setTimeout(g,0);try{return n(g,0)}catch(_){try{return n.call(null,g,0)}catch(y){return n.call(this,g,0)}}}(function(){try{n=typeof setTimeout=="function"?setTimeout:t}catch(g){n=t}try{e=typeof clearTimeout=="function"?clearTimeout:r}catch(g){e=r}})();var a,f=[],o=!1,c=-1;function d(){o&&a&&(o=!1,a.length?f=a.concat(f):c=-1,f.length&&h())}function h(){if(!o){var g=s(d);o=!0;for(var _=f.length;_;){for(a=f,f=[];++c<_;)a&&a[c].run();c=-1,_=f.length}a=null,o=!1,function(y){if(e===clearTimeout)return clearTimeout(y);if((e===r||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(y);try{e(y)}catch(v){try{return e.call(null,y)}catch(b){return e.call(this,y)}}}(g)}}function u(g,_){this.fun=g,this.array=_}function m(){}i.nextTick=function(g){var _=new Array(arguments.length-1);if(arguments.length>1)for(var y=1;y<arguments.length;y++)_[y-1]=arguments[y];f.push(new u(g,_)),f.length!==1||o||s(h)},u.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(g){return[]},i.binding=function(g){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(g){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(p,l,n){"use strict";p.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(p,l,n){"use strict";var e=n(0),i=function(){for(var t,r=[],s=0;s<256;s++){t=s;for(var a=0;a<8;a++)t=1&t?3988292384^t>>>1:t>>>1;r[s]=t}return r}();p.exports=function(t,r){return t!==void 0&&t.length?e.getTypeOf(t)!=="string"?function(s,a,f,o){var c=i,d=o+f;s^=-1;for(var h=o;h<d;h++)s=s>>>8^c[255&(s^a[h])];return-1^s}(0|r,t,t.length,0):function(s,a,f,o){var c=i,d=o+f;s^=-1;for(var h=o;h<d;h++)s=s>>>8^c[255&(s^a.charCodeAt(h))];return-1^s}(0|r,t,t.length,0):0}},function(p,l,n){"use strict";var e=n(8),i=n(37),t=n(36),r=n(35);t=n(36);function s(a,f,o,c,d){this.compressedSize=a,this.uncompressedSize=f,this.crc32=o,this.compression=c,this.compressedContent=d}s.prototype={getContentWorker:function(){var a=new i(e.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new t("data_length")),f=this;return a.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),a},getCompressedWorker:function(){return new i(e.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(a,f,o){return a.pipe(new r).pipe(new t("uncompressedSize")).pipe(f.compressWorker(o)).pipe(new t("compressedSize")).withStreamInfo("compression",f)},p.exports=s},function(p,l,n){p.exports=!n(41)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(p,l){p.exports=function(n){return typeof n=="object"?n!==null:typeof n=="function"}},function(p,l,n){"use strict";(function(e,i,t){var r=n(14);function s(x){var S=this;this.next=null,this.entry=null,this.finish=function(){(function(L,C,F){var q=L.entry;for(L.entry=null;q;){var it=q.callback;C.pendingcb--,it(F),q=q.next}C.corkedRequestsFree?C.corkedRequestsFree.next=L:C.corkedRequestsFree=L})(S,x)}}p.exports=v;var a,f=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?i:r.nextTick;v.WritableState=y;var o=n(9);o.inherits=n(6);var c={deprecate:n(94)},d=n(48),h=n(13).Buffer,u=t.Uint8Array||function(){},m,g=n(47);function _(){}function y(x,S){a=a||n(4),x=x||{};var L=S instanceof a;this.objectMode=!!x.objectMode,L&&(this.objectMode=this.objectMode||!!x.writableObjectMode);var C=x.highWaterMark,F=x.writableHighWaterMark,q=this.objectMode?16:16384;this.highWaterMark=C||C===0?C:L&&(F||F===0)?F:q,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var it=x.decodeStrings===!1;this.decodeStrings=!it,this.defaultEncoding=x.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(st){(function(pt,_t){var X=pt._writableState,ot=X.sync,Tt=X.writecb;if(function(Gt){Gt.writing=!1,Gt.writecb=null,Gt.length-=Gt.writelen,Gt.writelen=0}(X),_t)(function(Gt,qt,Qt,ne,j){--qt.pendingcb,Qt?(r.nextTick(j,ne),r.nextTick(E,Gt,qt),Gt._writableState.errorEmitted=!0,Gt.emit("error",ne)):(j(ne),Gt._writableState.errorEmitted=!0,Gt.emit("error",ne),E(Gt,qt))})(pt,X,ot,_t,Tt);else{var Vt=P(X);Vt||X.corked||X.bufferProcessing||!X.bufferedRequest||M(pt,X),ot?f(R,pt,X,Vt,Tt):R(pt,X,Vt,Tt)}})(S,st)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function v(x){if(a=a||n(4),!(m.call(v,this)||this instanceof a))return new v(x);this._writableState=new y(x,this),this.writable=!0,x&&(typeof x.write=="function"&&(this._write=x.write),typeof x.writev=="function"&&(this._writev=x.writev),typeof x.destroy=="function"&&(this._destroy=x.destroy),typeof x.final=="function"&&(this._final=x.final)),d.call(this)}function b(x,S,L,C,F,q,it){S.writelen=C,S.writecb=it,S.writing=!0,S.sync=!0,L?x._writev(F,S.onwrite):x._write(F,q,S.onwrite),S.sync=!1}function R(x,S,L,C){L||function(F,q){q.length===0&&q.needDrain&&(q.needDrain=!1,F.emit("drain"))}(x,S),S.pendingcb--,C(),E(x,S)}function M(x,S){S.bufferProcessing=!0;var L=S.bufferedRequest;if(x._writev&&L&&L.next){var C=S.bufferedRequestCount,F=new Array(C),q=S.corkedRequestsFree;q.entry=L;for(var it=0,st=!0;L;)F[it]=L,L.isBuf||(st=!1),L=L.next,it+=1;F.allBuffers=st,b(x,S,!0,S.length,F,"",q.finish),S.pendingcb++,S.lastBufferedRequest=null,q.next?(S.corkedRequestsFree=q.next,q.next=null):S.corkedRequestsFree=new s(S),S.bufferedRequestCount=0}else{for(;L;){var pt=L.chunk,_t=L.encoding,X=L.callback;if(b(x,S,!1,S.objectMode?1:pt.length,pt,_t,X),L=L.next,S.bufferedRequestCount--,S.writing)break}L===null&&(S.lastBufferedRequest=null)}S.bufferedRequest=L,S.bufferProcessing=!1}function P(x){return x.ending&&x.length===0&&x.bufferedRequest===null&&!x.finished&&!x.writing}function T(x,S){x._final(function(L){S.pendingcb--,L&&x.emit("error",L),S.prefinished=!0,x.emit("prefinish"),E(x,S)})}function E(x,S){var L=P(S);return L&&(function(C,F){F.prefinished||F.finalCalled||(typeof C._final=="function"?(F.pendingcb++,F.finalCalled=!0,r.nextTick(T,C,F)):(F.prefinished=!0,C.emit("prefinish")))}(x,S),S.pendingcb===0&&(S.finished=!0,x.emit("finish"))),L}o.inherits(v,d),y.prototype.getBuffer=function(){for(var x=this.bufferedRequest,S=[];x;)S.push(x),x=x.next;return S},function(){try{Object.defineProperty(y.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(x){}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(m=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(x){return!!m.call(this,x)||this===v&&x&&x._writableState instanceof y}})):m=function(x){return x instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(x,S,L){var C=this._writableState,F=!1,q=!C.objectMode&&function(it){return h.isBuffer(it)||it instanceof u}(x);return q&&!h.isBuffer(x)&&(x=function(it){return h.from(it)}(x)),typeof S=="function"&&(L=S,S=null),q?S="buffer":S||(S=C.defaultEncoding),typeof L!="function"&&(L=_),C.ended?function(it,st){var pt=new Error("write after end");it.emit("error",pt),r.nextTick(st,pt)}(this,L):(q||function(it,st,pt,_t){var X=!0,ot=!1;return pt===null?ot=new TypeError("May not write null values to stream"):typeof pt=="string"||pt===void 0||st.objectMode||(ot=new TypeError("Invalid non-string/buffer chunk")),ot&&(it.emit("error",ot),r.nextTick(_t,ot),X=!1),X}(this,C,x,L))&&(C.pendingcb++,F=function(it,st,pt,_t,X,ot){if(!pt){var Tt=function(Qt,ne,j){return Qt.objectMode||Qt.decodeStrings===!1||typeof ne!="string"||(ne=h.from(ne,j)),ne}(st,_t,X);_t!==Tt&&(pt=!0,X="buffer",_t=Tt)}var Vt=st.objectMode?1:_t.length;st.length+=Vt;var Gt=st.length<st.highWaterMark;if(Gt||(st.needDrain=!0),st.writing||st.corked){var qt=st.lastBufferedRequest;st.lastBufferedRequest={chunk:_t,encoding:X,isBuf:pt,callback:ot,next:null},qt?qt.next=st.lastBufferedRequest:st.bufferedRequest=st.lastBufferedRequest,st.bufferedRequestCount+=1}else b(it,st,!1,Vt,_t,X,ot);return Gt}(this,C,q,x,S,L)),F},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var x=this._writableState;x.corked&&(x.corked--,x.writing||x.corked||x.finished||x.bufferProcessing||!x.bufferedRequest||M(this,x))},v.prototype.setDefaultEncoding=function(x){if(typeof x=="string"&&(x=x.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((x+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+x);return this._writableState.defaultEncoding=x,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(x,S,L){L(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(x,S,L){var C=this._writableState;typeof x=="function"?(L=x,x=null,S=null):typeof S=="function"&&(L=S,S=null),x!=null&&this.write(x,S),C.corked&&(C.corked=1,this.uncork()),C.ending||C.finished||function(F,q,it){q.ending=!0,E(F,q),it&&(q.finished?r.nextTick(it):F.once("finish",it)),q.ended=!0,F.writable=!1}(this,C,L)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(x){this._writableState&&(this._writableState.destroyed=x)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(x,S){this.end(),S(x)}}).call(this,n(15),n(96).setImmediate,n(5))},function(p,l,n){(l=p.exports=n(49)).Stream=l,l.Readable=l,l.Writable=n(21),l.Duplex=n(4),l.Transform=n(45),l.PassThrough=n(93)},function(p,l){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(r){return typeof r=="function"}function i(r){return typeof r=="object"&&r!==null}function t(r){return r===void 0}p.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(r){if(!function(s){return typeof s=="number"}(r)||r<0||isNaN(r))throw TypeError("n must be a positive number");return this._maxListeners=r,this},n.prototype.emit=function(r){var s,a,f,o,c,d;if(this._events||(this._events={}),r==="error"&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((s=arguments[1])instanceof Error)throw s;var h=new Error('Uncaught, unspecified "error" event. ('+s+")");throw h.context=s,h}if(t(a=this._events[r]))return!1;if(e(a))switch(arguments.length){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),a.apply(this,o)}else if(i(a))for(o=Array.prototype.slice.call(arguments,1),f=(d=a.slice()).length,c=0;c<f;c++)d[c].apply(this,o);return!0},n.prototype.addListener=function(r,s){var a;if(!e(s))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",r,e(s.listener)?s.listener:s),this._events[r]?i(this._events[r])?this._events[r].push(s):this._events[r]=[this._events[r],s]:this._events[r]=s,i(this._events[r])&&!this._events[r].warned&&(a=t(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[r].length>a&&(this._events[r].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[r].length),typeof console.trace=="function"&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(r,s){if(!e(s))throw TypeError("listener must be a function");var a=!1;function f(){this.removeListener(r,f),a||(a=!0,s.apply(this,arguments))}return f.listener=s,this.on(r,f),this},n.prototype.removeListener=function(r,s){var a,f,o,c;if(!e(s))throw TypeError("listener must be a function");if(!this._events||!this._events[r])return this;if(o=(a=this._events[r]).length,f=-1,a===s||e(a.listener)&&a.listener===s)delete this._events[r],this._events.removeListener&&this.emit("removeListener",r,s);else if(i(a)){for(c=o;c-- >0;)if(a[c]===s||a[c].listener&&a[c].listener===s){f=c;break}if(f<0)return this;a.length===1?(a.length=0,delete this._events[r]):a.splice(f,1),this._events.removeListener&&this.emit("removeListener",r,s)}return this},n.prototype.removeAllListeners=function(r){var s,a;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[r]&&delete this._events[r],this;if(arguments.length===0){for(s in this._events)s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events={},this}if(e(a=this._events[r]))this.removeListener(r,a);else if(a)for(;a.length;)this.removeListener(r,a[a.length-1]);return delete this._events[r],this},n.prototype.listeners=function(r){return this._events&&this._events[r]?e(this._events[r])?[this._events[r]]:this._events[r].slice():[]},n.prototype.listenerCount=function(r){if(this._events){var s=this._events[r];if(e(s))return 1;if(s)return s.length}return 0},n.listenerCount=function(r,s){return r.listenerCount(s)}},function(p,l,n){"use strict";var e=n(26);function i(t){e.call(this,t)}n(0).inherits(i,e),i.prototype.readData=function(t){if(this.checkOffset(t),t===0)return new Uint8Array(0);var r=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,r},p.exports=i},function(p,l,n){"use strict";var e=n(0);function i(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var r,s=0;for(this.checkOffset(t),r=this.index+t-1;r>=this.index;r--)s=(s<<8)+this.byteAt(r);return this.index+=t,s},readString:function(t){return e.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},p.exports=i},function(p,l,n){"use strict";var e=n(25);function i(t){e.call(this,t);for(var r=0;r<this.data.length;r++)t[r]=255&t[r]}n(0).inherits(i,e),i.prototype.byteAt=function(t){return this.data[this.zero+t]},i.prototype.lastIndexOfSignature=function(t){for(var r=t.charCodeAt(0),s=t.charCodeAt(1),a=t.charCodeAt(2),f=t.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===r&&this.data[o+1]===s&&this.data[o+2]===a&&this.data[o+3]===f)return o-this.zero;return-1},i.prototype.readAndCheckSignature=function(t){var r=t.charCodeAt(0),s=t.charCodeAt(1),a=t.charCodeAt(2),f=t.charCodeAt(3),o=this.readData(4);return r===o[0]&&s===o[1]&&a===o[2]&&f===o[3]},i.prototype.readData=function(t){if(this.checkOffset(t),t===0)return[];var r=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,r},p.exports=i},function(p,l,n){"use strict";var e=n(0),i=n(3),t=n(26),r=n(54),s=n(53),a=n(24);p.exports=function(f){var o=e.getTypeOf(f);return e.checkSupport(o),o!=="string"||i.uint8array?o==="nodebuffer"?new s(f):i.uint8array?new a(e.transformTo("uint8array",f)):new t(e.transformTo("array",f)):new r(f)}},function(p,l,n){"use strict";l.LOCAL_FILE_HEADER="PK",l.CENTRAL_FILE_HEADER="PK",l.CENTRAL_DIRECTORY_END="PK",l.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",l.ZIP64_CENTRAL_DIRECTORY_END="PK",l.DATA_DESCRIPTOR="PK\x07\b"},function(p,l,n){"use strict";p.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(p,l,n){"use strict";p.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(p,l,n){"use strict";var e=n(2),i=!0,t=!0;try{String.fromCharCode.apply(null,[0])}catch(f){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(f){t=!1}for(var r=new e.Buf8(256),s=0;s<256;s++)r[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;function a(f,o){if(o<65537&&(f.subarray&&t||!f.subarray&&i))return String.fromCharCode.apply(null,e.shrinkBuf(f,o));for(var c="",d=0;d<o;d++)c+=String.fromCharCode(f[d]);return c}r[254]=r[254]=1,l.string2buf=function(f){var o,c,d,h,u,m=f.length,g=0;for(h=0;h<m;h++)(64512&(c=f.charCodeAt(h)))==55296&&h+1<m&&(64512&(d=f.charCodeAt(h+1)))==56320&&(c=65536+(c-55296<<10)+(d-56320),h++),g+=c<128?1:c<2048?2:c<65536?3:4;for(o=new e.Buf8(g),u=0,h=0;u<g;h++)(64512&(c=f.charCodeAt(h)))==55296&&h+1<m&&(64512&(d=f.charCodeAt(h+1)))==56320&&(c=65536+(c-55296<<10)+(d-56320),h++),c<128?o[u++]=c:c<2048?(o[u++]=192|c>>>6,o[u++]=128|63&c):c<65536?(o[u++]=224|c>>>12,o[u++]=128|c>>>6&63,o[u++]=128|63&c):(o[u++]=240|c>>>18,o[u++]=128|c>>>12&63,o[u++]=128|c>>>6&63,o[u++]=128|63&c);return o},l.buf2binstring=function(f){return a(f,f.length)},l.binstring2buf=function(f){for(var o=new e.Buf8(f.length),c=0,d=o.length;c<d;c++)o[c]=f.charCodeAt(c);return o},l.buf2string=function(f,o){var c,d,h,u,m=o||f.length,g=new Array(2*m);for(d=0,c=0;c<m;)if((h=f[c++])<128)g[d++]=h;else if((u=r[h])>4)g[d++]=65533,c+=u-1;else{for(h&=u===2?31:u===3?15:7;u>1&&c<m;)h=h<<6|63&f[c++],u--;u>1?g[d++]=65533:h<65536?g[d++]=h:(h-=65536,g[d++]=55296|h>>10&1023,g[d++]=56320|1023&h)}return a(g,d)},l.utf8border=function(f,o){var c;for((o=o||f.length)>f.length&&(o=f.length),c=o-1;c>=0&&(192&f[c])==128;)c--;return c<0||c===0?o:c+r[f[c]]>o?c:o}},function(p,l,n){"use strict";var e=function(){for(var i,t=[],r=0;r<256;r++){i=r;for(var s=0;s<8;s++)i=1&i?3988292384^i>>>1:i>>>1;t[r]=i}return t}();p.exports=function(i,t,r,s){var a=e,f=s+r;i^=-1;for(var o=s;o<f;o++)i=i>>>8^a[255&(i^t[o])];return-1^i}},function(p,l,n){"use strict";p.exports=function(e,i,t,r){for(var s=65535&e|0,a=e>>>16&65535|0,f=0;t!==0;){t-=f=t>2e3?2e3:t;do a=a+(s=s+i[r++]|0)|0;while(--f);s%=65521,a%=65521}return s|a<<16|0}},function(p,l,n){"use strict";var e=n(1);l.STORE={magic:"\0\0",compressWorker:function(i){return new e("STORE compression")},uncompressWorker:function(){return new e("STORE decompression")}},l.DEFLATE=n(68)},function(p,l,n){"use strict";var e=n(1),i=n(17);function t(){e.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n(0).inherits(t,e),t.prototype.processChunk=function(r){this.streamInfo.crc32=i(r.data,this.streamInfo.crc32||0),this.push(r)},p.exports=t},function(p,l,n){"use strict";var e=n(0),i=n(1);function t(r){i.call(this,"DataLengthProbe for "+r),this.propName=r,this.withStreamInfo(r,0)}e.inherits(t,i),t.prototype.processChunk=function(r){if(r){var s=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=s+r.data.length}i.prototype.processChunk.call(this,r)},p.exports=t},function(p,l,n){"use strict";var e=n(0),i=n(1);function t(r){i.call(this,"DataWorker");var s=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,r.then(function(a){s.dataIsReady=!0,s.data=a,s.max=a&&a.length||0,s.type=e.getTypeOf(a),s.isPaused||s._tickAndRepeat()},function(a){s.error(a)})}e.inherits(t,i),t.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},t.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,e.delay(this._tickAndRepeat,[],this)),!0)},t.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(e.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},t.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var r=null,s=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":r=this.data.substring(this.index,s);break;case"uint8array":r=this.data.subarray(this.index,s);break;case"array":case"nodebuffer":r=this.data.slice(this.index,s)}return this.index=s,this.push({data:r,meta:{percent:this.max?this.index/this.max*100:0}})},p.exports=t},function(p,l,n){"use strict";l.base64=!1,l.binary=!1,l.dir=!1,l.createFolders=!0,l.date=null,l.compression=null,l.compressionOptions=null,l.comment=null,l.unixPermissions=null,l.dosPermissions=null},function(p,l,n){"use strict";(function(e){var i=n(0),t=n(72),r=n(1),s=n(44),a=n(3),f=n(8),o=null;if(a.nodestream)try{o=n(71)}catch(h){}function c(h,u){return new f.Promise(function(m,g){var _=[],y=h._internalType,v=h._outputType,b=h._mimeType;h.on("data",function(R,M){_.push(R),u&&u(M)}).on("error",function(R){_=[],g(R)}).on("end",function(){try{var R=function(M,P,T){switch(M){case"blob":return i.newBlob(i.transformTo("arraybuffer",P),T);case"base64":return s.encode(P);default:return i.transformTo(M,P)}}(v,function(M,P){var T,E=0,x=null,S=0;for(T=0;T<P.length;T++)S+=P[T].length;switch(M){case"string":return P.join("");case"array":return Array.prototype.concat.apply([],P);case"uint8array":for(x=new Uint8Array(S),T=0;T<P.length;T++)x.set(P[T],E),E+=P[T].length;return x;case"nodebuffer":return e.concat(P);default:throw new Error("concat : unsupported type '"+M+"'")}}(y,_),b);m(R)}catch(M){g(M)}_=[]}).resume()})}function d(h,u,m){var g=u;switch(u){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=u,this._mimeType=m,i.checkSupport(g),this._worker=h.pipe(new t(g)),h.lock()}catch(_){this._worker=new r("error"),this._worker.error(_)}}d.prototype={accumulate:function(h){return c(this,h)},on:function(h,u){var m=this;return h==="data"?this._worker.on(h,function(g){u.call(m,g.data,g.meta)}):this._worker.on(h,function(){i.delay(u,arguments,m)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(h){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new o(this,{objectMode:this._outputType!=="nodebuffer"},h)}},p.exports=d}).call(this,n(10).Buffer)},function(p,l,n){var e=n(20),i=n(11).document,t=e(i)&&e(i.createElement);p.exports=function(r){return t?i.createElement(r):{}}},function(p,l){p.exports=function(n){try{return!!n()}catch(e){return!0}}},function(p,l,n){var e=n(85);p.exports=function(i,t,r){if(e(i),t===void 0)return i;switch(r){case 1:return function(s){return i.call(t,s)};case 2:return function(s,a){return i.call(t,s,a)};case 3:return function(s,a,f){return i.call(t,s,a,f)}}return function(){return i.apply(t,arguments)}}},function(p,l){var n=p.exports={version:"2.3.0"};typeof __e=="number"&&(__e=n)},function(p,l,n){"use strict";var e=n(0),i=n(3),t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";l.encode=function(r){for(var s,a,f,o,c,d,h,u=[],m=0,g=r.length,_=g,y=e.getTypeOf(r)!=="string";m<r.length;)_=g-m,y?(s=r[m++],a=m<g?r[m++]:0,f=m<g?r[m++]:0):(s=r.charCodeAt(m++),a=m<g?r.charCodeAt(m++):0,f=m<g?r.charCodeAt(m++):0),o=s>>2,c=(3&s)<<4|a>>4,d=_>1?(15&a)<<2|f>>6:64,h=_>2?63&f:64,u.push(t.charAt(o)+t.charAt(c)+t.charAt(d)+t.charAt(h));return u.join("")},l.decode=function(r){var s,a,f,o,c,d,h=0,u=0;if(r.substr(0,5)==="data:")throw new Error("Invalid base64 input, it looks like a data url.");var m,g=3*(r=r.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(r.charAt(r.length-1)===t.charAt(64)&&g--,r.charAt(r.length-2)===t.charAt(64)&&g--,g%1!=0)throw new Error("Invalid base64 input, bad content length.");for(m=i.uint8array?new Uint8Array(0|g):new Array(0|g);h<r.length;)s=t.indexOf(r.charAt(h++))<<2|(o=t.indexOf(r.charAt(h++)))>>4,a=(15&o)<<4|(c=t.indexOf(r.charAt(h++)))>>2,f=(3&c)<<6|(d=t.indexOf(r.charAt(h++))),m[u++]=s,c!==64&&(m[u++]=a),d!==64&&(m[u++]=f);return m}},function(p,l,n){"use strict";p.exports=t;var e=n(4),i=n(9);function t(a){if(!(this instanceof t))return new t(a);e.call(this,a),this._transformState={afterTransform:(function(f,o){var c=this._transformState;c.transforming=!1;var d=c.writecb;if(!d)return this.emit("error",new Error("write callback called multiple times"));c.writechunk=null,c.writecb=null,o!=null&&this.push(o),d(f);var h=this._readableState;h.reading=!1,(h.needReadable||h.length<h.highWaterMark)&&this._read(h.highWaterMark)}).bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,a&&(typeof a.transform=="function"&&(this._transform=a.transform),typeof a.flush=="function"&&(this._flush=a.flush)),this.on("prefinish",r)}function r(){var a=this;typeof this._flush=="function"?this._flush(function(f,o){s(a,f,o)}):s(this,null,null)}function s(a,f,o){if(f)return a.emit("error",f);if(o!=null&&a.push(o),a._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(a._transformState.transforming)throw new Error("Calling transform done when still transforming");return a.push(null)}i.inherits=n(6),i.inherits(t,e),t.prototype.push=function(a,f){return this._transformState.needTransform=!1,e.prototype.push.call(this,a,f)},t.prototype._transform=function(a,f,o){throw new Error("_transform() is not implemented")},t.prototype._write=function(a,f,o){var c=this._transformState;if(c.writecb=o,c.writechunk=a,c.writeencoding=f,!c.transforming){var d=this._readableState;(c.needTransform||d.needReadable||d.length<d.highWaterMark)&&this._read(d.highWaterMark)}},t.prototype._read=function(a){var f=this._transformState;f.writechunk!==null&&f.writecb&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},t.prototype._destroy=function(a,f){var o=this;e.prototype._destroy.call(this,a,function(c){f(c),o.emit("close")})}},function(p,l,n){"use strict";var e=n(13).Buffer,i=e.isEncoding||function(u){switch((u=""+u)&&u.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(u){var m;switch(this.encoding=function(g){var _=function(y){if(!y)return"utf8";for(var v;;)switch(y){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return y;default:if(v)return;y=(""+y).toLowerCase(),v=!0}}(g);if(typeof _!="string"&&(e.isEncoding===i||!i(g)))throw new Error("Unknown encoding: "+g);return _||g}(u),this.encoding){case"utf16le":this.text=a,this.end=f,m=4;break;case"utf8":this.fillLast=s,m=4;break;case"base64":this.text=o,this.end=c,m=3;break;default:return this.write=d,void(this.end=h)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(m)}function r(u){return u<=127?0:u>>5==6?2:u>>4==14?3:u>>3==30?4:u>>6==2?-1:-2}function s(u){var m=this.lastTotal-this.lastNeed,g=function(_,y,v){if((192&y[0])!=128)return _.lastNeed=0,"\uFFFD";if(_.lastNeed>1&&y.length>1){if((192&y[1])!=128)return _.lastNeed=1,"\uFFFD";if(_.lastNeed>2&&y.length>2&&(192&y[2])!=128)return _.lastNeed=2,"\uFFFD"}}(this,u);return g!==void 0?g:this.lastNeed<=u.length?(u.copy(this.lastChar,m,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(u.copy(this.lastChar,m,0,u.length),void(this.lastNeed-=u.length))}function a(u,m){if((u.length-m)%2==0){var g=u.toString("utf16le",m);if(g){var _=g.charCodeAt(g.length-1);if(_>=55296&&_<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1],g.slice(0,-1)}return g}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=u[u.length-1],u.toString("utf16le",m,u.length-1)}function f(u){var m=u&&u.length?this.write(u):"";if(this.lastNeed){var g=this.lastTotal-this.lastNeed;return m+this.lastChar.toString("utf16le",0,g)}return m}function o(u,m){var g=(u.length-m)%3;return g===0?u.toString("base64",m):(this.lastNeed=3-g,this.lastTotal=3,g===1?this.lastChar[0]=u[u.length-1]:(this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1]),u.toString("base64",m,u.length-g))}function c(u){var m=u&&u.length?this.write(u):"";return this.lastNeed?m+this.lastChar.toString("base64",0,3-this.lastNeed):m}function d(u){return u.toString(this.encoding)}function h(u){return u&&u.length?this.write(u):""}l.StringDecoder=t,t.prototype.write=function(u){if(u.length===0)return"";var m,g;if(this.lastNeed){if((m=this.fillLast(u))===void 0)return"";g=this.lastNeed,this.lastNeed=0}else g=0;return g<u.length?m?m+this.text(u,g):this.text(u,g):m||""},t.prototype.end=function(u){var m=u&&u.length?this.write(u):"";return this.lastNeed?m+"\uFFFD":m},t.prototype.text=function(u,m){var g=function(y,v,b){var R=v.length-1;if(R<b)return 0;var M=r(v[R]);return M>=0?(M>0&&(y.lastNeed=M-1),M):--R<b||M===-2?0:(M=r(v[R]))>=0?(M>0&&(y.lastNeed=M-2),M):--R<b||M===-2?0:(M=r(v[R]))>=0?(M>0&&(M===2?M=0:y.lastNeed=M-3),M):0}(this,u,m);if(!this.lastNeed)return u.toString("utf8",m);this.lastTotal=g;var _=u.length-(g-this.lastNeed);return u.copy(this.lastChar,0,_),u.toString("utf8",m,_)},t.prototype.fillLast=function(u){if(this.lastNeed<=u.length)return u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,u.length),this.lastNeed-=u.length}},function(p,l,n){"use strict";var e=n(14);function i(t,r){t.emit("error",r)}p.exports={destroy:function(t,r){var s=this,a=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return a||f?(r?r(t):!t||this._writableState&&this._writableState.errorEmitted||e.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!r&&o?(e.nextTick(i,s,o),s._writableState&&(s._writableState.errorEmitted=!0)):r&&r(o)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(p,l,n){p.exports=n(23).EventEmitter},function(p,l,n){"use strict";(function(e,i){var t=n(14);p.exports=b;var r,s=n(51);b.ReadableState=v,n(23).EventEmitter;var a=function(X,ot){return X.listeners(ot).length},f=n(48),o=n(13).Buffer,c=e.Uint8Array||function(){},d=n(9);d.inherits=n(6);var h=n(99),u=void 0;u=h&&h.debuglog?h.debuglog("stream"):function(){};var m,g=n(98),_=n(47);d.inherits(b,f);var y=["error","close","destroy","pause","resume"];function v(X,ot){r=r||n(4),X=X||{};var Tt=ot instanceof r;this.objectMode=!!X.objectMode,Tt&&(this.objectMode=this.objectMode||!!X.readableObjectMode);var Vt=X.highWaterMark,Gt=X.readableHighWaterMark,qt=this.objectMode?16:16384;this.highWaterMark=Vt||Vt===0?Vt:Tt&&(Gt||Gt===0)?Gt:qt,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=X.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,X.encoding&&(m||(m=n(46).StringDecoder),this.decoder=new m(X.encoding),this.encoding=X.encoding)}function b(X){if(r=r||n(4),!(this instanceof b))return new b(X);this._readableState=new v(X,this),this.readable=!0,X&&(typeof X.read=="function"&&(this._read=X.read),typeof X.destroy=="function"&&(this._destroy=X.destroy)),f.call(this)}function R(X,ot,Tt,Vt,Gt){var qt,Qt=X._readableState;return ot===null?(Qt.reading=!1,function(ne,j){if(!j.ended){if(j.decoder){var J=j.decoder.end();J&&J.length&&(j.buffer.push(J),j.length+=j.objectMode?1:J.length)}j.ended=!0,E(ne)}}(X,Qt)):(Gt||(qt=function(ne,j){var J;return function(at){return o.isBuffer(at)||at instanceof c}(j)||typeof j=="string"||j===void 0||ne.objectMode||(J=new TypeError("Invalid non-string/buffer chunk")),J}(Qt,ot)),qt?X.emit("error",qt):Qt.objectMode||ot&&ot.length>0?(typeof ot=="string"||Qt.objectMode||Object.getPrototypeOf(ot)===o.prototype||(ot=function(ne){return o.from(ne)}(ot)),Vt?Qt.endEmitted?X.emit("error",new Error("stream.unshift() after end event")):M(X,Qt,ot,!0):Qt.ended?X.emit("error",new Error("stream.push() after EOF")):(Qt.reading=!1,Qt.decoder&&!Tt?(ot=Qt.decoder.write(ot),Qt.objectMode||ot.length!==0?M(X,Qt,ot,!1):S(X,Qt)):M(X,Qt,ot,!1))):Vt||(Qt.reading=!1)),function(ne){return!ne.ended&&(ne.needReadable||ne.length<ne.highWaterMark||ne.length===0)}(Qt)}function M(X,ot,Tt,Vt){ot.flowing&&ot.length===0&&!ot.sync?(X.emit("data",Tt),X.read(0)):(ot.length+=ot.objectMode?1:Tt.length,Vt?ot.buffer.unshift(Tt):ot.buffer.push(Tt),ot.needReadable&&E(X)),S(X,ot)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(X){this._readableState&&(this._readableState.destroyed=X)}}),b.prototype.destroy=_.destroy,b.prototype._undestroy=_.undestroy,b.prototype._destroy=function(X,ot){this.push(null),ot(X)},b.prototype.push=function(X,ot){var Tt,Vt=this._readableState;return Vt.objectMode?Tt=!0:typeof X=="string"&&((ot=ot||Vt.defaultEncoding)!==Vt.encoding&&(X=o.from(X,ot),ot=""),Tt=!0),R(this,X,ot,!1,Tt)},b.prototype.unshift=function(X){return R(this,X,null,!0,!1)},b.prototype.isPaused=function(){return this._readableState.flowing===!1},b.prototype.setEncoding=function(X){return m||(m=n(46).StringDecoder),this._readableState.decoder=new m(X),this._readableState.encoding=X,this};var P=8388608;function T(X,ot){return X<=0||ot.length===0&&ot.ended?0:ot.objectMode?1:X!=X?ot.flowing&&ot.length?ot.buffer.head.data.length:ot.length:(X>ot.highWaterMark&&(ot.highWaterMark=function(Tt){return Tt>=P?Tt=P:(Tt--,Tt|=Tt>>>1,Tt|=Tt>>>2,Tt|=Tt>>>4,Tt|=Tt>>>8,Tt|=Tt>>>16,Tt++),Tt}(X)),X<=ot.length?X:ot.ended?ot.length:(ot.needReadable=!0,0))}function E(X){var ot=X._readableState;ot.needReadable=!1,ot.emittedReadable||(u("emitReadable",ot.flowing),ot.emittedReadable=!0,ot.sync?t.nextTick(x,X):x(X))}function x(X){u("emit readable"),X.emit("readable"),q(X)}function S(X,ot){ot.readingMore||(ot.readingMore=!0,t.nextTick(L,X,ot))}function L(X,ot){for(var Tt=ot.length;!ot.reading&&!ot.flowing&&!ot.ended&&ot.length<ot.highWaterMark&&(u("maybeReadMore read 0"),X.read(0),Tt!==ot.length);)Tt=ot.length;ot.readingMore=!1}function C(X){u("readable nexttick read 0"),X.read(0)}function F(X,ot){ot.reading||(u("resume read 0"),X.read(0)),ot.resumeScheduled=!1,ot.awaitDrain=0,X.emit("resume"),q(X),ot.flowing&&!ot.reading&&X.read(0)}function q(X){var ot=X._readableState;for(u("flow",ot.flowing);ot.flowing&&X.read()!==null;);}function it(X,ot){return ot.length===0?null:(ot.objectMode?Tt=ot.buffer.shift():!X||X>=ot.length?(Tt=ot.decoder?ot.buffer.join(""):ot.buffer.length===1?ot.buffer.head.data:ot.buffer.concat(ot.length),ot.buffer.clear()):Tt=function(Vt,Gt,qt){var Qt;return Vt<Gt.head.data.length?(Qt=Gt.head.data.slice(0,Vt),Gt.head.data=Gt.head.data.slice(Vt)):Qt=Vt===Gt.head.data.length?Gt.shift():qt?function(ne,j){var J=j.head,at=1,xt=J.data;for(ne-=xt.length;J=J.next;){var Rt=J.data,Lt=ne>Rt.length?Rt.length:ne;if(Lt===Rt.length?xt+=Rt:xt+=Rt.slice(0,ne),(ne-=Lt)===0){Lt===Rt.length?(++at,J.next?j.head=J.next:j.head=j.tail=null):(j.head=J,J.data=Rt.slice(Lt));break}++at}return j.length-=at,xt}(Vt,Gt):function(ne,j){var J=o.allocUnsafe(ne),at=j.head,xt=1;for(at.data.copy(J),ne-=at.data.length;at=at.next;){var Rt=at.data,Lt=ne>Rt.length?Rt.length:ne;if(Rt.copy(J,J.length-ne,0,Lt),(ne-=Lt)===0){Lt===Rt.length?(++xt,at.next?j.head=at.next:j.head=j.tail=null):(j.head=at,at.data=Rt.slice(Lt));break}++xt}return j.length-=xt,J}(Vt,Gt),Qt}(X,ot.buffer,ot.decoder),Tt);var Tt}function st(X){var ot=X._readableState;if(ot.length>0)throw new Error('"endReadable()" called on non-empty stream');ot.endEmitted||(ot.ended=!0,t.nextTick(pt,ot,X))}function pt(X,ot){X.endEmitted||X.length!==0||(X.endEmitted=!0,ot.readable=!1,ot.emit("end"))}function _t(X,ot){for(var Tt=0,Vt=X.length;Tt<Vt;Tt++)if(X[Tt]===ot)return Tt;return-1}b.prototype.read=function(X){u("read",X),X=parseInt(X,10);var ot=this._readableState,Tt=X;if(X!==0&&(ot.emittedReadable=!1),X===0&&ot.needReadable&&(ot.length>=ot.highWaterMark||ot.ended))return u("read: emitReadable",ot.length,ot.ended),ot.length===0&&ot.ended?st(this):E(this),null;if((X=T(X,ot))===0&&ot.ended)return ot.length===0&&st(this),null;var Vt,Gt=ot.needReadable;return u("need readable",Gt),(ot.length===0||ot.length-X<ot.highWaterMark)&&u("length less than watermark",Gt=!0),ot.ended||ot.reading?u("reading or ended",Gt=!1):Gt&&(u("do read"),ot.reading=!0,ot.sync=!0,ot.length===0&&(ot.needReadable=!0),this._read(ot.highWaterMark),ot.sync=!1,ot.reading||(X=T(Tt,ot))),(Vt=X>0?it(X,ot):null)===null?(ot.needReadable=!0,X=0):ot.length-=X,ot.length===0&&(ot.ended||(ot.needReadable=!0),Tt!==X&&ot.ended&&st(this)),Vt!==null&&this.emit("data",Vt),Vt},b.prototype._read=function(X){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(X,ot){var Tt=this,Vt=this._readableState;switch(Vt.pipesCount){case 0:Vt.pipes=X;break;case 1:Vt.pipes=[Vt.pipes,X];break;default:Vt.pipes.push(X)}Vt.pipesCount+=1,u("pipe count=%d opts=%j",Vt.pipesCount,ot);var Gt=(!ot||ot.end!==!1)&&X!==i.stdout&&X!==i.stderr?Qt:te;function qt(zt,ee){u("onunpipe"),zt===Tt&&ee&&ee.hasUnpiped===!1&&(ee.hasUnpiped=!0,u("cleanup"),X.removeListener("close",Rt),X.removeListener("finish",Lt),X.removeListener("drain",ne),X.removeListener("error",xt),X.removeListener("unpipe",qt),Tt.removeListener("end",Qt),Tt.removeListener("end",te),Tt.removeListener("data",at),j=!0,!Vt.awaitDrain||X._writableState&&!X._writableState.needDrain||ne())}function Qt(){u("onend"),X.end()}Vt.endEmitted?t.nextTick(Gt):Tt.once("end",Gt),X.on("unpipe",qt);var ne=function(zt){return function(){var ee=zt._readableState;u("pipeOnDrain",ee.awaitDrain),ee.awaitDrain&&ee.awaitDrain--,ee.awaitDrain===0&&a(zt,"data")&&(ee.flowing=!0,q(zt))}}(Tt);X.on("drain",ne);var j=!1,J=!1;function at(zt){u("ondata"),J=!1,X.write(zt)!==!1||J||((Vt.pipesCount===1&&Vt.pipes===X||Vt.pipesCount>1&&_t(Vt.pipes,X)!==-1)&&!j&&(u("false write response, pause",Tt._readableState.awaitDrain),Tt._readableState.awaitDrain++,J=!0),Tt.pause())}function xt(zt){u("onerror",zt),te(),X.removeListener("error",xt),a(X,"error")===0&&X.emit("error",zt)}function Rt(){X.removeListener("finish",Lt),te()}function Lt(){u("onfinish"),X.removeListener("close",Rt),te()}function te(){u("unpipe"),Tt.unpipe(X)}return Tt.on("data",at),function(zt,ee,$){if(typeof zt.prependListener=="function")return zt.prependListener(ee,$);zt._events&&zt._events[ee]?s(zt._events[ee])?zt._events[ee].unshift($):zt._events[ee]=[$,zt._events[ee]]:zt.on(ee,$)}(X,"error",xt),X.once("close",Rt),X.once("finish",Lt),X.emit("pipe",Tt),Vt.flowing||(u("pipe resume"),Tt.resume()),X},b.prototype.unpipe=function(X){var ot=this._readableState,Tt={hasUnpiped:!1};if(ot.pipesCount===0)return this;if(ot.pipesCount===1)return X&&X!==ot.pipes?this:(X||(X=ot.pipes),ot.pipes=null,ot.pipesCount=0,ot.flowing=!1,X&&X.emit("unpipe",this,Tt),this);if(!X){var Vt=ot.pipes,Gt=ot.pipesCount;ot.pipes=null,ot.pipesCount=0,ot.flowing=!1;for(var qt=0;qt<Gt;qt++)Vt[qt].emit("unpipe",this,Tt);return this}var Qt=_t(ot.pipes,X);return Qt===-1?this:(ot.pipes.splice(Qt,1),ot.pipesCount-=1,ot.pipesCount===1&&(ot.pipes=ot.pipes[0]),X.emit("unpipe",this,Tt),this)},b.prototype.on=function(X,ot){var Tt=f.prototype.on.call(this,X,ot);if(X==="data")this._readableState.flowing!==!1&&this.resume();else if(X==="readable"){var Vt=this._readableState;Vt.endEmitted||Vt.readableListening||(Vt.readableListening=Vt.needReadable=!0,Vt.emittedReadable=!1,Vt.reading?Vt.length&&E(this):t.nextTick(C,this))}return Tt},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var X=this._readableState;return X.flowing||(u("resume"),X.flowing=!0,function(ot,Tt){Tt.resumeScheduled||(Tt.resumeScheduled=!0,t.nextTick(F,ot,Tt))}(this,X)),this},b.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(X){var ot=this,Tt=this._readableState,Vt=!1;for(var Gt in X.on("end",function(){if(u("wrapped end"),Tt.decoder&&!Tt.ended){var Qt=Tt.decoder.end();Qt&&Qt.length&&ot.push(Qt)}ot.push(null)}),X.on("data",function(Qt){u("wrapped data"),Tt.decoder&&(Qt=Tt.decoder.write(Qt)),(!Tt.objectMode||Qt!=null)&&(Tt.objectMode||Qt&&Qt.length)&&(ot.push(Qt)||(Vt=!0,X.pause()))}),X)this[Gt]===void 0&&typeof X[Gt]=="function"&&(this[Gt]=function(Qt){return function(){return X[Qt].apply(X,arguments)}}(Gt));for(var qt=0;qt<y.length;qt++)X.on(y[qt],this.emit.bind(this,y[qt]));return this._read=function(Qt){u("wrapped _read",Qt),Vt&&(Vt=!1,X.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=it}).call(this,n(5),n(15))},function(p,l,n){p.exports=n(100)},function(p,l){var n={}.toString;p.exports=Array.isArray||function(e){return n.call(e)=="[object Array]"}},function(p,l,n){"use strict";var e=n(27),i=n(0),t=n(18),r=n(17),s=n(7),a=n(34),f=n(3);function o(c,d){this.options=c,this.loadOptions=d}o.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(c){var d,h;if(c.skip(22),this.fileNameLength=c.readInt(2),h=c.readInt(2),this.fileName=c.readData(this.fileNameLength),c.skip(h),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((d=function(u){for(var m in a)if(a.hasOwnProperty(m)&&a[m].magic===u)return a[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new t(this.compressedSize,this.uncompressedSize,this.crc32,d,c.readData(this.compressedSize))},readCentralPart:function(c){this.versionMadeBy=c.readInt(2),c.skip(2),this.bitFlag=c.readInt(2),this.compressionMethod=c.readString(2),this.date=c.readDate(),this.crc32=c.readInt(4),this.compressedSize=c.readInt(4),this.uncompressedSize=c.readInt(4);var d=c.readInt(2);if(this.extraFieldsLength=c.readInt(2),this.fileCommentLength=c.readInt(2),this.diskNumberStart=c.readInt(2),this.internalFileAttributes=c.readInt(2),this.externalFileAttributes=c.readInt(4),this.localHeaderOffset=c.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");c.skip(d),this.readExtraFields(c),this.parseZIP64ExtraField(c),this.fileComment=c.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var c=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),c===0&&(this.dosPermissions=63&this.externalFileAttributes),c===3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(c){if(this.extraFields[1]){var d=e(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(c){var d,h,u,m=c.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});c.index<m;)d=c.readInt(2),h=c.readInt(2),u=c.readData(h),this.extraFields[d]={id:d,length:h,value:u}},handleUTF8:function(){var c=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var d=this.findExtraFieldUnicodePath();if(d!==null)this.fileNameStr=d;else{var h=i.transformTo(c,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(h)}var u=this.findExtraFieldUnicodeComment();if(u!==null)this.fileCommentStr=u;else{var m=i.transformTo(c,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var c=this.extraFields[28789];if(c){var d=e(c.value);return d.readInt(1)!==1||r(this.fileName)!==d.readInt(4)?null:s.utf8decode(d.readData(c.length-5))}return null},findExtraFieldUnicodeComment:function(){var c=this.extraFields[25461];if(c){var d=e(c.value);return d.readInt(1)!==1||r(this.fileComment)!==d.readInt(4)?null:s.utf8decode(d.readData(c.length-5))}return null}},p.exports=o},function(p,l,n){"use strict";var e=n(24);function i(t){e.call(this,t)}n(0).inherits(i,e),i.prototype.readData=function(t){this.checkOffset(t);var r=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,r},p.exports=i},function(p,l,n){"use strict";var e=n(25);function i(t){e.call(this,t)}n(0).inherits(i,e),i.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},i.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},i.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},i.prototype.readData=function(t){this.checkOffset(t);var r=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,r},p.exports=i},function(p,l,n){"use strict";var e=n(27),i=n(0),t=n(28),r=n(52),s=(n(7),n(3));function a(f){this.files=[],this.loadOptions=f}a.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var o=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(o)+", expected "+i.pretty(f)+")")}},isSignature:function(f,o){var c=this.reader.index;this.reader.setIndex(f);var d=this.reader.readString(4)===o;return this.reader.setIndex(c),d},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),o=s.uint8array?"uint8array":"array",c=i.transformTo(o,f);this.zipComment=this.loadOptions.decodeFileName(c)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,o,c,d=this.zip64EndOfCentralSize-44;0<d;)f=this.reader.readInt(2),o=this.reader.readInt(4),c=this.reader.readData(o),this.zip64ExtensibleData[f]={id:f,length:o,value:c}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,o;for(f=0;f<this.files.length;f++)o=this.files[f],this.reader.setIndex(o.localHeaderOffset),this.checkSignature(t.LOCAL_FILE_HEADER),o.readLocalPart(this.reader),o.handleUTF8(),o.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(t.CENTRAL_FILE_HEADER);)(f=new r({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(t.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,t.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var o=f;if(this.checkSignature(t.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,t.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(t.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var c=this.centralDirOffset+this.centralDirSize;this.zip64&&(c+=20,c+=12+this.zip64EndOfCentralSize);var d=o-c;if(d>0)this.isSignature(o,t.CENTRAL_FILE_HEADER)||(this.reader.zero=d);else if(d<0)throw new Error("Corrupted zip: missing "+Math.abs(d)+" bytes.")},prepareReader:function(f){this.reader=e(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},p.exports=a},function(p,l,n){"use strict";var e=n(0),i=n(8),t=n(7),r=(e=n(0),n(55)),s=n(35),a=n(12);function f(o){return new i.Promise(function(c,d){var h=o.decompressed.getContentWorker().pipe(new s);h.on("error",function(u){d(u)}).on("end",function(){h.streamInfo.crc32!==o.decompressed.crc32?d(new Error("Corrupted zip : CRC32 mismatch")):c()}).resume()})}p.exports=function(o,c){var d=this;return c=e.extend(c||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:t.utf8decode}),a.isNode&&a.isStream(o)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):e.prepareContent("the loaded zip file",o,!0,c.optimizedBinaryString,c.base64).then(function(h){var u=new r(c);return u.load(h),u}).then(function(h){var u=[i.Promise.resolve(h)],m=h.files;if(c.checkCRC32)for(var g=0;g<m.length;g++)u.push(f(m[g]));return i.Promise.all(u)}).then(function(h){for(var u=h.shift(),m=u.files,g=0;g<m.length;g++){var _=m[g];d.file(_.fileNameStr,_.decompressed,{binary:!0,optimizedBinaryString:!0,date:_.date,dir:_.dir,comment:_.fileCommentStr.length?_.fileCommentStr:null,unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions,createFolders:c.createFolders})}return u.zipComment.length&&(d.comment=u.zipComment),d})}},function(p,l,n){"use strict";var e=n(0),i=n(1);function t(r,s){i.call(this,"Nodejs stream input adapter for "+r),this._upstreamEnded=!1,this._bindStream(s)}e.inherits(t,i),t.prototype._bindStream=function(r){var s=this;this._stream=r,r.pause(),r.on("data",function(a){s.push({data:a,meta:{percent:0}})}).on("error",function(a){s.isPaused?this.generatedError=a:s.error(a)}).on("end",function(){s.isPaused?s._upstreamEnded=!0:s.end()})},t.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},t.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},p.exports=t},function(p,l,n){"use strict";var e=n(0),i=n(1),t=n(7),r=n(17),s=n(28),a=function(c,d){var h,u="";for(h=0;h<d;h++)u+=String.fromCharCode(255&c),c>>>=8;return u},f=function(c,d,h,u,m,g){var _,y,v=c.file,b=c.compression,R=g!==t.utf8encode,M=e.transformTo("string",g(v.name)),P=e.transformTo("string",t.utf8encode(v.name)),T=v.comment,E=e.transformTo("string",g(T)),x=e.transformTo("string",t.utf8encode(T)),S=P.length!==v.name.length,L=x.length!==T.length,C="",F="",q="",it=v.dir,st=v.date,pt={crc32:0,compressedSize:0,uncompressedSize:0};d&&!h||(pt.crc32=c.crc32,pt.compressedSize=c.compressedSize,pt.uncompressedSize=c.uncompressedSize);var _t=0;d&&(_t|=8),R||!S&&!L||(_t|=2048);var X=0,ot=0;it&&(X|=16),m==="UNIX"?(ot=798,X|=function(Vt,Gt){var qt=Vt;return Vt||(qt=Gt?16893:33204),(65535&qt)<<16}(v.unixPermissions,it)):(ot=20,X|=function(Vt,Gt){return 63&(Vt||0)}(v.dosPermissions)),_=st.getUTCHours(),_<<=6,_|=st.getUTCMinutes(),_<<=5,_|=st.getUTCSeconds()/2,y=st.getUTCFullYear()-1980,y<<=4,y|=st.getUTCMonth()+1,y<<=5,y|=st.getUTCDate(),S&&(F=a(1,1)+a(r(M),4)+P,C+="up"+a(F.length,2)+F),L&&(q=a(1,1)+a(r(E),4)+x,C+="uc"+a(q.length,2)+q);var Tt="";return Tt+="\n\0",Tt+=a(_t,2),Tt+=b.magic,Tt+=a(_,2),Tt+=a(y,2),Tt+=a(pt.crc32,4),Tt+=a(pt.compressedSize,4),Tt+=a(pt.uncompressedSize,4),Tt+=a(M.length,2),Tt+=a(C.length,2),{fileRecord:s.LOCAL_FILE_HEADER+Tt+M+C,dirRecord:s.CENTRAL_FILE_HEADER+a(ot,2)+Tt+a(E.length,2)+"\0\0\0\0"+a(X,4)+a(u,4)+M+C+E}};function o(c,d,h,u){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=d,this.zipPlatform=h,this.encodeFileName=u,this.streamFiles=c,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}e.inherits(o,i),o.prototype.push=function(c){var d=c.meta.percent||0,h=this.entriesCount,u=this._sources.length;this.accumulate?this.contentBuffer.push(c):(this.bytesWritten+=c.data.length,i.prototype.push.call(this,{data:c.data,meta:{currentFile:this.currentFile,percent:h?(d+100*(h-u-1))/h:100}}))},o.prototype.openedSource=function(c){this.currentSourceOffset=this.bytesWritten,this.currentFile=c.file.name;var d=this.streamFiles&&!c.file.dir;if(d){var h=f(c,d,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:h.fileRecord,meta:{percent:0}})}else this.accumulate=!0},o.prototype.closedSource=function(c){this.accumulate=!1;var d=this.streamFiles&&!c.file.dir,h=f(c,d,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(h.dirRecord),d)this.push({data:function(u){return s.DATA_DESCRIPTOR+a(u.crc32,4)+a(u.compressedSize,4)+a(u.uncompressedSize,4)}(c),meta:{percent:100}});else for(this.push({data:h.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},o.prototype.flush=function(){for(var c=this.bytesWritten,d=0;d<this.dirRecords.length;d++)this.push({data:this.dirRecords[d],meta:{percent:100}});var h=this.bytesWritten-c,u=function(m,g,_,y,v){var b=e.transformTo("string",v(y));return s.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(m,2)+a(m,2)+a(g,4)+a(_,4)+a(b.length,2)+b}(this.dirRecords.length,h,c,this.zipComment,this.encodeFileName);this.push({data:u,meta:{percent:100}})},o.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},o.prototype.registerPrevious=function(c){this._sources.push(c);var d=this;return c.on("data",function(h){d.processChunk(h)}),c.on("end",function(){d.closedSource(d.previous.streamInfo),d._sources.length?d.prepareNextSource():d.end()}),c.on("error",function(h){d.error(h)}),this},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},o.prototype.error=function(c){var d=this._sources;if(!i.prototype.error.call(this,c))return!1;for(var h=0;h<d.length;h++)try{d[h].error(c)}catch(u){}return!0},o.prototype.lock=function(){i.prototype.lock.call(this);for(var c=this._sources,d=0;d<c.length;d++)c[d].lock()},p.exports=o},function(p,l,n){"use strict";p.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(p,l,n){"use strict";var e=n(2),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],t=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];p.exports=function(a,f,o,c,d,h,u,m){var g,_,y,v,b,R,M,P,T,E=m.bits,x=0,S=0,L=0,C=0,F=0,q=0,it=0,st=0,pt=0,_t=0,X=null,ot=0,Tt=new e.Buf16(16),Vt=new e.Buf16(16),Gt=null,qt=0;for(x=0;x<=15;x++)Tt[x]=0;for(S=0;S<c;S++)Tt[f[o+S]]++;for(F=E,C=15;C>=1&&Tt[C]===0;C--);if(F>C&&(F=C),C===0)return d[h++]=20971520,d[h++]=20971520,m.bits=1,0;for(L=1;L<C&&Tt[L]===0;L++);for(F<L&&(F=L),st=1,x=1;x<=15;x++)if(st<<=1,(st-=Tt[x])<0)return-1;if(st>0&&(a===0||C!==1))return-1;for(Vt[1]=0,x=1;x<15;x++)Vt[x+1]=Vt[x]+Tt[x];for(S=0;S<c;S++)f[o+S]!==0&&(u[Vt[f[o+S]]++]=S);if(a===0?(X=Gt=u,R=19):a===1?(X=i,ot-=257,Gt=t,qt-=257,R=256):(X=r,Gt=s,R=-1),_t=0,S=0,x=L,b=h,q=F,it=0,y=-1,v=(pt=1<<F)-1,a===1&&pt>852||a===2&&pt>592)return 1;for(;;){M=x-it,u[S]<R?(P=0,T=u[S]):u[S]>R?(P=Gt[qt+u[S]],T=X[ot+u[S]]):(P=96,T=0),g=1<<x-it,L=_=1<<q;do d[b+(_t>>it)+(_-=g)]=M<<24|P<<16|T|0;while(_!==0);for(g=1<<x-1;_t&g;)g>>=1;if(g!==0?(_t&=g-1,_t+=g):_t=0,S++,--Tt[x]==0){if(x===C)break;x=f[o+u[S]]}if(x>F&&(_t&v)!==y){for(it===0&&(it=F),b+=L,st=1<<(q=x-it);q+it<C&&!((st-=Tt[q+it])<=0);)q++,st<<=1;if(pt+=1<<q,a===1&&pt>852||a===2&&pt>592)return 1;d[y=_t&v]=F<<24|q<<16|b-h|0}}return _t!==0&&(d[b+_t]=x-it<<24|64<<16|0),m.bits=F,0}},function(p,l,n){"use strict";p.exports=function(e,i){var t,r,s,a,f,o,c,d,h,u,m,g,_,y,v,b,R,M,P,T,E,x,S,L,C;t=e.state,r=e.next_in,L=e.input,s=r+(e.avail_in-5),a=e.next_out,C=e.output,f=a-(i-e.avail_out),o=a+(e.avail_out-257),c=t.dmax,d=t.wsize,h=t.whave,u=t.wnext,m=t.window,g=t.hold,_=t.bits,y=t.lencode,v=t.distcode,b=(1<<t.lenbits)-1,R=(1<<t.distbits)-1;t:do{_<15&&(g+=L[r++]<<_,_+=8,g+=L[r++]<<_,_+=8),M=y[g&b];e:for(;;){if(g>>>=P=M>>>24,_-=P,(P=M>>>16&255)===0)C[a++]=65535&M;else{if(!(16&P)){if(!(64&P)){M=y[(65535&M)+(g&(1<<P)-1)];continue e}if(32&P){t.mode=12;break t}e.msg="invalid literal/length code",t.mode=30;break t}T=65535&M,(P&=15)&&(_<P&&(g+=L[r++]<<_,_+=8),T+=g&(1<<P)-1,g>>>=P,_-=P),_<15&&(g+=L[r++]<<_,_+=8,g+=L[r++]<<_,_+=8),M=v[g&R];i:for(;;){if(g>>>=P=M>>>24,_-=P,!(16&(P=M>>>16&255))){if(!(64&P)){M=v[(65535&M)+(g&(1<<P)-1)];continue i}e.msg="invalid distance code",t.mode=30;break t}if(E=65535&M,_<(P&=15)&&(g+=L[r++]<<_,(_+=8)<P&&(g+=L[r++]<<_,_+=8)),(E+=g&(1<<P)-1)>c){e.msg="invalid distance too far back",t.mode=30;break t}if(g>>>=P,_-=P,E>(P=a-f)){if((P=E-P)>h&&t.sane){e.msg="invalid distance too far back",t.mode=30;break t}if(x=0,S=m,u===0){if(x+=d-P,P<T){T-=P;do C[a++]=m[x++];while(--P);x=a-E,S=C}}else if(u<P){if(x+=d+u-P,(P-=u)<T){T-=P;do C[a++]=m[x++];while(--P);if(x=0,u<T){T-=P=u;do C[a++]=m[x++];while(--P);x=a-E,S=C}}}else if(x+=u-P,P<T){T-=P;do C[a++]=m[x++];while(--P);x=a-E,S=C}for(;T>2;)C[a++]=S[x++],C[a++]=S[x++],C[a++]=S[x++],T-=3;T&&(C[a++]=S[x++],T>1&&(C[a++]=S[x++]))}else{x=a-E;do C[a++]=C[x++],C[a++]=C[x++],C[a++]=C[x++],T-=3;while(T>2);T&&(C[a++]=C[x++],T>1&&(C[a++]=C[x++]))}break}}break}}while(r<s&&a<o);r-=T=_>>3,g&=(1<<(_-=T<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<s?s-r+5:5-(r-s),e.avail_out=a<o?o-a+257:257-(a-o),t.hold=g,t.bits=_}},function(p,l,n){"use strict";var e=n(2),i=n(33),t=n(32),r=n(61),s=n(60),a=0,f=1,o=2,c=4,d=5,h=6,u=0,m=1,g=2,_=-2,y=-3,v=-4,b=-5,R=8,M=1,P=2,T=3,E=4,x=5,S=6,L=7,C=8,F=9,q=10,it=11,st=12,pt=13,_t=14,X=15,ot=16,Tt=17,Vt=18,Gt=19,qt=20,Qt=21,ne=22,j=23,J=24,at=25,xt=26,Rt=27,Lt=28,te=29,zt=30,ee=31,$=32,N=852,K=592,k=15;function Y(W){return(W>>>24&255)+(W>>>8&65280)+((65280&W)<<8)+((255&W)<<24)}function ht(W){var ct;return W&&W.state?(ct=W.state,W.total_in=W.total_out=ct.total=0,W.msg="",ct.wrap&&(W.adler=1&ct.wrap),ct.mode=M,ct.last=0,ct.havedict=0,ct.dmax=32768,ct.head=null,ct.hold=0,ct.bits=0,ct.lencode=ct.lendyn=new e.Buf32(N),ct.distcode=ct.distdyn=new e.Buf32(K),ct.sane=1,ct.back=-1,u):_}function wt(W){var ct;return W&&W.state?((ct=W.state).wsize=0,ct.whave=0,ct.wnext=0,ht(W)):_}function Et(W,ct){var z,nt;return W&&W.state?(nt=W.state,ct<0?(z=0,ct=-ct):(z=1+(ct>>4),ct<48&&(ct&=15)),ct&&(ct<8||ct>15)?_:(nt.window!==null&&nt.wbits!==ct&&(nt.window=null),nt.wrap=z,nt.wbits=ct,wt(W))):_}function Mt(W,ct){var z,nt;return W?(nt=new function(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0},W.state=nt,nt.window=null,(z=Et(W,ct))!==u&&(W.state=null),z):_}var Dt,At,Xt=!0;function ie(W){if(Xt){var ct;for(Dt=new e.Buf32(512),At=new e.Buf32(32),ct=0;ct<144;)W.lens[ct++]=8;for(;ct<256;)W.lens[ct++]=9;for(;ct<280;)W.lens[ct++]=7;for(;ct<288;)W.lens[ct++]=8;for(s(f,W.lens,0,288,Dt,0,W.work,{bits:9}),ct=0;ct<32;)W.lens[ct++]=5;s(o,W.lens,0,32,At,0,W.work,{bits:5}),Xt=!1}W.lencode=Dt,W.lenbits=9,W.distcode=At,W.distbits=5}function le(W,ct,z,nt){var Ht,Kt=W.state;return Kt.window===null&&(Kt.wsize=1<<Kt.wbits,Kt.wnext=0,Kt.whave=0,Kt.window=new e.Buf8(Kt.wsize)),nt>=Kt.wsize?(e.arraySet(Kt.window,ct,z-Kt.wsize,Kt.wsize,0),Kt.wnext=0,Kt.whave=Kt.wsize):((Ht=Kt.wsize-Kt.wnext)>nt&&(Ht=nt),e.arraySet(Kt.window,ct,z-nt,Ht,Kt.wnext),(nt-=Ht)?(e.arraySet(Kt.window,ct,z-nt,nt,0),Kt.wnext=nt,Kt.whave=Kt.wsize):(Kt.wnext+=Ht,Kt.wnext===Kt.wsize&&(Kt.wnext=0),Kt.whave<Kt.wsize&&(Kt.whave+=Ht))),0}l.inflateReset=wt,l.inflateReset2=Et,l.inflateResetKeep=ht,l.inflateInit=function(W){return Mt(W,k)},l.inflateInit2=Mt,l.inflate=function(W,ct){var z,nt,Ht,Kt,fe,Ft,he,Bt,$t,Ue,Ee,pe,Ie,Qe,Oe,$e,Fe,ii,ni,_i,Ge,Je,ze,ri,je=0,He=new e.Buf8(4),li=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!W||!W.state||!W.output||!W.input&&W.avail_in!==0)return _;(z=W.state).mode===st&&(z.mode=pt),fe=W.next_out,Ht=W.output,he=W.avail_out,Kt=W.next_in,nt=W.input,Ft=W.avail_in,Bt=z.hold,$t=z.bits,Ue=Ft,Ee=he,Je=u;t:for(;;)switch(z.mode){case M:if(z.wrap===0){z.mode=pt;break}for(;$t<16;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if(2&z.wrap&&Bt===35615){z.check=0,He[0]=255&Bt,He[1]=Bt>>>8&255,z.check=t(z.check,He,2,0),Bt=0,$t=0,z.mode=P;break}if(z.flags=0,z.head&&(z.head.done=!1),!(1&z.wrap)||(((255&Bt)<<8)+(Bt>>8))%31){W.msg="incorrect header check",z.mode=zt;break}if((15&Bt)!==R){W.msg="unknown compression method",z.mode=zt;break}if($t-=4,Ge=8+(15&(Bt>>>=4)),z.wbits===0)z.wbits=Ge;else if(Ge>z.wbits){W.msg="invalid window size",z.mode=zt;break}z.dmax=1<<Ge,W.adler=z.check=1,z.mode=512&Bt?q:st,Bt=0,$t=0;break;case P:for(;$t<16;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if(z.flags=Bt,(255&z.flags)!==R){W.msg="unknown compression method",z.mode=zt;break}if(57344&z.flags){W.msg="unknown header flags set",z.mode=zt;break}z.head&&(z.head.text=Bt>>8&1),512&z.flags&&(He[0]=255&Bt,He[1]=Bt>>>8&255,z.check=t(z.check,He,2,0)),Bt=0,$t=0,z.mode=T;case T:for(;$t<32;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}z.head&&(z.head.time=Bt),512&z.flags&&(He[0]=255&Bt,He[1]=Bt>>>8&255,He[2]=Bt>>>16&255,He[3]=Bt>>>24&255,z.check=t(z.check,He,4,0)),Bt=0,$t=0,z.mode=E;case E:for(;$t<16;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}z.head&&(z.head.xflags=255&Bt,z.head.os=Bt>>8),512&z.flags&&(He[0]=255&Bt,He[1]=Bt>>>8&255,z.check=t(z.check,He,2,0)),Bt=0,$t=0,z.mode=x;case x:if(1024&z.flags){for(;$t<16;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}z.length=Bt,z.head&&(z.head.extra_len=Bt),512&z.flags&&(He[0]=255&Bt,He[1]=Bt>>>8&255,z.check=t(z.check,He,2,0)),Bt=0,$t=0}else z.head&&(z.head.extra=null);z.mode=S;case S:if(1024&z.flags&&((pe=z.length)>Ft&&(pe=Ft),pe&&(z.head&&(Ge=z.head.extra_len-z.length,z.head.extra||(z.head.extra=new Array(z.head.extra_len)),e.arraySet(z.head.extra,nt,Kt,pe,Ge)),512&z.flags&&(z.check=t(z.check,nt,pe,Kt)),Ft-=pe,Kt+=pe,z.length-=pe),z.length))break t;z.length=0,z.mode=L;case L:if(2048&z.flags){if(Ft===0)break t;pe=0;do Ge=nt[Kt+pe++],z.head&&Ge&&z.length<65536&&(z.head.name+=String.fromCharCode(Ge));while(Ge&&pe<Ft);if(512&z.flags&&(z.check=t(z.check,nt,pe,Kt)),Ft-=pe,Kt+=pe,Ge)break t}else z.head&&(z.head.name=null);z.length=0,z.mode=C;case C:if(4096&z.flags){if(Ft===0)break t;pe=0;do Ge=nt[Kt+pe++],z.head&&Ge&&z.length<65536&&(z.head.comment+=String.fromCharCode(Ge));while(Ge&&pe<Ft);if(512&z.flags&&(z.check=t(z.check,nt,pe,Kt)),Ft-=pe,Kt+=pe,Ge)break t}else z.head&&(z.head.comment=null);z.mode=F;case F:if(512&z.flags){for(;$t<16;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if(Bt!==(65535&z.check)){W.msg="header crc mismatch",z.mode=zt;break}Bt=0,$t=0}z.head&&(z.head.hcrc=z.flags>>9&1,z.head.done=!0),W.adler=z.check=0,z.mode=st;break;case q:for(;$t<32;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}W.adler=z.check=Y(Bt),Bt=0,$t=0,z.mode=it;case it:if(z.havedict===0)return W.next_out=fe,W.avail_out=he,W.next_in=Kt,W.avail_in=Ft,z.hold=Bt,z.bits=$t,g;W.adler=z.check=1,z.mode=st;case st:if(ct===d||ct===h)break t;case pt:if(z.last){Bt>>>=7&$t,$t-=7&$t,z.mode=Rt;break}for(;$t<3;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}switch(z.last=1&Bt,$t-=1,3&(Bt>>>=1)){case 0:z.mode=_t;break;case 1:if(ie(z),z.mode=qt,ct===h){Bt>>>=2,$t-=2;break t}break;case 2:z.mode=Tt;break;case 3:W.msg="invalid block type",z.mode=zt}Bt>>>=2,$t-=2;break;case _t:for(Bt>>>=7&$t,$t-=7&$t;$t<32;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if((65535&Bt)!=(Bt>>>16^65535)){W.msg="invalid stored block lengths",z.mode=zt;break}if(z.length=65535&Bt,Bt=0,$t=0,z.mode=X,ct===h)break t;case X:z.mode=ot;case ot:if(pe=z.length){if(pe>Ft&&(pe=Ft),pe>he&&(pe=he),pe===0)break t;e.arraySet(Ht,nt,Kt,pe,fe),Ft-=pe,Kt+=pe,he-=pe,fe+=pe,z.length-=pe;break}z.mode=st;break;case Tt:for(;$t<14;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if(z.nlen=257+(31&Bt),Bt>>>=5,$t-=5,z.ndist=1+(31&Bt),Bt>>>=5,$t-=5,z.ncode=4+(15&Bt),Bt>>>=4,$t-=4,z.nlen>286||z.ndist>30){W.msg="too many length or distance symbols",z.mode=zt;break}z.have=0,z.mode=Vt;case Vt:for(;z.have<z.ncode;){for(;$t<3;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}z.lens[li[z.have++]]=7&Bt,Bt>>>=3,$t-=3}for(;z.have<19;)z.lens[li[z.have++]]=0;if(z.lencode=z.lendyn,z.lenbits=7,ze={bits:z.lenbits},Je=s(a,z.lens,0,19,z.lencode,0,z.work,ze),z.lenbits=ze.bits,Je){W.msg="invalid code lengths set",z.mode=zt;break}z.have=0,z.mode=Gt;case Gt:for(;z.have<z.nlen+z.ndist;){for(;$e=(je=z.lencode[Bt&(1<<z.lenbits)-1])>>>16&255,Fe=65535&je,!((Oe=je>>>24)<=$t);){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if(Fe<16)Bt>>>=Oe,$t-=Oe,z.lens[z.have++]=Fe;else{if(Fe===16){for(ri=Oe+2;$t<ri;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if(Bt>>>=Oe,$t-=Oe,z.have===0){W.msg="invalid bit length repeat",z.mode=zt;break}Ge=z.lens[z.have-1],pe=3+(3&Bt),Bt>>>=2,$t-=2}else if(Fe===17){for(ri=Oe+3;$t<ri;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}$t-=Oe,Ge=0,pe=3+(7&(Bt>>>=Oe)),Bt>>>=3,$t-=3}else{for(ri=Oe+7;$t<ri;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}$t-=Oe,Ge=0,pe=11+(127&(Bt>>>=Oe)),Bt>>>=7,$t-=7}if(z.have+pe>z.nlen+z.ndist){W.msg="invalid bit length repeat",z.mode=zt;break}for(;pe--;)z.lens[z.have++]=Ge}}if(z.mode===zt)break;if(z.lens[256]===0){W.msg="invalid code -- missing end-of-block",z.mode=zt;break}if(z.lenbits=9,ze={bits:z.lenbits},Je=s(f,z.lens,0,z.nlen,z.lencode,0,z.work,ze),z.lenbits=ze.bits,Je){W.msg="invalid literal/lengths set",z.mode=zt;break}if(z.distbits=6,z.distcode=z.distdyn,ze={bits:z.distbits},Je=s(o,z.lens,z.nlen,z.ndist,z.distcode,0,z.work,ze),z.distbits=ze.bits,Je){W.msg="invalid distances set",z.mode=zt;break}if(z.mode=qt,ct===h)break t;case qt:z.mode=Qt;case Qt:if(Ft>=6&&he>=258){W.next_out=fe,W.avail_out=he,W.next_in=Kt,W.avail_in=Ft,z.hold=Bt,z.bits=$t,r(W,Ee),fe=W.next_out,Ht=W.output,he=W.avail_out,Kt=W.next_in,nt=W.input,Ft=W.avail_in,Bt=z.hold,$t=z.bits,z.mode===st&&(z.back=-1);break}for(z.back=0;$e=(je=z.lencode[Bt&(1<<z.lenbits)-1])>>>16&255,Fe=65535&je,!((Oe=je>>>24)<=$t);){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if($e&&!(240&$e)){for(ii=Oe,ni=$e,_i=Fe;$e=(je=z.lencode[_i+((Bt&(1<<ii+ni)-1)>>ii)])>>>16&255,Fe=65535&je,!(ii+(Oe=je>>>24)<=$t);){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}Bt>>>=ii,$t-=ii,z.back+=ii}if(Bt>>>=Oe,$t-=Oe,z.back+=Oe,z.length=Fe,$e===0){z.mode=xt;break}if(32&$e){z.back=-1,z.mode=st;break}if(64&$e){W.msg="invalid literal/length code",z.mode=zt;break}z.extra=15&$e,z.mode=ne;case ne:if(z.extra){for(ri=z.extra;$t<ri;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}z.length+=Bt&(1<<z.extra)-1,Bt>>>=z.extra,$t-=z.extra,z.back+=z.extra}z.was=z.length,z.mode=j;case j:for(;$e=(je=z.distcode[Bt&(1<<z.distbits)-1])>>>16&255,Fe=65535&je,!((Oe=je>>>24)<=$t);){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if(!(240&$e)){for(ii=Oe,ni=$e,_i=Fe;$e=(je=z.distcode[_i+((Bt&(1<<ii+ni)-1)>>ii)])>>>16&255,Fe=65535&je,!(ii+(Oe=je>>>24)<=$t);){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}Bt>>>=ii,$t-=ii,z.back+=ii}if(Bt>>>=Oe,$t-=Oe,z.back+=Oe,64&$e){W.msg="invalid distance code",z.mode=zt;break}z.offset=Fe,z.extra=15&$e,z.mode=J;case J:if(z.extra){for(ri=z.extra;$t<ri;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}z.offset+=Bt&(1<<z.extra)-1,Bt>>>=z.extra,$t-=z.extra,z.back+=z.extra}if(z.offset>z.dmax){W.msg="invalid distance too far back",z.mode=zt;break}z.mode=at;case at:if(he===0)break t;if(pe=Ee-he,z.offset>pe){if((pe=z.offset-pe)>z.whave&&z.sane){W.msg="invalid distance too far back",z.mode=zt;break}pe>z.wnext?(pe-=z.wnext,Ie=z.wsize-pe):Ie=z.wnext-pe,pe>z.length&&(pe=z.length),Qe=z.window}else Qe=Ht,Ie=fe-z.offset,pe=z.length;pe>he&&(pe=he),he-=pe,z.length-=pe;do Ht[fe++]=Qe[Ie++];while(--pe);z.length===0&&(z.mode=Qt);break;case xt:if(he===0)break t;Ht[fe++]=z.length,he--,z.mode=Qt;break;case Rt:if(z.wrap){for(;$t<32;){if(Ft===0)break t;Ft--,Bt|=nt[Kt++]<<$t,$t+=8}if(Ee-=he,W.total_out+=Ee,z.total+=Ee,Ee&&(W.adler=z.check=z.flags?t(z.check,Ht,Ee,fe-Ee):i(z.check,Ht,Ee,fe-Ee)),Ee=he,(z.flags?Bt:Y(Bt))!==z.check){W.msg="incorrect data check",z.mode=zt;break}Bt=0,$t=0}z.mode=Lt;case Lt:if(z.wrap&&z.flags){for(;$t<32;){if(Ft===0)break t;Ft--,Bt+=nt[Kt++]<<$t,$t+=8}if(Bt!==(4294967295&z.total)){W.msg="incorrect length check",z.mode=zt;break}Bt=0,$t=0}z.mode=te;case te:Je=m;break t;case zt:Je=y;break t;case ee:return v;case $:default:return _}return W.next_out=fe,W.avail_out=he,W.next_in=Kt,W.avail_in=Ft,z.hold=Bt,z.bits=$t,(z.wsize||Ee!==W.avail_out&&z.mode<zt&&(z.mode<Rt||ct!==c))&&le(W,W.output,W.next_out,Ee-W.avail_out)?(z.mode=ee,v):(Ue-=W.avail_in,Ee-=W.avail_out,W.total_in+=Ue,W.total_out+=Ee,z.total+=Ee,z.wrap&&Ee&&(W.adler=z.check=z.flags?t(z.check,Ht,Ee,W.next_out-Ee):i(z.check,Ht,Ee,W.next_out-Ee)),W.data_type=z.bits+(z.last?64:0)+(z.mode===st?128:0)+(z.mode===qt||z.mode===X?256:0),(Ue===0&&Ee===0||ct===c)&&Je===u&&(Je=b),Je)},l.inflateEnd=function(W){if(!W||!W.state)return _;var ct=W.state;return ct.window&&(ct.window=null),W.state=null,u},l.inflateGetHeader=function(W,ct){var z;return W&&W.state&&2&(z=W.state).wrap?(z.head=ct,ct.done=!1,u):_},l.inflateSetDictionary=function(W,ct){var z,nt=ct.length;return W&&W.state?(z=W.state).wrap!==0&&z.mode!==it?_:z.mode===it&&i(1,ct,nt,0)!==z.check?y:le(W,ct,nt,nt)?(z.mode=ee,v):(z.havedict=1,u):_},l.inflateInfo="pako inflate (from Nodeca project)"},function(p,l,n){"use strict";var e=n(62),i=n(2),t=n(31),r=n(29),s=n(16),a=n(30),f=n(59),o=Object.prototype.toString;function c(h){if(!(this instanceof c))return new c(h);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},h||{});var u=this.options;u.raw&&u.windowBits>=0&&u.windowBits<16&&(u.windowBits=-u.windowBits,u.windowBits===0&&(u.windowBits=-15)),!(u.windowBits>=0&&u.windowBits<16)||h&&h.windowBits||(u.windowBits+=32),u.windowBits>15&&u.windowBits<48&&!(15&u.windowBits)&&(u.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var m=e.inflateInit2(this.strm,u.windowBits);if(m!==r.Z_OK)throw new Error(s[m]);this.header=new f,e.inflateGetHeader(this.strm,this.header)}function d(h,u){var m=new c(u);if(m.push(h,!0),m.err)throw m.msg||s[m.err];return m.result}c.prototype.push=function(h,u){var m,g,_,y,v,b,R=this.strm,M=this.options.chunkSize,P=this.options.dictionary,T=!1;if(this.ended)return!1;g=u===~~u?u:u===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof h=="string"?R.input=t.binstring2buf(h):o.call(h)==="[object ArrayBuffer]"?R.input=new Uint8Array(h):R.input=h,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new i.Buf8(M),R.next_out=0,R.avail_out=M),(m=e.inflate(R,r.Z_NO_FLUSH))===r.Z_NEED_DICT&&P&&(b=typeof P=="string"?t.string2buf(P):o.call(P)==="[object ArrayBuffer]"?new Uint8Array(P):P,m=e.inflateSetDictionary(this.strm,b)),m===r.Z_BUF_ERROR&&T===!0&&(m=r.Z_OK,T=!1),m!==r.Z_STREAM_END&&m!==r.Z_OK)return this.onEnd(m),this.ended=!0,!1;R.next_out&&(R.avail_out!==0&&m!==r.Z_STREAM_END&&(R.avail_in!==0||g!==r.Z_FINISH&&g!==r.Z_SYNC_FLUSH)||(this.options.to==="string"?(_=t.utf8border(R.output,R.next_out),y=R.next_out-_,v=t.buf2string(R.output,_),R.next_out=y,R.avail_out=M-y,y&&i.arraySet(R.output,R.output,_,y,0),this.onData(v)):this.onData(i.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(T=!0)}while((R.avail_in>0||R.avail_out===0)&&m!==r.Z_STREAM_END);return m===r.Z_STREAM_END&&(g=r.Z_FINISH),g===r.Z_FINISH?(m=e.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===r.Z_OK):g!==r.Z_SYNC_FLUSH||(this.onEnd(r.Z_OK),R.avail_out=0,!0)},c.prototype.onData=function(h){this.chunks.push(h)},c.prototype.onEnd=function(h){h===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=h,this.msg=this.strm.msg},l.Inflate=c,l.inflate=d,l.inflateRaw=function(h,u){return(u=u||{}).raw=!0,d(h,u)},l.ungzip=d},function(p,l,n){"use strict";var e=n(2),i=4,t=0,r=1,s=2;function a(k){for(var Y=k.length;--Y>=0;)k[Y]=0}var f=0,o=1,c=2,d=29,h=256,u=h+1+d,m=30,g=19,_=2*u+1,y=15,v=16,b=7,R=256,M=16,P=17,T=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=new Array(2*(u+2));a(C);var F=new Array(2*m);a(F);var q=new Array(512);a(q);var it=new Array(256);a(it);var st=new Array(d);a(st);var pt,_t,X,ot=new Array(m);function Tt(k,Y,ht,wt,Et){this.static_tree=k,this.extra_bits=Y,this.extra_base=ht,this.elems=wt,this.max_length=Et,this.has_stree=k&&k.length}function Vt(k,Y){this.dyn_tree=k,this.max_code=0,this.stat_desc=Y}function Gt(k){return k<256?q[k]:q[256+(k>>>7)]}function qt(k,Y){k.pending_buf[k.pending++]=255&Y,k.pending_buf[k.pending++]=Y>>>8&255}function Qt(k,Y,ht){k.bi_valid>v-ht?(k.bi_buf|=Y<<k.bi_valid&65535,qt(k,k.bi_buf),k.bi_buf=Y>>v-k.bi_valid,k.bi_valid+=ht-v):(k.bi_buf|=Y<<k.bi_valid&65535,k.bi_valid+=ht)}function ne(k,Y,ht){Qt(k,ht[2*Y],ht[2*Y+1])}function j(k,Y){var ht=0;do ht|=1&k,k>>>=1,ht<<=1;while(--Y>0);return ht>>>1}function J(k,Y,ht){var wt,Et,Mt=new Array(y+1),Dt=0;for(wt=1;wt<=y;wt++)Mt[wt]=Dt=Dt+ht[wt-1]<<1;for(Et=0;Et<=Y;Et++){var At=k[2*Et+1];At!==0&&(k[2*Et]=j(Mt[At]++,At))}}function at(k){var Y;for(Y=0;Y<u;Y++)k.dyn_ltree[2*Y]=0;for(Y=0;Y<m;Y++)k.dyn_dtree[2*Y]=0;for(Y=0;Y<g;Y++)k.bl_tree[2*Y]=0;k.dyn_ltree[2*R]=1,k.opt_len=k.static_len=0,k.last_lit=k.matches=0}function xt(k){k.bi_valid>8?qt(k,k.bi_buf):k.bi_valid>0&&(k.pending_buf[k.pending++]=k.bi_buf),k.bi_buf=0,k.bi_valid=0}function Rt(k,Y,ht,wt){var Et=2*Y,Mt=2*ht;return k[Et]<k[Mt]||k[Et]===k[Mt]&&wt[Y]<=wt[ht]}function Lt(k,Y,ht){for(var wt=k.heap[ht],Et=ht<<1;Et<=k.heap_len&&(Et<k.heap_len&&Rt(Y,k.heap[Et+1],k.heap[Et],k.depth)&&Et++,!Rt(Y,wt,k.heap[Et],k.depth));)k.heap[ht]=k.heap[Et],ht=Et,Et<<=1;k.heap[ht]=wt}function te(k,Y,ht){var wt,Et,Mt,Dt,At=0;if(k.last_lit!==0)do wt=k.pending_buf[k.d_buf+2*At]<<8|k.pending_buf[k.d_buf+2*At+1],Et=k.pending_buf[k.l_buf+At],At++,wt===0?ne(k,Et,Y):(ne(k,(Mt=it[Et])+h+1,Y),(Dt=E[Mt])!==0&&Qt(k,Et-=st[Mt],Dt),ne(k,Mt=Gt(--wt),ht),(Dt=x[Mt])!==0&&Qt(k,wt-=ot[Mt],Dt));while(At<k.last_lit);ne(k,R,Y)}function zt(k,Y){var ht,wt,Et,Mt=Y.dyn_tree,Dt=Y.stat_desc.static_tree,At=Y.stat_desc.has_stree,Xt=Y.stat_desc.elems,ie=-1;for(k.heap_len=0,k.heap_max=_,ht=0;ht<Xt;ht++)Mt[2*ht]!==0?(k.heap[++k.heap_len]=ie=ht,k.depth[ht]=0):Mt[2*ht+1]=0;for(;k.heap_len<2;)Mt[2*(Et=k.heap[++k.heap_len]=ie<2?++ie:0)]=1,k.depth[Et]=0,k.opt_len--,At&&(k.static_len-=Dt[2*Et+1]);for(Y.max_code=ie,ht=k.heap_len>>1;ht>=1;ht--)Lt(k,Mt,ht);Et=Xt;do ht=k.heap[1],k.heap[1]=k.heap[k.heap_len--],Lt(k,Mt,1),wt=k.heap[1],k.heap[--k.heap_max]=ht,k.heap[--k.heap_max]=wt,Mt[2*Et]=Mt[2*ht]+Mt[2*wt],k.depth[Et]=(k.depth[ht]>=k.depth[wt]?k.depth[ht]:k.depth[wt])+1,Mt[2*ht+1]=Mt[2*wt+1]=Et,k.heap[1]=Et++,Lt(k,Mt,1);while(k.heap_len>=2);k.heap[--k.heap_max]=k.heap[1],function(le,W){var ct,z,nt,Ht,Kt,fe,Ft=W.dyn_tree,he=W.max_code,Bt=W.stat_desc.static_tree,$t=W.stat_desc.has_stree,Ue=W.stat_desc.extra_bits,Ee=W.stat_desc.extra_base,pe=W.stat_desc.max_length,Ie=0;for(Ht=0;Ht<=y;Ht++)le.bl_count[Ht]=0;for(Ft[2*le.heap[le.heap_max]+1]=0,ct=le.heap_max+1;ct<_;ct++)(Ht=Ft[2*Ft[2*(z=le.heap[ct])+1]+1]+1)>pe&&(Ht=pe,Ie++),Ft[2*z+1]=Ht,z>he||(le.bl_count[Ht]++,Kt=0,z>=Ee&&(Kt=Ue[z-Ee]),fe=Ft[2*z],le.opt_len+=fe*(Ht+Kt),$t&&(le.static_len+=fe*(Bt[2*z+1]+Kt)));if(Ie!==0){do{for(Ht=pe-1;le.bl_count[Ht]===0;)Ht--;le.bl_count[Ht]--,le.bl_count[Ht+1]+=2,le.bl_count[pe]--,Ie-=2}while(Ie>0);for(Ht=pe;Ht!==0;Ht--)for(z=le.bl_count[Ht];z!==0;)(nt=le.heap[--ct])>he||(Ft[2*nt+1]!==Ht&&(le.opt_len+=(Ht-Ft[2*nt+1])*Ft[2*nt],Ft[2*nt+1]=Ht),z--)}}(k,Y),J(Mt,ie,k.bl_count)}function ee(k,Y,ht){var wt,Et,Mt=-1,Dt=Y[1],At=0,Xt=7,ie=4;for(Dt===0&&(Xt=138,ie=3),Y[2*(ht+1)+1]=65535,wt=0;wt<=ht;wt++)Et=Dt,Dt=Y[2*(wt+1)+1],++At<Xt&&Et===Dt||(At<ie?k.bl_tree[2*Et]+=At:Et!==0?(Et!==Mt&&k.bl_tree[2*Et]++,k.bl_tree[2*M]++):At<=10?k.bl_tree[2*P]++:k.bl_tree[2*T]++,At=0,Mt=Et,Dt===0?(Xt=138,ie=3):Et===Dt?(Xt=6,ie=3):(Xt=7,ie=4))}function $(k,Y,ht){var wt,Et,Mt=-1,Dt=Y[1],At=0,Xt=7,ie=4;for(Dt===0&&(Xt=138,ie=3),wt=0;wt<=ht;wt++)if(Et=Dt,Dt=Y[2*(wt+1)+1],!(++At<Xt&&Et===Dt)){if(At<ie)do ne(k,Et,k.bl_tree);while(--At!=0);else Et!==0?(Et!==Mt&&(ne(k,Et,k.bl_tree),At--),ne(k,M,k.bl_tree),Qt(k,At-3,2)):At<=10?(ne(k,P,k.bl_tree),Qt(k,At-3,3)):(ne(k,T,k.bl_tree),Qt(k,At-11,7));At=0,Mt=Et,Dt===0?(Xt=138,ie=3):Et===Dt?(Xt=6,ie=3):(Xt=7,ie=4)}}a(ot);var N=!1;function K(k,Y,ht,wt){Qt(k,(f<<1)+(wt?1:0),3),function(Et,Mt,Dt,At){xt(Et),At&&(qt(Et,Dt),qt(Et,~Dt)),e.arraySet(Et.pending_buf,Et.window,Mt,Dt,Et.pending),Et.pending+=Dt}(k,Y,ht,!0)}l._tr_init=function(k){N||(function(){var Y,ht,wt,Et,Mt,Dt=new Array(y+1);for(wt=0,Et=0;Et<d-1;Et++)for(st[Et]=wt,Y=0;Y<1<<E[Et];Y++)it[wt++]=Et;for(it[wt-1]=Et,Mt=0,Et=0;Et<16;Et++)for(ot[Et]=Mt,Y=0;Y<1<<x[Et];Y++)q[Mt++]=Et;for(Mt>>=7;Et<m;Et++)for(ot[Et]=Mt<<7,Y=0;Y<1<<x[Et]-7;Y++)q[256+Mt++]=Et;for(ht=0;ht<=y;ht++)Dt[ht]=0;for(Y=0;Y<=143;)C[2*Y+1]=8,Y++,Dt[8]++;for(;Y<=255;)C[2*Y+1]=9,Y++,Dt[9]++;for(;Y<=279;)C[2*Y+1]=7,Y++,Dt[7]++;for(;Y<=287;)C[2*Y+1]=8,Y++,Dt[8]++;for(J(C,u+1,Dt),Y=0;Y<m;Y++)F[2*Y+1]=5,F[2*Y]=j(Y,5);pt=new Tt(C,E,h+1,u,y),_t=new Tt(F,x,0,m,y),X=new Tt(new Array(0),S,0,g,b)}(),N=!0),k.l_desc=new Vt(k.dyn_ltree,pt),k.d_desc=new Vt(k.dyn_dtree,_t),k.bl_desc=new Vt(k.bl_tree,X),k.bi_buf=0,k.bi_valid=0,at(k)},l._tr_stored_block=K,l._tr_flush_block=function(k,Y,ht,wt){var Et,Mt,Dt=0;k.level>0?(k.strm.data_type===s&&(k.strm.data_type=function(At){var Xt,ie=4093624447;for(Xt=0;Xt<=31;Xt++,ie>>>=1)if(1&ie&&At.dyn_ltree[2*Xt]!==0)return t;if(At.dyn_ltree[18]!==0||At.dyn_ltree[20]!==0||At.dyn_ltree[26]!==0)return r;for(Xt=32;Xt<h;Xt++)if(At.dyn_ltree[2*Xt]!==0)return r;return t}(k)),zt(k,k.l_desc),zt(k,k.d_desc),Dt=function(At){var Xt;for(ee(At,At.dyn_ltree,At.l_desc.max_code),ee(At,At.dyn_dtree,At.d_desc.max_code),zt(At,At.bl_desc),Xt=g-1;Xt>=3&&At.bl_tree[2*L[Xt]+1]===0;Xt--);return At.opt_len+=3*(Xt+1)+5+5+4,Xt}(k),Et=k.opt_len+3+7>>>3,(Mt=k.static_len+3+7>>>3)<=Et&&(Et=Mt)):Et=Mt=ht+5,ht+4<=Et&&Y!==-1?K(k,Y,ht,wt):k.strategy===i||Mt===Et?(Qt(k,(o<<1)+(wt?1:0),3),te(k,C,F)):(Qt(k,(c<<1)+(wt?1:0),3),function(At,Xt,ie,le){var W;for(Qt(At,Xt-257,5),Qt(At,ie-1,5),Qt(At,le-4,4),W=0;W<le;W++)Qt(At,At.bl_tree[2*L[W]+1],3);$(At,At.dyn_ltree,Xt-1),$(At,At.dyn_dtree,ie-1)}(k,k.l_desc.max_code+1,k.d_desc.max_code+1,Dt+1),te(k,k.dyn_ltree,k.dyn_dtree)),at(k),wt&&xt(k)},l._tr_tally=function(k,Y,ht){return k.pending_buf[k.d_buf+2*k.last_lit]=Y>>>8&255,k.pending_buf[k.d_buf+2*k.last_lit+1]=255&Y,k.pending_buf[k.l_buf+k.last_lit]=255&ht,k.last_lit++,Y===0?k.dyn_ltree[2*ht]++:(k.matches++,Y--,k.dyn_ltree[2*(it[ht]+h+1)]++,k.dyn_dtree[2*Gt(Y)]++),k.last_lit===k.lit_bufsize-1},l._tr_align=function(k){Qt(k,o<<1,3),ne(k,R,C),function(Y){Y.bi_valid===16?(qt(Y,Y.bi_buf),Y.bi_buf=0,Y.bi_valid=0):Y.bi_valid>=8&&(Y.pending_buf[Y.pending++]=255&Y.bi_buf,Y.bi_buf>>=8,Y.bi_valid-=8)}(k)}},function(p,l,n){"use strict";var e,i=n(2),t=n(64),r=n(33),s=n(32),a=n(16),f=0,o=1,c=3,d=4,h=5,u=0,m=1,g=-2,_=-3,y=-5,v=-1,b=1,R=2,M=3,P=4,T=0,E=2,x=8,S=9,L=15,C=8,F=286,q=30,it=19,st=2*F+1,pt=15,_t=3,X=258,ot=X+_t+1,Tt=32,Vt=42,Gt=69,qt=73,Qt=91,ne=103,j=113,J=666,at=1,xt=2,Rt=3,Lt=4,te=3;function zt(W,ct){return W.msg=a[ct],ct}function ee(W){return(W<<1)-(W>4?9:0)}function $(W){for(var ct=W.length;--ct>=0;)W[ct]=0}function N(W){var ct=W.state,z=ct.pending;z>W.avail_out&&(z=W.avail_out),z!==0&&(i.arraySet(W.output,ct.pending_buf,ct.pending_out,z,W.next_out),W.next_out+=z,ct.pending_out+=z,W.total_out+=z,W.avail_out-=z,ct.pending-=z,ct.pending===0&&(ct.pending_out=0))}function K(W,ct){t._tr_flush_block(W,W.block_start>=0?W.block_start:-1,W.strstart-W.block_start,ct),W.block_start=W.strstart,N(W.strm)}function k(W,ct){W.pending_buf[W.pending++]=ct}function Y(W,ct){W.pending_buf[W.pending++]=ct>>>8&255,W.pending_buf[W.pending++]=255&ct}function ht(W,ct,z,nt){var Ht=W.avail_in;return Ht>nt&&(Ht=nt),Ht===0?0:(W.avail_in-=Ht,i.arraySet(ct,W.input,W.next_in,Ht,z),W.state.wrap===1?W.adler=r(W.adler,ct,Ht,z):W.state.wrap===2&&(W.adler=s(W.adler,ct,Ht,z)),W.next_in+=Ht,W.total_in+=Ht,Ht)}function wt(W,ct){var z,nt,Ht=W.max_chain_length,Kt=W.strstart,fe=W.prev_length,Ft=W.nice_match,he=W.strstart>W.w_size-ot?W.strstart-(W.w_size-ot):0,Bt=W.window,$t=W.w_mask,Ue=W.prev,Ee=W.strstart+X,pe=Bt[Kt+fe-1],Ie=Bt[Kt+fe];W.prev_length>=W.good_match&&(Ht>>=2),Ft>W.lookahead&&(Ft=W.lookahead);do if(Bt[(z=ct)+fe]===Ie&&Bt[z+fe-1]===pe&&Bt[z]===Bt[Kt]&&Bt[++z]===Bt[Kt+1]){Kt+=2,z++;do;while(Bt[++Kt]===Bt[++z]&&Bt[++Kt]===Bt[++z]&&Bt[++Kt]===Bt[++z]&&Bt[++Kt]===Bt[++z]&&Bt[++Kt]===Bt[++z]&&Bt[++Kt]===Bt[++z]&&Bt[++Kt]===Bt[++z]&&Bt[++Kt]===Bt[++z]&&Kt<Ee);if(nt=X-(Ee-Kt),Kt=Ee-X,nt>fe){if(W.match_start=ct,fe=nt,nt>=Ft)break;pe=Bt[Kt+fe-1],Ie=Bt[Kt+fe]}}while((ct=Ue[ct&$t])>he&&--Ht!=0);return fe<=W.lookahead?fe:W.lookahead}function Et(W){var ct,z,nt,Ht,Kt,fe=W.w_size;do{if(Ht=W.window_size-W.lookahead-W.strstart,W.strstart>=fe+(fe-ot)){i.arraySet(W.window,W.window,fe,fe,0),W.match_start-=fe,W.strstart-=fe,W.block_start-=fe,ct=z=W.hash_size;do nt=W.head[--ct],W.head[ct]=nt>=fe?nt-fe:0;while(--z);ct=z=fe;do nt=W.prev[--ct],W.prev[ct]=nt>=fe?nt-fe:0;while(--z);Ht+=fe}if(W.strm.avail_in===0)break;if(z=ht(W.strm,W.window,W.strstart+W.lookahead,Ht),W.lookahead+=z,W.lookahead+W.insert>=_t)for(Kt=W.strstart-W.insert,W.ins_h=W.window[Kt],W.ins_h=(W.ins_h<<W.hash_shift^W.window[Kt+1])&W.hash_mask;W.insert&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[Kt+_t-1])&W.hash_mask,W.prev[Kt&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=Kt,Kt++,W.insert--,!(W.lookahead+W.insert<_t)););}while(W.lookahead<ot&&W.strm.avail_in!==0)}function Mt(W,ct){for(var z,nt;;){if(W.lookahead<ot){if(Et(W),W.lookahead<ot&&ct===f)return at;if(W.lookahead===0)break}if(z=0,W.lookahead>=_t&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+_t-1])&W.hash_mask,z=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),z!==0&&W.strstart-z<=W.w_size-ot&&(W.match_length=wt(W,z)),W.match_length>=_t)if(nt=t._tr_tally(W,W.strstart-W.match_start,W.match_length-_t),W.lookahead-=W.match_length,W.match_length<=W.max_lazy_match&&W.lookahead>=_t){W.match_length--;do W.strstart++,W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+_t-1])&W.hash_mask,z=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart;while(--W.match_length!=0);W.strstart++}else W.strstart+=W.match_length,W.match_length=0,W.ins_h=W.window[W.strstart],W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+1])&W.hash_mask;else nt=t._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++;if(nt&&(K(W,!1),W.strm.avail_out===0))return at}return W.insert=W.strstart<_t-1?W.strstart:_t-1,ct===d?(K(W,!0),W.strm.avail_out===0?Rt:Lt):W.last_lit&&(K(W,!1),W.strm.avail_out===0)?at:xt}function Dt(W,ct){for(var z,nt,Ht;;){if(W.lookahead<ot){if(Et(W),W.lookahead<ot&&ct===f)return at;if(W.lookahead===0)break}if(z=0,W.lookahead>=_t&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+_t-1])&W.hash_mask,z=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),W.prev_length=W.match_length,W.prev_match=W.match_start,W.match_length=_t-1,z!==0&&W.prev_length<W.max_lazy_match&&W.strstart-z<=W.w_size-ot&&(W.match_length=wt(W,z),W.match_length<=5&&(W.strategy===b||W.match_length===_t&&W.strstart-W.match_start>4096)&&(W.match_length=_t-1)),W.prev_length>=_t&&W.match_length<=W.prev_length){Ht=W.strstart+W.lookahead-_t,nt=t._tr_tally(W,W.strstart-1-W.prev_match,W.prev_length-_t),W.lookahead-=W.prev_length-1,W.prev_length-=2;do++W.strstart<=Ht&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+_t-1])&W.hash_mask,z=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart);while(--W.prev_length!=0);if(W.match_available=0,W.match_length=_t-1,W.strstart++,nt&&(K(W,!1),W.strm.avail_out===0))return at}else if(W.match_available){if((nt=t._tr_tally(W,0,W.window[W.strstart-1]))&&K(W,!1),W.strstart++,W.lookahead--,W.strm.avail_out===0)return at}else W.match_available=1,W.strstart++,W.lookahead--}return W.match_available&&(nt=t._tr_tally(W,0,W.window[W.strstart-1]),W.match_available=0),W.insert=W.strstart<_t-1?W.strstart:_t-1,ct===d?(K(W,!0),W.strm.avail_out===0?Rt:Lt):W.last_lit&&(K(W,!1),W.strm.avail_out===0)?at:xt}function At(W,ct,z,nt,Ht){this.good_length=W,this.max_lazy=ct,this.nice_length=z,this.max_chain=nt,this.func=Ht}function Xt(W){var ct;return W&&W.state?(W.total_in=W.total_out=0,W.data_type=E,(ct=W.state).pending=0,ct.pending_out=0,ct.wrap<0&&(ct.wrap=-ct.wrap),ct.status=ct.wrap?Vt:j,W.adler=ct.wrap===2?0:1,ct.last_flush=f,t._tr_init(ct),u):zt(W,g)}function ie(W){var ct=Xt(W);return ct===u&&function(z){z.window_size=2*z.w_size,$(z.head),z.max_lazy_match=e[z.level].max_lazy,z.good_match=e[z.level].good_length,z.nice_match=e[z.level].nice_length,z.max_chain_length=e[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=_t-1,z.match_available=0,z.ins_h=0}(W.state),ct}function le(W,ct,z,nt,Ht,Kt){if(!W)return g;var fe=1;if(ct===v&&(ct=6),nt<0?(fe=0,nt=-nt):nt>15&&(fe=2,nt-=16),Ht<1||Ht>S||z!==x||nt<8||nt>15||ct<0||ct>9||Kt<0||Kt>P)return zt(W,g);nt===8&&(nt=9);var Ft=new function(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*st),this.dyn_dtree=new i.Buf16(2*(2*q+1)),this.bl_tree=new i.Buf16(2*(2*it+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(pt+1),this.heap=new i.Buf16(2*F+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*F+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0};return W.state=Ft,Ft.strm=W,Ft.wrap=fe,Ft.gzhead=null,Ft.w_bits=nt,Ft.w_size=1<<Ft.w_bits,Ft.w_mask=Ft.w_size-1,Ft.hash_bits=Ht+7,Ft.hash_size=1<<Ft.hash_bits,Ft.hash_mask=Ft.hash_size-1,Ft.hash_shift=~~((Ft.hash_bits+_t-1)/_t),Ft.window=new i.Buf8(2*Ft.w_size),Ft.head=new i.Buf16(Ft.hash_size),Ft.prev=new i.Buf16(Ft.w_size),Ft.lit_bufsize=1<<Ht+6,Ft.pending_buf_size=4*Ft.lit_bufsize,Ft.pending_buf=new i.Buf8(Ft.pending_buf_size),Ft.d_buf=1*Ft.lit_bufsize,Ft.l_buf=3*Ft.lit_bufsize,Ft.level=ct,Ft.strategy=Kt,Ft.method=z,ie(W)}e=[new At(0,0,0,0,function(W,ct){var z=65535;for(z>W.pending_buf_size-5&&(z=W.pending_buf_size-5);;){if(W.lookahead<=1){if(Et(W),W.lookahead===0&&ct===f)return at;if(W.lookahead===0)break}W.strstart+=W.lookahead,W.lookahead=0;var nt=W.block_start+z;if((W.strstart===0||W.strstart>=nt)&&(W.lookahead=W.strstart-nt,W.strstart=nt,K(W,!1),W.strm.avail_out===0)||W.strstart-W.block_start>=W.w_size-ot&&(K(W,!1),W.strm.avail_out===0))return at}return W.insert=0,ct===d?(K(W,!0),W.strm.avail_out===0?Rt:Lt):(W.strstart>W.block_start&&(K(W,!1),W.strm.avail_out),at)}),new At(4,4,8,4,Mt),new At(4,5,16,8,Mt),new At(4,6,32,32,Mt),new At(4,4,16,16,Dt),new At(8,16,32,32,Dt),new At(8,16,128,128,Dt),new At(8,32,128,256,Dt),new At(32,128,258,1024,Dt),new At(32,258,258,4096,Dt)],l.deflateInit=function(W,ct){return le(W,ct,x,L,C,T)},l.deflateInit2=le,l.deflateReset=ie,l.deflateResetKeep=Xt,l.deflateSetHeader=function(W,ct){return W&&W.state?W.state.wrap!==2?g:(W.state.gzhead=ct,u):g},l.deflate=function(W,ct){var z,nt,Ht,Kt;if(!W||!W.state||ct>h||ct<0)return W?zt(W,g):g;if(nt=W.state,!W.output||!W.input&&W.avail_in!==0||nt.status===J&&ct!==d)return zt(W,W.avail_out===0?y:g);if(nt.strm=W,z=nt.last_flush,nt.last_flush=ct,nt.status===Vt)if(nt.wrap===2)W.adler=0,k(nt,31),k(nt,139),k(nt,8),nt.gzhead?(k(nt,(nt.gzhead.text?1:0)+(nt.gzhead.hcrc?2:0)+(nt.gzhead.extra?4:0)+(nt.gzhead.name?8:0)+(nt.gzhead.comment?16:0)),k(nt,255&nt.gzhead.time),k(nt,nt.gzhead.time>>8&255),k(nt,nt.gzhead.time>>16&255),k(nt,nt.gzhead.time>>24&255),k(nt,nt.level===9?2:nt.strategy>=R||nt.level<2?4:0),k(nt,255&nt.gzhead.os),nt.gzhead.extra&&nt.gzhead.extra.length&&(k(nt,255&nt.gzhead.extra.length),k(nt,nt.gzhead.extra.length>>8&255)),nt.gzhead.hcrc&&(W.adler=s(W.adler,nt.pending_buf,nt.pending,0)),nt.gzindex=0,nt.status=Gt):(k(nt,0),k(nt,0),k(nt,0),k(nt,0),k(nt,0),k(nt,nt.level===9?2:nt.strategy>=R||nt.level<2?4:0),k(nt,te),nt.status=j);else{var fe=x+(nt.w_bits-8<<4)<<8;fe|=(nt.strategy>=R||nt.level<2?0:nt.level<6?1:nt.level===6?2:3)<<6,nt.strstart!==0&&(fe|=Tt),fe+=31-fe%31,nt.status=j,Y(nt,fe),nt.strstart!==0&&(Y(nt,W.adler>>>16),Y(nt,65535&W.adler)),W.adler=1}if(nt.status===Gt)if(nt.gzhead.extra){for(Ht=nt.pending;nt.gzindex<(65535&nt.gzhead.extra.length)&&(nt.pending!==nt.pending_buf_size||(nt.gzhead.hcrc&&nt.pending>Ht&&(W.adler=s(W.adler,nt.pending_buf,nt.pending-Ht,Ht)),N(W),Ht=nt.pending,nt.pending!==nt.pending_buf_size));)k(nt,255&nt.gzhead.extra[nt.gzindex]),nt.gzindex++;nt.gzhead.hcrc&&nt.pending>Ht&&(W.adler=s(W.adler,nt.pending_buf,nt.pending-Ht,Ht)),nt.gzindex===nt.gzhead.extra.length&&(nt.gzindex=0,nt.status=qt)}else nt.status=qt;if(nt.status===qt)if(nt.gzhead.name){Ht=nt.pending;do{if(nt.pending===nt.pending_buf_size&&(nt.gzhead.hcrc&&nt.pending>Ht&&(W.adler=s(W.adler,nt.pending_buf,nt.pending-Ht,Ht)),N(W),Ht=nt.pending,nt.pending===nt.pending_buf_size)){Kt=1;break}Kt=nt.gzindex<nt.gzhead.name.length?255&nt.gzhead.name.charCodeAt(nt.gzindex++):0,k(nt,Kt)}while(Kt!==0);nt.gzhead.hcrc&&nt.pending>Ht&&(W.adler=s(W.adler,nt.pending_buf,nt.pending-Ht,Ht)),Kt===0&&(nt.gzindex=0,nt.status=Qt)}else nt.status=Qt;if(nt.status===Qt)if(nt.gzhead.comment){Ht=nt.pending;do{if(nt.pending===nt.pending_buf_size&&(nt.gzhead.hcrc&&nt.pending>Ht&&(W.adler=s(W.adler,nt.pending_buf,nt.pending-Ht,Ht)),N(W),Ht=nt.pending,nt.pending===nt.pending_buf_size)){Kt=1;break}Kt=nt.gzindex<nt.gzhead.comment.length?255&nt.gzhead.comment.charCodeAt(nt.gzindex++):0,k(nt,Kt)}while(Kt!==0);nt.gzhead.hcrc&&nt.pending>Ht&&(W.adler=s(W.adler,nt.pending_buf,nt.pending-Ht,Ht)),Kt===0&&(nt.status=ne)}else nt.status=ne;if(nt.status===ne&&(nt.gzhead.hcrc?(nt.pending+2>nt.pending_buf_size&&N(W),nt.pending+2<=nt.pending_buf_size&&(k(nt,255&W.adler),k(nt,W.adler>>8&255),W.adler=0,nt.status=j)):nt.status=j),nt.pending!==0){if(N(W),W.avail_out===0)return nt.last_flush=-1,u}else if(W.avail_in===0&&ee(ct)<=ee(z)&&ct!==d)return zt(W,y);if(nt.status===J&&W.avail_in!==0)return zt(W,y);if(W.avail_in!==0||nt.lookahead!==0||ct!==f&&nt.status!==J){var Ft=nt.strategy===R?function(he,Bt){for(var $t;;){if(he.lookahead===0&&(Et(he),he.lookahead===0)){if(Bt===f)return at;break}if(he.match_length=0,$t=t._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++,$t&&(K(he,!1),he.strm.avail_out===0))return at}return he.insert=0,Bt===d?(K(he,!0),he.strm.avail_out===0?Rt:Lt):he.last_lit&&(K(he,!1),he.strm.avail_out===0)?at:xt}(nt,ct):nt.strategy===M?function(he,Bt){for(var $t,Ue,Ee,pe,Ie=he.window;;){if(he.lookahead<=X){if(Et(he),he.lookahead<=X&&Bt===f)return at;if(he.lookahead===0)break}if(he.match_length=0,he.lookahead>=_t&&he.strstart>0&&(Ue=Ie[Ee=he.strstart-1])===Ie[++Ee]&&Ue===Ie[++Ee]&&Ue===Ie[++Ee]){pe=he.strstart+X;do;while(Ue===Ie[++Ee]&&Ue===Ie[++Ee]&&Ue===Ie[++Ee]&&Ue===Ie[++Ee]&&Ue===Ie[++Ee]&&Ue===Ie[++Ee]&&Ue===Ie[++Ee]&&Ue===Ie[++Ee]&&Ee<pe);he.match_length=X-(pe-Ee),he.match_length>he.lookahead&&(he.match_length=he.lookahead)}if(he.match_length>=_t?($t=t._tr_tally(he,1,he.match_length-_t),he.lookahead-=he.match_length,he.strstart+=he.match_length,he.match_length=0):($t=t._tr_tally(he,0,he.window[he.strstart]),he.lookahead--,he.strstart++),$t&&(K(he,!1),he.strm.avail_out===0))return at}return he.insert=0,Bt===d?(K(he,!0),he.strm.avail_out===0?Rt:Lt):he.last_lit&&(K(he,!1),he.strm.avail_out===0)?at:xt}(nt,ct):e[nt.level].func(nt,ct);if(Ft!==Rt&&Ft!==Lt||(nt.status=J),Ft===at||Ft===Rt)return W.avail_out===0&&(nt.last_flush=-1),u;if(Ft===xt&&(ct===o?t._tr_align(nt):ct!==h&&(t._tr_stored_block(nt,0,0,!1),ct===c&&($(nt.head),nt.lookahead===0&&(nt.strstart=0,nt.block_start=0,nt.insert=0))),N(W),W.avail_out===0))return nt.last_flush=-1,u}return ct!==d?u:nt.wrap<=0?m:(nt.wrap===2?(k(nt,255&W.adler),k(nt,W.adler>>8&255),k(nt,W.adler>>16&255),k(nt,W.adler>>24&255),k(nt,255&W.total_in),k(nt,W.total_in>>8&255),k(nt,W.total_in>>16&255),k(nt,W.total_in>>24&255)):(Y(nt,W.adler>>>16),Y(nt,65535&W.adler)),N(W),nt.wrap>0&&(nt.wrap=-nt.wrap),nt.pending!==0?u:m)},l.deflateEnd=function(W){var ct;return W&&W.state?(ct=W.state.status)!==Vt&&ct!==Gt&&ct!==qt&&ct!==Qt&&ct!==ne&&ct!==j&&ct!==J?zt(W,g):(W.state=null,ct===j?zt(W,_):u):g},l.deflateSetDictionary=function(W,ct){var z,nt,Ht,Kt,fe,Ft,he,Bt,$t=ct.length;if(!W||!W.state||(Kt=(z=W.state).wrap)===2||Kt===1&&z.status!==Vt||z.lookahead)return g;for(Kt===1&&(W.adler=r(W.adler,ct,$t,0)),z.wrap=0,$t>=z.w_size&&(Kt===0&&($(z.head),z.strstart=0,z.block_start=0,z.insert=0),Bt=new i.Buf8(z.w_size),i.arraySet(Bt,ct,$t-z.w_size,z.w_size,0),ct=Bt,$t=z.w_size),fe=W.avail_in,Ft=W.next_in,he=W.input,W.avail_in=$t,W.next_in=0,W.input=ct,Et(z);z.lookahead>=_t;){nt=z.strstart,Ht=z.lookahead-(_t-1);do z.ins_h=(z.ins_h<<z.hash_shift^z.window[nt+_t-1])&z.hash_mask,z.prev[nt&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=nt,nt++;while(--Ht);z.strstart=nt,z.lookahead=_t-1,Et(z)}return z.strstart+=z.lookahead,z.block_start=z.strstart,z.insert=z.lookahead,z.lookahead=0,z.match_length=z.prev_length=_t-1,z.match_available=0,W.next_in=Ft,W.input=he,W.avail_in=fe,z.wrap=Kt,u},l.deflateInfo="pako deflate (from Nodeca project)"},function(p,l,n){"use strict";var e=n(65),i=n(2),t=n(31),r=n(16),s=n(30),a=Object.prototype.toString,f=0,o=-1,c=0,d=8;function h(m){if(!(this instanceof h))return new h(m);this.options=i.assign({level:o,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},m||{});var g=this.options;g.raw&&g.windowBits>0?g.windowBits=-g.windowBits:g.gzip&&g.windowBits>0&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var _=e.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(_!==f)throw new Error(r[_]);if(g.header&&e.deflateSetHeader(this.strm,g.header),g.dictionary){var y;if(y=typeof g.dictionary=="string"?t.string2buf(g.dictionary):a.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(_=e.deflateSetDictionary(this.strm,y))!==f)throw new Error(r[_]);this._dict_set=!0}}function u(m,g){var _=new h(g);if(_.push(m,!0),_.err)throw _.msg||r[_.err];return _.result}h.prototype.push=function(m,g){var _,y,v=this.strm,b=this.options.chunkSize;if(this.ended)return!1;y=g===~~g?g:g===!0?4:0,typeof m=="string"?v.input=t.string2buf(m):a.call(m)==="[object ArrayBuffer]"?v.input=new Uint8Array(m):v.input=m,v.next_in=0,v.avail_in=v.input.length;do{if(v.avail_out===0&&(v.output=new i.Buf8(b),v.next_out=0,v.avail_out=b),(_=e.deflate(v,y))!==1&&_!==f)return this.onEnd(_),this.ended=!0,!1;v.avail_out!==0&&(v.avail_in!==0||y!==4&&y!==2)||(this.options.to==="string"?this.onData(t.buf2binstring(i.shrinkBuf(v.output,v.next_out))):this.onData(i.shrinkBuf(v.output,v.next_out)))}while((v.avail_in>0||v.avail_out===0)&&_!==1);return y===4?(_=e.deflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===f):y!==2||(this.onEnd(f),v.avail_out=0,!0)},h.prototype.onData=function(m){this.chunks.push(m)},h.prototype.onEnd=function(m){m===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},l.Deflate=h,l.deflate=u,l.deflateRaw=function(m,g){return(g=g||{}).raw=!0,u(m,g)},l.gzip=function(m,g){return(g=g||{}).gzip=!0,u(m,g)}},function(p,l,n){"use strict";var e={};(0,n(2).assign)(e,n(66),n(63),n(29)),p.exports=e},function(p,l,n){"use strict";var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",i=n(67),t=n(0),r=n(1),s=e?"uint8array":"array";function a(f,o){r.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=o,this.meta={}}l.magic="\b\0",t.inherits(a,r),a.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(t.transformTo(s,f.data),!1)},a.prototype.flush=function(){r.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},a.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this._pako=null},a.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(o){f.push({data:o,meta:f.meta})}},l.compressWorker=function(f){return new a("Deflate",f)},l.uncompressWorker=function(){return new a("Inflate",{})}},function(p,l,n){"use strict";var e=n(34),i=n(58);l.generateWorker=function(t,r,s){var a=new i(r.streamFiles,s,r.platform,r.encodeFileName),f=0;try{t.forEach(function(o,c){f++;var d=function(g,_){var y=g||_,v=e[y];if(!v)throw new Error(y+" is not a valid compression method !");return v}(c.options.compression,r.compression),h=c.options.compressionOptions||r.compressionOptions||{},u=c.dir,m=c.date;c._compressWorker(d,h).withStreamInfo("file",{name:o,dir:u,date:m,comment:c.comment||"",unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions}).pipe(a)}),a.entriesCount=f}catch(o){a.error(o)}return a}},function(p,l,n){"use strict";var e=n(39),i=n(37),t=n(7),r=n(18),s=n(1),a=function(d,h,u){this.name=d,this.dir=u.dir,this.date=u.date,this.comment=u.comment,this.unixPermissions=u.unixPermissions,this.dosPermissions=u.dosPermissions,this._data=h,this._dataBinary=u.binary,this.options={compression:u.compression,compressionOptions:u.compressionOptions}};a.prototype={internalStream:function(d){var h=null,u="string";try{if(!d)throw new Error("No output type specified.");var m=(u=d.toLowerCase())==="string"||u==="text";u!=="binarystring"&&u!=="text"||(u="string"),h=this._decompressWorker();var g=!this._dataBinary;g&&!m&&(h=h.pipe(new t.Utf8EncodeWorker)),!g&&m&&(h=h.pipe(new t.Utf8DecodeWorker))}catch(_){(h=new s("error")).error(_)}return new e(h,u,"")},async:function(d,h){return this.internalStream(d).accumulate(h)},nodeStream:function(d,h){return this.internalStream(d||"nodebuffer").toNodejsStream(h)},_compressWorker:function(d,h){if(this._data instanceof r&&this._data.compression.magic===d.magic)return this._data.getCompressedWorker();var u=this._decompressWorker();return this._dataBinary||(u=u.pipe(new t.Utf8EncodeWorker)),r.createWorkerFrom(u,d,h)},_decompressWorker:function(){return this._data instanceof r?this._data.getContentWorker():this._data instanceof s?this._data:new i(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],o=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},c=0;c<f.length;c++)a.prototype[f[c]]=o;p.exports=a},function(p,l,n){"use strict";var e=n(50).Readable;function i(t,r,s){e.call(this,r),this._helper=t;var a=this;t.on("data",function(f,o){a.push(f)||a._helper.pause(),s&&s(o)}).on("error",function(f){a.emit("error",f)}).on("end",function(){a.push(null)})}n(0).inherits(i,e),i.prototype._read=function(){this._helper.resume()},p.exports=i},function(p,l,n){"use strict";var e=n(1),i=n(0);function t(r){e.call(this,"ConvertWorker to "+r),this.destType=r}i.inherits(t,e),t.prototype.processChunk=function(r){this.push({data:i.transformTo(this.destType,r.data),meta:r.meta})},p.exports=t},function(p,l,n){"use strict";(function(e){var i,t,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var s=0,a=new r(d),f=e.document.createTextNode("");a.observe(f,{characterData:!0}),i=function(){f.data=s=++s%2}}else if(e.setImmediate||e.MessageChannel===void 0)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var h=e.document.createElement("script");h.onreadystatechange=function(){d(),h.onreadystatechange=null,h.parentNode.removeChild(h),h=null},e.document.documentElement.appendChild(h)}:function(){setTimeout(d,0)};else{var o=new e.MessageChannel;o.port1.onmessage=d,i=function(){o.port2.postMessage(0)}}var c=[];function d(){var h,u;t=!0;for(var m=c.length;m;){for(u=c,c=[],h=-1;++h<m;)u[h]();m=c.length}t=!1}p.exports=function(h){c.push(h)!==1||t||i()}}).call(this,n(5))},function(p,l,n){"use strict";var e=n(73);function i(){}var t={},r=["REJECTED"],s=["FULFILLED"],a=["PENDING"];function f(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=a,this.queue=[],this.outcome=void 0,m!==i&&h(this,m)}function o(m,g,_){this.promise=m,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof _=="function"&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function c(m,g,_){e(function(){var y;try{y=g(_)}catch(v){return t.reject(m,v)}y===m?t.reject(m,new TypeError("Cannot resolve promise with itself")):t.resolve(m,y)})}function d(m){var g=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof g=="function")return function(){g.apply(m,arguments)}}function h(m,g){var _=!1;function y(R){_||(_=!0,t.reject(m,R))}function v(R){_||(_=!0,t.resolve(m,R))}var b=u(function(){g(v,y)});b.status==="error"&&y(b.value)}function u(m,g){var _={};try{_.value=m(g),_.status="success"}catch(y){_.status="error",_.value=y}return _}p.exports=f,f.prototype.catch=function(m){return this.then(null,m)},f.prototype.then=function(m,g){if(typeof m!="function"&&this.state===s||typeof g!="function"&&this.state===r)return this;var _=new this.constructor(i);return this.state!==a?c(_,this.state===s?m:g,this.outcome):this.queue.push(new o(_,m,g)),_},o.prototype.callFulfilled=function(m){t.resolve(this.promise,m)},o.prototype.otherCallFulfilled=function(m){c(this.promise,this.onFulfilled,m)},o.prototype.callRejected=function(m){t.reject(this.promise,m)},o.prototype.otherCallRejected=function(m){c(this.promise,this.onRejected,m)},t.resolve=function(m,g){var _=u(d,g);if(_.status==="error")return t.reject(m,_.value);var y=_.value;if(y)h(m,y);else{m.state=s,m.outcome=g;for(var v=-1,b=m.queue.length;++v<b;)m.queue[v].callFulfilled(g)}return m},t.reject=function(m,g){m.state=r,m.outcome=g;for(var _=-1,y=m.queue.length;++_<y;)m.queue[_].callRejected(g);return m},f.resolve=function(m){return m instanceof this?m:t.resolve(new this(i),m)},f.reject=function(m){var g=new this(i);return t.reject(g,m)},f.all=function(m){var g=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=m.length,y=!1;if(!_)return this.resolve([]);for(var v=new Array(_),b=0,R=-1,M=new this(i);++R<_;)P(m[R],R);return M;function P(T,E){g.resolve(T).then(function(x){v[E]=x,++b!==_||y||(y=!0,t.resolve(M,v))},function(x){y||(y=!0,t.reject(M,x))})}},f.race=function(m){var g=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var _=m.length,y=!1;if(!_)return this.resolve([]);for(var v=-1,b=new this(i);++v<_;)R(m[v]);return b;function R(M){g.resolve(M).then(function(P){y||(y=!0,t.resolve(b,P))},function(P){y||(y=!0,t.reject(b,P))})}}},function(p,l){var n={}.toString;p.exports=function(e){return n.call(e).slice(8,-1)}},function(p,l,n){p.exports=n(11).document&&document.documentElement},function(p,l){p.exports=function(n,e,i){var t=i===void 0;switch(e.length){case 0:return t?n():n.call(i);case 1:return t?n(e[0]):n.call(i,e[0]);case 2:return t?n(e[0],e[1]):n.call(i,e[0],e[1]);case 3:return t?n(e[0],e[1],e[2]):n.call(i,e[0],e[1],e[2]);case 4:return t?n(e[0],e[1],e[2],e[3]):n.call(i,e[0],e[1],e[2],e[3])}return n.apply(i,e)}},function(p,l,n){var e,i,t,r=n(42),s=n(77),a=n(76),f=n(40),o=n(11),c=o.process,d=o.setImmediate,h=o.clearImmediate,u=o.MessageChannel,m=0,g={},_=function(){var v=+this;if(g.hasOwnProperty(v)){var b=g[v];delete g[v],b()}},y=function(v){_.call(v.data)};d&&h||(d=function(v){for(var b=[],R=1;arguments.length>R;)b.push(arguments[R++]);return g[++m]=function(){s(typeof v=="function"?v:Function(v),b)},e(m),m},h=function(v){delete g[v]},n(75)(c)=="process"?e=function(v){c.nextTick(r(_,v,1))}:u?(t=(i=new u).port2,i.port1.onmessage=y,e=r(t.postMessage,t,1)):o.addEventListener&&typeof postMessage=="function"&&!o.importScripts?(e=function(v){o.postMessage(v+"","*")},o.addEventListener("message",y,!1)):e="onreadystatechange"in f("script")?function(v){a.appendChild(f("script")).onreadystatechange=function(){a.removeChild(this),_.call(v)}}:function(v){setTimeout(r(_,v,1),0)}),p.exports={set:d,clear:h}},function(p,l){p.exports=function(n,e){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:e}}},function(p,l,n){var e=n(20);p.exports=function(i,t){if(!e(i))return i;var r,s;if(t&&typeof(r=i.toString)=="function"&&!e(s=r.call(i))||typeof(r=i.valueOf)=="function"&&!e(s=r.call(i))||!t&&typeof(r=i.toString)=="function"&&!e(s=r.call(i)))return s;throw TypeError("Can't convert object to primitive value")}},function(p,l,n){p.exports=!n(19)&&!n(41)(function(){return Object.defineProperty(n(40)("div"),"a",{get:function(){return 7}}).a!=7})},function(p,l,n){var e=n(20);p.exports=function(i){if(!e(i))throw TypeError(i+" is not an object!");return i}},function(p,l,n){var e=n(82),i=n(81),t=n(80),r=Object.defineProperty;l.f=n(19)?Object.defineProperty:function(s,a,f){if(e(s),a=t(a,!0),e(f),i)try{return r(s,a,f)}catch(o){}if("get"in f||"set"in f)throw TypeError("Accessors not supported!");return"value"in f&&(s[a]=f.value),s}},function(p,l,n){var e=n(83),i=n(79);p.exports=n(19)?function(t,r,s){return e.f(t,r,i(1,s))}:function(t,r,s){return t[r]=s,t}},function(p,l){p.exports=function(n){if(typeof n!="function")throw TypeError(n+" is not a function!");return n}},function(p,l,n){var e=n(11),i=n(43),t=n(42),r=n(84),s=function(a,f,o){var c,d,h,u=a&s.F,m=a&s.G,g=a&s.S,_=a&s.P,y=a&s.B,v=a&s.W,b=m?i:i[f]||(i[f]={}),R=b.prototype,M=m?e:g?e[f]:(e[f]||{}).prototype;for(c in m&&(o=f),o)(d=!u&&M&&M[c]!==void 0)&&c in b||(h=d?M[c]:o[c],b[c]=m&&typeof M[c]!="function"?o[c]:y&&d?t(h,e):v&&M[c]==h?function(P){var T=function(E,x,S){if(this instanceof P){switch(arguments.length){case 0:return new P;case 1:return new P(E);case 2:return new P(E,x)}return new P(E,x,S)}return P.apply(this,arguments)};return T.prototype=P.prototype,T}(h):_&&typeof h=="function"?t(Function.call,h):h,_&&((b.virtual||(b.virtual={}))[c]=h,a&s.R&&R&&!R[c]&&r(R,c,h)))};s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,p.exports=s},function(p,l,n){var e=n(86),i=n(78);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(p,l,n){n(87),p.exports=n(43).setImmediate},function(p,l,n){p.exports=n(22).PassThrough},function(p,l,n){p.exports=n(22).Transform},function(p,l,n){p.exports=n(4)},function(p,l,n){p.exports=n(21)},function(p,l,n){"use strict";p.exports=t;var e=n(45),i=n(9);function t(r){if(!(this instanceof t))return new t(r);e.call(this,r)}i.inherits=n(6),i.inherits(t,e),t.prototype._transform=function(r,s,a){a(null,r)}},function(p,l,n){(function(e){function i(t){try{if(!e.localStorage)return!1}catch(s){return!1}var r=e.localStorage[t];return r!=null&&String(r).toLowerCase()==="true"}p.exports=function(t,r){if(i("noDeprecation"))return t;var s=!1;return function(){if(!s){if(i("throwDeprecation"))throw new Error(r);i("traceDeprecation")?console.trace(r):console.warn(r),s=!0}return t.apply(this,arguments)}}}).call(this,n(5))},function(p,l,n){(function(e,i){(function(t,r){"use strict";if(!t.setImmediate){var s,a=1,f={},o=!1,c=t.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(t);d=d&&d.setTimeout?d:t,{}.toString.call(t.process)==="[object process]"?s=function(m){i.nextTick(function(){u(m)})}:function(){if(t.postMessage&&!t.importScripts){var m=!0,g=t.onmessage;return t.onmessage=function(){m=!1},t.postMessage("","*"),t.onmessage=g,m}}()?function(){var m="setImmediate$"+Math.random()+"$",g=function(_){_.source===t&&typeof _.data=="string"&&_.data.indexOf(m)===0&&u(+_.data.slice(m.length))};t.addEventListener?t.addEventListener("message",g,!1):t.attachEvent("onmessage",g),s=function(_){t.postMessage(m+_,"*")}}():t.MessageChannel?function(){var m=new MessageChannel;m.port1.onmessage=function(g){u(g.data)},s=function(g){m.port2.postMessage(g)}}():c&&"onreadystatechange"in c.createElement("script")?function(){var m=c.documentElement;s=function(g){var _=c.createElement("script");_.onreadystatechange=function(){u(g),_.onreadystatechange=null,m.removeChild(_),_=null},m.appendChild(_)}}():s=function(m){setTimeout(u,0,m)},d.setImmediate=function(m){typeof m!="function"&&(m=new Function(""+m));for(var g=new Array(arguments.length-1),_=0;_<g.length;_++)g[_]=arguments[_+1];var y={callback:m,args:g};return f[a]=y,s(a),a++},d.clearImmediate=h}function h(m){delete f[m]}function u(m){if(o)setTimeout(u,0,m);else{var g=f[m];if(g){o=!0;try{(function(_){var y=_.callback,v=_.args;switch(v.length){case 0:y();break;case 1:y(v[0]);break;case 2:y(v[0],v[1]);break;case 3:y(v[0],v[1],v[2]);break;default:y.apply(r,v)}})(g)}finally{h(m),o=!1}}}}})(typeof self>"u"?e===void 0?this:e:self)}).call(this,n(5),n(15))},function(p,l,n){(function(e){var i=e!==void 0&&e||typeof self<"u"&&self||window,t=Function.prototype.apply;function r(s,a){this._id=s,this._clearFn=a}l.setTimeout=function(){return new r(t.call(setTimeout,i,arguments),clearTimeout)},l.setInterval=function(){return new r(t.call(setInterval,i,arguments),clearInterval)},l.clearTimeout=l.clearInterval=function(s){s&&s.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},l.enroll=function(s,a){clearTimeout(s._idleTimeoutId),s._idleTimeout=a},l.unenroll=function(s){clearTimeout(s._idleTimeoutId),s._idleTimeout=-1},l._unrefActive=l.active=function(s){clearTimeout(s._idleTimeoutId);var a=s._idleTimeout;a>=0&&(s._idleTimeoutId=setTimeout(function(){s._onTimeout&&s._onTimeout()},a))},n(95),l.setImmediate=typeof self<"u"&&self.setImmediate||e!==void 0&&e.setImmediate||this&&this.setImmediate,l.clearImmediate=typeof self<"u"&&self.clearImmediate||e!==void 0&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(5))},function(p,l){},function(p,l,n){"use strict";var e=n(13).Buffer,i=n(97);function t(r,s,a){r.copy(s,a)}p.exports=function(){function r(){(function(s,a){if(!(s instanceof a))throw new TypeError("Cannot call a class as a function")})(this,r),this.head=null,this.tail=null,this.length=0}return r.prototype.push=function(s){var a={data:s,next:null};this.length>0?this.tail.next=a:this.head=a,this.tail=a,++this.length},r.prototype.unshift=function(s){var a={data:s,next:this.head};this.length===0&&(this.tail=a),this.head=a,++this.length},r.prototype.shift=function(){if(this.length!==0){var s=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,s}},r.prototype.clear=function(){this.head=this.tail=null,this.length=0},r.prototype.join=function(s){if(this.length===0)return"";for(var a=this.head,f=""+a.data;a=a.next;)f+=s+a.data;return f},r.prototype.concat=function(s){if(this.length===0)return e.alloc(0);if(this.length===1)return this.head.data;for(var a=e.allocUnsafe(s>>>0),f=this.head,o=0;f;)t(f.data,a,o),o+=f.data.length,f=f.next;return a},r}(),i&&i.inspect&&i.inspect.custom&&(p.exports.prototype[i.inspect.custom]=function(){var r=i.inspect({length:this.length});return this.constructor.name+" "+r})},function(p,l){},function(p,l,n){p.exports=i;var e=n(23).EventEmitter;function i(){e.call(this)}n(6)(i,e),i.Readable=n(22),i.Writable=n(92),i.Duplex=n(91),i.Transform=n(90),i.PassThrough=n(89),i.Stream=i,i.prototype.pipe=function(t,r){var s=this;function a(m){t.writable&&t.write(m)===!1&&s.pause&&s.pause()}function f(){s.readable&&s.resume&&s.resume()}s.on("data",a),t.on("drain",f),t._isStdio||r&&r.end===!1||(s.on("end",c),s.on("close",d));var o=!1;function c(){o||(o=!0,t.end())}function d(){o||(o=!0,typeof t.destroy=="function"&&t.destroy())}function h(m){if(u(),e.listenerCount(this,"error")===0)throw m}function u(){s.removeListener("data",a),t.removeListener("drain",f),s.removeListener("end",c),s.removeListener("close",d),s.removeListener("error",h),t.removeListener("error",h),s.removeListener("end",u),s.removeListener("close",u),t.removeListener("close",u)}return s.on("error",h),t.on("error",h),s.on("end",u),s.on("close",u),t.on("close",u),t.emit("pipe",s),t}},function(p,l){l.read=function(n,e,i,t,r){var s,a,f=8*r-t-1,o=(1<<f)-1,c=o>>1,d=-7,h=i?r-1:0,u=i?-1:1,m=n[e+h];for(h+=u,s=m&(1<<-d)-1,m>>=-d,d+=f;d>0;s=256*s+n[e+h],h+=u,d-=8);for(a=s&(1<<-d)-1,s>>=-d,d+=t;d>0;a=256*a+n[e+h],h+=u,d-=8);if(s===0)s=1-c;else{if(s===o)return a?NaN:1/0*(m?-1:1);a+=Math.pow(2,t),s-=c}return(m?-1:1)*a*Math.pow(2,s-t)},l.write=function(n,e,i,t,r,s){var a,f,o,c=8*s-r-1,d=(1<<c)-1,h=d>>1,u=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=t?0:s-1,g=t?1:-1,_=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(f=isNaN(e)?1:0,a=d):(a=Math.floor(Math.log(e)/Math.LN2),e*(o=Math.pow(2,-a))<1&&(a--,o*=2),(e+=a+h>=1?u/o:u*Math.pow(2,1-h))*o>=2&&(a++,o/=2),a+h>=d?(f=0,a=d):a+h>=1?(f=(e*o-1)*Math.pow(2,r),a+=h):(f=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;n[i+m]=255&f,m+=g,f/=256,r-=8);for(a=a<<r|f,c+=r;c>0;n[i+m]=255&a,m+=g,a/=256,c-=8);n[i+m-g]|=128*_}},function(p,l,n){"use strict";l.byteLength=function(d){var h=f(d),u=h[0],m=h[1];return 3*(u+m)/4-m},l.toByteArray=function(d){for(var h,u=f(d),m=u[0],g=u[1],_=new t(function(R,M,P){return 3*(M+P)/4-P}(0,m,g)),y=0,v=g>0?m-4:m,b=0;b<v;b+=4)h=i[d.charCodeAt(b)]<<18|i[d.charCodeAt(b+1)]<<12|i[d.charCodeAt(b+2)]<<6|i[d.charCodeAt(b+3)],_[y++]=h>>16&255,_[y++]=h>>8&255,_[y++]=255&h;return g===2&&(h=i[d.charCodeAt(b)]<<2|i[d.charCodeAt(b+1)]>>4,_[y++]=255&h),g===1&&(h=i[d.charCodeAt(b)]<<10|i[d.charCodeAt(b+1)]<<4|i[d.charCodeAt(b+2)]>>2,_[y++]=h>>8&255,_[y++]=255&h),_},l.fromByteArray=function(d){for(var h,u=d.length,m=u%3,g=[],_=0,y=u-m;_<y;_+=16383)g.push(c(d,_,_+16383>y?y:_+16383));return m===1?(h=d[u-1],g.push(e[h>>2]+e[h<<4&63]+"==")):m===2&&(h=(d[u-2]<<8)+d[u-1],g.push(e[h>>10]+e[h>>4&63]+e[h<<2&63]+"=")),g.join("")};for(var e=[],i=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=r.length;s<a;++s)e[s]=r[s],i[r.charCodeAt(s)]=s;function f(d){var h=d.length;if(h%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=d.indexOf("=");return u===-1&&(u=h),[u,u===h?0:4-u%4]}function o(d){return e[d>>18&63]+e[d>>12&63]+e[d>>6&63]+e[63&d]}function c(d,h,u){for(var m,g=[],_=h;_<u;_+=3)m=(d[_]<<16&16711680)+(d[_+1]<<8&65280)+(255&d[_+2]),g.push(o(m));return g.join("")}i[45]=62,i[95]=63},function(p,l,n){"use strict";var e=n(7),i=n(0),t=n(1),r=n(39),s=n(38),a=n(18),f=n(70),o=n(69),c=n(12),d=n(57),h=function(v,b,R){var M,P=i.getTypeOf(b),T=i.extend(R||{},s);T.date=T.date||new Date,T.compression!==null&&(T.compression=T.compression.toUpperCase()),typeof T.unixPermissions=="string"&&(T.unixPermissions=parseInt(T.unixPermissions,8)),T.unixPermissions&&16384&T.unixPermissions&&(T.dir=!0),T.dosPermissions&&16&T.dosPermissions&&(T.dir=!0),T.dir&&(v=m(v)),T.createFolders&&(M=u(v))&&g.call(this,M,!0);var E=P==="string"&&T.binary===!1&&T.base64===!1;R&&R.binary!==void 0||(T.binary=!E),(b instanceof a&&b.uncompressedSize===0||T.dir||!b||b.length===0)&&(T.base64=!1,T.binary=!0,b="",T.compression="STORE",P="string");var x=null;x=b instanceof a||b instanceof t?b:c.isNode&&c.isStream(b)?new d(v,b):i.prepareContent(v,b,T.binary,T.optimizedBinaryString,T.base64);var S=new f(v,x,T);this.files[v]=S},u=function(v){v.slice(-1)==="/"&&(v=v.substring(0,v.length-1));var b=v.lastIndexOf("/");return b>0?v.substring(0,b):""},m=function(v){return v.slice(-1)!=="/"&&(v+="/"),v},g=function(v,b){return b=b!==void 0?b:s.createFolders,v=m(v),this.files[v]||h.call(this,v,null,{dir:!0,createFolders:b}),this.files[v]};function _(v){return Object.prototype.toString.call(v)==="[object RegExp]"}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(v){var b,R,M;for(b in this.files)this.files.hasOwnProperty(b)&&(M=this.files[b],(R=b.slice(this.root.length,b.length))&&b.slice(0,this.root.length)===this.root&&v(R,M))},filter:function(v){var b=[];return this.forEach(function(R,M){v(R,M)&&b.push(M)}),b},file:function(v,b,R){if(arguments.length===1){if(_(v)){var M=v;return this.filter(function(T,E){return!E.dir&&M.test(T)})}var P=this.files[this.root+v];return P&&!P.dir?P:null}return v=this.root+v,h.call(this,v,b,R),this},folder:function(v){if(!v)return this;if(_(v))return this.filter(function(P,T){return T.dir&&v.test(P)});var b=this.root+v,R=g.call(this,b),M=this.clone();return M.root=R.name,M},remove:function(v){v=this.root+v;var b=this.files[v];if(b||(v.slice(-1)!=="/"&&(v+="/"),b=this.files[v]),b&&!b.dir)delete this.files[v];else for(var R=this.filter(function(P,T){return T.name.slice(0,v.length)===v}),M=0;M<R.length;M++)delete this.files[R[M].name];return this},generate:function(v){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(v){var b,R={};try{if((R=i.extend(v||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:e.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");i.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var M=R.comment||this.comment||"";b=o.generateWorker(this,R,M)}catch(P){(b=new t("error")).error(P)}return new r(b,R.type||"string",R.mimeType)},generateAsync:function(v,b){return this.generateInternalStream(v).accumulate(b)},generateNodeStream:function(v,b){return(v=v||{}).type||(v.type="nodebuffer"),this.generateInternalStream(v).toNodejsStream(b)}};p.exports=y},function(p,l,n){"use strict";function e(){if(!(this instanceof e))return new e;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var i=new e;for(var t in this)typeof this[t]!="function"&&(i[t]=this[t]);return i}}e.prototype=n(103),e.prototype.loadAsync=n(56),e.support=n(3),e.defaults=n(38),e.version="3.1.5",e.loadAsync=function(i,t){return new e().loadAsync(i,t)},e.external=n(8),p.exports=e}])}),B("formats/kml/KmzFile",["../../util/jszip","../../util/Promise","../../util/WWUtil"],function(p,l,n){"use strict";var e=function(i,t){this._binary=i,this._fileCache=t};return e.prototype.load=function(){var i=this,t=null,r=!1;return new p().loadAsync(this._binary).then(function(s){return l.all(Object.keys(s.files).map(function(a){return s.files[a]}).map(function(a){return i.hasExtension("kml",a.name)&&!r?(r=!0,a.async("text").then(function(f){t=f})):i.hasExtension("kml",a.name)?a.async("base64").then(function(f){return new WorldWind.KmlFile(f).then(function(o){i._fileCache.add("href;"+a.name,o)})}):a.async("base64").then(function(f){var o="data:image/jpeg;base64,"+f;i._fileCache.add("href;"+a.name,o)})}))}).then(function(){return t})},e.prototype.hasExtension=function(i,t){return n.endsWith(t,"."+i)},e}),B("formats/kml/util/KmlRefreshListener",[],function(){var p=function(){this.currentActiveEvents=[]};return p.prototype.addEvent=function(l){var n=this;setTimeout(function(){n.currentActiveEvents.push(l)},l.time)},p.prototype.getActiveEvents=function(){var l=this.currentActiveEvents.slice();return this.currentActiveEvents=[],l},p.Event=function(l,n,e){this.type=l,this.payload=e,this.time=n},p}),B("formats/kml/util/KmlRemoteFile",["../../../error/ArgumentError","../../../util/Logger","../../../util/Promise"],function(p,l,n){"use strict";var e=function(i){if(!i.ajax&&!i.zip)throw new p(l.logMessage(l.LEVEL_SEVERE,"RemoteDocument","constructor","Invalid option for retrieval specified. Use either ajax or zip option."));this.options=i};return e.prototype.get=function(){var i=this.options;if(i.ajax)return this.ajax(i.url,i);if(i.zip)return i.responseType=i.responseType||"arraybuffer",this.ajax(i.url,i);throw new p(l.logMessage(l.LEVEL_SEVERE,"RemoteDocument","constructor","Invalid option for retrieval specified. Use either ajax or zip option."))},e.prototype.ajax=function(i,t){return new n(function(r,s){var a=new XMLHttpRequest;a.open("GET",i,!0),t.responseType&&(a.responseType=t.responseType),a.onreadystatechange=function(){if(a.readyState===4)if(a.status===200){var f;t.responseType=="arraybuffer"?f=this.response:f=this.responseText,r({text:f,headers:a.getAllResponseHeaders()})}else l.log(l.LEVEL_WARNING,"KmlFile retrieval failed ("+a.statusText+"): "+i)},a.onerror=(function(){l.log(l.LEVEL_WARNING,"Remote file retrieval failed: "+i),s()}).bind(this),a.ontimeout=(function(){l.log(l.LEVEL_WARNING,"Remote file retrieval timed out: "+i),s()}).bind(this),a.send(null)})},e}),B("formats/kml/util/KmlStyleResolver",["../KmlFile","../styles/KmlStyle","../../../util/Logger","../../../util/Promise"],function(p,l,n,e){"use strict";var i=function(t){this._fileCache=t};return i.prototype.handleRemoteStyle=function(t,r){return t?this.handleStyleUrl(t):r?this.handleStyleSelector(r):(n.logMessage(n.LEVEL_INFO,"KmlStyleResolver","handleRemoteStyle","Style was null."),e.resolve(l.default()))},i.prototype.handleStyleUrl=function(t){var r=this;return this.handlePromiseOfFile(t).then(function(s){return s.resolveStyle(t)}).then(function(s){return s.isMap?s.resolve(r):e.resolve({normal:s,highlight:null})})},i.prototype.handlePromiseOfFile=function(t){var r=this._fileCache.retrieve(t);return r?e.resolve(r):new WorldWind.KmlFile({url:t}).then((function(s){return this._fileCache.add(t,s),s}).bind(this))},i.prototype.handleStyleSelector=function(t){return t.isMap?t.resolve(this):new e(function(r){window.setTimeout(function(){r({normal:t,highlight:null})},0)})},i}),B("util/XmlDocument",["../error/ArgumentError","../util/Logger"],function(p,l){var n=function(e){this._document=e};return n.prototype.dom=function(){if(DOMParser){var e=new DOMParser,i=e.parseFromString(this._document,"text/xml");if(i.getElementsByTagName("parsererror").length||!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"XmlDocument","dom","Invalid XML document. "+i.getElementsByTagName("parsererror")[0].innerHTML));return i}else{var t=new ActiveXObject("Microsoft.XMLDOM");return t.async=!1,t.loadXML(text),t}},n.isValid=function(e){try{return new n(e).dom(),!0}catch(i){return!1}},n}),B("formats/kml/KmlFile",["../../error/ArgumentError","./KmlElements","./KmlFileCache","./KmlObject","./styles/KmlStyle","./styles/KmlStyleMap","./KmlTimeSpan","./KmlTimeStamp","./KmzFile","../../util/Logger","../../util/Promise","./util/KmlRefreshListener","./util/KmlRemoteFile","./util/KmlStyleResolver","../../util/XmlDocument","../../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m){"use strict";var g=function(_,y){var v=this;if(!_)throw new p(f.logMessage(f.LEVEL_SEVERE,"KmlFile","constructor","invalidDocumentPassed"));return this._controls=y||null,this._fileCache=new n,this._styleResolver=new h(this._fileCache),this._listener=new c,this._headers=null,this.requestRemote(_).then(function(b){var R=b.text;if(v._headers=b.headers,v.hasExtension("kmz",_)){var M=new a(R,v._fileCache);return M.load()}else return R}).then(function(b){return v._document=new u(b).dom(),e.call(v,{objectNode:v._document.documentElement,controls:y}),v._fileCache.add(_,v,!0),v})};return g.prototype=Object.create(e.prototype),Object.defineProperties(g.prototype,{shapes:{get:function(){return this._factory.all(this)}}}),g.prototype.render=function(_,y){var v=this;y=y||{},this.shapes.forEach(function(b){b.render(_,{lastStyle:y.lastStyle||null,lastVisibility:y.lastVisibility||null,currentTimeInterval:y.currentTimeInterval||null,regionInvisible:y.regionInvisible||null,fileCache:v._fileCache,styleResolver:v._styleResolver,listener:v._listener,activeEvents:v._listener.getActiveEvents()})})},g.prototype.hasExtension=function(_,y){return m.endsWith(y,"."+_)},g.prototype.requestRemote=function(_){var y={};return y.url=_,this.hasExtension("kmz",_)?y.zip=!0:y.ajax=!0,new d(y).get()},g.prototype.resolveStyle=function(_){var y=this,v=_.substring(_.indexOf("#")+1,_.length);return new o(function(b,R){var M;y._document.querySelector?M=y._document.querySelector("*[id='"+v+"']"):M=y._document.getElementById(v),(!M||M==null)&&R(),M.nodeName==i.prototype.getTagNames()[0]?b(new i({objectNode:M},{styleResolver:y._styleResolver})):M.nodeName==t.prototype.getTagNames()[0]?b(new t({objectNode:M},{styleResolver:y._styleResolver})):f.logMessage(f.LEVEL_WARNING,"KmlFile","resolveStyle","Style must contain either Style node or StyleMap node.")})},g.prototype.getExpired=function(){var _=new Date(this._headers.getRequestHeader("Expires")),y=new Date;return y.getTime-_.getTime()},g}),B("formats/kml/KmlLatLonAltBox",["./KmlElements","./KmlObject","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlNorth:{get:function(){return this._factory.specific(this,{name:"north",transformer:n.number})}},kmlSouth:{get:function(){return this._factory.specific(this,{name:"south",transformer:n.number})}},kmlEast:{get:function(){return this._factory.specific(this,{name:"east",transformer:n.number})}},kmlWest:{get:function(){return this._factory.specific(this,{name:"west",transformer:n.number})}},kmlMinAltitude:{get:function(){return this._factory.specific(this,{name:"minAltitude",transformer:n.number})}},kmlMaxAltitude:{get:function(){return this._factory.specific(this,{name:"maxAltitude",transformer:n.number})}}}),e.prototype.getTagNames=function(){return["LatLonAltBox"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/KmlLod",["./KmlElements","./KmlObject","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlMinLodPixels:{get:function(){return this._factory.specific(this,{name:"minLodPixels",transformer:n.number})}},kmlMaxLodPixels:{get:function(){return this._factory.specific(this,{name:"maxLodPixels",transformer:n.number})}},kmlMinFadeExtent:{get:function(){return this._factory.specific(this,{name:"minFadeExtent",transformer:n.number})}},kmlMaxFadeExtent:{get:function(){return this._factory.specific(this,{name:"maxFadeExtent",transformer:n.number})}}}),e.prototype.getTagNames=function(){return["Lod"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/KmlRegion",["../../geom/BoundingBox","../../util/Color","./KmlElements","./KmlLatLonAltBox","./KmlLod","./KmlObject","./styles/KmlStyle","./util/KmlNodeTransformers","../../geom/Sector"],function(p,l,n,e,i,t,r,s,a){"use strict";var f=function(o){t.call(this,o)};return f.prototype=Object.create(t.prototype),Object.defineProperties(f.prototype,{kmlLatLonAltBox:{get:function(){return this._factory.specific(this,{name:e.prototype.getTagNames(),transformer:s.kmlObject})}},kmlLod:{get:function(){return this._factory.specific(this,{name:i.prototype.getTagNames(),transformer:s.kmlObject})}}}),f.prototype.intersectsVisible=function(o){var c=this.kmlLatLonAltBox,d=new p;return d.setToSector(new a(c.kmlSouth,c.kmlNorth,c.kmlWest,c.kmlEast),o.globe,c.kmlMinAltitude,c.kmlMaxAltitude),d.intersectsFrustum(o.frustumInModelCoordinates)&&(!c.kmlMinAltitude||o.eyePosition.altitude>c.kmlMinAltitude)&&(!c.kmlMaxAltitude||o.eyePosition.altitude<c.kmlMaxAltitude)},f.prototype.getTagNames=function(){return["Region"]},n.addKey(f.prototype.getTagNames()[0],f),f}),B("formats/kml/features/KmlFeature",["./../KmlObject","../KmlAbstractView","../KmlFile","../styles/KmlStyleMap","../styles/KmlStyleSelector","../KmlRegion","../KmlTimePrimitive","../util/KmlNodeTransformers","../../../util/Promise"],function(p,l,n,e,i,t,r,s,a){"use strict";var f=function(o){this.isFeature=o.isFeature=!0,p.call(this,o),this._pStyle=null,this.controlledVisibility=null};return f.prototype=Object.create(p.prototype),Object.defineProperties(f.prototype,{style:{get:function(){return this._pStyle}},kmlName:{get:function(){return this._factory.specific(this,{name:"name",transformer:s.string})}},kmlVisibility:{get:function(){return this._factory.specific(this,{name:"visibility",transformer:s.boolean})}},kmlOpen:{get:function(){return this._factory.specific(this,{name:"open",transformer:s.boolean})}},kmlAddress:{get:function(){return this._factory.specific(this,{name:"address",transformer:s.string})}},kmlPhoneNumber:{get:function(){return this._factory.specific(this,{name:"phoneNumber",transformer:s.string})}},kmlDescription:{get:function(){return this._factory.specific(this,{name:"description",transformer:s.string})}},kmlStyleUrl:{get:function(){return this._factory.specific(this,{name:"styleUrl",transformer:s.string})}},kmlSnippet:{get:function(){return this._factory.specific(this,{name:"Snippet",transformer:s.string})}},kmlAbstractView:{get:function(){return this._factory.any(this,{name:l.prototype.getTagNames()})}},kmlTimePrimitive:{get:function(){return this._factory.any(this,{name:r.prototype.getTagNames()})}},kmlStyleSelector:{get:function(){return this._factory.any(this,{name:i.prototype.getTagNames()})}},kmlRegion:{get:function(){return this._factory.any(this,{name:t.prototype.getTagNames()})}}}),f.prototype.render=function(o,c){p.prototype.render.call(this,o,c),this.solveStyle(o,c),this.solveVisibility(o,c)},f.prototype.solveStyle=function(o,c){this.getStyle(o,c),this.style!=null&&(c.lastStyle=this.style)},f.prototype.solveRegion=function(o){return this.kmlRegion?this.kmlRegion.intersectsVisible(o):!0},f.prototype.solveVisibility=function(o,c){var d=c.lastVisibility!==!1,h=this.solveTimeVisibility(o),u=this.solveRegion(o),m=this.kmlVisibility!==!1;this.controlledVisibility===!0?this.enabled=!0:this.controlledVisibility===!1?this.enabled=!1:this.enabled=d&&h&&u&&m,c.lastVisibility=this.enabled,this._renderable&&(this._renderable.enabled=this.enabled)},f.prototype.solveTimeVisibility=function(o){var c=this.kmlTimePrimitive&&this.kmlTimePrimitive.timeRange();if(o.currentLayer.currentTimeInterval&&c){var d=o.currentLayer.currentTimeInterval[0],h=o.currentLayer.currentTimeInterval[1];if(c&&(c.from<d||c.from>h||c.to>h))return!1}return!0},f.prototype.getStyle=function(o,c){if(!this._pStyle){var d=this;return c.styleResolver.handleRemoteStyle(d.kmlStyleUrl,d.kmlStyleSelector).then(function(h){d._pStyle=h,o.redrawRequested=!0})}},f.prototype.getTagNames=function(){return["NetworkLink","Placemark","PhotoOverlay","ScreenOverlay","GroundOverlay","Folder","Document"]},f}),B("formats/kml/features/KmlContainer",["./KmlFeature"],function(p){"use strict";var l=function(n){p.call(this,n)};return l.prototype=Object.create(p.prototype),Object.defineProperties(l.prototype,{kmlShapes:{get:function(){var n=this._factory.all(this);return n.filter(function(e){return e.isFeature})}}}),l.prototype.render=function(n,e){p.prototype.render.call(this,n,e);var i=this;this.kmlShapes.forEach(function(t){t.render(n,{lastStyle:e.lastStyle,lastVisibility:i.enabled,currentTimeInterval:e.currentTimeInterval,regionInvisible:e.regionInvisible,fileCache:e.fileCache,styleResolver:e.styleResolver,listener:e.listener,activeEvents:e.activeEvents})})},l.prototype.getTagNames=function(){return["Folder","Document"]},l}),B("formats/kml/controls/KmlControls",["../../../util/Logger"],function(p){"use strict";var l=function(){};return l.prototype.hook=function(){p.logMessage(p.LEVEL_WARNING,"KmlControls","hook","Every KML controls should override hook method.")},l}),B("formats/kml/util/KmlCreate",["../KmlElements","../KmlObject"],function(p,l){var n=function(e){l.call(this,e)};return n.prototype=Object.create(l.prototype),Object.defineProperties(n.prototype,{shapes:{get:function(){return this._factory.all(this)}}}),n.prototype.getTagNames=function(){return["Create"]},p.addKey(n.prototype.getTagNames()[0],n),n}),B("formats/kml/util/KmlDelete",["../KmlElements","../KmlObject"],function(p,l){var n=function(e){l.call(this,e)};return n.prototype=Object.create(l.prototype),Object.defineProperties(n.prototype,{shapes:{get:function(){return this._factory.all(this)}}}),n.prototype.getTagNames=function(){return["Delete"]},p.addKey(n.prototype.getTagNames()[0],n),n}),B("formats/kml/util/KmlSchema",["./../KmlElements","../KmlObject"],function(p,l){"use strict";var n=function(e){l.call(this,e)};return n.prototype=Object.create(l.prototype),n.prototype.getTagNames=function(){return["Schema"]},p.addKey(n.prototype.getTagNames()[0],n),n}),B("formats/kml/features/KmlDocument",["./KmlContainer","../KmlElements","./KmlFeature","../util/KmlSchema"],function(p,l,n,e){"use strict";var i=function(t){p.call(this,t)};return i.prototype=Object.create(p.prototype),Object.defineProperties(i.prototype,{kmlSchemas:{get:function(){var t=this._factory.all(this);return t.filter(function(r){return r instanceof e})}}}),i.prototype.getTagNames=function(){return["Document"]},l.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/features/KmlFolder",["./KmlContainer","./../KmlElements"],function(p,l){"use strict";var n=function(e){p.call(this,e)};return n.prototype=Object.create(p.prototype),n.prototype.getTagNames=function(){return["Folder"]},l.addKey(n.prototype.getTagNames()[0],n),n}),B("formats/kml/geom/KmlGeometry",["../KmlObject"],function(p){"use strict";var l=function(n){p.call(this,n),this._renderable=null};return l.prototype=Object.create(p.prototype),l.prototype.render=function(n,e){p.prototype.render.call(this,n,e),this.enabled=e.lastVisibility},l.prototype.getTagNames=l.getTagNames=function(){return["Point","LinearRing","LineString","MultiGeometry","Polygon"]},l}),B("formats/kml/KmlLatLonBox",["./KmlElements","./KmlObject","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlNorth:{get:function(){return this._factory.specific(this,{name:"north",transformer:n.number})}},kmlSouth:{get:function(){return this._factory.specific(this,{name:"south",transformer:n.number})}},kmlEast:{get:function(){return this._factory.specific(this,{name:"east",transformer:n.number})}},kmlWest:{get:function(){return this._factory.specific(this,{name:"west",transformer:n.number})}},kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:n.string})}}}),e.prototype.getTagNames=function(){return["LatLonBox"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/KmlLatLonQuad",["./KmlElements","./KmlObject","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlCoordinates:{get:function(){return this._factory.specific(this,{name:"coordinates",transformer:n.string})}}}),e.prototype.getTagNames=function(){return["gx:LatLonQuad"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/features/KmlOverlay",["./KmlFeature","./../KmlIcon","../util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){p.call(this,i)};return e.prototype=Object.create(p.prototype),Object.defineProperties(e.prototype,{kmlColor:{get:function(){return this._factory.specific(this,{name:"color",transformer:n.string})}},kmlDrawOrder:{get:function(){return this._factory.specific(this,{name:"drawOrder",transformer:n.string})}},kmlIcon:{get:function(){return this._factory.any(this,{name:l.prototype.getTagNames()})}}}),e.prototype.getTagNames=function(){return["PhotoOverlay","ScreenOverlay","GroundOverlay"]},e}),B("formats/kml/features/KmlGroundOverlay",["./../KmlElements","./KmlFeature","../KmlLatLonBox","../KmlLatLonQuad","./KmlOverlay","../util/KmlNodeTransformers","../../../geom/Sector","../../../shapes/SurfaceImage"],function(p,l,n,e,i,t,r,s){"use strict";var a=function(f){this.isGroundOverlay=!0,i.call(this,f)};return a.prototype=Object.create(i.prototype),Object.defineProperties(a.prototype,{kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:t.string})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:t.string})}},kmlLatLonBox:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}},kmlLatLonQuad:{get:function(){return this._factory.any(this,{name:e.prototype.getTagNames()})}}}),a.prototype.render=function(f,o){l.prototype.render.call(this,f,o),!this._renderable&&this.enabled&&this.kmlIcon&&this.kmlLatLonBox&&(this._renderable=new s(new r(this.kmlLatLonBox.kmlSouth,this.kmlLatLonBox.kmlNorth,this.kmlLatLonBox.kmlWest,this.kmlLatLonBox.kmlEast),this.kmlIcon.kmlHref(o.fileCache)),f.redrawRequested=!0),this._renderable&&this._renderable.render(f)},a.prototype.getTagNames=function(){return["GroundOverlay"]},p.addKey(a.prototype.getTagNames()[0],a),a}),B("formats/kml/util/KmlImagePyramid",["../KmlElements","../KmlObject","../util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlTileSize:{get:function(){return this._factory.specific(this,{name:"tileSize",transformer:n.number})}},kmlMaxWidth:{get:function(){return this._factory.specific(this,{name:"maxWidth",transformer:n.number})}},kmlMaxHeight:{get:function(){return this._factory.specific(this,{name:"maxHeight",transformer:n.number})}},kmlGridOrigin:{get:function(){return this._factory.specific(this,{name:"gridOrigin",transformer:n.string})}}}),e.prototype.getTagNames=function(){return["ImagePyramid"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("shapes/Path",["../shapes/AbstractShape","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolyline","../geom/Vec2","../geom/Vec3"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h){"use strict";var u=function(m,g){if(!m)throw new l(r.logMessage(r.LEVEL_SEVERE,"Path","constructor","missingPositions"));p.call(this,g),this._positions=m,this._pathType=WorldWind.GREAT_CIRCLE,this._terrainConformance=10,this._numSubSegments=10,this.referencePosition=this.determineReferencePosition(this._positions),this.scratchPoint=new h(0,0,0)};return u.prototype=Object.create(p.prototype),Object.defineProperties(u.prototype,{positions:{get:function(){return this._positions},set:function(m){if(!m)throw new l(r.logMessage(r.LEVEL_SEVERE,"Path","constructor","missingPositions"));this._positions=m,this.referencePosition=this.determineReferencePosition(this._positions),this.reset()}},followTerrain:{get:function(){return this._followTerrain},set:function(m){this._followTerrain=m,this.reset()}},terrainConformance:{get:function(){return this._terrainConformance},set:function(m){this._terrainConformance=m,this.reset()}},numSubSegments:{get:function(){return this._numSubSegments},set:function(m){this._numSubSegments=m>=0?m:0,this.reset()}},pathType:{get:function(){return this._pathType},set:function(m){this._pathType=m,this.reset()}},extrude:{get:function(){return this._extrude},set:function(m){this._extrude=m,this.reset()}}}),u.prototype.determineReferencePosition=function(m){return m.length>0?m[0]:null},u.prototype.mustGenerateGeometry=function(m){return!this.currentData.tessellatedPoints||this.currentData.drawInterior!==this.activeAttributes.drawInterior||this.currentData.drawVerticals!==this.activeAttributes.drawVerticals||!this.followTerrain&&this.currentData.numSubSegments!==this.numSubSegments||this.followTerrain&&this.currentData.terrainConformance!==this.terrainConformance?!0:this.altitudeMode===WorldWind.ABSOLUTE?!1:this.currentData.isExpired},u.prototype.createSurfaceShape=function(){return new c(this.positions,null)},u.prototype.doMakeOrderedRenderable=function(m){if(!this.referencePosition)return null;if(!this.mustGenerateGeometry(m))return this;var g=this.currentData.referencePoint;m.surfacePointForMode(this.referencePosition.latitude,this.referencePosition.longitude,this.referencePosition.altitude,this._altitudeMode,g),this.currentData.transformationMatrix.setToTranslation(g[0],g[1],g[2]);var _=this.makeTessellatedPositions(m);if(_.length<2)return null;var y=this.computeRenderedPath(m,_);return this.currentData.tessellatedPoints=y,this.currentData.drawInterior=this.activeAttributes.drawInterior,this.currentData.drawVerticals=this.activeAttributes.drawVerticals,this.currentData.numSubSegments=this.numSubSegments,this.currentData.terrainConformance=this.terrainConformance,this.resetExpiration(this.currentData),this.currentData.fillVbo=!0,this.currentData.extent||(this.currentData.extent=new e),this.currentData.extent.setToPoints(y),this.currentData.extent.translate(this.currentData.referencePoint),this},u.prototype.makeTessellatedPositions=function(m){var g=[],_=m.eyePoint,y=this.mustDrawVerticals(m),v=new h(0,0,0),b=new h(0,0,0),R=this._positions[0],M,P,T;y&&(this.currentData.verticalIndices=new Int16Array(this.positions.length*2),this.currentData.verticalIndices[0]=0,this.currentData.verticalIndices[1]=1),g.push(R),m.surfacePointForMode(R.latitude,R.longitude,R.altitude,this._altitudeMode,v);for(var E=1,x=this._positions.length;E<x;E++)if(M=this._positions[E],m.surfacePointForMode(M.latitude,M.longitude,M.altitude,this._altitudeMode,b),P=_.distanceTo(v),T=m.pixelSizeAtDistance(P),v.distanceTo(b)<T*8&&this.altitudeMode!==WorldWind.ABSOLUTE?g.push(M):this.makeSegment(m,R,M,v,b,g),R=M,v.copy(b),y){var S=2*(g.length-1);this.currentData.verticalIndices[E*2]=S,this.currentData.verticalIndices[E*2+1]=S+1}return g},u.prototype.makeSegment=function(m,g,_,y,v,b){var R=m.eyePoint,M=new t(0,0),P=0,T,E,x,S,L,C;if(this._pathType===WorldWind.LINEAR&&!this._followTerrain){y.equals(v)||b.push(_);return}if(this._pathType===WorldWind.LINEAR?x=t.linearDistance(g,_):this._pathType===WorldWind.RHUMB_LINE?x=t.rhumbDistance(g,_):x=t.greatCircleDistance(g,_),this._altitudeMode!==WorldWind.CLAMP_TO_GROUND&&(P=.5*(g.altitude+_.altitude)),T=x*(m.globe.equatorialRadius+P*m.verticalExaggeration),!(T<=0)){for(this._pathType===WorldWind.LINEAR?E=t.linearAzimuth(g,_):this._pathType===WorldWind.RHUMB_LINE?E=t.rhumbAzimuth(g,_):E=t.greatCircleAzimuth(g,_),this.scratchPoint.copy(y),S=0,L=0;S<1&&(this._followTerrain?L+=this._terrainConformance*m.pixelSizeAtDistance(this.scratchPoint.distanceTo(R)):L+=T/this._numSubSegments,!(T<L||T-L<1e-9));)S=L/T,C=S*x,this._pathType===WorldWind.LINEAR?t.linearLocation(g,E,C,M):this._pathType===WorldWind.RHUMB_LINE?t.rhumbLocation(g,E,C,M):t.greatCircleLocation(g,E,C,M),M.altitude=(1-S)*g.altitude+S*_.altitude,b.push(new f(M.latitude,M.longitude,M.altitude)),this._followTerrain&&m.surfacePointForMode(M.latitude,M.longitude,M.altitude,WorldWind.CLAMP_TO_GROUND,this.scratchPoint);b.push(_)}},u.prototype.computeRenderedPath=function(m,g){var _=this.mustDrawInterior(m)||this.mustDrawVerticals(m),y=Number.MAX_VALUE,v=m.eyePoint,b=(_?2:1)*g.length,R=new Float32Array(b*3),M=_?6:3,P=new h(0,0,0),T,E,x,S;this._followTerrain&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND?T=WorldWind.RELATIVE_TO_GROUND:T=this.altitudeMode;for(var L=0,C=g.length;L<C;L++)E=g[L],m.surfacePointForMode(E.latitude,E.longitude,E.altitude,T,P),S=P.distanceToSquared(v),S<y&&(y=S),P.subtract(this.currentData.referencePoint),x=M*L,R[x]=P[0],R[x+1]=P[1],R[x+2]=P[2],_&&(m.surfacePointForMode(E.latitude,E.longitude,0,WorldWind.CLAMP_TO_GROUND,P),S=P.distanceToSquared(v),S<y&&(y=S),P.subtract(this.currentData.referencePoint),R[x+3]=P[0],R[x+4]=P[1],R[x+5]=P[2]);return this.currentData.pointBufferHasExtrusionPoints=_,this.currentData.eyeDistance=Math.sqrt(y),R},u.prototype.mustDrawInterior=function(m){return this.activeAttributes.drawInterior&&this._extrude&&this._altitudeMode!==WorldWind.CLAMP_TO_GROUND},u.prototype.mustDrawVerticals=function(m){return this.activeAttributes.drawOutline&&this.activeAttributes.drawVerticals&&this.altitudeMode!==WorldWind.CLAMP_TO_GROUND},u.prototype.doRenderOrdered=function(m){var g=m.currentGlContext,_=m.currentProgram,y=this.currentData,v=y.tessellatedPoints.length/3,b,R,M,P,T;if(this.applyMvpMatrix(m),y.vboCacheKey||(y.vboCacheKey=m.gpuResourceCache.generateCacheKey()),b=m.gpuResourceCache.resourceForKey(y.vboCacheKey),b||(b=g.createBuffer(),m.gpuResourceCache.putResource(this.currentData.vboCacheKey,b,y.tessellatedPoints.length*4),y.fillVbo=!0),g.bindBuffer(g.ARRAY_BUFFER,b),y.fillVbo&&(g.bufferData(g.ARRAY_BUFFER,y.tessellatedPoints,g.STATIC_DRAW),m.frameStatistics.incrementVboLoadCount(1)),_.loadTextureEnabled(g,!1),m.pickingMode&&(M=m.uniquePickColor()),this.mustDrawInterior(m)&&(R=this.activeAttributes.interiorColor,g.depthMask(R.alpha*this.layer.opacity>=1||m.pickingMode),_.loadColor(g,m.pickingMode?M:R),_.loadOpacity(g,m.pickingMode?1:this.layer.opacity),g.vertexAttribPointer(_.vertexPointLocation,3,g.FLOAT,!1,0,0),g.drawArrays(g.TRIANGLE_STRIP,0,v)),this.activeAttributes.drawOutline&&((this.mustDrawVerticals(m)&&this.mustDrawInterior(m)||this.altitudeMode===WorldWind.CLAMP_TO_GROUND)&&this.applyMvpMatrixForOutline(m),R=this.activeAttributes.outlineColor,g.depthMask(R.alpha*this.layer.opacity>=1||m.pickingMode),_.loadColor(g,m.pickingMode?M:R),_.loadOpacity(g,m.pickingMode?1:this.layer.opacity),g.lineWidth(this.activeAttributes.outlineWidth),this.currentData.pointBufferHasExtrusionPoints?(P=24,T=v/2):(P=12,T=v),g.vertexAttribPointer(_.vertexPointLocation,3,g.FLOAT,!1,P,0),g.drawArrays(g.LINE_STRIP,0,T),this.mustDrawVerticals(m)&&(y.verticalIndicesVboCacheKey||(y.verticalIndicesVboCacheKey=m.gpuResourceCache.generateCacheKey()),b=m.gpuResourceCache.resourceForKey(y.verticalIndicesVboCacheKey),b||(b=g.createBuffer(),m.gpuResourceCache.putResource(y.verticalIndicesVboCacheKey,b,y.verticalIndices.length*4),y.fillVbo=!0),g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,b),y.fillVbo&&(g.bufferData(g.ELEMENT_ARRAY_BUFFER,y.verticalIndices,g.STATIC_DRAW),m.frameStatistics.incrementVboLoadCount(1)),g.vertexAttribPointer(_.vertexPointLocation,3,g.FLOAT,!1,0,0),g.drawElements(g.LINES,y.verticalIndices.length,g.UNSIGNED_SHORT,0))),y.fillVbo=!1,m.pickingMode){var E=new a(M,this.pickDelegate?this.pickDelegate:this,null,this.layer,!1);m.resolvePick(E)}},u.prototype.beginDrawing=function(m){var g=m.currentGlContext;this.mustDrawInterior(m)&&g.disable(g.CULL_FACE),m.findAndBindProgram(n),g.enableVertexAttribArray(m.currentProgram.vertexPointLocation)},u.prototype.endDrawing=function(m){var g=m.currentGlContext;g.disableVertexAttribArray(m.currentProgram.vertexPointLocation),g.depthMask(!0),g.lineWidth(1),g.enable(g.CULL_FACE)},u}),B("formats/kml/geom/KmlLineString",["../../../util/Color","../KmlElements","./KmlGeometry","../styles/KmlStyle","../../../geom/Location","../util/KmlNodeTransformers","../../../shapes/Path","../../../geom/Position","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolyline","../../../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o){"use strict";var c=function(d){n.call(this,d),this._style=null};return c.prototype=Object.create(n.prototype),Object.defineProperties(c.prototype,{kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:t.boolean})||!1}},kmlTessellate:{get:function(){return this._factory.specific(this,{name:"tessellate",transformer:t.boolean})||!1}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:t.string})||WorldWind.ABSOLUTE}},kmlPositions:{get:function(){return this._factory.specific(this,{name:"coordinates",transformer:t.positions})}},kmlCenter:{get:function(){var d=this.kmlPositions,h=0,u=0,m=0;return d.forEach(function(g){h+=g.latitude,u+=g.longitude,m+=g.altitude}),new s(h/this.kmlPositions.length,u/this.kmlPositions.length,m/this.kmlPositions.length)}}}),c.prototype.createPath=function(d,h){this.kmlAltitudeMode==WorldWind.CLAMP_TO_GROUND?this._renderable=new f(this.prepareLocations(),this.prepareAttributes(d.normal,h)):this._renderable=new r(this.prepareLocations(),this.prepareAttributes(d.normal,h)),d.highlight&&(this._renderable.highlightAttributes=this.prepareAttributes(d.highlight,h)),this.moveValidProperties()},c.prototype.render=function(d,h){n.prototype.render.call(this,d,h),h.lastStyle&&!this._renderable&&(this.createPath(h.lastStyle,h.fileCache),d.redrawRequested=!0),this._renderable&&(this._renderable.enabled=this.enabled,this._renderable.render(d))},c.prototype.prepareAttributes=function(d,h){var u=d&&d.generate(h)||{};return u._applyLighting=!0,u._drawOutline=!0,u._drawInterior=!0,u._drawVerticals=this.kmlExtrude||!1,u._outlineStippleFactor=0,u._outlineStipplePattern=61680,u._enableLighting=!0,new a(e.shapeAttributes(u))},c.prototype.prepareLocations=function(){return this.kmlPositions},c.prototype.moveValidProperties=function(){this._renderable.extrude=this.kmlExtrude||!1,this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.ABSOLUTE,this._renderable.tesselate=this.kmlTesselate||!1},c.prototype.equals=function(d){if(!d)return!1;var h=o.arrayEquals(d.kmlPositions,this.kmlPositions);return h&&d.kmlExtrude==this.kmlExtrude&&d.kmlTessellate==this.kmlTessellate&&d.kmlAltitudeMode==this.kmlAltitudeMode},c.prototype.getTagNames=function(){return["LineString"]},l.addKey(c.prototype.getTagNames()[0],c),c}),B("formats/kml/geom/KmlLinearRing",["./KmlLineString","../KmlElements"],function(p,l){"use strict";var n=function(e){p.call(this,e)};return n.prototype=Object.create(p.prototype),n.prototype.getTagNames=function(){return["LinearRing"]},l.addKey(n.prototype.getTagNames()[0],n),n}),B("formats/kml/KmlLocation",["./KmlElements","./KmlObject","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:n.string})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:n.string})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:n.string})}}}),e.prototype.getTagNames=function(){return["Location"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/KmlLookAt",["./KmlAbstractView","./KmlElements","./util/KmlNodeTransformers","../../geom/Position"],function(p,l,n,e){"use strict";var i=function(t){p.call(this,t)};return i.prototype=Object.create(p.prototype),Object.defineProperties(i.prototype,{kmlLongitude:{get:function(){return this._factory.specific(this,{name:"longitude",transformer:n.number})}},kmlLatitude:{get:function(){return this._factory.specific(this,{name:"latitude",transformer:n.number})}},kmlAltitude:{get:function(){return this._factory.specific(this,{name:"altitude",transformer:n.number})}},kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:n.number})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:n.number})}},kmlRange:{get:function(){return this._factory.specific(this,{name:"range",transformer:n.number})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:n.string})}}}),i.prototype.update=function(t){if(t.wwd){var r=this.kmlAltitude||4e3;t.wwd.goTo(new e(this.kmlLatitude,this.kmlLongitude,r))}},i.prototype.getTagNames=function(){return["LookAt"]},l.addKey(i.prototype.getTagNames()[0],i),i}),B("formats/kml/geom/KmlMultiGeometry",["./../KmlElements","./KmlGeometry","../../../geom/Position"],function(p,l,n){"use strict";var e=function(i){l.call(this,i),this._style=i.style};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlShapes:{get:function(){return this._factory.all(this)}},kmlCenter:{get:function(){var i=this.kmlShapes.map(function(a){return a.kmlCenter}),t=0,r=0,s=0;return i.forEach(function(a){t+=a.latitude,r+=a.longitude,s+=a.altitude}),new n(t/i.length,r/i.length,s/i.length)}}}),e.prototype.render=function(i,t){l.prototype.render.call(this,i,t),this.kmlShapes.forEach(function(r){r.render(i,t)})},e.prototype.getTagNames=function(){return["MultiGeometry"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/geom/KmlMultiTrack",["./../KmlElements","./KmlGeometry"],function(p,l){"use strict";var n=function(e){l.call(this,e)};return n.prototype=Object.create(l.prototype),n.prototype.getTagNames=function(){return["gx:MultiTrack"]},p.addKey(n.prototype.getTagNames()[0],n),n}),B("formats/kml/features/KmlNetworkLink",["./../KmlElements","./KmlFeature","../KmlFile","../KmlLink","../util/KmlNodeTransformers","../util/KmlRefreshListener"],function(p,l,n,e,i,t){"use strict";var r="refreshNetworkLinkEvent",s=function(a){l.call(this,a),this.isFeature=!0,this.resolvedFile=null,this.displayed=!1,this.isDownloading=!1};return s.prototype=Object.create(l.prototype),Object.defineProperties(s.prototype,{kmlRefreshVisibility:{get:function(){return this._factory.specific(this,{name:"refreshVisibility",transformer:i.boolean})}},kmlFlyToView:{get:function(){return this._factory.specific(this,{name:"flyToView",transformer:i.boolean})}},kmlLink:{get:function(){return this._factory.any(this,{name:e.prototype.getTagNames()})}}}),s.prototype.getTagNames=function(){return["NetworkLink"]},s.prototype.render=function(a,f){if(l.prototype.render.call(this,a,f),!(!f.lastVisibility&&!this.displayed)){if(!this.isDownloading&&!this.resolvedFile){this.isDownloading=!0;var o=this;new n(o.buildUrl(f.fileCache)).then(function(c){o.resolvedFile=c,o.isDownloading=!1,o.fireEvent(f)})}this.resolvedFile&&!this.displayed&&(this.resolvedFile.render(a,f),this.handleRefresh(f))}},s.prototype.buildUrl=function(a){return this.kmlLink.kmlHref(a)},s.prototype.handleRefresh=function(a){var f=a.activeEvents;if(f=f.filter(function(c){return c.type==r}),f.length>0){var o=this;new n(o.buildUrl(a.fileCache)).then(function(c){o.resolvedFile=c,o.fireEvent(a)})}},s.prototype.fireEvent=function(a){var f=0;if(this.kmlLink.kmlRefreshMode=="onInterval")f=this.kmlLink.kmlRefreshInterval*1e3;else if(this.kmlLink.kmlRefreshMode=="onExpire")if(this.resolvedFile)f=this.resolvedFile.getExpired();else return;else return;a.listener.addEvent(new t.Event(r,f,null))},p.addKey(s.prototype.getTagNames()[0],s),s}),B("formats/kml/util/KmlUpdate",["./KmlChange","./KmlCreate","./KmlDelete","../KmlElements","../KmlObject","./KmlNodeTransformers"],function(p,l,n,e,i,t){var r=function(s){i.call(this,s)};return r.prototype=Object.create(i.prototype),Object.defineProperties(r.prototype,{targetHref:{get:function(){return this._factory.specific(this,{name:"minRefreshPeriod",transformer:t.number})}},Change:{get:function(){return this._factory.any(this,{name:p.prototype.getTagNames()})}},Create:{get:function(){return this._factory.any(this,{name:l.prototype.getTagNames()})}},Delete:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}}}),r.prototype.getTagNames=function(){return["Update"]},e.addKey(r.prototype.getTagNames()[0],r),r}),B("formats/kml/util/KmlNetworkLinkControl",["../KmlAbstractView","../KmlElements","../KmlObject","./KmlNodeTransformers","./KmlUpdate"],function(p,l,n,e,i){var t=function(r){n.call(this,r)};return t.prototype=Object.create(n.prototype),Object.defineProperties(t.prototype,{minRefreshPeriod:{get:function(){return this._factory.specific(this,{name:"minRefreshPeriod",transformer:e.number})}},maxSessionLength:{get:function(){return this._factory.specific(this,{name:"maxSessionLength",transformer:e.number})}},cookie:{get:function(){return this._factory.specific(this,{name:"cookie",transformer:e.string})}},message:{get:function(){return this._factory.specific(this,{name:"message",transformer:e.string})}},linkName:{get:function(){return this._factory.specific(this,{name:"linkName",transformer:e.string})}},linkDescription:{get:function(){return this._factory.specific(this,{name:"linkDescription",transformer:e.string})}},linkSnippet:{get:function(){return this._factory.specific(this,{name:"linkSnippet",transformer:e.string})}},expires:{get:function(){return this._factory.specific(this,{name:"expires",transformer:e.date})}},Update:{get:function(){return this._factory.any(this,{name:i.prototype.getTagNames()})}},AbstractView:{get:function(){return this._factory.any(this,{name:p.prototype.getTagNames()})}}}),t.prototype.getTagNames=function(){return["NetworkLinkControl"]},l.addKey(t.prototype.getTagNames()[0],t),t}),B("formats/kml/KmlOrientation",["./KmlElements","./KmlObject","./util/KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlHeading:{get:function(){return this._factory.specific(this,{name:"heading",transformer:n.number})}},kmlTilt:{get:function(){return this._factory.specific(this,{name:"tilt",transformer:n.number})}},kmlRoll:{get:function(){return this._factory.specific(this,{name:"roll",transformer:n.number})}}}),e.prototype.getTagNames=function(){return["Orientation"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/geom/KmlPoint",["../../../util/Color","../KmlElements","./KmlGeometry","../../../geom/Location","../util/KmlNodeTransformers","../../../shapes/Polygon","../../../geom/Position"],function(p,l,n,e,i,t,r){"use strict";var s=function(a){n.call(this,a),this._shape=null};return s.prototype=Object.create(n.prototype),Object.defineProperties(s.prototype,{kmlPosition:{get:function(){var a=this._factory.specific(this,{name:"coordinates",transformer:i.string}).split(",");return new r(a[1],a[0],a[2]||0)}},kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:i.boolean})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:i.string})}},kmlCenter:{get:function(){return this.kmlPosition}}}),s.prototype.getTagNames=function(){return["Point"]},l.addKey(s.prototype.getTagNames()[0],s),s}),B("formats/kml/util/KmlViewVolume",["../KmlElements","../KmlObject","./KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlLeftFov:{get:function(){return this._factory.specific(this,{name:"leftFov",transformer:n.number})}},kmlRightFov:{get:function(){return this._factory.specific(this,{name:"rightFov",transformer:n.number})}},kmlBottomFov:{get:function(){return this._factory.specific(this,{name:"bottomFov",transformer:n.number})}},kmlTopFov:{get:function(){return this._factory.specific(this,{name:"topFov",transformer:n.number})}},kmlNear:{get:function(){return this._factory.specific(this,{name:"near",transformer:n.string})}}}),e.prototype.getTagNames=function(){return["ViewVolume"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/features/KmlPhotoOverlay",["../util/KmlImagePyramid","./../KmlElements","./KmlOverlay","../geom/KmlPoint","../util/KmlNodeTransformers","../util/KmlViewVolume"],function(p,l,n,e,i,t){"use strict";var r=function(s){n.call(this,s)};return r.prototype=Object.create(n.prototype),Object.defineProperties(r.prototype,{kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:i.string})}},kmlShape:{get:function(){return this._factory.specific(this,{name:"shape",transformer:i.string})}},kmlPoint:{get:function(){return this._factory.any(this,{name:e.prototype.getTagNames()})}},kmlViewVolume:{get:function(){return this._factory.any(this,{name:t.prototype.getTagNames()})}},kmlImagePyramid:{get:function(){return this._factory.any(this,{name:p.prototype.getTagNames()})}}}),r.prototype.getTagNames=function(){return["PhotoOverlay"]},l.addKey(r.prototype.getTagNames[0],r),r}),B("formats/kml/features/KmlPlacemark",["./../KmlElements","./KmlFeature","../geom/KmlGeometry","../styles/KmlStyle","../KmlTimeSpan","../KmlTimeStamp","../../../shapes/PlacemarkAttributes","../../../shapes/Placemark","../../../util/Color","../../../shapes/ShapeAttributes","../../../shapes/TextAttributes","../../../util/Offset","../../../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o,c,d){"use strict";var h=function(u){l.call(this,u)};return h.prototype=Object.create(l.prototype),Object.defineProperties(h.prototype,{kmlGeometry:{get:function(){return this._factory.any(this,{name:n.prototype.getTagNames()})}}}),h.prototype.render=function(u,m){l.prototype.render.call(this,u,m),m=d.clone(m),m.lastStyle&&!this._renderable&&this.kmlGeometry&&(this._renderable=new s(this.kmlGeometry.kmlCenter,!1,this.prepareAttributes(m.lastStyle.normal,m.fileCache)),m.lastStyle.highlight&&(this._renderable.highlightAttributes=this.prepareAttributes(m.lastStyle.highlight,m.fileCache)),this.moveValidProperties(),u.redrawRequested=!0),this._renderable&&this.kmlGeometry&&(this.kmlGeometry.render(u,m),this._renderable.render(u))},h.prototype.prepareAttributes=function(u,m){var g=u&&u.generate({},m)||{normal:{},highlight:{}},_=new r(e.placemarkAttributes(g));return g._labelAttributes._offset=new c(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,1),_.imageOffset=new c(WorldWind.OFFSET_FRACTION,.3,WorldWind.OFFSET_FRACTION,0),_.imageColor=a.WHITE,_.labelAttributes=new o(e.textAttributes(g._labelAttributes)),_.drawLeaderLine=!0,_.leaderLineAttributes=new f(e.shapeAttributes({_outlineColor:a.RED})),_},h.prototype.moveValidProperties=function(){this._renderable.label=this.kmlName||"",this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.RELATIVE_TO_GROUND,this._renderable.enableLeaderLinePicking=!0},h.prototype.getTagNames=function(){return["Placemark"]},p.addKey(h.prototype.getTagNames()[0],h),h}),B("formats/kml/geom/KmlPolygon",["../../../util/Color","../KmlElements","./KmlGeometry","./KmlLinearRing","../styles/KmlStyle","../../../geom/Location","../util/KmlNodeTransformers","../../../shapes/Polygon","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolygon"],function(p,l,n,e,i,t,r,s,a,f){"use strict";var o=function(c){n.call(this,c),this.initialized=!1};return o.prototype=Object.create(n.prototype),Object.defineProperties(o.prototype,{kmlExtrude:{get:function(){return this._factory.specific(this,{name:"extrude",transformer:r.boolean})}},kmlTessellate:{get:function(){return this._factory.specific(this,{name:"tessellate",transformer:r.boolean})}},kmlAltitudeMode:{get:function(){return this._factory.specific(this,{name:"altitudeMode",transformer:r.string})}},kmlOuterBoundary:{get:function(){return this._factory.specific(this,{name:"outerBoundaryIs",transformer:r.linearRing})}},kmlInnerBoundary:{get:function(){return this._factory.specific(this,{name:"innerBoundaryIs",transformer:r.linearRing})}},kmlCenter:{get:function(){return this.kmlOuterBoundary.kmlCenter}}}),o.prototype.createPolygon=function(c,d){this.kmlAltitudeMode===WorldWind.CLAMP_TO_GROUND||this.kmlInnerBoundary&&this.kmlInnerBoundary.kmlAltitudeMode===WorldWind.CLAMP_TO_GROUND||this.kmlOuterBoundary&&this.kmlOuterBoundary.kmlAltitudeMode===WorldWind.CLAMP_TO_GROUND?this._renderable=new f(this.prepareLocations(),this.prepareAttributes(c.normal,d)):this._renderable=new s(this.prepareLocations(),this.prepareAttributes(c.normal,d)),c.highlight&&(this._renderable.highlightAttributes=this.prepareAttributes(c.highlight,d)),this.moveValidProperties()},o.prototype.render=function(c,d){n.prototype.render.call(this,c,d),d.lastStyle&&!this._renderable&&(this.createPolygon(d.lastStyle,d.fileCache),c.redrawRequested=!0),this._renderable&&(this._renderable.enabled=this.enabled,this._renderable.render(c))},o.prototype.moveValidProperties=function(){this._renderable.extrude=this.kmlExtrude||!0,this._renderable.altitudeMode=this.kmlAltitudeMode||WorldWind.CLAMP_TO_GROUND},o.prototype.prepareAttributes=function(c,d){var h=c&&c.generate(d)||{};return h._drawVerticals=this.kmlExtrude||!1,h._applyLighting=!0,h._depthTest=!0,h._outlineStippleFactor=0,h._outlineStipplePattern=61680,h._enableLighting=!0,new a(i.shapeAttributes(h))},o.prototype.prepareLocations=function(){var c=[];return this.kmlInnerBoundary!=null?(c[0]=this.kmlInnerBoundary.kmlPositions,c[1]=this.kmlOuterBoundary.kmlPositions):c=this.kmlOuterBoundary.kmlPositions,c},o.prototype.getStyle=function(){return this._style},o.prototype.getTagNames=function(){return["Polygon"]},l.addKey(o.prototype.getTagNames()[0],o),o}),B("formats/kml/util/KmlScale",["./../KmlElements","../KmlObject","./KmlNodeTransformers"],function(p,l,n){"use strict";var e=function(i){l.call(this,i)};return e.prototype=Object.create(l.prototype),Object.defineProperties(e.prototype,{kmlX:{get:function(){return this._factory.specific(this,{name:"x",transformer:n.number})}},kmlY:{get:function(){return this._factory.specific(this,{name:"y",transformer:n.number})}},kmlZ:{get:function(){return this._factory.specific(this,{name:"z",transformer:n.number})}}}),e.prototype.getTagNames=function(){return["Scale"]},p.addKey(e.prototype.getTagNames()[0],e),e}),B("formats/kml/features/KmlScreenOverlay",["./../KmlElements","./KmlFeature","./KmlOverlay","../util/KmlNodeTransformers","../../../util/Offset","../../../shapes/ScreenImage"],function(p,l,n,e,i,t){"use strict";var r=function(s){n.call(this,s)};return r.prototype=Object.create(n.prototype),Object.defineProperties(r.prototype,{kmlRotation:{get:function(){return this._factory.specific(this,{name:"rotation",transformer:e.number})}},kmlOverlayXYx:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:e.attribute("x"),attribute:"kmlOverlayXYx"})}},kmlOverlayXYy:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:e.attribute("y"),attribute:"kmlOverlayXYy"})}},kmlOverlayXYxunits:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:e.attribute("xunits"),attribute:"kmlOverlayXYxunits"})}},kmlOverlayXYyunits:{get:function(){return this._factory.specific(this,{name:"overlayXY",transformer:e.attribute("yunits"),attribute:"kmlOverlayXYyunits"})}},kmlScreenXYx:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:e.attribute("x"),attribute:"kmlScreenXYx"})}},kmlScreenXYy:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:e.attribute("y"),attribute:"kmlScreenXYy"})}},kmlScreenXYxunits:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:e.attribute("xunits"),attribute:"kmlScreenXYxunits"})}},kmlScreenXYyunits:{get:function(){return this._factory.specific(this,{name:"screenXY",transformer:e.attribute("yunits"),attribute:"kmlScreenXYyunits"})}},kmlRotationXYx:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:e.attribute("x"),attribute:"kmlRotationXYx"})}},kmlRotationXYy:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:e.attribute("y"),attribute:"kmlRotationXYy"})}},kmlRotationXYxunits:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:e.attribute("xunits"),attribute:"kmlRotationXYxunits"})}},kmlRotationXYyunits:{get:function(){return this._factory.specific(this,{name:"rotationXY",transformer:e.attribute("yunits"),attribute:"kmlRotationXYyunits"})}},kmlSizex:{get:function(){return this._factory.specific(this,{name:"size",transformer:e.attribute("x"),attribute:"kmlSizex"})}},kmlSizey:{get:function(){return this._factory.specific(this,{name:"size",transformer:e.attribute("y"),attribute:"kmlSizey"})}},kmlSizexunits:{get:function(){return this._factory.specific(this,{name:"size",transformer:e.attribute("xunits"),attribute:"kmlSizexunits"})}},kmlSizeyunits:{get:function(){return this._factory.specific(this,{name:"size",transformer:e.attribute("yunits"),attribute:"kmlSizeyunits"})}}}),r.prototype.render=function(s,a){l.prototype.render.call(this,s,a),this._renderable||this.kmlIcon&&(this._renderable=new t(new i(this.kmlScreenXYxunits,this.kmlScreenXYx,this.kmlScreenXYyunits,this.kmlScreenXYy),this.kmlIcon.kmlHref(a.fileCache)),this._renderable.imageOffset=new i(this.kmlOverlayXYxunits,this.kmlOverlayXYx,this.kmlOverlayXYyunits,this.kmlOverlayXYy),s.redrawRequested=!0),this._renderable&&this._renderable.render(s)},r.prototype.getTagNames=function(){return["ScreenOverlay"]},p.addKey(r.prototype.getTagNames()[0],r),r}),B("formats/kml/features/KmlTour",["./../KmlElements","./KmlFeature"],function(p,l){"use strict";var n=function(e){l.call(this,e)};return n.prototype=Object.create(l.prototype),n.prototype.getTagNames=function(){return["gx:Tour"]},p.addKey(n.prototype.getTagNames()[0],n),n}),B("formats/kml/geom/KmlTrack",["./../KmlElements","./KmlGeometry"],function(p,l){"use strict";var n=function(e){l.call(this,e)};return n.prototype=Object.create(l.prototype),n.prototype.getTagNames=function(){return["gx:Track"]},p.addKey(n.prototype.getTagNames()[0],n),n}),B("formats/kml/controls/KmlTreeVisibility",["../../../util/WWUtil","./KmlControls"],function(p,l){"use strict";var n=function(e,i){l.apply(this),this._visualElementId=e,this._wwd=i};return n.prototype=Object.create(l.prototype),n.prototype.hook=function(e,i){i.isFeature&&this.createControls(e)},n.prototype.createControls=function(e){var i=e.kmlName||e.id||p.guid(),t=e.enabled&&e.kmlVisibility===!0,r=document.createElement("div"),s=document.createElement("input");s.setAttribute("type","checkbox"),t&&s.setAttribute("checked","checked"),s.addEventListener("click",o,!0),r.appendChild(s);var a;e.kmlAbstractView?a=document.createElement("a"):a=document.createElement("span"),a.appendChild(document.createTextNode(i)),a.addEventListener("click",c,!0),r.appendChild(a),document.getElementById(this._visualElementId).appendChild(r);var f=this;function o(){t=!t,f.updateDescendants(e,t)}function c(){e.kmlAbstractView&&e.kmlAbstractView.update({wwd:f._wwd})}},n.prototype.updateDescendants=function(e,i){e.controlledVisibility=i,this._wwd.redraw()},n}),B("layer/LandsatRestLayer",["../error/ArgumentError","../geom/Location","../util/Logger","../geom/Sector","../layer/TiledImageLayer","../util/LevelRowColumnUrlBuilder","../util/WWUtil"],function(p,l,n,e,i,t,r){"use strict";var s=function(a,f,o){var c=r.urlPath(a+"/"+f);i.call(this,e.FULL_SPHERE,new l(36,36),10,"image/png",c,512,512),this.displayName=o,this.pickEnabled=!1,this.urlBuilder=new t(a,f)};return s.prototype=Object.create(i.prototype),s}),B("util/measure/LengthMeasurer",["../../error/ArgumentError","../../geom/Location","../Logger","./MeasurerUtils","../../geom/Position","../../geom/Vec3"],function(p,l,n,e,i,t){var r=function(s){if(!s)throw new p(n.logMessage(n.LEVEL_SEVERE,"LengthMeasurer","constructor","missingWorldWindow"));this.wwd=s,this.DEFAULT_MIN_SEGMENT_LENGTH=30,this._maxSegmentLength=1e5,this._lengthTerrainSamplingSteps=128,this.subdividedPositions=null};return Object.defineProperties(r.prototype,{maxSegmentLength:{get:function(){return this._maxSegmentLength},set:function(s){this._maxSegmentLength=s}},lengthTerrainSamplingSteps:{get:function(){return this._lengthTerrainSamplingSteps},set:function(s){this._lengthTerrainSamplingSteps=s}}}),r.prototype.getLength=function(s,a,f){return f=f||WorldWind.GREAT_CIRCLE,this.subdividedPositions=null,this.computeLength(s,a,f)},r.prototype.getPathLength=function(s){return this.subdividedPositions=null,this.computeLength(s.positions,s.followTerrain,s.pathType)},r.prototype.getGeographicDistance=function(s,a){if(s instanceof WorldWind.Path)var f=s.positions,o=s.pathType;else Array.isArray(s)&&(f=s,o=a||WorldWind.GREAT_CIRCLE);if(!f||f.length<2)return-1;var c=l.greatCircleDistance;o===WorldWind.RHUMB_LINE?c=l.rhumbDistance:o===WorldWind.LINEAR&&(c=l.linearDistance);for(var d=0,h=0,u=f.length-1;h<u;h++){var m=f[h],g=f[h+1];d+=c(m,g)}return d*this.wwd.globe.equatorialRadius},r.prototype.computeLength=function(s,a,f){if(!s||s.length<2)return-1;var o=this.wwd.globe;if(this.subdividedPositions==null){var c=this._maxSegmentLength;if(a){var d=this.computeLength(s,!1,f);c=d/this._lengthTerrainSamplingSteps,c=Math.min(Math.max(c,this.DEFAULT_MIN_SEGMENT_LENGTH),this._maxSegmentLength)}this.subdividedPositions=e.subdividePositions(o,s,a,f,c)}var h=0,u=this.subdividedPositions[0],m=new t(0,0,0),g=new t(0,0,0);m=o.computePointFromPosition(u.latitude,u.longitude,u.altitude,m);for(var _=1,y=this.subdividedPositions.length;_<y;_++){var v=this.subdividedPositions[_];g=o.computePointFromPosition(v.latitude,v.longitude,v.altitude,g),h+=m.distanceTo(g),m.copy(g)}return h},r}),B("navigate/Navigator",[],function(){"use strict";var p=function(){this.heading=0,this.tilt=0,this.roll=0};return p}),B("navigate/LookAtNavigator",["../geom/Location","../navigate/Navigator"],function(p,l){"use strict";var n=function(){l.call(this),this.lookAtLocation=new p(30,-110),this.range=1e7,this.enable2DLimits=!0};return n.prototype=Object.create(l.prototype),n}),B("cache/MemoryCacheListener",["../util/Logger","../error/UnsupportedOperationError"],function(p,l){"use strict";var n=function(){};return n.prototype.entryRemoved=function(e,i){throw new l(p.logMessage(p.LEVEL_SEVERE,"MemoryCacheListener","entryRemoved","abstractInvocation"))},n.prototype.removalError=function(e,i,t){throw new l(p.logMessage(p.LEVEL_SEVERE,"MemoryCacheListener","removalError","abstractInvocation"))},n}),B("util/NominatimGeocoder",["../util/Logger"],function(p){"use strict";var l=function(){this.service="https://open.mapquestapi.com/nominatim/v1/search/"};return l.prototype.lookup=function(n,e,i){var t=this.service+n.replace(" ","%20")+"?format=json",r=new XMLHttpRequest,s=this;t+="&key="+(i||"lUvVRchXGGDh5Xwk3oidrXeIDAAevOUS"),r.open("GET",t,!0),r.onreadystatechange=function(){if(r.readyState===4&&r.status===200){var a=JSON.parse(r.responseText);e(s,a)}},r.send(null)},l}),B("ogc/ows/OwsLanguageString",["../../error/ArgumentError","../../util/Logger"],function(p,l){"use strict";var n=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"LanguageString","constructor","missingDomElement"));this.value=e.textContent,this.lang;var i=e.getAttribute("lang");i&&(this.lang=i)};return n}),B("ogc/ows/OwsDescription",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsLanguageString"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsDescription","assembleDescriptions","missingDomElement"));for(var t=i.children||i.childNodes,r=0;r<t.length;r++){var s=t[r];if(s.localName==="Title")this.titles=this.titles||[],this.titles.push(new n(s));else if(s.localName==="Abstract")this.abstracts=this.abstracts||[],this.abstracts.push(new n(s));else if(s.localName==="Keywords"){this.keywords=this.keywords||[];for(var a=s.children||s.childNodes,f=0;f<a.length;f++){var o=a[f];o.localName==="Keyword"&&this.keywords.push(new n(o))}}}};return e}),B("ogc/ows/OwsConstraint",["../../error/ArgumentError","../../util/Logger"],function(p,l){"use strict";var n=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsConstraint","constructor","missingDomElement"));this.name=e.getAttribute("name");for(var i=e.children||e.childNodes,t=0;t<i.length;t++){var r=i[t];if(r.localName==="AllowedValues"){this.allowedValues=this.allowedValues||[];for(var s=r.children||r.childNodes,a=0;a<s.length;a++)s[a].localName==="Value"&&this.allowedValues.push(s[a].textContent)}else r.localName==="AnyValue"?this.anyValue=!0:r.localName==="NoValues"&&(this.noValues=!0)}};return n}),B("ogc/ows/OwsOperationsMetadata",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsConstraint"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsOperationsMetadata","constructor","missingDomElement"));for(var t=i.children||i.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="Operation"&&(this.operation=this.operation||[],this.operation.push(e.assembleOperation(s)))}};return e.prototype.getGetCapabilities=function(){return this.getOperationMetadataByName("GetCapabilities")},e.prototype.getGetTile=function(){return this.getOperationMetadataByName("GetTile")},e.prototype.getOperationMetadataByName=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsOperationsMetadata","getOperationsMetadataByName","missingName"));for(var t=0;t<this.operation.length;t++)if(this.operation[t].name===i)return this.operation[t];return null},e.assembleOperation=function(i){var t={};t.name=i.getAttribute("name");for(var r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="DCP"&&(t.dcp=t.dcp||[],t.dcp.push(e.assembleDcp(a)))}return t},e.assembleDcp=function(i){for(var t={},r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];if(a.localName==="HTTP")for(var f=a.children||a.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Get"?(t.getMethods=t.getMethods||[],t.getMethods.push(e.assembleMethod(c))):c.localName==="Post"&&(t.postMethods=t.postMethods||[],t.postMethods.push(e.assembleMethod(c)))}}return t},e.assembleMethod=function(i){var t={};t.url=i.getAttribute("xlink:href");for(var r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="Constraint"&&(t.constraint=t.constraint||[],t.constraint.push(new n(a)))}return t},e}),B("ogc/ows/OwsServiceIdentification",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsDescription"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsServiceIdentification","constructor","missingDomElement"));n.call(this,i);for(var t=i.children||i.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="ServiceType"?this.serviceType=s.textContent:s.localName==="ServiceTypeVersion"?(this.serviceTypeVersions=this.serviceTypeVersions||[],this.serviceTypeVersions.push(s.textContent)):s.localName==="Profile"?(this.profile=this.profile||[],this.profile.push(s.textContent)):s.localName==="Fees"?this.fees=s.textContent:s.localName==="AccessConstraints"&&(this.accessConstraints=this.accessConstraints||[],this.accessConstraints.push(s.textContent))}};return e.prototype=Object.create(n.prototype),e}),B("ogc/ows/OwsServiceProvider",["../../error/ArgumentError","../../util/Logger"],function(p,l){"use strict";var n=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsServiceProvider","constructor","missingDomElement"));for(var i=e.children||e.childNodes,t=0;t<i.length;t++){var r=i[t];r.localName==="ProviderName"?this.providerName=r.textContent:r.localName==="ProviderSite"?this.providerSiteUrl=r.getAttribute("xlink:href"):r.localName==="ServiceContact"&&(this.serviceContact=n.assembleServiceContact(r))}};return n.assembleServiceContact=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsServiceProvider","assembleServiceContact","missingDomElement"));for(var i={},t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="IndividualName"?i.individualName=s.textContent:s.localName==="PositionName"?i.positionName=s.textContent:s.localName==="ContactInfo"&&(i.contactInfo=n.assembleContacts(s))}return i},n.assembleContacts=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsServiceProvider","assembleContacts","missingDomElement"));for(var i={},t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="HoursOfService"?i.hoursOfService=s.textContent:s.localName==="ContactInstructions"?i.contactInstructions=s.textContent:s.localName==="Phone"?i.phone=n.assemblePhone(s):s.localName==="Address"&&(i.address=n.assembleAddress(s))}return i},n.assemblePhone=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsServiceProvider","assemblePhone","missingDomElement"));for(var i={},t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="Voice"?i.voice=s.textContent:s.localName==="Facsimile"&&(i.facsimile=s.textContent)}return i},n.assembleAddress=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsServiceProvider","assembleAddress","missingDomElement"));for(var i={},t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="DeliveryPoint"?(i.deliveryPoints=i.deliveryPoints||[],i.deliveryPoints.push(s.textContent)):s.localName==="City"?i.city=s.textContent:s.localName==="AdministrativeArea"?i.administrativeArea=s.textContent:s.localName==="PostalCode"?(i.postalCodes=i.postalCodes||[],i.postalCodes.push(s.textContent)):s.localName==="Country"?(i.countries=i.countries||[],i.countries.push(s.textContent)):s.localName==="ElectronicMailAddress"&&(i.electronicMailAddresses=i.electronicMailAddresses||[],i.electronicMailAddresses.push(s.textContent))}return i},n}),B("ogc/wms/WmsLayerCapabilities",["../../error/ArgumentError","../../util/Logger"],function(p,l){"use strict";var n=function(e,i){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsLayerCapabilities","constructor","Layer element is null or undefined."));this.parent=i,this.layers,this.name,this.title,this.abstract,this.keywordList,this.identifiers,this.metadataUrls,this.dataUrls,this.featureListUrls,this.assembleLayer(e)};return Object.defineProperties(n.prototype,{capability:{get:function(){for(var e=this;e&&e instanceof n;)e=e.parent;return e}},queryable:{get:function(){return n.replace(this,"_queryable")}},cascaded:{get:function(){return n.replace(this,"_cascaded")}},opaque:{get:function(){return n.replace(this,"_opaque")}},noSubsets:{get:function(){return n.replace(this,"_noSubsets")}},fixedWidth:{get:function(){return n.replace(this,"_fixedWidth")}},fixedHeight:{get:function(){return n.replace(this,"_fixedHeight")}},styles:{get:function(){return n.accumulate(this,"_styles",[])}},crses:{get:function(){return n.accumulate(this,"_crses",[])}},srses:{get:function(){return n.accumulate(this,"_srses",[])}},geographicBoundingBox:{get:function(){return n.replace(this,"_geographicBoundingBox")}},latLonBoundingBox:{get:function(){return n.replace(this,"_latLonBoundingBox")}},boundingBoxes:{get:function(){return n.replace(this,"_boundingBoxes")}},dimensions:{get:function(){for(var e=[],i=this;i&&i instanceof n;)i._dimensions&&i._dimensions.length>0&&i._dimensions.forEach(function(t){var r=t.name,s=!0;e.forEach(function(a){a.name===r&&(s=!1)}),s&&e.push(t)}),i=i.parent;return e.length>0?e:void 0}},extents:{get:function(){for(var e=[],i=this;i&&i instanceof n;)i._extents&&i._extents.length>0&&i._extents.forEach(function(t){var r=t.name,s=!0;e.forEach(function(a){a.name===r&&(s=!1)}),s&&e.push(t)}),i=i.parent;return e.length>0?e:void 0}},attribution:{get:function(){return n.replace(this,"_attribution")}},authorityUrls:{get:function(){return n.accumulate(this,"_authorityUrls",[])}},minScaleDenominator:{get:function(){return n.replace(this,"_minScaleDenominator")}},maxScaleDenominator:{get:function(){return n.replace(this,"_maxScaleDenominator")}},scaleHint:{get:function(){return n.replace(this,"_scaleHint")}}}),n.prototype.style=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsLayerCapabilities","style","Style name is null or undefined."));var i=this.styles;if(!i)return null;for(var t=0,r=i.length,s;t<r;t++)if(s=i[t],s.name===e)return s},n.accumulate=function(e,i,t){for(;e&&e instanceof n;){var r=e[i];if(r)for(var s=0;s<r.length;s++)t.push(r[s]);e=e.parent}return t.length>0?t:null},n.replace=function(e,i){for(;e&&e instanceof n;){var t=e[i];if(t)return t;e=e.parent}},n.prototype.assembleLayer=function(e){var i,t,r,s;t=e.getAttribute("queryable"),t&&(this._queryable=t==="1"||t==="true"),t=e.getAttribute("opaque"),t&&(this._opaque=t==="1"||t==="true"),t=e.getAttribute("noSubsets"),t&&(this._noSubsets=t==="1"||t==="true"),t=e.getAttribute("cascaded"),t&&(this._cascaded=parseInt("10")),t=e.getAttribute("fixedWidth"),t&&(this._fixedWidth=parseInt("10")),t=e.getAttribute("fixedHeight"),t&&(this._fixedHeight=parseInt("10"));var a=e.children||e.childNodes;for(r=0;r<a.length;r++){var f=a[r];if(f.localName==="Layer")this.layers||(this.layers=[]),this.layers.push(new n(f,this));else if(f.localName==="Name")this.name=f.textContent;else if(f.localName==="Title")this.title=f.textContent;else if(f.localName==="Abstract")this.abstract=f.textContent;else if(f.localName==="KeywordList"){this.keywordList=this.keywordList||[];for(var o=f.children||f.childNodes,c=0;c<o.length;c++){var d=o[c];d.localName==="Keyword"&&this.keywordList.push(d.textContent)}}else f.localName==="Style"?(this._styles||(this._styles=[]),this._styles.push(n.assembleStyle(f))):f.localName==="CRS"?(this._crses||(this._crses=[]),this._crses.push(f.textContent)):f.localName==="SRS"?(this._srses||(this._srses=[]),this._srses.push(f.textContent)):f.localName==="EX_GeographicBoundingBox"?this._geographicBoundingBox=n.assembleGeographicBoundingBox(f):f.localName==="LatLonBoundingBox"?this._geographicBoundingBox=n.assembleLatLonBoundingBox(f):f.localName==="BoundingBox"?(this._boundingBoxes||(this._boundingBoxes=[]),this._boundingBoxes.push(n.assembleBoundingBox(f))):f.localName==="Dimension"?(this._dimensions||(this._dimensions=[]),this._dimensions.push(n.assembleDimension(f))):f.localName==="Extent"?(this._extents||(this._extents=[]),this._extents.push(n.assembleDimension(f))):f.localName==="Attribution"?this._attribution=n.assembleAttribution(f):f.localName==="AuthorityURL"?(this._authorityUrls||(this._authorityUrls=[]),this._authorityUrls.push(n.assembleAuthorityUrl(f))):f.localName==="Identifier"?(this.identifiers||(this.identifiers=[]),this.identifiers.push(n.assembleIdentifier(f))):f.localName==="MetadataURL"?(this.metadataUrls||(this.metadataUrls=[]),this.metadataUrls.push(n.assembleMetadataUrl(f))):f.localName==="DataURL"?(this.dataUrls||(this.dataUrls=[]),this.dataUrls.push(n.assembleUrl(f))):f.localName==="FeatureListURL"?(this.featureListUrls||(this.featureListUrls=[]),this.featureListUrls.push(n.assembleUrl(f))):f.localName==="MinScaleDenominator"?this._minScaleDenominator=parseFloat(f.textContent):f.localName==="MaxScaleDenominator"?this._maxScaleDenominator=parseFloat(f.textContent):f.localName==="ScaleHint"&&(this._scaleHint={},this._scaleHint.min=n.getFloatAttribute(f,"min"),this._scaleHint.max=n.getFloatAttribute(f,"max"))}},n.assembleStyle=function(e){for(var i={},t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="Name"?i.name=s.textContent:s.localName==="Title"?i.title=s.textContent:s.localName==="Abstract"?i.abstract=s.textContent:s.localName==="LegendURL"?(i.legendUrls||(i.legendUrls=[]),i.legendUrls.push(n.assembleLegendUrl(s))):s.localName==="StyleSheetURL"?i.styleSheetUrl=n.assembleUrl(s):s.localName==="StyleURL"&&(i.styleUrl=n.assembleUrl(s))}return i},n.assembleGeographicBoundingBox=function(e){for(var i={},t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="westBoundLongitude"?i.westBoundLongitude=parseFloat(s.textContent):s.localName==="eastBoundLongitude"?i.eastBoundLongitude=parseFloat(s.textContent):s.localName==="southBoundLatitude"?i.southBoundLatitude=parseFloat(s.textContent):s.localName==="northBoundLatitude"&&(i.northBoundLatitude=parseFloat(s.textContent))}return i},n.assembleLatLonBoundingBox=function(e){var i={};return i.minx=n.getFloatAttribute(e,"minx"),i.miny=n.getFloatAttribute(e,"miny"),i.maxx=n.getFloatAttribute(e,"maxx"),i.maxy=n.getFloatAttribute(e,"maxy"),i},n.assembleBoundingBox=function(e){var i={};return i.crs=e.getAttribute("CRS"),i.minx=n.getFloatAttribute(e,"minx"),i.miny=n.getFloatAttribute(e,"miny"),i.maxx=n.getFloatAttribute(e,"maxx"),i.maxy=n.getFloatAttribute(e,"maxy"),i.resx=n.getFloatAttribute(e,"resx"),i.resy=n.getFloatAttribute(e,"resy"),i},n.assembleDimension=function(e){var i={};return i.name=e.getAttribute("name"),i.units=e.getAttribute("units"),i.unitSymbol=e.getAttribute("unitSymbol"),i.default=e.getAttribute("default"),i.multipleValues=e.getAttribute("multipleValues"),i.multipleValues&&(i.multipleValues=i.multipleValues==="true"||i.multipleValues==="1"),i.nearestValue=e.getAttribute("nearestValue"),i.nearestValue&&(i.nearestValue=i.nearestValue==="true"||i.nearestValue==="1"),i.current=e.getAttribute("current"),i.current&&(i.current=i.current==="true"||i.current==="1"),i.content=e.textContent,i},n.assembleAttribution=function(e){for(var i={},t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="Title"?i.title=s.textContent:s.localName==="OnlineResource"?i.url=s.getAttribute("xlink:href"):s.localName==="LogoUrul"&&(i.logoUrl=n.assembleLogoUrl(s))}return i},n.assembleAuthorityUrl=function(e){var i={};i.name=e.getAttribute("name");for(var t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="OnlineResource"&&(i.url=s.getAttribute("xlink:href"))}return i},n.assembleIdentifier=function(e){var i={};return i.authority=e.getAttribute("authority"),i.content=e.textContent,i},n.assembleMetadataUrl=function(e){var i={};i.type=e.getAttribute("type");for(var t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="Format"?i.format=s.textContent:s.localName==="OnlineResource"&&(i.url=s.getAttribute("xlink:href"))}return i},n.assembleLegendUrl=function(e){var i={};i.width=n.getIntegerAttribute(e,"width"),i.height=n.getIntegerAttribute(e,"height");for(var t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="Format"?i.format=s.textContent:s.localName==="OnlineResource"&&(i.url=s.getAttribute("xlink:href"))}return i},n.assembleLogoUrl=function(e){var i={};i.width=n.getIntegerAttribute(e,"width"),i.height=n.getIntegerAttribute(e,"height");for(var t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="Format"?i.format=s.textContent:s.localName==="OnlineResource"&&(i.url=s.getAttribute("xlink:href"))}return i},n.assembleUrl=function(e){for(var i={},t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="Format"?i.format=s.textContent:s.localName==="OnlineResource"&&(i.url=s.getAttribute("xlink:href"))}return i},n.getIntegerAttribute=function(e,i){var t=e.getAttribute(i);return t?t=parseInt(t):t=void 0,t},n.getFloatAttribute=function(e,i){var t=e.getAttribute(i);return t?t=parseFloat(t):t=void 0,t},n}),B("ogc/wms/WmsCapabilities",["../../error/ArgumentError","../../util/Logger","../../ogc/wms/WmsLayerCapabilities"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(i)};return e.prototype.getNamedLayers=function(){return this.accumulateNamedLayers(this.capability.layers)},e.prototype.accumulateNamedLayers=function(i,t){var r=t||[];if(!i)return r;for(var s=0,a=i.length;s<a;s++){var f=i[s];f.name&&r.push(f),f.layers&&this.accumulateNamedLayers(f.layers,r)}return r},e.prototype.getNamedLayer=function(i){if(!i||i.length===0)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsCapabilities","getNamedLayer","No WMS layer name provided."));for(var t=this.getNamedLayers(),r=0,s=t.length;r<s;r++)if(i===t[r].name)return t[r];return null},e.prototype.assembleDocument=function(i){var t=i.documentElement;this.version=t.getAttribute("version"),this.updateSequence=t.getAttribute("updateSequence");for(var r=t.children||t.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="Service"?this.service=this.assembleService(a):a.localName==="Capability"&&(this.capability=this.assembleCapability(a))}},e.prototype.assembleService=function(i){for(var t={capsDoc:this},r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="Name"?t.name=a.textContent:a.localName==="Title"?t.title=a.textContent:a.localName==="Abstract"?t.abstract=a.textContent:a.localName==="KeywordList"?t.keywordList=this.assembleKeywordList(a):a.localName==="OnlineResource"?t.url=a.getAttribute("xlink:href"):a.localName==="Fees"?t.fees=a.textContent:a.localName==="AccessConstraints"?t.accessConstraints=a.textContent:a.localName=="LayerLimit"?t.layerLimit=parseInt(a.textContent):a.localName=="MaxWidth"?t.maxWidth=parseInt(a.textContent):a.localName=="MaxHeight"?t.maxHeight=parseInt(a.textContent):a.localName==="ContactInformation"&&(t.contactInformation=this.assembleContactInformation(a))}return t},e.prototype.assembleKeywordList=function(i){for(var t=[],r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="Keyword"&&t.push(a.textContent)}return t},e.prototype.assembleContactInformation=function(i){for(var t={},r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="ContactPersonPrimary"?t.contactPersonPrimary=this.assembleContactPersonPrimary(a):a.localName==="ContactPosition"?t.contactPosition=a.textContent:a.localName==="ContactVoiceTelephone"?t.contactVoiceTelephone=a.textContent:a.localName==="ContactFacsimileTelephone"?t.contactFacsimileTelephone=a.textContent:a.localName==="ContactElectronicMailAddress"?t.contactElectronicMailAddress=a.textContent:a.localName==="ContactAddress"&&(t.contactAddress=this.assembleContactAddress(a))}return t},e.prototype.assembleContactPersonPrimary=function(i){for(var t={},r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="ContactPerson"?t.contactPerson=a.textContent:a.localName==="ContactOrganization"&&(t.contactOrganization=a.textContent)}return t},e.prototype.assembleContactAddress=function(i){for(var t={},r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="AddressType"?t.addressType=a.textContent:a.localName==="Address"?t.address=a.textContent:a.localName==="City"?t.city=a.textContent:a.localName==="StateOrProvince"?t.stateOrProvince=a.textContent:a.localName==="PostCode"?t.postCode=a.textContent:a.localName==="Country"&&(t.country=a.textContent)}return t},e.prototype.assembleCapability=function(i){for(var t={capsDoc:this},r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="Request"?t.request=this.assembleRequests(a):a.localName==="Exception"?t.exception=this.assembleException(a):a.localName==="Layer"&&(t.layers=t.layers||[],t.layers.push(new n(a,t)))}return t},e.prototype.assembleRequests=function(i){for(var t={},r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="GetCapabilities"?t.getCapabilities=this.assembleRequest(a):a.localName==="GetMap"?t.getMap=this.assembleRequest(a):a.localName==="GetFeatureInfo"&&(t.getFeatureInfo=this.assembleRequest(a))}return t},e.prototype.assembleRequest=function(i){for(var t={name:i.localName},r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];if(a.localName==="Format")t.formats=t.formats||[],t.formats.push(a.textContent);else if(a.localName==="DCPType")for(var f=a.children||a.childNodes,o=0;o<f.length;o++){var c=f[o];if(c.localName==="HTTP")for(var d=c.children||c.childNodes,h=0;h<d.length;h++){var u=d[h];if(u.localName==="Get")for(var m=u.children||u.childNodes,g=0;g<m.length;g++){var _=m[g];_.localName==="OnlineResource"&&(t.getUrl=_.getAttribute("xlink:href"))}}}}return t},e.prototype.assembleException=function(i){for(var t={},r=i.children||i.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="Format"&&(t.formats=t.formats||[],t.formats.push(a.textContent))}return t},e}),B("ogc/wmts/WmtsLayerCapabilities",["../../error/ArgumentError","../../geom/Sector","../../ogc/ows/OwsDescription","../../util/Logger"],function(p,l,n,e){"use strict";var i=function(t,r){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"WmtsLayerCapabilities","constructor","missingDomElement"));n.call(this,t),this.capabilities=r,this.identifier,this.title,this.abstract,this.keywords,this.wgs84BoundingBox,this.boundingBox,this.styles,this.formats,this.infoFormat,this.dimension,this.metadata,this.tileMatrixSetLink,this.resourceUrl,this.assembleLayer(t)};return i.prototype=Object.create(n.prototype),i.prototype.getLayerSupportedTileMatrixSets=function(){for(var t=[],r=0,s=this.tileMatrixSetLink.length;r<s;r++)for(var a=this.tileMatrixSetLink[r].tileMatrixSet,f=0,o=this.capabilities.contents.tileMatrixSet.length;f<o;f++){var c=this.capabilities.contents.tileMatrixSet[f].identifier;c===a&&t.push(this.capabilities.contents.tileMatrixSet[f])}return t},i.prototype.assembleLayer=function(t){for(var r=t.children||t.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="Identifier"?this.identifier=a.textContent:a.localName==="WGS84BoundingBox"?this.wgs84BoundingBox=i.assembleBoundingBox(a):a.localName==="BoundingBox"?(this.boundingBox=this.boundingBox||[],this.boundingBox.push(i.assembleBoundingBox(a))):a.localName==="Style"?(this.style=this.style||[],this.style.push(i.assembleStyle(a))):a.localName==="Format"?(this.format=this.format||[],this.format.push(a.textContent)):a.localName==="InfoFormat"?(this.infoFormat=this.infoFormat||[],this.infoFormat.push(a.textContent)):a.localName==="Dimension"?(this.dimension=this.dimension||[],this.dimension.push(i.assembleDimension(a))):a.localName==="Metadata"?(this.metadata=this.metadata||[],this.metadata.push(i.assembleMetadata(a))):a.localName==="ResourceURL"?(this.resourceUrl=this.resourceUrl||[],this.resourceUrl.push(i.assembleResourceUrl(a))):a.localName==="TileMatrixSetLink"&&(this.tileMatrixSetLink=this.tileMatrixSetLink||[],this.tileMatrixSetLink.push(i.assembleTileMatrixSetLink(a)))}},i.assembleStyle=function(t){var r=new n(t);r.isDefault=t.getAttribute("isDefault");for(var s=t.children||t.childNodes,a=0;a<s.length;a++){var f=s[a];f.localName==="Identifier"?r.identifier=f.textContent:f.localName==="LegendURL"&&(r.legendUrl=r.legendUrl||[],r.legendUrl.push(i.assembleLegendUrl(f)))}return r},i.assembleBoundingBox=function(t){var r={},s=t.getAttribute("crs");s&&(r.crs=s);for(var a=t.children||t.childNodes,f=0;f<a.length;f++){var o=a[f];if(o.localName==="LowerCorner"){var c=o.textContent.split(" ");r.lowerCorner=[parseFloat(c[0]),parseFloat(c[1])]}else if(o.localName==="UpperCorner"){var d=o.textContent.split(" ");r.upperCorner=[parseFloat(d[0]),parseFloat(d[1])]}}return t.localName==="WGS84BoundingBox"&&(r.getSector=function(){return new l(r.lowerCorner[1],r.upperCorner[1],r.lowerCorner[0],r.upperCorner[0])}),r},i.assembleDimension=function(t){for(var r=new n(t),s=t.children||t.childNodes,a=0;a<s.length;a++){var f=s[a];f.localName==="Identifier"?r.identifier=f.textContent:f.localName==="UOM"?r.uom={name:f.getAttribute("name"),reference:f.getAttribute("reference")}:f.localName=="UnitSymbol"?r.unitSymbol=f.textContent:f.localName==="Default"?r.default=f.textContent:f.localName==="Current"?r.current=f.textContent==="true":f.localName==="Value"&&(r.value=r.value||[],r.value.push(f.textContent))}return r},i.assembleMetadata=function(t){var r={},s=t.getAttribute("xlink:href");s&&(r.url=s);var a=t.getAttribute("about");s&&(r.about=a);var f=t.getAttribute("xlink:type");f&&(r.type=f);var o=t.getAttribute("xlink:role");o&&(r.role=o);var c=t.getAttribute("xlink:title");c&&(r.title=c);for(var d=t.children||t.childNodes,h=0;h<d.length;h++){var u=d[h];u.localName==="Metadata"&&(r.metadata=WmsLayerCapabilities.assembleMetadata(u))}return r},i.assembleResourceUrl=function(t){var r={};return r.format=t.getAttribute("format"),r.resourceType=t.getAttribute("resourceType"),r.template=t.getAttribute("template"),r},i.assembleLegendUrl=function(t){var r={};return r.format=t.getAttribute("format"),r.minScaleDenominator=t.getAttribute("minScaleDenominator"),r.maxScaleDenominator=t.getAttribute("maxScaleDenominator"),r.href=t.getAttribute("xlink:href"),r.width=t.getAttribute("width"),r.height=t.getAttribute("height"),r},i.assembleTileMatrixSetLink=function(t){for(var r={},s=t.children||t.childNodes,a=0;a<s.length;a++){var f=s[a];f.localName==="TileMatrixSet"?r.tileMatrixSet=f.textContent:f.localName==="TileMatrixSetLimits"&&(r.tileMatrixSetLimits=i.assembleTileMatrixSetLimits(f))}return r},i.assembleTileMatrixSetLimits=function(t){for(var r={},s=t.children||t.childNodes,a=0;a<s.length;a++){var f=s[a];f.localName==="TileMatrixLimits"&&(r.tileMatrixLimits=r.tileMatrixLimits||[],r.tileMatrixLimits.push(i.assembleTileMatrixLimits(f)))}return r},i.assembleTileMatrixLimits=function(t){for(var r={},s=t.children||t.childNodes,a=0;a<s.length;a++){var f=s[a];f.localName==="TileMatrix"?r.tileMatrix=f.textContent:f.localName==="MinTileRow"?r.minTileRow=parseInt(f.textContent):f.localName==="MaxTileRow"?r.maxTileRow=parseInt(f.textContent):f.localName==="MinTileCol"?r.minTileCol=parseInt(f.textContent):f.localName==="maxTileCol"&&(r.maxTileCol=parseInt(f.textContent))}return r},i}),B("ogc/wmts/WmtsCapabilities",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsDescription","../../ogc/ows/OwsLanguageString","../../ogc/ows/OwsOperationsMetadata","../../ogc/ows/OwsServiceIdentification","../../ogc/ows/OwsServiceProvider","../../ogc/wms/WmsCapabilities","../../ogc/wmts/WmtsLayerCapabilities"],function(p,l,n,e,i,t,r,s,a){"use strict";var f=function(o){if(!o)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmtsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(o)};return f.prototype.getLayers=function(){return this.contents.layer},f.prototype.getLayer=function(o){if(!o)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmtsCapabilities","getLayer","empty identifier"));for(var c=0,d=this.contents.layer.length;c<d;c++){var h=this.contents.layer[c];if(h.identifier===o)return h}return null},f.prototype.assembleDocument=function(o){var c=o.documentElement;this.version=c.getAttribute("version"),this.updateSequence=c.getAttribute("updateSequence");for(var d=c.children||c.childNodes,h=0;h<d.length;h++){var u=d[h];u.localName==="ServiceIdentification"?this.serviceIdentification=new t(u):u.localName==="ServiceProvider"?this.serviceProvider=new r(u):u.localName==="OperationsMetadata"?this.operationsMetadata=new i(u):u.localName==="Contents"?this.contents=this.assembleContents(u):u.localName==="Themes"?this.themes=f.assembleThemes(u):u.localName==="ServiceMetadataURL"&&(this.serviceMetadataUrls=this.serviceMetadataUrls||[],this.serviceMetadataUrls.push(f.assembleServiceMetadataURL(u)))}},f.prototype.assembleContents=function(o){for(var c={},d=o.children||o.childNodes,h=0;h<d.length;h++){var u=d[h];if(u.localName==="Layer"){c.layer=c.layer||[];try{c.layer.push(new a(u,this))}catch(m){l.logMessage(l.LEVEL_SEVERE,"WmtsCapabilities","constructor","Exception reading WMTS layer description: "+m.message)}}else if(u.localName==="TileMatrixSet"){c.tileMatrixSet=c.tileMatrixSet||[];try{c.tileMatrixSet.push(f.assembleTileMatrixSet(u))}catch(m){l.logMessage(l.LEVEL_SEVERE,"WmtsCapabilities","constructor","Exception reading WMTS tile matrix set description: "+m.message)}}}return c},f.assembleTileMatrixSet=function(o){for(var c=new n(o),d=o.children||o.childNodes,h=0;h<d.length;h++){var u=d[h];u.localName==="Identifier"?c.identifier=u.textContent:u.localName==="SupportedCRS"?c.supportedCRS=u.textContent:u.localName==="WellKnownScaleSet"?c.wellKnownScaleSet=u.textContent:u.localName==="BoundingBox"?c.boundingBox=a.assembleBoundingBox(u):u.localName==="TileMatrix"&&(c.tileMatrix=c.tileMatrix||[],c.tileMatrix.push(f.assembleTileMatrix(u)))}f.sortTileMatrices(c);for(var m=0;m<c.tileMatrix.length;m++)c.tileMatrix[m].levelNumber=m;return c},f.assembleTileMatrix=function(o){for(var c=new n(o),d=o.children||o.childNodes,h=0;h<d.length;h++){var u=d[h];if(u.localName==="Identifier")c.identifier=u.textContent;else if(u.localName==="ScaleDenominator")c.scaleDenominator=parseFloat(u.textContent);else if(u.localName==="TileWidth")c.tileWidth=parseFloat(u.textContent);else if(u.localName==="TileHeight")c.tileHeight=parseFloat(u.textContent);else if(u.localName==="MatrixWidth")c.matrixWidth=parseFloat(u.textContent);else if(u.localName==="MatrixHeight")c.matrixHeight=parseFloat(u.textContent);else if(u.localName==="TopLeftCorner"){var m=u.textContent.split(" ");c.topLeftCorner=[parseFloat(m[0]),parseFloat(m[1])]}}return c},f.assembleThemes=function(o){for(var c,d=o.children||o.childNodes,h=0;h<d.length;h++){var u=d[h];u.localName==="Theme"&&(c=c||[],c.push(f.assembleTheme(u)))}return c},f.assembleTheme=function(o){for(var c=new n(o),d=o.children||o.childNodes,h=0;h<d.length;h++){var u=d[h];u.localName==="Identifier"?c.identifier=u.textContent:u.localName==="LayerRef"?(c.layerRef=c.layerRef||[],c.layerRef.push(u.textContent)):u.localName==="Theme"&&(c.themes=c.themes||[],c.themes.push(f.assembleTheme(u)))}return c},f.assembleServiceMetadataURL=function(o){var c={},d=o.getAttribute("xlink:href");return d&&(c.url=d),c},f.sortTileMatrices=function(o){o.tileMatrix.sort(function(c,d){return d.scaleDenominator-c.scaleDenominator})},f.prototype.getGetTileKvpAddress=function(){for(var o=0;o<this.operationsMetadata.operation.length;o++){var c=this.operationsMetadata.operation[o];if(c.name==="GetTile")return c.dcp[0].getMethods[0].url}return null},f}),B("layer/WmtsLayerTile",["../geom/Angle","../error/ArgumentError","../geom/BoundingBox","../util/Logger","../geom/Vec3","../util/WWUtil"],function(p,l,n,e,i,t){"use strict";var r=function(s,a,f,o,c){this.sector=s,this.tileMatrix=a,this.row=f,this.column=o,this.imagePath=c,this.texelSize=s.deltaLatitude()*p.DEGREES_TO_RADIANS/a.tileHeight,this.tileKey=a.levelNumber.toString()+"."+f.toString()+"."+o.toString(),this.gpuCacheKey=c};return r.prototype.isEqual=function(s){return!s||!s.tileKey?!1:this.tileKey==s.tileKey},r.prototype.distanceTo=function(s){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"Tile","distanceTo","missingVector"));for(var a=s[0],f=s[1],o=s[2],c,d,h,u=this.samplePoints,m=Number.POSITIVE_INFINITY,g=0,_=u.length;g<_;g+=3)c=a-u[g],d=f-u[g+1],h=o-u[g+2],m=Math.min(m,c*c+d*d+h*h);return Math.sqrt(m)},r.prototype.subdivide=function(s,a){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"WmtsLayerTile","subdivide","The specified tile matrix is null or undefined."));if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"WmtsLayerTile","subdivide","The specified tile factory is null or undefined."));for(var f,o,c=[],d=s.matrixHeight/this.tileMatrix.matrixHeight,h=s.matrixWidth/this.tileMatrix.matrixWidth,u=0;u<d;u++)for(var m=0;m<h;m++)f=d*this.row+u,o=h*this.column+m,c.push(a.createTile(s,f,o));return c},r.prototype.subdivideToCache=function(s,a,f){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile matrix is null or undefined."));if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"Tile","subdivideToCache","The specified tile factory is null or undefined."));var o=f?f.entryForKey(this.tileKey):null;return o||(o=this.subdivide(s,a),o&&f&&f.putEntry(this.tileKey,o,o.length)),o},r.prototype.mustSubdivide=function(s,a){var f=s.globe.equatorialRadius*this.texelSize,o=this.distanceTo(s.eyePoint),c=s.pixelSizeAtDistance(o);return f>Math.max(a*c,.5)},r.prototype.update=function(s){var a=s.globe.elevationTimestamp(),f=s.verticalExaggeration,o=s.globeStateKey;(this.updateTimestamp!=a||this.updateVerticalExaggeration!=f||this.updateGlobeStateKey!=o)&&(this.doUpdate(s),s.frameStatistics.incrementTileUpdateCount(1),this.updateTimestamp=a,this.updateVerticalExaggeration=f,this.updateGlobeStateKey=o)},r.prototype.doUpdate=function(s){var a=s.globe,f=s.verticalExaggeration,o=a.minAndMaxElevationsForSector(this.sector),c=o[0]*f,d=o[1]*f;c===d&&(c=d+10),this.extent||(this.extent=new n),this.extent.setToSector(this.sector,a,c,d),this.samplePoints||(this.sampleElevations=new Float64Array(9),this.samplePoints=new Float64Array(3*this.sampleElevations.length)),t.fillArray(this.sampleElevations,.5*(c+d)),a.computePointsForGrid(this.sector,3,3,this.sampleElevations,i.ZERO,this.samplePoints),this.referencePoint||(this.referencePoint=new i(0,0,0)),a.computePointFromPosition(this.sector.centroidLatitude(),this.sector.centroidLongitude(),0,this.referencePoint)},r.prototype.bind=function(s){var a=s.gpuResourceCache.resourceForKey(this.gpuCacheKey);return a&&a.bind(s)?!0:this.fallbackTile?this.fallbackTile.bind(s):!1},r.prototype.applyInternalTransform=function(s,a){},r}),B("layer/WmtsLayer",["../util/AbsentResourceList","../error/ArgumentError","../util/Logger","../geom/Matrix","../geom/Sector","../layer/Layer","../cache/MemoryCache","../render/Texture","../util/WmsUrlBuilder","../layer/WmtsLayerTile","../util/WWMath","../util/WWUtil"],function(p,l,n,e,i,t,r,s,a,f,o,c){"use strict";var d=function(h,u){if(!h)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","constructor","No layer configuration specified."));if(t.call(this,"WMTS Layer"),this.layerIdentifier=h.identifier,this.styleIdentifier=h.style,this.timeString=u,this.imageFormat=h.format,this.resourceUrl=h.resourceUrl,this.serviceUrl=h.service,this.tileMatrixSet=h.tileMatrixSet,this.lasTtMVP=e.fromIdentity(),!h.wgs84BoundingBox&&!h.boundingBox)if(this.tileMatrixSet.boundingBox)this.sector=new i(h.tileMatrixSet.boundingBox.lowerCorner[1],h.tileMatrixSet.boundingBox.upperCorner[1],h.tileMatrixSet.boundingBox.lowerCorner[0],h.tileMatrixSet.boundingBox.upperCorner[0]);else throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","constructor","No bounding box was specified in the layer or tile matrix set capabilities."));else if(h.wgs84BoundingBox)this.sector=h.wgs84BoundingBox.getSector();else if(this.tileMatrixSet.boundingBox&&d.isEpsg4326Crs(this.tileMatrixSet.boundingBox.crs))this.sector=new i(this.tileMatrixSet.boundingBox.lowerCorner[1],this.tileMatrixSet.boundingBox.upperCorner[1],this.tileMatrixSet.boundingBox.lowerCorner[0],this.tileMatrixSet.boundingBox.upperCorner[0]);else if(d.isEpsg4326Crs(this.tileMatrixSet.supportedCRS))throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","constructor","No EPSG:4326 bounding box was specified in the layer or tile matrix set capabilities."));if(!d.isTileSubdivisionCompatible(this.tileMatrixSet))throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","constructor","TileMatrixSet level division not compatible."));var m=this.tileMatrixSet.supportedCRS,g=d.isEpsg3857Crs(m)||d.isEpsg4326Crs(m)||d.isOGCCrs84(m);if(!g)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","constructor","Provided CRS is not compatible."));this.cachePath=(this.resourceUrl||this.serviceUrl)+this.layerIdentifier+this.styleIdentifier+this.tileMatrixSet.identifier,u&&(this.cachePath=this.cachePath+u),this.displayName=h.title,this.currentTiles=[],this.currentTilesInvalid=!0,this.tileCache=new r(1e3,850),this.currentRetrievals=[],this.absentResourceList=new p(3,5e4),this.pickEnabled=!1,this.detailControl=1.75,this.retrievalQueueSize=WorldWind.configuration.layerRetrievalQueueSize};return d.isTileSubdivisionCompatible=function(h){if(!h||!h.tileMatrix||h.tileMatrix.length<1)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","isTileSubdivisionCompatible","Empty tile matrix set"));for(var u,m,g,_=h.tileMatrix[0],y=1,v=h.tileMatrix.length;y<v;y++)if(g=h.tileMatrix[y],u=g.matrixHeight/_.matrixHeight,m=g.matrixWidth/_.matrixWidth,_=g,u!==2||m!==2)return!1;return!0},d.createTileMatrixSet=function(h){if(!h.matrixSet)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No matrixSet provided."));if(!h.projection)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No projection provided."));if(!h.extent||h.extent.length!=4)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No extent provided."));var u={lowerCorner:[h.extent[0],h.extent[1]],upperCorner:[h.extent[2],h.extent[3]]};if(!h.resolutions)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No resolutions provided."));if(!h.tileSize)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No tile size provided."));if(!h.topLeftCorner||h.topLeftCorner.length!=2)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","No extent provided."));if(h.prefix===void 0)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","Prefix not provided."));if(!(d.isEpsg4326Crs(h.projection)||d.isOGCCrs84(h.projection)||d.isEpsg3857Crs(h.projection)))throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","createTileMatrixSet","Projection provided not supported."));for(var m=[],g,_=0;_<h.resolutions.length;_++){d.isEpsg4326Crs(h.projection)||d.isOGCCrs84(h.projection)?g=h.resolutions[_]*6378137*2*Math.PI/360/28e-5:d.isEpsg3857Crs(h.projection)&&(g=h.resolutions[_]/28e-5);var y=h.tileSize*h.resolutions[_],v=h.tileSize*h.resolutions[_],b=Math.ceil((h.extent[2]-h.extent[0]-.01*y)/y),R=Math.ceil((h.extent[3]-h.extent[1]-.01*v)/v),M={identifier:h.prefix?h.matrixSet+":"+_:_,levelNumber:_,matrixHeight:R,matrixWidth:b,tileHeight:h.tileSize,tileWidth:h.tileSize,topLeftCorner:h.topLeftCorner,scaleDenominator:g};m.push(M)}return{identifier:h.matrixSet,supportedCRS:h.projection,boundingBox:u,tileMatrix:m}},d.formLayerConfiguration=function(h,u,m,g){var _={};if(_.identifier=h.identifier,g){for(var y=!1,v=0;v<h.format.length;v++)if(h.format[v]===g){y=!0,_.format=h.format[v];break}y||(n.logMessage(n.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","The specified image format is not available. Another one will be used."),_.format=null)}if(_.format||(h.format.indexOf("image/png")>=0?_.format="image/png":h.format.indexOf("image/jpeg")>=0?_.format="image/jpeg":h.format.indexOf("image/tiff")>=0?_.format="image/tiff":h.format.indexOf("image/gif")>=0?_.format="image/gif":_.format=h.format[0]),!_.format)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","formLayerConfiguration","Layer does not provide a supported image format."));if(h.resourceUrl&&h.resourceUrl.length>=1){for(var v=0;v<h.resourceUrl.length;v++)if(_.format===h.resourceUrl[v].format){_.resourceUrl=h.resourceUrl[v].template;break}}else _.service=h.capabilities.getGetTileKvpAddress(),_.service&&(_.service=a.fixGetMapString(_.service));if(!_.resourceUrl&&!_.service)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","formLayerConfiguration","No resource URL or KVP GetTile service URL specified in WMTS capabilities."));if(u){for(var b=!1,v=0;v<h.style.length;v++)if(h.style[v].identifier===u){b=!0,_.style=h.style[v].identifier;break}b||(n.logMessage(n.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","The specified style identifier is not available. The server's default style will be used."),_.style=null)}if(!_.style){for(v=0;v<h.style.length;v++)if(h.style[v].isDefault){_.style=h.style[v].identifier;break}}_.style||n.logMessage(n.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","No default style available. A style will not be specified in tile requests.");var R=h.getLayerSupportedTileMatrixSets();if(m){for(var v=0,M=R.length;v<M;v++)if(R[v].identifier===m&&d.isTileSubdivisionCompatible(R[v])){_.tileMatrixSet=R[v];break}_.tileMatrixSet||(n.logMessage(n.LEVEL_WARNING,"WmtsLayer","formLayerConfiguration","The specified tileMatrixSet is not available. Another one will be used."),_.tileMatrixSet=null)}if(!_.tileMatrixSet){for(var P,T=null,E=null,x=null,v=0,M=R.length;v<M;v++)P=R[v],d.isTileSubdivisionCompatible(P)&&(d.isEpsg4326Crs(P.supportedCRS)?T=T||P:d.isEpsg3857Crs(P.supportedCRS)?E=E||P:d.isOGCCrs84(P.supportedCRS)&&(x=x||P));_.tileMatrixSet=T||E||x}if(!_.tileMatrixSet)throw new l(n.logMessage(n.LEVEL_SEVERE,"WmtsLayer","formLayerConfiguration","No supported Tile Matrix Set could be found."));return _.boundingBox=h.boundingBox,_.wgs84BoundingBox=h.wgs84BoundingBox,h.titles.length>0?_.title=h.titles[0].value:_.title=h.identifier,_},d.prototype=Object.create(t.prototype),d.prototype.doRender=function(h){h.terrain&&((this.currentTilesInvalid||!h.modelviewProjection.equals(this.lasTtMVP)||h.globeStateKey!==this.lastGlobeStateKey)&&(this.currentTilesInvalid=!1,this.assembleTiles(h)),this.lasTtMVP.copy(h.modelviewProjection),this.lastGlobeStateKey=h.globeStateKey,this.currentTiles.length>0&&(h.surfaceTileRenderer.renderTiles(h,this.currentTiles,this.opacity),h.frameStatistics.incrementImageTileCount(this.currentTiles.length),this.inCurrentFrame=!0))},d.prototype.isLayerInView=function(h){return h.terrain&&h.terrain.sector&&h.terrain.sector.intersects(this.sector)},d.prototype.isTileVisible=function(h,u){return h.globe.projectionLimits&&!u.sector.overlaps(h.globe.projectionLimits)?!1:u.extent.intersectsFrustum(h.frustumInModelCoordinates)},d.prototype.assembleTiles=function(h){this.currentTiles=[],(!this.topLevelTiles||this.topLevelTiles.length===0)&&this.createTopLevelTiles(h);for(var u=0,m=this.topLevelTiles.length;u<m;u++){var g=this.topLevelTiles[u];g.update(h),this.currentAncestorTile=null,this.isTileVisible(h,g)&&this.addTileOrDescendants(h,g)}},d.prototype.addTileOrDescendants=function(h,u){if(u.column>=u.tileMatrix.matrixWidth&&(u.column=u.column-u.tileMatrix.matrixWidth),u.column<0&&(u.column=u.column+u.tileMatrix.matrixWidth),this.tileMeetsRenderingCriteria(h,u)){this.addTile(h,u);return}var m=null;try{(this.isTileTextureInMemory(h,u)||u.tileMatrix.levelNumber===0)&&(m=this.currentAncestorTile,this.currentAncestorTile=u);for(var g=this.tileMatrixSet.tileMatrix[u.tileMatrix.levelNumber+1],_=u.subdivideToCache(g,this,this.tileCache),y=0,v=_.length;y<v;y++){var b=_[y];b.update(h),this.sector.intersects(b.sector)&&this.isTileVisible(h,b)&&this.addTileOrDescendants(h,b)}}finally{m&&(this.currentAncestorTile=m)}},d.prototype.addTile=function(h,u){u.fallbackTile=null;var m=h.gpuResourceCache.resourceForKey(u.imagePath);if(m){this.currentTiles.push(u),this.expiration&&this.isTextureExpired(m)&&this.retrieveTileImage(h,u);return}this.retrieveTileImage(h,u),this.currentAncestorTile&&this.isTileTextureInMemory(h,this.currentAncestorTile)&&this.currentTiles.push(this.currentAncestorTile)},d.prototype.isTextureExpired=function(h){return this.expiration&&h.creationTime.getTime()<=this.expiration.getTime()},d.prototype.isTileTextureInMemory=function(h,u){return h.gpuResourceCache.containsResource(u.imagePath)},d.prototype.tileMeetsRenderingCriteria=function(h,u){var m=this.detailControl;return(u.sector.minLatitude>=75||u.sector.maxLatitude<=-75)&&(m*=1.2),u.tileMatrix.levelNumber===this.tileMatrixSet.tileMatrix.length-1||!u.mustSubdivide(h,m)},d.prototype.retrieveTileImage=function(h,u){if(this.currentRetrievals.indexOf(u.imagePath)<0){if(this.currentRetrievals.length>this.retrievalQueueSize||this.absentResourceList.isResourceAbsent(u.imagePath))return;var m=this.resourceUrlForTile(u,this.imageFormat),g=new Image,_=u.imagePath,y=h.gpuResourceCache,v=h.currentGlContext.canvas,b=this;if(!m){this.currentTilesInvalid=!0;return}m=m.substr(0,m.indexOf("?"))+encodeURIComponent(m.substr(m.indexOf("?"))),g.onload=function(){n.log(n.LEVEL_INFO,"Image retrieval succeeded: "+m);var R=b.createTexture(h,u,g);if(b.removeFromCurrentRetrievals(_),R){y.putResource(_,R,R.size),b.currentTilesInvalid=!0,b.absentResourceList.unmarkResourceAbsent(_);var M=document.createEvent("Event");M.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),v.dispatchEvent(M)}},g.onerror=function(){b.removeFromCurrentRetrievals(_),b.absentResourceList.markResourceAbsent(_),n.log(n.LEVEL_WARNING,"Image retrieval failed: "+m)},this.currentRetrievals.push(_),g.crossOrigin="anonymous",g.src=m}},d.prototype.resourceUrlForTile=function(h,u){var m;return this.resourceUrl?(m=this.resourceUrl.replace("{Style}",this.styleIdentifier).replace("{TileMatrixSet}",this.tileMatrixSet.identifier).replace("{TileMatrix}",h.tileMatrix.identifier).replace("{TileCol}",h.column).replace("{TileRow}",h.row),this.timeString&&(m=m.replace("{Time}",this.timeString))):(m=this.serviceUrl+"service=WMTS&request=GetTile&version=1.0.0",m+="&Layer="+this.layerIdentifier,this.styleIdentifier&&(m+="&Style="+this.styleIdentifier),m+="&Format="+u,this.timeString&&(m+="&Time="+this.timeString),m+="&TileMatrixSet="+this.tileMatrixSet.identifier,m+="&TileMatrix="+h.tileMatrix.identifier,m+="&TileRow="+h.row,m+="&TileCol="+h.column),m},d.prototype.removeFromCurrentRetrievals=function(h){var u=this.currentRetrievals.indexOf(h);u>-1&&this.currentRetrievals.splice(u,1)},d.prototype.createTopLevelTiles=function(h){var u=this.tileMatrixSet.tileMatrix[0];this.topLevelTiles=[];for(var m=0;m<u.matrixHeight;m++)for(var g=0;g<u.matrixWidth;g++)this.topLevelTiles.push(this.createTile(u,m,g))},d.prototype.createTile=function(h,u,m){if(d.isEpsg4326Crs(this.tileMatrixSet.supportedCRS))return this.createTile4326(h,u,m);if(d.isEpsg3857Crs(this.tileMatrixSet.supportedCRS))return this.createTile3857(h,u,m);if(d.isOGCCrs84(this.tileMatrixSet.supportedCRS))return this.createTileCrs84(h,u,m)},d.prototype.createTileCrs84=function(h,u,m){var g=this.sector.deltaLatitude()/h.matrixHeight,_=this.sector.deltaLongitude()/h.matrixWidth,y=h.topLeftCorner[1]-u*g,v=y-g,b=h.topLeftCorner[0]+_*m,R=b+_,M=new i(v,y,b,R);return this.makeTile(M,h,u,m)},d.prototype.createTile4326=function(h,u,m){var g=this.sector.deltaLatitude()/h.matrixHeight,_=this.sector.deltaLongitude()/h.matrixWidth,y=h.topLeftCorner[0]-u*g,v=y-g,b=h.topLeftCorner[1]+_*m,R=b+_,M=new i(v,y,b,R);return this.makeTile(M,h,u,m)},d.prototype.createTile3857=function(h,u,m){h.mapWidth||this.computeTileMatrixValues3857(h);var g=o.clamp(m*h.tileWidth-.5,0,h.mapWidth),_=o.clamp(u*h.tileHeight-.5,0,h.mapHeight),y=o.clamp(g+h.tileWidth+.5,0,h.mapWidth),v=o.clamp(_+h.tileHeight+.5,0,h.mapHeight),b,R,M,P,T,E;b=g/h.mapWidth,R=v/h.mapHeight,P=h.topLeftCorner[0]+b*h.tileMatrixDeltaX,M=h.topLeftCorner[1]-R*h.tileMatrixDeltaY;var x=o.epsg3857ToEpsg4326(P,M);b=y/h.mapWidth,R=_/h.mapHeight,E=h.topLeftCorner[0]+b*h.tileMatrixDeltaX,T=h.topLeftCorner[1]-R*h.tileMatrixDeltaY;var S=o.epsg3857ToEpsg4326(E,T),L=new i(x[0],S[0],x[1],S[1]);return this.makeTile(L,h,u,m)},d.prototype.computeTileMatrixValues3857=function(h){var u=h.scaleDenominator*28e-5,m=h.tileWidth*u,g=h.tileHeight*u,_=h.topLeftCorner[0]+m*h.matrixWidth,y=h.topLeftCorner[1]-g*h.matrixHeight,v=[_,y],b=h.topLeftCorner;h.tileMatrixDeltaX=v[0]-b[0],h.tileMatrixDeltaY=b[1]-v[1],h.mapWidth=h.tileWidth*h.matrixWidth,h.mapHeight=h.tileHeight*h.matrixHeight},d.prototype.makeTile=function(h,u,m,g){var _=this.cachePath+"-layer/"+u.identifier+"/"+m+"/"+g+"."+c.suffixForMimeType(this.imageFormat);return new f(h,u,m,g,_)},d.prototype.createTexture=function(h,u,m){if(d.isEpsg4326Crs(this.tileMatrixSet.supportedCRS))return new s(h.currentGlContext,m);if(d.isEpsg3857Crs(this.tileMatrixSet.supportedCRS))return this.createTexture3857(h,u,m);if(d.isOGCCrs84(this.tileMatrixSet.supportedCRS))return new s(h.currentGlContext,m)},d.prototype.createTexture3857=function(h,u,m){this.destCanvas||(this.destCanvas=document.createElement("canvas"),this.destContext=this.destCanvas.getContext("2d"));var g=h.canvas2D,_=h.ctx2D,y,v=this.destCanvas,b=this.destContext,R=b.createImageData(m.width,m.height),M=u.sector,P=o.gudermannianInverse(M.minLatitude),T=o.gudermannianInverse(M.maxLatitude),E,x,S,L,C,F,q;g.width=m.width,g.height=m.height,v.width=m.width,v.height=m.height,_.drawImage(m,0,0,m.width,m.height),y=_.getImageData(0,0,m.width,m.height);for(var it=0;it<1;it++)for(var st=0;st<m.height;st++){F=1-st/(m.height-1),E=F*M.deltaLatitude()+M.minLatitude,x=o.gudermannianInverse(E),q=1-(x-P)/(T-P),q=o.clamp(q,0,1),S=Math.floor(q*(m.height-1));for(var pt=0;pt<m.width;pt++)L=4*(pt+S*m.width),C=4*(pt+st*m.width),R.data[C]=y.data[L],R.data[C+1]=y.data[L+1],R.data[C+2]=y.data[L+2],R.data[C+3]=y.data[L+3]}return b.putImageData(R,0,0),new s(h.currentGlContext,v)},d.isEpsg4326Crs=function(h){return h.indexOf("EPSG")>=0&&h.indexOf("4326")>=0},d.isEpsg3857Crs=function(h){return h.indexOf("EPSG")>=0&&(h.indexOf("3857")>=0||h.indexOf("900913")>=0)},d.isOGCCrs84=function(h){return h.indexOf("OGC")>=0&&h.indexOf("CRS84")>=0},d}),B("layer/OpenStreetMapImageLayer",["../util/Color","../layer/Layer","../util/Logger","../ogc/wmts/WmtsCapabilities","../layer/WmtsLayer"],function(p,l,n,e,i){"use strict";var t=function(r){l.call(this,this.displayName),this.displayName=r||"Open Street Map",this.layer=null,this.xhr=null,this.pickEnabled=!0};return t.prototype=Object.create(l.prototype),t.prototype.doRender=function(r){this.configureLayer(r),this.layer&&(this.layer.opacity=this.opacity,this.layer.doRender(r),this.inCurrentFrame=this.layer.inCurrentFrame,this.inCurrentFrame&&(r.screenCreditController.addCredit("OpenStreetMap \xA9",p.DARK_GRAY),r.screenCreditController.addCredit("EOX.at \xA9",p.DARK_GRAY)))},t.prototype.configureLayer=function(r){if(!this.xhr){var s=this,a=r.currentGlContext.canvas;this.xhr=new XMLHttpRequest,this.xhr.open("GET","https://tiles.maps.eox.at/wmts/1.0.0/WMTSCapabilities.xml",!0),this.xhr.onreadystatechange=function(){if(s.xhr.readyState===4)if(s.xhr.status===200){var f=new e(s.xhr.responseXML),o=f.getLayer("osm"),c=i.formLayerConfiguration(o);c.title=s.displayName,s.layer=new i(c);var d=document.createEvent("Event");d.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),a.dispatchEvent(d)}else n.log(n.LEVEL_WARNING,"OSM retrieval failed ("+xhr.statusText+"): "+url)},this.xhr.onerror=function(){n.log(n.LEVEL_WARNING,"OSM retrieval failed: "+url)},this.xhr.ontimeout=function(){n.log(n.LEVEL_WARNING,"OSM retrieval timed out: "+url)},this.xhr.send(null)}},t}),B("projections/ProjectionGnomonic",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Sector","../util/WWMath"],function(p,l,n,e,i,t){"use strict";var r=function(s){this.north=s!=="South";var a=this.north?new i(30,90,-180,180):new i(-90,-30,-180,180);n.call(this,"Polar Gnomonic",!1,a),this._pole=s,this.displayName=this.north?"North Gnomonic":"South Gnomonic",this._stateKey="projection polar gnomonic "+this._pole+" "};return r.prototype=Object.create(n.prototype),Object.defineProperties(r.prototype,{pole:{get:function(){return this._pole},set:function(s){this._pole=s,this.north=this._pole!=="South",this.projectionLimits=this.north?new i(30,90,-180,180):new i(-90,-30,-180,180),this._stateKey="projection polar gnomonic "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}}),r.prototype.geographicToCartesian=function(s,a,f,o,c,d){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesian","missingGlobe"));if(!d)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesian","missingResult"));if(this.north&&a===90||!this.north&&a===-90)d[0]=0,d[1]=0,d[2]=o;else{var h=this.north?1:-1,u=s.equatorialRadius/Math.tan(a*p.DEGREES_TO_RADIANS);d[0]=u*Math.sin(f*p.DEGREES_TO_RADIANS)*h,d[1]=u*-Math.cos(f*p.DEGREES_TO_RADIANS),d[2]=o}return d},r.prototype.geographicToCartesianGrid=function(s,a,f,o,c,d,h,u){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingGlobe"));if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingSector"));if(!c||c.length<f*o)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!u)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","geographicToCartesianGrid","missingResult"));var m=a.minLatitude*p.DEGREES_TO_RADIANS,g=a.maxLatitude*p.DEGREES_TO_RADIANS,_=a.minLongitude*p.DEGREES_TO_RADIANS,y=a.maxLongitude*p.DEGREES_TO_RADIANS,v=(g-m)/(f>1?f-1:1),b=(y-_)/(o>1?o-1:1),R=this.projectionLimits.minLatitude*p.DEGREES_TO_RADIANS,M=this.projectionLimits.maxLatitude*p.DEGREES_TO_RADIANS,P=this.north?1:-1,T=d||new Vec3(0,0,0),E,x,S=0,L=0,C,F,q,it;for(E=0,C=m;E<f;E++,C+=v)for(E===f-1&&(C=g),q=t.clamp(C,R,M),it=s.equatorialRadius/Math.tan(q),(this.north&&q===Math.PI/2||!this.north&&q===-Math.PI/2)&&(it=0),x=0,F=_;x<o;x++,F+=b)x===o-1&&(F=y),u[L++]=it*Math.sin(F)*P-T[0],u[L++]=it*-Math.cos(F)-T[1],u[L++]=c[S++]-T[2];return u},r.prototype.cartesianToGeographic=function(s,a,f,o,c,d){if(!s)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","cartesianToGeographic","missingGlobe"));if(!d)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","cartesianToGeographic","missingResult"));var h=Math.sqrt(a*a+f*f),u;return h<1e-4?(d.latitude=this.north?90:-90,d.longitude=0,d.altitude=o):(u=Math.atan2(h,s.equatorialRadius),u>Math.PI&&(u=Math.PI),d.latitude=Math.asin(Math.cos(u)*(this.north?1:-1))*p.RADIANS_TO_DEGREES,d.longitude=Math.atan2(a,f*(this.north?-1:1))*p.RADIANS_TO_DEGREES,d.altitude=o),d},r.prototype.northTangentAtLocation=function(s,a,f,o){if(!o)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","northTangentAtLocation","missingResult"));return o[0]=Math.sin(f*p.DEGREES_TO_RADIANS)*(this.north?-1:1),o[1]=Math.cos(f*p.DEGREES_TO_RADIANS),o[2]=0,o},r.prototype.northTangentAtPoint=function(s,a,f,o,c,d){if(!d)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionGnomonic","northTangentAtLocation","missingResult"));var h=Math.sqrt(a*a+f*f);return h<1e-4?(d[0]=0,d[1]=1,d[2]=0):(d[0]=a/h*(this.north?-1:1),d[1]=f/h*(this.north?-1:1),d[2]=0),d},r}),B("projections/ProjectionMercator",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Sector","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r){"use strict";var s=function(){n.call(this,"Mercator",!0,new i(-78,78,-180,180))};return s.prototype=Object.create(n.prototype),s.prototype.geographicToCartesian=function(a,f,o,c,d,h){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesian","missingGlobe"));if(!h)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesian","missingResult"));f>this.projectionLimits.maxLatitude&&(f=this.projectionLimits.maxLatitude),f<this.projectionLimits.minLatitude&&(f=this.projectionLimits.minLatitude);var u=Math.sqrt(a.eccentricitySquared),m=Math.sin(f*p.DEGREES_TO_RADIANS),g=(1+m)/(1-m)*Math.pow((1-u*m)/(1+u*m),u);return h[0]=a.equatorialRadius*o*p.DEGREES_TO_RADIANS+(d?d[0]:0),h[1]=.5*a.equatorialRadius*Math.log(g),h[2]=c,h},Object.defineProperties(s.prototype,{stateKey:{get:function(){return"projection mercator "}}}),s.prototype.geographicToCartesianGrid=function(a,f,o,c,d,h,u,m){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingGlobe"));if(!f)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingSector"));if(!d||d.length<o*c)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!m)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionMercator","geographicToCartesianGrid","missingResult"));var g=a.equatorialRadius,_=Math.sqrt(a.eccentricitySquared),y=f.minLatitude*p.DEGREES_TO_RADIANS,v=f.maxLatitude*p.DEGREES_TO_RADIANS,b=f.minLongitude*p.DEGREES_TO_RADIANS,R=f.maxLongitude*p.DEGREES_TO_RADIANS,M=(v-y)/(o>1?o-1:1),P=(R-b)/(c>1?c-1:1),T=this.projectionLimits.minLatitude*p.DEGREES_TO_RADIANS,E=this.projectionLimits.maxLatitude*p.DEGREES_TO_RADIANS,x=h||new t(0,0,0),S=u?u[0]:0,L,C,F=0,q=0,it,st,pt,_t,X,ot;for(L=0,it=y;L<o;L++,it+=M)for(L===o-1&&(it=v),pt=r.clamp(it,T,E),_t=Math.sin(pt),X=(1+_t)/(1-_t)*Math.pow((1-_*_t)/(1+_*_t),_),ot=g*Math.log(X)*.5-x[1],C=0,st=b;C<c;C++,st+=P)C===c-1&&(st=R),m[q++]=g*st-x[0]+S,m[q++]=ot,m[q++]=d[F++]-x[2];return m},s.prototype.cartesianToGeographic=function(a,f,o,c,d,h){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionMercator","cartesianToGeographic","missingGlobe"));if(!h)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionMercator","cartesianToGeographic","missingResult"));var u=a.eccentricitySquared,m=u*u,g=m*u,_=g*u,y=Math.pow(Math.E,-o/a.equatorialRadius),v=Math.PI/2-2*Math.atan(y),b=u/2+5*m/24+g/12+13*_/360,R=7*m/48+29*g/240+811*_/11520,M=7*g/120+81*_/1120,P=4279*_/161280,T=v-R+P,E=b-3*M,x=2*R-8*P,S=4*M,L=8*P,C=Math.sin(2*v),F=T+C*(E+C*(x+C*(S+L*C)));return h.latitude=F*p.RADIANS_TO_DEGREES,h.longitude=(f-(d?d[0]:0))/a.equatorialRadius*p.RADIANS_TO_DEGREES,h.altitude=c,h},s}),B("projections/ProjectionPolarEquidistant",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger"],function(p,l,n,e){"use strict";var i=function(t){n.call(this,"Polar Equidistant",!1,null),this._pole=t,this.north=t!=="South",this.displayName=this.north?"North Polar":"South Polar",this._stateKey="projection polar equidistant "+this._pole+" "};return i.prototype=Object.create(n.prototype),Object.defineProperties(i.prototype,{pole:{get:function(){return this._pole},set:function(t){this._pole=t,this.north=this._pole!=="South",this._stateKey="projection polar equidistant "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}}),i.prototype.geographicToCartesian=function(t,r,s,a,f,o){if(!t)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesian","missingGlobe"));if(!o)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesian","missingResult"));if(this.north&&r===90||!this.north&&r===-90)o[0]=0,o[1]=0,o[2]=a;else{var c=this.north?-1:1,d=t.equatorialRadius*(Math.PI/2+r*p.DEGREES_TO_RADIANS*c);o[0]=d*Math.sin(s*p.DEGREES_TO_RADIANS),o[1]=d*Math.cos(s*p.DEGREES_TO_RADIANS)*c,o[2]=a}return o},i.prototype.geographicToCartesianGrid=function(t,r,s,a,f,o,c,d){if(!t)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingGlobe"));if(!r)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingSector"));if(!f||f.length<s*a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!d)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","geographicToCartesianGrid","missingResult"));var h=t.equatorialRadius,u=r.minLatitude*p.DEGREES_TO_RADIANS,m=r.maxLatitude*p.DEGREES_TO_RADIANS,g=r.minLongitude*p.DEGREES_TO_RADIANS,_=r.maxLongitude*p.DEGREES_TO_RADIANS,y=(m-u)/(s>1?s-1:1),v=(_-g)/(a>1?a-1:1),b=this.north?-1:1,R=o||new Vec3(0,0,0),M=Math.PI/2,P,T,E=0,x=0,S=new Float64Array(a),L=new Float64Array(a),C,F,q;for(T=0,F=g;T<a;T++,F+=v)T===a-1&&(F=_),S[T]=Math.cos(F),L[T]=Math.sin(F);for(P=0,C=u;P<s;P++,C+=y)for(P===s-1&&(C=m),q=h*(M+C*b),(this.north&&C===M||!this.north&&C===-M)&&(q=0),T=0;T<a;T++)d[x++]=q*L[T]-R[0],d[x++]=q*S[T]*b-R[1],d[x++]=f[E++]-R[2];return d},i.prototype.cartesianToGeographic=function(t,r,s,a,f,o){if(!t)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","cartesianToGeographic","missingGlobe"));if(!o)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","cartesianToGeographic","missingResult"));var c=Math.sqrt(r*r+s*s),d;return c<1e-4?(o.latitude=this.north?90:-90,o.longitude=0,o.altitude=a):(d=c/t.equatorialRadius,d>Math.PI&&(d=Math.PI),o.latitude=Math.asin(Math.cos(d)*(this.north?1:-1))*p.RADIANS_TO_DEGREES,o.longitude=Math.atan2(r,s*(this.north?-1:1))*p.RADIANS_TO_DEGREES,o.altitude=a),o},i.prototype.northTangentAtLocation=function(t,r,s,a){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));return a[0]=Math.sin(s*p.DEGREES_TO_RADIANS)*(this.north?-1:1),a[1]=Math.cos(s*p.DEGREES_TO_RADIANS),a[2]=0,a},i.prototype.northTangentAtPoint=function(t,r,s,a,f,o){if(!o)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));var c=Math.sqrt(r*r+s*s);return c<1e-4?(o[0]=0,o[1]=1,o[2]=0):(o[0]=r/c*(this.north?-1:1),o[1]=s/c*(this.north?-1:1),o[2]=0),o},i}),B("projections/ProjectionUPS",["../geom/Angle","../error/ArgumentError","../projections/GeographicProjection","../util/Logger","../geom/Sector","../geom/Vec3","../util/WWMath"],function(p,l,n,e,i,t,r){"use strict";var s=function(a){this.north=a!=="South";var f=this.north?new i(0,90,-180,180):new i(-90,0,-180,180);n.call(this,"Uniform Polar Stereographic",!1,f),this._pole=a,this.displayName=this.north?"North UPS":"South UPS",this._stateKey="projection ups "+this._pole+" "};return s.prototype=Object.create(n.prototype),Object.defineProperties(s.prototype,{pole:{get:function(){return this._pole},set:function(a){this._pole=a,this.north=this._pole!=="South",this.projectionLimits=this.north?new i(0,90,-180,180):new i(-90,0,-180,180),this._stateKey="projection ups "+this._pole+" "}},stateKey:{get:function(){return this._stateKey}}}),s.prototype.geographicToCartesian=function(a,f,o,c,d,h){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesian","missingGlobe"));if(!h)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesian","missingResult"));if(this.north&&f===90||!this.north&&f===-90)h[0]=0,h[1]=0,h[2]=c;else{var u=this.north?1:-1,m=f*p.DEGREES_TO_RADIANS,g=o*p.DEGREES_TO_RADIANS,_=.994,y=Math.sqrt(a.eccentricitySquared),v=Math.sqrt(Math.pow(1+y,1+y)*Math.pow(1-y,1-y)),b,R,M;(this.north&&m<0||!this.north&&m>0)&&(m=0),b=Math.sin(m*u),R=Math.sqrt((1-b)/(1+b)*Math.pow((1+y*b)/(1-y*b),y)),M=2*a.equatorialRadius*_*R/v,h[0]=M*Math.sin(g),h[1]=-M*Math.cos(g)*u,h[2]=c}return h},s.prototype.geographicToCartesianGrid=function(a,f,o,c,d,h,u,m){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingGlobe"));if(!f)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingSector"));if(!d||d.length<o*c)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","The specified elevations array is null, undefined or insufficient length"));if(!m)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionUPS","geographicToCartesianGrid","missingResult"));var g=a.equatorialRadius,_=f.minLatitude*p.DEGREES_TO_RADIANS,y=f.maxLatitude*p.DEGREES_TO_RADIANS,v=f.minLongitude*p.DEGREES_TO_RADIANS,b=f.maxLongitude*p.DEGREES_TO_RADIANS,R=(y-_)/(o>1?o-1:1),M=(b-v)/(c>1?c-1:1),P=this.projectionLimits.minLatitude*p.DEGREES_TO_RADIANS,T=this.projectionLimits.maxLatitude*p.DEGREES_TO_RADIANS,E=.994,x=Math.sqrt(a.eccentricitySquared),S=Math.sqrt(Math.pow(1+x,1+x)*Math.pow(1-x,1-x)),L=this.north?1:-1,C=h||new t(0,0,0),F,q,it=0,st=0,pt,_t,X,ot,Tt,Vt;for(F=0,pt=_;F<o;F++,pt+=R)for(F===o-1&&(pt=y),X=r.clamp(pt,P,T),ot=Math.sin(X*L),Tt=Math.sqrt((1-ot)/(1+ot)*Math.pow((1+x*ot)/(1-x*ot),x)),Vt=2*g*E*Tt/S,q=0,_t=v;q<c;q++,_t+=M)q===c-1&&(_t=b),m[st++]=Vt*Math.sin(_t)-C[0],m[st++]=-Vt*Math.cos(_t)*L-C[1],m[st++]=d[it++]-C[2];return m},s.prototype.cartesianToGeographic=function(a,f,o,c,d,h){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionUPS","cartesianToGeographic","missingGlobe"));if(!h)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionUPS","cartesianToGeographic","missingResult"));var u=Math.atan2(f,o*(this.north?-1:1)),m=.994,g=Math.sqrt(a.eccentricitySquared),_=Math.sqrt(f*f+o*o),y=Math.sqrt(Math.pow(1+g,1+g)*Math.pow(1-g,1-g)),v=_*y/(2*a.equatorialRadius*m),b=a.eccentricitySquared,R=b*b,M=R*b,P=M*b,T=Math.PI/2-2*Math.atan(v),E=b/2+5*R/24+M/12+13*P/360,x=7*R/48+29*M/240+811*P/11520,S=7*M/120+81*P/1120,L=4279*P/161280,C=T-x+L,F=E-3*S,q=2*x-8*L,it=4*S,st=8*L,pt=Math.sin(2*T),_t=C+pt*(F+pt*(q+pt*(it+st*pt)));return _t*=this.north?1:-1,h.latitude=_t*p.RADIANS_TO_DEGREES,h.longitude=u*p.RADIANS_TO_DEGREES,h.altitude=c,h},s.prototype.northTangentAtLocation=function(a,f,o,c){if(!c)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionUPS","northTangentAtLocation","missingResult"));return c[0]=Math.sin(o*p.DEGREES_TO_RADIANS)*(this.north?-1:1),c[1]=Math.cos(o*p.DEGREES_TO_RADIANS),c[2]=0,c},s.prototype.northTangentAtPoint=function(a,f,o,c,d,h){if(!h)throw new l(e.logMessage(e.LEVEL_SEVERE,"ProjectionPolarEquidistant","northTangentAtLocation","missingResult"));var u=Math.sqrt(f*f+o*o);return u<1e-4?(h[0]=0,h[1]=1,h[2]=0):(h[0]=f/u*(this.north?-1:1),h[1]=o/u*(this.north?-1:1),h[2]=0),h},s}),B("util/ByteBuffer",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"ByteBuffer","constructor","missingArray"));this.array=e,this.data=new DataView(e),this.position=0,this._order=n.LITTLE_ENDIAN};return n.prototype.getByte=function(){var e=this.data.getUint8(this.position);return this.position+=n.BYTE_SIZE,e},n.prototype.getByteArray=function(e){var i=new Uint8Array(this.array,this.position,e);return this.position+=n.BYTE_SIZE*e,i},n.prototype.getInt16=function(){var e=this.data.getInt16(this.position,this._order);return this.position+=n.INT16_SIZE,e},n.prototype.getInt16Array=function(e){var i=new Int16Array(this.array,this.position,e);return this.position+=n.INT16_SIZE*e,i},n.prototype.getInt32=function(){var e=this.data.getInt32(this.position,this._order);return this.position+=n.INT32_SIZE,e},n.prototype.getInt32Array=function(e){var i=new Int32Array(this.array,this.position,e);return this.position+=n.INT32_SIZE*e,i},n.prototype.getFloat=function(){var e=this.data.getFloat32(this.position,this._order);return this.position+=n.FLOAT_SIZE,e},n.prototype.getFloatArray=function(e){var i=new Float32Array(this.array,this.position,e);return this.position+=n.FLOAT_SIZE*e,i},n.prototype.getDouble=function(){var e=this.data.getFloat64(this.position,this._order);return this.position+=n.DOUBLE_SIZE,e},n.prototype.getDoubleArray=function(e){var i;if(this.position%8!=0){var t=this.array.slice(this.position,this.position+e*n.DOUBLE_SIZE);i=new Float64Array(t)}else i=new Float64Array(this.array,this.position,e);return this.position+=n.DOUBLE_SIZE*e,i},n.prototype.skipBytes=function(e){this.position+=e*n.BYTE_SIZE},n.prototype.skipInt16s=function(e){this.position+=e*n.INT16_SIZE},n.prototype.skipInt32s=function(e){this.position+=e*n.INT32_SIZE},n.prototype.skipFloats=function(e){this.position+=e*n.FLOAT_SIZE},n.prototype.skipDoubles=function(e){this.position+=e*n.DOUBLE_SIZE},n.prototype.seek=function(e){this.position=e},n.prototype.order=function(e){this._order=e},n.prototype.limit=function(){return this.data.byteLength},n.prototype.hasRemaining=function(){return this.position<this.data.byteLength},n.BIG_ENDIAN=!1,n.LITTLE_ENDIAN=!0,n.BYTE_SIZE=1,n.INT16_SIZE=2,n.INT32_SIZE=4,n.FLOAT_SIZE=4,n.DOUBLE_SIZE=8,n}),B("formats/shapefile/DBaseField",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseFile","../../util/Logger"],function(p,l,n,e){"use strict";var i=function(t,r){if(!t)throw new p(e.logMessage(e.LEVEL_SEVERE,"DBaseField","constructor","missingAttributeName"));if(!r)throw new p(e.logMessage(e.LEVEL_SEVERE,"DBaseField","constructor","missingBuffer"));this.name=null,this.type=null,this.typeCode=-1,this.length=-1,this.decimals=-1,this.readFieldDescriptor(t,r)};return i.prototype.getName=function(){return this.name},i.prototype.getType=function(){return this.type},i.prototype.getLength=function(){return this.length},i.prototype.getDecimals=function(){return this.decimals},i.prototype.readFieldDescriptor=function(t,r){r.order(l.LITTLE_ENDIAN);var s=r.position;if(this.name=t.readNullTerminatedString(r,i.FIELD_NAME_LENGTH),r.seek(s+i.FIELD_NAME_LENGTH),this.typeCode=String.fromCharCode(r.getByte()),this.type=i.getFieldType(this.typeCode),this.type==null)throw new Error(e.log(e.LEVEL_SEVERE,"Shapefile dBase encountered unsupported field type: "+this.typeCode));r.skipBytes(4),this.length=r.getByte(),this.decimals=r.getByte(),r.seek(s+i.FIELD_DESCRIPTOR_LENGTH)},i.getFieldType=function(t){switch(t){case"C":return i.TYPE_CHAR;case"D":return i.TYPE_DATE;case"F":return i.TYPE_NUMBER;case"L":return i.TYPE_BOOLEAN;case"N":return i.TYPE_NUMBER;default:return null}},i.prototype.toString=function(){return this.name+"("+this.typeCode+")"},i.TYPE_CHAR="DBase.FieldTypeChar",i.TYPE_NUMBER="DBase.FieldTypeNumber",i.TYPE_DATE="DBase.FieldTypeDate",i.TYPE_BOOLEAN="DBase.FieldTypeBoolean",i.FIELD_NAME_LENGTH=11,i.FIELD_DESCRIPTOR_LENGTH=32,i}),B("formats/shapefile/DBaseRecord",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseField","../../formats/shapefile/DBaseFile","../../util/Logger"],function(p,l,n,e,i){"use strict";var t=function(r,s,a){if(!r)throw new p(i.logMessage(i.LEVEL_SEVERE,"DBaseRecord","constructor","missingAttributeName"));if(!s)throw new p(i.logMessage(i.LEVEL_SEVERE,"DBaseRecord","constructor","missingBuffer"));this.deleted=!1,this.recordNumber=a,this.values=null,this.readFromBuffer(r,s,a)};return t.prototype.isDeleted=function(){return this.deleted},t.prototype.getRecordNumber=function(){return this.recordNumber},t.prototype.readFromBuffer=function(r,s,a){s.order(l.LITTLE_ENDIAN),this.recordNumber=a;var f=s.getByte();this.deleted=f==42;var o=r.getFields();this.values={};for(var c=0,d=o.length;c<d;c+=1){var h=o[c],u=h.getName(),m=r.readNullTerminatedString(s,h.getLength()).trim();try{if(h.getType()==n.TYPE_BOOLEAN){var g=m.charAt(0);this.values[u]=g=="t"||g=="T"||g=="Y"||g=="y"}else h.getType()==n.TYPE_CHAR?this.values[u]=m:h.getType()==n.TYPE_DATE?this.values[u]=new Date(m):h.getType()==n.TYPE_NUMBER&&(this.values[u]=+m)}catch(_){i.log(i.LEVEL_WARNING,"Shapefile attribute parsing error:"+h.toString()+" -> "+m.toString()+" ["+_+"]")}}},t}),B("formats/shapefile/DBaseFile",["../../error/ArgumentError","../../util/ByteBuffer","../../formats/shapefile/DBaseField","../../formats/shapefile/DBaseRecord","../../util/Logger"],function(p,l,n,e,i){"use strict";var t=function(r){if(!r)throw new p(i.logMessage(i.LEVEL_SEVERE,"DBaseFile","constructor","missingUrl"));this.url=r,this.header=null,this.fields=null,this.buffer=null,this.boolean=!0,this.numRecordsRead=0,this._completionCallback=null};return t.prototype.getLastModificationDate=function(){return this.header.lastModificationDate},t.prototype.getNumberOfRecords=function(){return this.header.numberOfRecords},t.prototype.getHeaderLength=function(){return this.header.headerLength},t.prototype.getRecordLength=function(){return this.header.recordLength},t.prototype.getNumberOfFields=function(){return(this.header.headerLength-1-t.FIXED_HEADER_LENGTH)/t.FIELD_DESCRIPTOR_LENGTH},t.prototype.getFields=function(){return this.fields},t.prototype.hasNext=function(){return this.numRecordsRead<this.header.numberOfRecords},t.prototype.nextRecord=function(){return this.numRecordsRead>=this.getNumberOfRecords()?null:this.readNextRecord(this._buffer,++this.numRecordsRead)},t.prototype.load=function(r){this._completionCallback=r,this.requestUrl(this.url)},t.prototype.requestUrl=function(r){var s=new XMLHttpRequest;s.open("GET",r,!0),s.responseType="arraybuffer",s.onreadystatechange=(function(){s.readyState===4&&(s.status===200?(this._buffer=new l(s.response),this.parse(),this._completionCallback&&this._completionCallback(this)):(i.log(i.LEVEL_WARNING,"DBaseFile retrieval failed ("+s.statusText+"): "+r),this._completionCallback&&this._completionCallback(this)))}).bind(this),s.onerror=function(){i.log(i.LEVEL_WARNING,"DBaseFile retrieval failed: "+r),this._completionCallback&&this._completionCallback(this)},s.ontimeout=function(){i.log(i.LEVEL_WARNING,"DBaseFile retrieval timed out: "+r),this._completionCallback&&this._completionCallback(this)},s.send(null)},t.prototype.parse=function(){this.header=this.readHeader(this._buffer),this.fields=this.readFieldDescriptors(this._buffer,this.getNumberOfFields())},t.prototype.readHeader=function(r){var s=r.position;r.order(l.LITTLE_ENDIAN);var a=r.getByte();if(a>5)throw new Error("???");var f=r.getByte(),o=r.getByte(),c=r.getByte(),d=r.getInt32(),h=r.getInt16(),u=r.getInt16(),m={year:1900+f,month:o-1,day:c},g={fileCode:a,lastModificationDate:m,numberOfRecords:d,headerLength:h,recordLength:u};return r.seek(s+t.FIXED_HEADER_LENGTH),g},t.prototype.readFieldDescriptors=function(r,s){for(var a=r.position,f=[],o=0;o<s;o+=1)f[o]=new n(this,r);var c=this.header.headerLength-t.FIXED_HEADER_LENGTH;return r.seek(a+c),f},t.prototype.readNextRecord=function(r,s){return new e(this,r,s)},t.prototype.readNullTerminatedString=function(r,s){if(s<=0)return 0;for(var a="",f=0;f<s;f+=1){var o=r.getByte();if(o==0)break;a+=String.fromCharCode(o)}return this.isStringEmpty(a)?"":a},t.prototype.isStringEmpty=function(r){return r.length<=0||t.isStringFilled(r,32)||t.isStringFilled(r,42)},t.isStringFilled=function(r,s){if(r.length<=0)return!1;for(var a=0;a<r.length;a++)if(r.charAt(a)!=s)return!1;return!0},t.FIXED_HEADER_LENGTH=32,t.FIELD_DESCRIPTOR_LENGTH=32,t}),B("formats/shapefile/PrjFile",["../../error/ArgumentError","../../util/Logger","../../error/NotYetImplementedError"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"DBaseFile","constructor","missingUrl"));this._url=i,this._completionCallback=null,this._params=null};return Object.defineProperties(e.prototype,{url:{get:function(){return this._url}},coordinateSystem:{get:function(){return this.params?this.params[e.COORDINATE_SYSTEM]:null}},params:{get:function(){return this._params}}}),e.prototype.load=function(i){this._completionCallback=i,this.requestUrl(this._url)},e.prototype.requestUrl=function(i){var t=new XMLHttpRequest;t.open("GET",i,!0),t.responseType="arraybuffer",t.onreadystatechange=(function(){if(t.readyState===4){if(t.status===200){var r=String.fromCharCode.apply(null,new Uint8Array(t.response));this._params=this.decodeOGCCoordinateSystem(r)}else l.log(l.LEVEL_WARNING,"PrjFile retrieval failed ("+t.statusText+"): "+i);this._completionCallback&&this._completionCallback(this)}}).bind(this),t.onerror=(function(){l.log(l.LEVEL_WARNING,"PrjFile retrieval failed: "+i),this._completionCallback&&this._completionCallback(this)}).bind(this),t.ontimeout=(function(){l.log(l.LEVEL_WARNING,"PrjFile retrieval timed out: "+i),this._completionCallback&&this._completionCallback(this)}).bind(this),t.send(null)},e.prototype.decodeOGCCoordinateSystem=function(i){i||new p(l.logMessage(l.LEVEL_SEVERE,"PrjFile","decodeOGCCoordinateSystem","missingText"));var t={};if(i=i.trim().toUpperCase(),e.GEOGCS_WKT_PATTERN.test(i))t[e.COORDINATE_SYSTEM]=e.COORDINATE_SYSTEM_GEOGRAPHIC;else{var r=i.match(e.PROJCS_WKT_PATTERN);if(r)throw t[PrfFile.COORDINATE_SYSTEM]=e.COORDINATE_SYSTEM_PROJECTED,new n(l.log(l.LEVEL_SEVERE,"PrjFile implementation  for projected coordinate systems in incomplete."));t[e.COORDINATE_SYSTEM]=e.COORDINATE_SYSTEM_UNKNOWN}return t},e.prototype.isUnknownCoordinateSystem=function(){return!this.params||this.params.coordinateSystem===e.COORDINATE_SYSTEM_UNKNOWN},e.prototype.isKnownCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem!==e.COORDINATE_SYSTEM_UNKNOWN},e.prototype.isGeographicCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem===e.COORDINATE_SYSTEM_GEOGRAPHIC},e.prototype.isProjectedCoordinateSystem=function(){return!!this.params&&this.params.coordinateSystem===e.COORDINATE_SYSTEM_PROJECTED},e.GEOGCS_WKT_PATTERN=new RegExp("\\{*GEOGCS[\\[\\(](.*)[\\]\\)]\\}*"),e.PROJCS_WKT_PATTERN=new RegExp("\\{*PROJCS[\\[\\(](.*)[\\]\\)]\\}*"),e.UTM_NAME_WKT_PATTERN=new RegExp(".*UTM.*ZONE.*?(\\d+).*?([\\w\\s]+).*?"),e.COORDINATE_SYSTEM="Coordinate_system",e.COORDINATE_SYSTEM_GEOGRAPHIC="Coordinate_system_geographic",e.COORDINATE_SYSTEM_PROJECTED="Coordinate_system_projected",e.COORDINATE_SYSTEM_UNKNOWN="Coordinate_system_unknown",e.PROJECTION_NAME="Projection_name",e.PROJECTION_UTM="Projection_UTM",e.PROJECTION_ZONE="Projection_zone",e.PROJECTION_HEMISPHERE="Projection_hemisphere",e.PROJECTION_HEMISPHERE_NORTH="Projection_hemisphere_north",e.PROJECTION_HEMISPHERE_SOUTH="Projection_hemisphere_south",e}),B("formats/shapefile/ShapefileRecord",["../../geom/Angle","../../error/ArgumentError","../../util/ByteBuffer","../../geom/Location","../../util/Logger","../../formats/shapefile/Shapefile"],function(p,l,n,e,i,t){"use strict";var r=function(s,a){if(!s)throw new l(i.logMessage(i.LEVEL_SEVERE,"ShapefileRecord","constructor","The specified shapefile is null or undefined"));if(!a)throw new l(i.logMessage(i.LEVEL_SEVERE,"ShapefileRecord","constructor","The specified buffer is null or undefined"));this._shapefile=s,this._recordNumber=-1,this._attributes={},this._numberOfParts=0,this._firstPartNumber=0,this._lastPartNumber=0,this._numberOfPoints=0,this._boundingRectangle=[],this._zRange=null,this._zValues=null,this._mRange=null,this._mValues=null,this._contentLengthInBytes=-1,this._buffer=a,this._isNormalized=!1,this._parts=[],this.readRecord()};return Object.defineProperties(r.prototype,{shapefile:{get:function(){return this._shapefile}},recordNumber:{get:function(){return this._recordNumber}},attributes:{get:function(){return this._attributes}},numberOfParts:{get:function(){return this._numberOfParts}},firstPartNumber:{get:function(){return this._firstPartNumber}},lastPartNumber:{get:function(){return this._lastPartNumber}},numberOfPoints:{get:function(){return this._numberOfPoints}},boundingRectangle:{get:function(){return this._boundingRectangle}},zRange:{get:function(){return this._zRange}},zValues:{get:function(){return this._zValues}},mRange:{get:function(){return this._mRange}},mValues:{get:function(){return this._mValues}}}),r.prototype.pointBuffer=function(s){return s>=0&&s<this._parts.length?this._parts[s]:null},r.prototype.readRecord=function(){this.readHeader(),this._buffer.order(n.LITTLE_ENDIAN);var s=this._buffer.getInt32(),a=this.shapefile.getShapeType(s);this.validateShapeType(a),this.readContents()},r.prototype.readHeader=function(){this._buffer.order(n.BIG_ENDIAN),this._recordNumber=this._buffer.getInt32(),this._contentLengthInBytes=this._buffer.getInt32()*2},r.prototype.validateShapeType=function(s){if(s!==this.shapefile.NULL&&s!==this.shapefile.shapeType)throw new Error(i.log(i.LEVEL_SEVERE,"Shapefile record is not supported."))},r.prototype.readNullContents=function(){this._numberOfParts=0,this._numberOfPoints=0,this._parts=null,this._boundingRectangle=null,this._buffer.seek(this._contentLengthInBytes-n.INT32_SIZE)},r.prototype.readPointContents=function(){this._numberOfParts=1,this._firstPartNumber=0,this._lastPartNumber=this._numberOfParts-1,this._numberOfPoints=1,this._parts=[this._buffer.getDoubleArray(2)];var s=this._parts[0][1],a=this._parts[0][0];this._boundingRectangle=[s,s,a,a],this.isZType()&&this.readZ(!0),this.isMeasureType()&&this.readOptionalMeasures(!0)},r.prototype.readPolylineContents=function(){var s=this.shapefile.readBoundingRectangle(this._buffer);if(this._boundingRectangle=s.coords,this._isNormalized=s.isNormalized,this._numberOfParts=this._buffer.getInt32(),this._firstPartNumber=0,this._lastPartNumber=this._numberOfParts-1,this._numberOfPoints=this._buffer.getInt32(),this._numberOfParts>0&&this._numberOfPoints>0)for(var a=this._buffer.getInt32Array(this.numberOfParts),f=0;f<this.numberOfParts;f+=1){var o=f==this.numberOfParts-1?this._numberOfPoints-a[f]:a[f+1]-a[f];this._parts[f]=this._buffer.getDoubleArray(o*2),r.normalizeLocations(this._parts[f])}this.isZType()&&this.readZ(!1),this.isMeasureType()&&this.readOptionalMeasures(!1)},r.prototype.readMultiPointContents=function(){var s=this.shapefile.readBoundingRectangle(this._buffer);this._boundingRectangle=s.coords,this._isNormalized=s.isNormalized,this._numberOfParts=1,this._numberOfPoints=this._buffer.getInt32(),this._parts=[this._buffer.getDoubleArray(this._numberOfPoints*2)],r.normalizeLocations(this._parts[0]),this.isZType()&&this.readZ(!1),this.isMeasureType()&&this.readOptionalMeasures(!1)},r.prototype.readZ=function(s){if(s){this._zValues=this._buffer.getDoubleArray(1);var a=this._zValues[0];this._zRange=[a,a]}else this._zRange=this._buffer.getDoubleArray(2),this._zValues=this._buffer.getDoubleArray(this.numberOfPoints)},r.prototype.readOptionalMeasures=function(s){if(this._buffer.hasRemaining()&&this._buffer.limit()-this._buffer.position>=this.numberOfPoints*8)if(s){this._mValues=this._buffer.getDoubleArray(1);var a=this._mValues[0];this._mRange=[a,a]}else this._mRange=this._buffer.getDoubleArray(2),this._mValues=this._buffer.getDoubleArray(this.numberOfPoints)},r.normalizeLocations=function(s){for(var a=0,f=s.length;a<f;a+=2){var o=s[a],c=s[a+1];s[a]=p.normalizedDegreesLongitude(o),s[a+1]=p.normalizedDegreesLatitude(c)}},r.prototype.isPointType=function(){return this.shapefile.isPointType()},r.prototype.isMultiPointType=function(){return this.shapefile.isMultiPointType()},r.prototype.isPolylineType=function(){return this.shapefile.isPolylineType()},r.prototype.isPolygonType=function(){return this.shapefile.isPolygonType()},r.prototype.isZType=function(){return this.shapefile.isZType()},r.prototype.isMeasureType=function(){return this.shapefile.isMeasureType()},r.prototype.setAttributes=function(s){this._attributes=s},r.RECORD_HEADER_LENGTH=8,r}),B("formats/shapefile/ShapefileRecordMultiPoint",["../../util/ByteBuffer","../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(p,l,n){"use strict";var e=function(i,t){n.call(this,i,t)};return e.prototype=Object.create(n.prototype),e.prototype.readContents=function(){this.readMultiPointContents()},e}),B("formats/shapefile/ShapefileRecordNull",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(p,l){"use strict";var n=function(e,i){l.call(this,e,i)};return n.prototype=Object.create(l.prototype),n.prototype.readContents=function(){this.readNullContents()},n}),B("formats/shapefile/ShapefileRecordPoint",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(p,l){"use strict";var n=function(e,i){l.call(this,e,i)};return n.prototype=Object.create(l.prototype),n.prototype.readContents=function(){this.readPointContents()},n}),B("formats/shapefile/ShapefileRecordPolygon",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(p,l){"use strict";var n=function(e,i){l.call(this,e,i)};return n.prototype=Object.create(l.prototype),n.prototype.readContents=function(){this.readPolylineContents()},n}),B("formats/shapefile/ShapefileRecordPolyline",["../../formats/shapefile/Shapefile","../../formats/shapefile/ShapefileRecord"],function(p,l){"use strict";var n=function(e,i){l.call(this,e,i)};return n.prototype=Object.create(l.prototype),n.prototype.readContents=function(){this.readPolylineContents()},n}),B("formats/shapefile/Shapefile",["../../geom/Angle","../../error/ArgumentError","../../util/ByteBuffer","../../util/Color","../../formats/shapefile/DBaseFile","../../geom/Location","../../util/Logger","../../error/NotYetImplementedError","../../shapes/Path","../../shapes/Placemark","../../shapes/PlacemarkAttributes","../../shapes/Polygon","../../geom/Position","../../formats/shapefile/PrjFile","../../layer/RenderableLayer","../../shapes/ShapeAttributes","../../formats/shapefile/ShapefileRecord","../../formats/shapefile/ShapefileRecordMultiPoint","../../formats/shapefile/ShapefileRecordNull","../../formats/shapefile/ShapefileRecordPoint","../../formats/shapefile/ShapefileRecordPolygon","../../formats/shapefile/ShapefileRecordPolyline","../../shapes/SurfacePolygon","../../shapes/SurfacePolyline"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m,g,_,y,v,b,R,M,P){"use strict";var T=function(E){if(!E)throw new l(r.logMessage(r.LEVEL_SEVERE,"Shapefile","constructor","missingUrl"));this._url=E,this._shapeType=null,this._layer=null,this._shapeConfigurationCallback=this.defaultShapeConfigurationCallback,this._parserCompletionCallback=this.defaultParserCompletionCallback,this._buffer=null,this.attributeFile=new i(E.replace(".shp",".dbf")),this.projectionFile=new h(E.replace(".shp",".prj")),this.defaultPlacemarkAttributes=new o(null),this.defaultShapeAttributes=new m(null)};return Object.defineProperties(T.prototype,{url:{get:function(){return this._url}},shapeType:{get:function(){return this._shapeType}},layer:{get:function(){return this._layer}},parserCompletionCallback:{get:function(){return this._parserCompletionCallback}},shapeConfigurationCallback:{get:function(){return this._shapeConfigurationCallback}}}),T.prototype.load=function(E,x,S){E&&(this._parserCompletionCallback=E),x&&(this._shapeConfigurationCallback=x),this._layer=S||new u;var L=(function(){var C=(function(){this.requestUrl(this.url)}).bind(this);this.attributeFile.load(C)}).bind(this);this.projectionFile.load(L)},T.prototype.defaultParserCompletionCallback=function(E){this.addRenderablesForShapefile(this.layer)},T.prototype.defaultShapeConfigurationCallback=function(E,x){var S={},L=E.values.name||E.values.Name||E.values.NAME;if(L&&(S.name=L),x.isPointType())S.attributes=this.defaultPlacemarkAttributes;else if(x.isMultiPointType())S.attributes=this.defaultPlacemarkAttributes;else if(x.isPolylineType())S.attributes=this.defaultShapeAttributes;else if(x.isPolygonType()){S.attributes=this.defaultShapeAttributes;var C=E.values.height||E.values.Height||E.values.HEIGHT;C&&(S.height=C)}return S},T.prototype.addRenderablesForShapefile=function(E){if(!E)throw new l(r.logMessage(r.LEVEL_SEVERE,"Shapefile","addRenderablesForShapefile","missingLayer"));this.isPointType()?this.addRenderablesForPoints(E):this.isMultiPointType()?this.addRenderablesForMultiPoints(E):this.isPolylineType()?this.addRenderablesForPolylines(E):this.isPolygonType()&&this.addRenderablesForPolygons(E)},T.prototype.addRenderablesForPoints=function(E){if(!E)throw new l(r.logMessage(r.LEVEL_SEVERE,"Shapefile","addRenderablesForPoints","missingLayer"));for(var x=this.next();x;x=this.next()){var S=this.shapeConfigurationCallback(x.attributes,x),L=S&&S.altitude?S.altitude:0;if(S)for(var C=0,F=x.numberOfParts;C<F;C+=1)for(var q=x.pointBuffer(C),it=0,st=q.length;it<st;it+=2){var pt=q[it],_t=q[it+1],X=new d(_t,pt,L),ot=new f(X,!1,S.attributes);ot.altitudeMode=S.altitudeMode||WorldWind.RELATIVE_TO_GROUND,S.highlightAttributes&&(ot.highlightAttributes=S.highlightAttributes),S.name&&(ot.label=S.name),S.pickDelegate&&(ot.pickDelegate=S.pickDelegate),S.userProperties&&(ot.userProperties=S.userProperties),E.addRenderable(ot)}}},T.prototype.addRenderablesForMultiPoints=function(E){if(!E)throw new l(r.logMessage(r.LEVEL_SEVERE,"Shapefile","addRenderablesForMultiPoints","missingLayer"));for(var x=this.next();x;x=this.next()){var S=this.shapeConfigurationCallback(x.attributes,x),L=S&&S.altitude?S.altitude:0;if(S)for(var C=0,F=x.numberOfParts;C<F;C+=1)for(var q=x.pointBuffer(C),it=0,st=q.length;it<st;it+=2){var pt=q[it],_t=q[it+1],X=new d(_t,pt,L),ot=new f(X,!1,S.attributes);ot.altitudeMode=S.altitudeMode||WorldWind.RELATIVE_TO_GROUND,S.highlightAttributes&&(ot.highlightAttributes=S.highlightAttributes),S.name&&(ot.label=S.name),S.pickDelegate&&(ot.pickDelegate=S.pickDelegate),S.userProperties&&(ot.userProperties=S.userProperties),E.addRenderable(ot)}}},T.prototype.addRenderablesForPolylines=function(E){if(!E)throw new l(r.logMessage(r.LEVEL_SEVERE,"Shapefile","addRenderablesForPolylines","missingLayer"));for(var x=this.next();x;x=this.next()){var S=this.shapeConfigurationCallback(x.attributes,x),L=S&&S.altitude?S.altitude:0;if(S)for(var C=0,F=x.numberOfParts;C<F;C+=1){for(var q=x.pointBuffer(C),it=[],st=0,pt=q.length;st<pt;st+=2){var _t=q[st],X=q[st+1],ot=L?new d(X,_t,L):new t(X,_t);it.push(ot)}var Tt;L?(Tt=new a(it,S.attributes),Tt.altitudeMode=S.altitudeMode||WorldWind.RELATIVE_TO_GROUND):Tt=new P(it,S.attributes),S.highlightAttributes&&(Tt.highlightAttributes=S.highlightAttributes),S.name&&(Tt.displayName=S.name),S.pickDelegate&&(Tt.pickDelegate=S.pickDelegate),S.userProperties&&(Tt.userProperties=S.userProperties),E.addRenderable(Tt)}}},T.prototype.addRenderablesForPolygons=function(E){if(!E)throw new l(r.logMessage(r.LEVEL_SEVERE,"Shapefile","addRenderablesForPolygons","missingLayer"));for(var x=this.next();x;x=this.next()){for(var S=this.shapeConfigurationCallback(x.attributes,x),L=[],C,F=S.height,q=S.altitude,it=0,st=x.numberOfParts;it<st;it+=1){for(var pt=x.pointBuffer(it),_t=[],X=0,ot=pt.length-2;X<ot;X+=2){var Tt=pt[X],Vt=pt[X+1];F?C=new d(Vt,Tt,F):q?C=new d(Vt,Tt,q):C=new t(Vt,Tt),_t.push(C)}L.push(_t)}var Gt;F?(Gt=new c(L,S.attributes),Gt.extrude=!0,Gt.altitudeMode=S.altitudeMode||WorldWind.RELATIVE_TO_GROUND):q?(Gt=new c(L,S.attributes),Gt.altitudeMode=S.altitudeMode||WorldWind.RELATIVE_TO_GROUND):Gt=new M(L,S.attributes),S.highlightAttributes&&(Gt.highlightAttributes=S.highlightAttributes),S.name&&(Gt.displayName=S.name),S.pickDelegate&&(Gt.pickDelegate=S.pickDelegate),S.userProperties&&(Gt.userProperties=S.userProperties),E.addRenderable(Gt)}},T.prototype.next=function(){for(;this._buffer.position<this._buffer.limit();){var E=this.readRecord(this._buffer);if(!(E instanceof y))return E}return null},T.prototype.requestUrl=function(E){var x=new XMLHttpRequest;x.open("GET",E,!0),x.responseType="arraybuffer",x.onreadystatechange=(function(){x.readyState===4&&(x.status===200?(this._buffer=new n(x.response),this.parse()):r.log(r.LEVEL_WARNING,"Shapefile retrieval failed ("+x.statusText+"): "+E),this._parserCompletionCallback&&this._parserCompletionCallback(this))}).bind(this),x.onerror=function(){r.log(r.LEVEL_WARNING,"Shapefile retrieval failed: "+E),this._parserCompletionCallback&&this._parserCompletionCallback(this)},x.ontimeout=function(){r.log(r.LEVEL_WARNING,"Shapefile retrieval timed out: "+E),this._parserCompletionCallback&&this._parserCompletionCallback(this)},x.send(null)},T.prototype.parse=function(){try{var E=this.readHeader(this._buffer);this._shapeType=E.shapeType}catch(x){console.log(x)}finally{}},T.prototype.readHeader=function(E){E.order(n.BIG_ENDIAN);var x=E.getInt32();if(x!=T.FILE_CODE)throw new Error(r.log(r.LEVEL_SEVERE,"Shapefile header is invalid"));E.skipInt32s(5);var S=E.getInt32();E.order(n.LITTLE_ENDIAN);var L=E.getInt32(),C=E.getInt32(),F=this.readBoundingRectangle(E),q=this.getShapeType(C);if(q==null)throw new Error(r.log(r.LEVEL_SEVERE,"Shapefile type is unsupported: "+C.toString()));var it={fileLength:S*2,version:L,shapeType:q,boundingRectangle:F.coords,normalizePoints:F.isNormalized};return E.skipDoubles(4),it},T.prototype.readBoundingRectangle=function(E){return this.projectionFile?this.projectionFile.isGeographicCoordinateSystem()?this.readGeographicBoundingRectangle(E):this.projectionFile.isProjectedCoordinateSystem()?this.readProjectedBoundingRectangle(E):this.readUnspecifiedBoundingRectangle(E):this.readUnspecifiedBoundingRectangle(E)},T.prototype.readUnspecifiedBoundingRectangle=function(E){var x=this.readBoundingRectangleCoordinates(E);return{coords:x,isNormalized:!1}},T.prototype.readGeographicBoundingRectangle=function(E){var x=this.readBoundingRectangleCoordinates(E),S=!1,L=0;return x[0]<-90&&(L=p.normalizedDegreesLatitude(x[0]),x[0]=90,S=!0,x[1]<L&&(x[1]=L)),x[1]>90&&(L=p.normalizedDegreesLatitude(x[1]),x[1]=90,S=!0,x[0]>L&&(x[0]=L)),(x[2]<-180||x[3]>180)&&(x[2]=-180,x[3]=180,S=!0),{coords:x,isNormalized:S}},T.prototype.readProjectedBoundingRectangle=function(E){throw new s(r.log(r.LEVEL_SEVERE,"Shapefile.readProjectedBoundingRectangle() not yet implemented"))},T.prototype.readBoundingRectangleCoordinates=function(E){var x=E.getDouble(),S=E.getDouble(),L=E.getDouble(),C=E.getDouble();return[S,C,x,L]},T.prototype.readRecord=function(E){var x=this.createRecord(E);if(x!=null&&this.attributeFile!=null&&this.attributeFile.hasNext()){var S=this.attributeFile.nextRecord();x.setAttributes(S)}return x},T.prototype.createRecord=function(E){return this.isNullType()?this.createNull(E):this.isPointType()?this.createPoint(E):this.isMultiPointType()?this.createMultiPoint(E):this.isPolygonType()?this.createPolygon(E):this.isPolylineType()?this.createPolyline(E):null},T.prototype.createNull=function(E){return new y(this,E)},T.prototype.createPoint=function(E){return new v(this,E)},T.prototype.createMultiPoint=function(E){return new _(this,E)},T.prototype.createPolyline=function(E){return new R(this,E)},T.prototype.createPolygon=function(E){return new b(this,E)},T.prototype.getShapeType=function(E){switch(E){case 0:return T.NULL;case 1:return T.POINT;case 3:return T.POLYLINE;case 5:return T.POLYGON;case 8:return T.MULTI_POINT;case 11:return T.POINT_Z;case 13:return T.POLYLINE_Z;case 15:return T.POLYGON_Z;case 18:return T.MULTI_POINT_Z;case 21:return T.POINT_M;case 23:return T.POLYLINE_M;case 25:return T.POLYGON_M;case 28:return T.MULTI_POINT_M;default:return null}},T.prototype.isMeasureType=function(){return T.measureTypes.hasOwnProperty(this._shapeType)},T.prototype.isZType=function(){return T.zTypes.hasOwnProperty(this._shapeType)},T.prototype.isNullType=function(){return this._shapeType===T.NULL},T.prototype.isPointType=function(){return T.pointTypes.hasOwnProperty(this._shapeType)},T.prototype.isMultiPointType=function(){return T.multiPointTypes.hasOwnProperty(this._shapeType)},T.prototype.isPolylineType=function(){return T.polylineTypes.hasOwnProperty(this._shapeType)},T.prototype.isPolygonType=function(){return T.polygonTypes.hasOwnProperty(this._shapeType)},T.NULL="null",T.POINT="point",T.MULTI_POINT="multiPoint",T.POLYLINE="polyline",T.POLYGON="polygon",T.POINT_M=T.POINT+"M",T.MULTI_POINT_M=T.MULTI_POINT+"M",T.POLYLINE_M=T.POLYLINE+"M",T.POLYGON_M=T.POLYGON+"M",T.POINT_Z=T.POINT+"Z",T.MULTI_POINT_Z=T.MULTI_POINT+"Z",T.POLYLINE_Z=T.POLYLINE+"Z",T.POLYGON_Z=T.POLYGON+"Z",T.SHAPE_MULTI_PATCH="multiPatch",T.measureTypes={pointM:T.POINT_M,pointZ:T.POINT_Z,multiPointM:T.MULTI_POINT_M,multiPointZ:T.MULTI_POINT_Z,polylineM:T.POLYLINE_M,polylineZ:T.POLYLINE_Z,polygonM:T.POLYGON_M,polygonZ:T.POLYGON_Z},T.zTypes={pointZ:T.POINT_Z,multiPointZ:T.MULTI_POINT_Z,polylineZ:T.POLYLINE_Z,polygonZ:T.POLYGON_Z},T.pointTypes={point:T.POINT,pointZ:T.POINT_Z,pointM:T.POINT_M},T.multiPointTypes={multiPoint:T.MULTI_POINT,multiPointZ:T.MULTI_POINT_Z,multiPointM:T.MULTI_POINT_M},T.polylineTypes={polyline:T.POLYLINE,polylineZ:T.POLYLINE_Z,polylineM:T.POLYLINE_M},T.polygonTypes={polygon:T.POLYGON,polygonZ:T.POLYGON_Z,polygonM:T.POLYGON_M},T.FILE_CODE=9994,T}),B("layer/ShowTessellationLayer",["../shaders/BasicProgram","../layer/Layer"],function(p,l){"use strict";var n=function(){l.call(this,"Show Tessellation"),this.enableTerrainGeometry=!0,this.enableTerrainExtent=!1};return n.prototype=Object.create(l.prototype),n.prototype.doRender=function(e){try{this.beginRendering(e),this.enableTerrainGeometry&&this.drawTerrainGeometry(e),this.enableTerrainExtent&&this.drawTerrainExtent(e)}finally{this.endRendering(e)}},n.prototype.beginRendering=function(e){var i=e.currentGlContext;i.depthMask(!1)},n.prototype.endRendering=function(e){var i=e.currentGlContext;i.depthMask(!0)},n.prototype.drawTerrainGeometry=function(e){if(!(!e.terrain||!e.terrain.tessellator)){var i=e.currentGlContext,t=e.terrain,r=t.tessellator,s=t.surfaceGeometry,a,f;try{a=e.findAndBindProgram(p),r.beginRendering(e);for(var o=0,c=s.length;o<c;o++)f=s[o],r.beginRenderingTile(e,f),a.loadColorComponents(i,1,1,1,.3),r.renderWireframeTile(e,f),a.loadColorComponents(i,1,0,0,.6),r.renderTileOutline(e,f),r.endRenderingTile(e,f)}finally{r.endRendering(e)}}},n.prototype.drawTerrainExtent=function(e){for(var i=e.terrain.surfaceGeometry,t,r=0,s=i.length;r<s;r++)t=i[r],t.extent.render(e)},n}),B("shaders/StarFieldProgram",["../error/ArgumentError","../shaders/GpuProgram","../util/Logger"],function(p,l,n){"use strict";var e=function(i){var t="attribute vec4 vertexPoint;\nuniform mat4 mvpMatrix;\nuniform float numDays;\nuniform vec2 magnitudeRange;\nvarying float magnitudeWeight;\nfloat normalizeAngle(float angle) {\n   float angleDivisions = angle / 360.0;\n   return 360.0 * (angleDivisions - floor(angleDivisions));\n}\nvec3 computePosition(float dec, float ra) {\n   float GMST = normalizeAngle(280.46061837 + 360.98564736629 * numDays);\n   float GHA = normalizeAngle(GMST - ra);\n   float lon = -GHA + 360.0 * step(180.0, GHA);\n   float latRad = radians(dec);\n   float lonRad = radians(lon);\n   float radCosLat = cos(latRad);\n   return vec3(radCosLat * sin(lonRad), sin(latRad), radCosLat * cos(lonRad));\n}\nfloat normalizeScalar(float value, float minValue, float maxValue){\n   return (value - minValue) / (maxValue - minValue);\n}\nvoid main() {\n   vec3 vertexPosition = computePosition(vertexPoint.x, vertexPoint.y);\n   gl_Position = mvpMatrix * vec4(vertexPosition.xyz, 1.0);\n   gl_Position.z = gl_Position.w - 0.00001;\n   gl_PointSize = vertexPoint.z;\n   magnitudeWeight = normalizeScalar(vertexPoint.w, magnitudeRange.x, magnitudeRange.y);\n}",r="precision mediump float;\nuniform sampler2D textureSampler;\nuniform int textureEnabled;\nvarying float magnitudeWeight;\nconst vec4 white = vec4(1.0, 1.0, 1.0, 1.0);\nconst vec4 grey = vec4(0.5, 0.5, 0.5, 1.0);\nvoid main() {\n   if (textureEnabled == 1) {\n       gl_FragColor = texture2D(textureSampler, gl_PointCoord);\n   }\n   else {\n       gl_FragColor = mix(white, grey, magnitudeWeight);\n   }\n}";l.call(this,i,t,r,["vertexPoint"]),this.vertexPointLocation=this.attributeLocation(i,"vertexPoint"),this.mvpMatrixLocation=this.uniformLocation(i,"mvpMatrix"),this.numDaysLocation=this.uniformLocation(i,"numDays"),this.magnitudeRangeLocation=this.uniformLocation(i,"magnitudeRange"),this.textureUnitLocation=this.uniformLocation(i,"textureSampler"),this.textureEnabledLocation=this.uniformLocation(i,"textureEnabled")};return e.key="WorldWindGpuStarFieldProgram",e.prototype=Object.create(l.prototype),e.prototype.loadModelviewProjection=function(i,t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"StarFieldProgram","loadModelviewProjection","missingMatrix"));this.loadUniformMatrix(i,t,this.mvpMatrixLocation)},e.prototype.loadNumDays=function(i,t){if(t==null)throw new p(n.logMessage(n.LEVEL_SEVERE,"StarFieldProgram","loadNumDays","missingNumDays"));i.uniform1f(this.numDaysLocation,t)},e.prototype.loadMagnitudeRange=function(i,t,r){if(t==null)throw new p(n.logMessage(n.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMinMag"));if(r==null)throw new p(n.logMessage(n.LEVEL_SEVERE,"StarFieldProgram","loadMagRange","missingMaxMag"));i.uniform2f(this.magnitudeRangeLocation,t,r)},e.prototype.loadTextureUnit=function(i,t){i.uniform1i(this.textureUnitLocation,t-i.TEXTURE0)},e.prototype.loadTextureEnabled=function(i,t){i.uniform1i(this.textureEnabledLocation,t?1:0)},e}),B("layer/StarFieldLayer",["./Layer","../util/Logger","../geom/Matrix","../shaders/StarFieldProgram","../util/SunPosition"],function(p,l,n,e,i){"use strict";var t=function(r){p.call(this,"StarField"),this.pickEnabled=!1,this.sunSize=128,this.showSun=!0,this._starDataSource=r||WorldWind.configuration.baseUrl+"images/stars.json",this._sunImageSource=WorldWind.configuration.baseUrl+"images/sunTexture.png",this._matrix=n.fromIdentity(),this._starsPositionsVboCacheKey=null,this._numStars=0,this._starData=null,this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE,this._loadStarted=!1,this._minScale=1e7,this._sunPositionsCacheKey="",this._sunBufferView=new Float32Array(4),this._MAX_GL_POINT_SIZE=0};return t.prototype=Object.create(p.prototype),Object.defineProperties(t.prototype,{starDataSource:{get:function(){return this._starDataSource},set:function(r){this._starDataSource=r,this.invalidateStarData()}},sunImageSource:{get:function(){return this._sunImageSource},set:function(r){this._sunImageSource=r}}}),t.prototype.doRender=function(r){if(!r.globe.is2D()){if(!this.haveResources(r)){this.loadResources(r);return}this.beginRendering(r);try{this.doDraw(r)}finally{this.endRendering(r)}}},t.prototype.haveResources=function(r){var s=r.gpuResourceCache.resourceForKey(this._sunImageSource);return this._starData!=null&&s!=null},t.prototype.loadResources=function(r){var s=r.currentGlContext,a=r.gpuResourceCache;this._starData||this.fetchStarData();var f=a.resourceForKey(this._sunImageSource);f||a.retrieveTexture(s,this._sunImageSource)},t.prototype.beginRendering=function(r){var s=r.currentGlContext;r.findAndBindProgram(e),s.enableVertexAttribArray(0),s.depthMask(!1)},t.prototype.doDraw=function(r){this.loadCommonUniforms(r),this.renderStars(r),this.showSun&&this.renderSun(r)},t.prototype.loadCommonUniforms=function(r){var s=r.currentGlContext,a=r.currentProgram,f=r.eyePoint,o=r.globe.computePositionFromPoint(f[0],f[1],f[2],{}),c=Math.max(o.altitude*1.5,this._minScale);this._matrix.copy(r.modelviewProjection),this._matrix.multiplyByScale(c,c,c),a.loadModelviewProjection(s,this._matrix);var d=i.computeJulianDate(this.time||new Date);a.loadNumDays(s,d-2451545)},t.prototype.renderStars=function(r){var s=r.currentGlContext,a=r.gpuResourceCache,f=r.currentProgram;this._starsPositionsVboCacheKey||(this._starsPositionsVboCacheKey=a.generateCacheKey());var o=a.resourceForKey(this._starsPositionsVboCacheKey);if(o)s.bindBuffer(s.ARRAY_BUFFER,o);else{o=s.createBuffer();var c=this.createStarsGeometry();a.putResource(this._starsPositionsVboCacheKey,o,c.length*4),s.bindBuffer(s.ARRAY_BUFFER,o),s.bufferData(s.ARRAY_BUFFER,new Float32Array(c),s.STATIC_DRAW)}r.frameStatistics.incrementVboLoadCount(1),s.vertexAttribPointer(0,4,s.FLOAT,!1,0,0),f.loadMagnitudeRange(s,this._minMagnitude,this._maxMagnitude),f.loadTextureEnabled(s,!1),s.drawArrays(s.POINTS,0,this._numStars)},t.prototype.renderSun=function(r){var s=r.currentGlContext,a=r.currentProgram,f=r.gpuResourceCache;this._MAX_GL_POINT_SIZE||(this._MAX_GL_POINT_SIZE=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]),this.sunSize>this._MAX_GL_POINT_SIZE&&l.log(l.LEVEL_WARNING,"StarFieldLayer - sunSize is to big, max size allowed is: "+this._MAX_GL_POINT_SIZE);var o=i.getAsCelestialLocation(this.time||new Date);this._sunBufferView[0]=o.declination,this._sunBufferView[1]=o.rightAscension,this._sunBufferView[2]=Math.min(this.sunSize,this._MAX_GL_POINT_SIZE),this._sunBufferView[3]=1,this._sunPositionsCacheKey||(this._sunPositionsCacheKey=f.generateCacheKey());var c=f.resourceForKey(this._sunPositionsCacheKey);c?(s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferSubData(s.ARRAY_BUFFER,0,this._sunBufferView)):(c=s.createBuffer(),f.putResource(this._sunPositionsCacheKey,c,this._sunBufferView.length*4),s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,this._sunBufferView,s.DYNAMIC_DRAW)),r.frameStatistics.incrementVboLoadCount(1),s.vertexAttribPointer(0,4,s.FLOAT,!1,0,0),a.loadTextureEnabled(s,!0);var d=r.gpuResourceCache.resourceForKey(this._sunImageSource);d.bind(r),s.drawArrays(s.POINTS,0,1)},t.prototype.endRendering=function(r){var s=r.currentGlContext;s.depthMask(!0),s.disableVertexAttribArray(0)},t.prototype.fetchStarData=function(){if(!this._loadStarted){this._loadStarted=!0;var r=this,s=new XMLHttpRequest;s.onload=function(){if(this.status>=200&&this.status<300)try{r._starData=JSON.parse(this.response),r.sendRedrawRequest()}catch(a){l.log(l.LEVEL_SEVERE,"StarFieldLayer unable to parse JSON for star data "+a.toString())}else l.log(l.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data. Status: "+this.status+" "+this.statusText);r._loadStarted=!1},s.onerror=function(){l.log(l.LEVEL_SEVERE,"StarFieldLayer unable to fetch star data"),r._loadStarted=!1},s.ontimeout=function(){l.log(l.LEVEL_SEVERE,"StarFieldLayer fetch star data has timeout"),r._loadStarted=!1},s.open("GET",this._starDataSource,!0),s.send()}},t.prototype.createStarsGeometry=function(){var r=this.parseStarsMetadata(this._starData.metadata);if(r.raIndex===-1)throw new Error(l.logMessage(l.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing ra field in star data."));if(r.decIndex===-1)throw new Error(l.logMessage(l.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing dec field in star data."));if(r.magIndex===-1)throw new Error(l.logMessage(l.LEVEL_SEVERE,"StarFieldLayer","createStarsGeometry","Missing vmag field in star data."));var s=this._starData.data,a=[];this._minMagnitude=Number.MAX_VALUE,this._maxMagnitude=Number.MIN_VALUE;for(var f=0,o=s.length;f<o;f++){var c=s[f],d=c[r.decIndex],h=c[r.raIndex],u=c[r.magIndex],m=u<2?2:1;a.push(d,h,m,u),this._minMagnitude=Math.min(this._minMagnitude,u),this._maxMagnitude=Math.max(this._maxMagnitude,u)}return this._numStars=Math.floor(a.length/4),a},t.prototype.parseStarsMetadata=function(r){for(var s=-1,a=-1,f=-1,o=0,c=r.length;o<c;o++){var d=r[o];d.name==="ra"&&(s=o),d.name==="dec"&&(a=o),d.name==="vmag"&&(f=o)}return{raIndex:s,decIndex:a,magIndex:f}},t.prototype.invalidateStarData=function(){this._starData=null,this._starsPositionsVboCacheKey=null},t.prototype.sendRedrawRequest=function(){var r=document.createEvent("Event");r.initEvent(WorldWind.REDRAW_EVENT_TYPE,!0,!0),window.dispatchEvent(r)},t}),B("shapes/SurfaceCircle",["../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(p,l,n,e,i){"use strict";var t=function(r,s,a){if(!r)throw new p(n.logMessage(n.LEVEL_SEVERE,"SurfaceCircle","constructor","missingLocation"));if(s<0)throw new p(n.logMessage(n.LEVEL_SEVERE,"SurfaceCircle","constructor","Radius is negative"));i.call(this,a),this._center=r,this._radius=s,this._intervals=t.DEFAULT_NUM_INTERVALS};return t.prototype=Object.create(i.prototype),Object.defineProperties(t.prototype,{center:{get:function(){return this._center},set:function(r){this.stateKeyInvalid=!0,this.resetBoundaries(),this._center=r}},radius:{get:function(){return this._radius},set:function(r){this.stateKeyInvalid=!0,this.resetBoundaries(),this._radius=r}},intervals:{get:function(){return this._intervals},set:function(r){this.stateKeyInvalid=!0,this.resetBoundaries(),this._intervals=r}}}),t.staticStateKey=function(r){var s=i.staticStateKey(r);return s+" ce "+r.center.toString()+" ra "+r.radius.toString()},t.prototype.computeStateKey=function(){return t.staticStateKey(this)},t.prototype.computeBoundaries=function(r){if(this.radius===0)return null;var s=1+Math.max(t.MIN_NUM_INTERVALS,this.intervals),a=360/(s-1),f=this.radius/r.globe.radiusAt(this.center.latitude,this.center.longitude);this._boundaries=new Array(s);for(var o=0;o<s;o++){var c=o!==s-1?o*a:0;this._boundaries[o]=l.greatCircleLocation(this.center,c,f,new l(0,0))}},t.prototype.getReferencePosition=function(){return this.center},t.prototype.moveTo=function(r,s){this.center=s},t.MIN_NUM_INTERVALS=8,t.DEFAULT_NUM_INTERVALS=64,t}),B("shapes/SurfaceEllipse",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape","../util/WWMath"],function(p,l,n,e,i,t,r){"use strict";var s=function(a,f,o,c,d){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"SurfaceEllipse","constructor","missingLocation"));if(f<0||o<0)throw new l(e.logMessage(e.LEVEL_SEVERE,"SurfaceEllipse","constructor","Radius is negative."));t.call(this,d),this._center=a,this._majorRadius=f,this._minorRadius=o,this._heading=c,this._intervals=s.DEFAULT_NUM_INTERVALS};return s.prototype=Object.create(t.prototype),Object.defineProperties(s.prototype,{center:{get:function(){return this._center},set:function(a){this.stateKeyInvalid=!0,this.resetBoundaries(),this._center=a}},majorRadius:{get:function(){return this._majorRadius},set:function(a){this.stateKeyInvalid=!0,this.resetBoundaries(),this._majorRadius=a}},minorRadius:{get:function(){return this._minorRadius},set:function(a){this.stateKeyInvalid=!0,this.resetBoundaries(),this._minorRadius=a}},heading:{get:function(){return this._heading},set:function(a){this.stateKeyInvalid=!0,this.resetBoundaries(),this._heading=a}},intervals:{get:function(){return this._intervals},set:function(a){this.stateKeyInvalid=!0,this.resetBoundaries(),this._intervals=a}}}),s.staticStateKey=function(a){var f=t.staticStateKey(a);return f+" ce "+a.center.toString()+" ma "+a.majorRadius.toString()+" mi "+a.minorRadius.toString()+" he "+a.heading.toString()+" in "+a.intervals.toString()},s.prototype.computeStateKey=function(){return s.staticStateKey(this)},s.prototype.computeBoundaries=function(a){if(this.majorRadius==0&&this.minorRadius==0)return null;var f=a.globe,o=1+Math.max(s.MIN_NUM_INTERVALS,this.intervals),c=2*Math.PI/(o-1),d=f.radiusAt(this.center.latitude,this.center.longitude);this._boundaries=new Array(o);for(var h=0;h<o;h++){var u=h!=o-1?h*c:0,m=this.majorRadius*Math.cos(u),g=this.minorRadius*Math.sin(u),_=Math.sqrt(m*m+g*g),y=Math.PI/2-(Math.acos(m/_)*r.signum(g)-this.heading*p.DEGREES_TO_RADIANS);this._boundaries[h]=n.greatCircleLocation(this.center,y*p.RADIANS_TO_DEGREES,_/d,new n(0,0))}},s.prototype.getReferencePosition=function(){return this.center},s.prototype.moveTo=function(a,f){this.center=f},s.MIN_NUM_INTERVALS=8,s.DEFAULT_NUM_INTERVALS=64,s}),B("shapes/SurfaceRectangle",["../geom/Angle","../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape","../util/WWMath"],function(p,l,n,e,i,t,r){"use strict";var s=function(a,f,o,c,d){if(!a)throw new l(e.logMessage(e.LEVEL_SEVERE,"SurfaceRectangle","constructor","missingLocation"));if(f<0||o<0)throw new l(e.logMessage(e.LEVEL_SEVERE,"SurfaceRectangle","constructor","Size is negative."));t.call(this,d),this._center=a,this._width=f,this._height=o,this._heading=c};return s.prototype=Object.create(t.prototype),Object.defineProperties(s.prototype,{center:{get:function(){return this._center},set:function(a){this.stateKeyInvalid=!0,this.resetBoundaries(),this._center=a}},width:{get:function(){return this._width},set:function(a){this.stateKeyInvalid=!0,this.resetBoundaries(),this._width=a}},height:{get:function(){return this._height},set:function(a){this.stateKeyInvalid=!0,this.resetBoundaries(),this._height=a}},heading:{get:function(){return this._heading},set:function(a){this.stateKeyInvalid=!0,this.resetBoundaries(),this._heading=a}}}),s.staticStateKey=function(a){var f=t.staticStateKey(a);return f+" ce "+a.center.toString()+" wi "+a.width.toString()+" he "+a.height.toString()+" hd "+a.heading.toString()},s.prototype.computeStateKey=function(){return s.staticStateKey(this)},s.prototype.computeBoundaries=function(a){var f=.5*this.width,o=.5*this.height,c=a.globe.radiusAt(this.center.latitude,this.center.longitude);this._boundaries=new Array(4),this.addLocation(0,-f,-o,c),this.addLocation(1,f,-o,c),this.addLocation(2,f,o,c),this.addLocation(3,-f,o,c)},s.prototype.addLocation=function(a,f,o,c){var d=Math.sqrt(f*f+o*o),h=Math.PI/2-(Math.acos(f/d)*r.signum(o)-this.heading*p.DEGREES_TO_RADIANS);this._boundaries[a]=n.greatCircleLocation(this.center,h*p.RADIANS_TO_DEGREES,d/c,new n(0,0))},s.prototype.getReferencePosition=function(){return this.center},s.prototype.moveTo=function(a,f){this.center=this.computeShiftedLocations(a,this.getReferencePosition(),f,[this.center])[0]},s}),B("render/SurfaceRenderable",["../util/Logger","../error/UnsupportedOperationError"],function(p,l){"use strict";var n=function(){throw this.displayName="Renderable",this.enabled=!0,new l(p.logMessage(p.LEVEL_SEVERE,"SurfaceRenderable","constructor","abstractInvocation"))};return n.prototype.renderSurface=function(e){throw new l(p.logMessage(p.LEVEL_SEVERE,"SurfaceRenderable","renderSurface","abstractInvocation"))},n}),B("shapes/SurfaceSector",["../error/ArgumentError","../geom/Location","../util/Logger","../shapes/ShapeAttributes","../shapes/SurfaceShape"],function(p,l,n,e,i){"use strict";var t=function(r,s){if(!r)throw new p(n.logMessage(n.LEVEL_SEVERE,"SurfaceSector","constructor","missingSector"));i.call(this,s),this._sector=r};return t.prototype=Object.create(i.prototype),Object.defineProperties(t.prototype,{sector:{get:function(){return this._sector},set:function(r){this.stateKeyInvalid=!0,this.resetBoundaries(),this._sector=r}}}),t.staticStateKey=function(r){var s=i.staticStateKey(r);return s},t.prototype.computeStateKey=function(){return t.staticStateKey(this)},t.prototype.computeBoundaries=function(r){var s=this._sector;this._boundaries=new Array(4),this._boundaries[0]=new l(s.minLatitude,s.minLongitude),this._boundaries[1]=new l(s.maxLatitude,s.minLongitude),this._boundaries[2]=new l(s.maxLatitude,s.maxLongitude),this._boundaries[3]=new l(s.minLatitude,s.maxLongitude)},t.prototype.getReferencePosition=function(){return new l(this.sector.centroidLatitude(),this.sector.centroidLongitude())},t.prototype.moveTo=function(r,s){var a=this._sector,f=new Array(3);f[0]=new l(a.minLatitude,a.minLongitude),f[1]=new l(a.maxLatitude,a.minLongitude),f[2]=new l(a.maxLatitude,a.maxLongitude),f=this.computeShiftedLocations(r,this.getReferencePosition(),s,f),this.sector=new WorldWind.Sector(f[0].latitude,f[1].latitude,f[1].longitude,f[2].longitude)},t}),B("layer/TectonicPlatesLayer",["../error/ArgumentError","../util/Color","../geom/Location","../util/Logger","../layer/RenderableLayer","../shapes/ShapeAttributes","../shapes/SurfacePolygon"],function(p,l,n,e,i,t,r){"use strict";var s=function(a){i.call(this,"Tectonic Plates"),a?this._attributes=a:(this._attributes=new t(null),this._attributes.drawInterior=!1,this._attributes.drawOutline=!0,this._attributes.outlineColor=l.RED),this.loadPlateData()};return s.prototype=Object.create(i.prototype),Object.defineProperties(s.prototype,{attributes:{get:function(){return this._attributes},set:function(a){a&&this.renderables.map(function(f,o,c){f.attributes=a})}}}),s.prototype.loadPlateData=function(){var a=WorldWind.configuration.baseUrl+"images/TectonicPlates.json",f=new XMLHttpRequest;f.open("GET",a,!0),f.onreadystatechange=(function(){f.readyState===4&&(f.status===200?this.parse(f.responseText):e.log(e.LEVEL_WARNING,"Tectonic plate data retrieval failed ("+f.statusText+"): "+a))}).bind(this),f.onerror=function(){e.log(e.LEVEL_WARNING,"Tectonic plate data retrieval failed: "+a)},f.ontimeout=function(){e.log(e.LEVEL_WARNING,"Tectonic plate data retrieval timed out: "+a)},f.send(null)},s.prototype.parse=function(a){var f=JSON.parse(a),o=this;f.features.map(function(c,d,h){var u=[];c.geometry.coordinates.map(function(g,_,y){u.push(new n(g[1],g[0]))});var m=new r(u,o._attributes);o.addRenderable(m)})},s}),B("util/TileFactory",["../util/Logger","../error/UnsupportedOperationError"],function(p,l){"use strict";var n=function(){};return n.prototype.createTile=function(e,i,t,r){throw new l(p.logMessage(p.LEVEL_SEVERE,"TileFactory","createTile","abstractInvocation"))},n}),B("shapes/TriangleMesh",["../shapes/AbstractMesh","../error/ArgumentError","../shaders/BasicTextureProgram","../geom/BoundingBox","../util/Color","../util/ImageSource","../geom/Location","../util/Logger","../geom/Matrix","../pick/PickedObject","../geom/Position","../shapes/ShapeAttributes","../shapes/SurfacePolygon","../geom/Vec2","../geom/Vec3"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u){"use strict";var m=function(g,_,y){if(!g)throw new l(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","missingPositions"));if(g.length<1)throw new l(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","missingPositions"));if(g.length>65536)throw new l(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","Too many positions. Must be fewer than 65537. Use TriangleMesh.split to split the shape."));if(!_)throw new l(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","Indices array is null or undefined"));if(_.length<3)throw new l(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","constructor","Too few indices."));p.call(this,y),this._positions=g,this._indices=_,this.referencePosition=this._positions[0]};return m.prototype=Object.create(p.prototype),Object.defineProperties(m.prototype,{positions:{get:function(){return this._positions},set:function(g){if(!g)throw new l(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","positions","missingPositions"));this._positions=g,this.referencePosition=this._positions[0],this.reset()}},indices:{get:function(){return this._indices},set:function(g){if(!g)throw new l(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","indices","Indices array is null or undefined"));this._indices=g,this.meshIndices=null,this.reset()}},outlineIndices:{get:function(){return this._outlineIndices},set:function(g){this._outlineIndices=g,this.meshOutlineIndices=null,this.reset()}},textureCoordinates:{get:function(){return this._textureCoordinates},set:function(g){if(g&&g.length!=this._positions.length)throw new l(s.logMessage(s.LEVEL_SEVERE,"TriangleMesh","textureCoordinates","Number of texture coordinates is inconsistent with the currently specified positions."));this._textureCoordinates=g,this.reset(),this.texCoords=null}}}),m.prototype.createSurfaceShape=function(){if(this._outlineIndices){for(var g=[],_=0;_<this._outlineIndices.length;_++)g.push(this._positions[this._outlineIndices[_]]);return new d(g,null)}else return null},m.prototype.computeMeshPoints=function(g,_){for(var y=Number.MAX_VALUE,v=g.eyePoint,b=new Float32Array(this._positions.length*3),R=new u(0,0,0),M=0,P,T,E=0;E<this._positions.length;E++)P=this._positions[E],g.surfacePointForMode(P.latitude,P.longitude,P.altitude*this._altitudeScale,this.altitudeMode,R),T=R.distanceToSquared(v),T<y&&(y=T),R.subtract(this.currentData.referencePoint),b[M++]=R[0],b[M++]=R[1],b[M++]=R[2];return _.eyeDistance=Math.sqrt(y),b},m.prototype.computeTexCoords=function(){if(this._textureCoordinates){for(var g=new Float32Array(2*this._textureCoordinates.length),_=0,y=0,v=this._textureCoordinates.length;y<v;y++){var b=this._textureCoordinates[y];g[_++]=b[0],g[_++]=b[1]}return g}else return null},m.prototype.computeMeshIndices=function(){for(var g=new Uint16Array(this._indices.length),_=0,y=this._indices.length;_<y;_++)g[_]=this._indices[_];return g},m.prototype.computeOutlineIndices=function(){if(this._outlineIndices){for(var g=new Uint16Array(this._outlineIndices.length),_=0;_<this._outlineIndices.length;_++)g[_]=this._outlineIndices[_];return g}else return null},m.split=function(g,_,y,v){for(var b=[],R=[],M=[],P=[],T=[],E,x,S=0;S<=_.length;S++){if(S===_.length||b.length>65533&&M.length%3===0){if(b.length>0){var L={positions:b,indices:M};if(y&&(L.textureCoords=R),v){for(var C=[],F=0;F<v.length;F++)E=v[F],x=P[E],x&&C.push(P[v[F]]);L.outlineIndices=C}T.push(L)}if(S===_.length)break;b=[],M=[],P=[]}E=_[S],x=P[E],x||(x=b.length,P[E]=x,b.push(g[E]),y&&R.push(y[E])),M.push(x)}return T},m}),B("util/UrlBuilder",["../util/Logger","../error/UnsupportedOperationError"],function(p,l){"use strict";var n=function(){};return n.prototype.urlForTile=function(e,i){throw new l(p.logMessage(p.LEVEL_SEVERE,"UrlBuilder","urlForTile","abstractInvocation"))},n}),B("layer/ViewControlsLayer",["../geom/Angle","../error/ArgumentError","../layer/Layer","../geom/Location","../util/Logger","../util/Offset","../shapes/ScreenImage","../geom/Vec2"],function(p,l,n,e,i,t,r,s){"use strict";var a=function(f){if(!f)throw new l(i.logMessage(i.LEVEL_SEVERE,"ViewControlsLayer","constructor","missingWorldWindow"));n.call(this,"View Controls"),this.wwd=f,this.placement=new t(WorldWind.OFFSET_PIXELS,11,WorldWind.OFFSET_PIXELS,11),this.alignment=new t(WorldWind.OFFSET_FRACTION,0,WorldWind.OFFSET_FRACTION,0),this.exaggerationIncrement=.01,this.zoomIncrement=.04,this.headingIncrement=1,this.tiltIncrement=1,this.fieldOfViewIncrement=.1,this.panIncrement=.001,this._inactiveOpacity=.5,this._activeOpacity=1;var o=new t(WorldWind.OFFSET_PIXELS,0,WorldWind.OFFSET_PIXELS,0),c=WorldWind.configuration.baseUrl+"images/view/";this.panControl=new r(o.clone(),c+"view-pan-64x64.png"),this.zoomInControl=new r(o.clone(),c+"view-zoom-in-32x32.png"),this.zoomOutControl=new r(o.clone(),c+"view-zoom-out-32x32.png"),this.headingLeftControl=new r(o.clone(),c+"view-heading-left-32x32.png"),this.headingRightControl=new r(o.clone(),c+"view-heading-right-32x32.png"),this.tiltUpControl=new r(o.clone(),c+"view-pitch-up-32x32.png"),this.tiltDownControl=new r(o.clone(),c+"view-pitch-down-32x32.png"),this.exaggerationUpControl=new r(o.clone(),c+"view-elevation-up-32x32.png"),this.exaggerationDownControl=new r(o.clone(),c+"view-elevation-down-32x32.png"),this.fovNarrowControl=new r(o.clone(),c+"view-fov-narrow-32x32.png"),this.fovWideControl=new r(o.clone(),c+"view-fov-wide-32x32.png"),this.fovNarrowControl.enabled=!1,this.fovWideControl.enabled=!1,this.controls=[this.panControl,this.zoomInControl,this.zoomOutControl,this.headingLeftControl,this.headingRightControl,this.tiltUpControl,this.tiltDownControl,this.exaggerationUpControl,this.exaggerationDownControl,this.fovNarrowControl,this.fovWideControl];for(var d=0;d<this.controls.length;d++)this.controls[d].imageOffset=o.clone(),this.controls[d].opacity=this._inactiveOpacity,this.controls[d]===this.panControl?this.controls[d].size=64:this.controls[d].size=32;this.panControlCenter=new s(0,0),this.pickEnabled=!1,this.wwd.worldWindowController.addGestureListener(this)};return a.prototype=Object.create(n.prototype),Object.defineProperties(a.prototype,{showPanControl:{get:function(){return this.panControl.enabled},set:function(f){this.panControl.enabled=f}},showZoomControl:{get:function(){return this.zoomInControl.enabled},set:function(f){this.zoomInControl.enabled=f,this.zoomOutControl.enabled=f}},showHeadingControl:{get:function(){return this.headingLeftControl.enabled},set:function(f){this.headingLeftControl.enabled=f,this.headingRightControl.enabled=f}},showTiltControl:{get:function(){return this.tiltUpControl.enabled},set:function(f){this.tiltUpControl.enabled=f,this.tiltDownControl.enabled=f}},showExaggerationControl:{get:function(){return this.exaggerationUpControl.enabled},set:function(f){this.exaggerationUpControl.enabled=f,this.exaggerationDownControl.enabled=f}},showFieldOfViewControl:{get:function(){return this.fovNarrowControl.enabled},set:function(f){this.fovNarrowControl.enabled=f,this.fovWideControl.enabled=f}},inactiveOpacity:{get:function(){return this._inactiveOpacity},set:function(f){this._inactiveOpacity=f;for(var o=0;o<this.controls.length;o++)this.controls[o].opacity=f}},activeOpacity:{get:function(){return this._activeOpacity},set:function(f){this._activeOpacity=f;for(var o=0;o<this.controls.length;o++)this.controls[o].opacity=f}}}),a.prototype.doRender=function(f){var o=0,c=64,d,h,u,m;this.inCurrentFrame=!1,this.showPanControl&&(o+=this.panControl.size,this.inCurrentFrame=!0),this.showZoomControl&&(o+=this.zoomInControl.size,this.inCurrentFrame=!0),this.showHeadingControl&&(o+=this.headingLeftControl.size,this.inCurrentFrame=!0),this.showTiltControl&&(o+=this.tiltDownControl.size,this.inCurrentFrame=!0),this.showExaggerationControl&&(o+=this.exaggerationDownControl.size,this.inCurrentFrame=!0),this.showFieldOfViewControl&&(o+=this.fovNarrowControl.size,this.inCurrentFrame=!0),h=this.placement.offsetForSize(f.viewport.width,f.viewport.height),d=this.alignment.offsetForSize(o,c),u=h[0]-d[0],m=h[1]-d[1],this.showPanControl&&(this.panControl.screenOffset.x=u,this.panControl.screenOffset.y=m,this.panControl.render(f),this.panControlCenter[0]=u+this.panControl.size/2,this.panControlCenter[1]=m+this.panControl.size/2,u+=this.panControl.size),this.showZoomControl&&(this.zoomOutControl.screenOffset.x=u,this.zoomOutControl.screenOffset.y=m,this.zoomInControl.screenOffset.x=u,this.zoomInControl.screenOffset.y=m+this.zoomOutControl.size,this.zoomOutControl.render(f),this.zoomInControl.render(f),u+=this.zoomOutControl.size),this.showHeadingControl&&(this.headingRightControl.screenOffset.x=u,this.headingRightControl.screenOffset.y=m,this.headingLeftControl.screenOffset.x=u,this.headingLeftControl.screenOffset.y=m+this.headingLeftControl.size,this.headingRightControl.render(f),this.headingLeftControl.render(f),u+=this.headingLeftControl.size),this.showTiltControl&&(this.tiltDownControl.screenOffset.x=u,this.tiltDownControl.screenOffset.y=m,this.tiltUpControl.screenOffset.x=u,this.tiltUpControl.screenOffset.y=m+this.tiltDownControl.size,this.tiltDownControl.render(f),this.tiltUpControl.render(f),u+=this.tiltDownControl.size),this.showExaggerationControl&&(this.exaggerationDownControl.screenOffset.x=u,this.exaggerationDownControl.screenOffset.y=m,this.exaggerationUpControl.screenOffset.x=u,this.exaggerationUpControl.screenOffset.y=m+this.exaggerationDownControl.size,this.exaggerationUpControl.render(f),this.exaggerationDownControl.render(f),u+=this.exaggerationDownControl.size),this.showFieldOfViewControl&&(this.fovNarrowControl.screenOffset.x=u,this.fovNarrowControl.screenOffset.y=m,this.fovWideControl.screenOffset.x=u,this.fovWideControl.screenOffset.y=m+this.fovNarrowControl.size,this.fovNarrowControl.render(f),this.fovWideControl.render(f))},a.prototype.isPointerDown=function(f){return f.type==="pointerdown"?!0:f.type==="mousedown"&&f.which===1},a.prototype.isPointerUp=function(f){return f.type==="pointerup"?!0:f.type==="mouseup"&&f.which===1},a.prototype.isPointerMove=function(f){return f.type==="pointermove"?!0:f.type==="mousemove"},a.prototype.isTouchStart=function(f){return f.type==="touchstart"},a.prototype.isTouchEnd=function(f){return f.type==="touchend"||f.type==="touchcancel"},a.prototype.isTouchMove=function(f){return f.type==="touchmove"},a.prototype.onGestureEvent=function(f){var o=!1,c;if(!this.enabled)return o;this.highlightedControl&&(this.highlight(this.highlightedControl,!1),this.wwd.redraw());var d=!1;if(f.type&&this.activeControl&&(this.isPointerUp(f)||this.isTouchEnd(f)&&this.isCurrentTouch(f)?d=!0:(c=this.pickControl(f),this.activeControl!==c&&(d=!0))),d)this.activeControl=null,this.activeOperation=null,f.preventDefault();else{if(this.activeOperation)o=this.activeOperation.call(this,f,null),f.preventDefault();else if(c=this.pickControl(f),c){var h=this.determineOperation(f,c);h&&(o=h.call(this,f,c))}this.handleHighlight(f,c),this.wwd.redraw()}return o},a.prototype.isControl=function(f){for(var o=0;o<this.controls.length;o++)if(this.controls[o]==f)return!0;return!1},a.prototype.pickControl=function(f){var o,c;if(f.changedTouches){var d=f.changedTouches.item(0);o=d.clientX,c=d.clientY}else o=f.clientX,c=f.clientY;for(var h=this.wwd.canvasCoordinates(o,c),u=h[0],m=this.wwd.canvas.height-h[1],g,_=0;_<this.controls.length;_++)if(g=this.controls[_],g.enabled&&u>=g.screenOffset.x&&u<=g.screenOffset.x+g.size&&m>=g.screenOffset.y&&m<=g.screenOffset.y+g.size)return g;return null},a.prototype.determineOperation=function(f,o){var c=null;return o&&o instanceof r&&(o===this.panControl?c=this.handlePan:o===this.zoomInControl||o===this.zoomOutControl?c=this.handleZoom:o===this.headingLeftControl||o===this.headingRightControl?c=this.handleHeading:o===this.tiltUpControl||o===this.tiltDownControl?c=this.handleTilt:o===this.exaggerationUpControl||o===this.exaggerationDownControl?c=this.handleExaggeration:(o===this.fovNarrowControl||o===this.fovWideControl)&&(c=this.handleFov)),c},a.prototype.isCurrentTouch=function(f){for(var o=0;o<f.changedTouches.length;o++)if(f.changedTouches.item(o).identifier===this.currentTouchId)return!0;return!1},a.prototype.handlePan=function(f,o){var c=!1;if(this.isPointerDown(f)||this.isPointerMove(f))this.currentEventPoint=this.wwd.canvasCoordinates(f.clientX,f.clientY);else if(this.isTouchStart(f)||this.isTouchMove(f)){var d=f.changedTouches.item(0);this.currentEventPoint=this.wwd.canvasCoordinates(d.clientX,d.clientY)}if(this.isPointerDown(f)||this.isTouchStart(f)){this.activeControl=o,this.activeOperation=this.handlePan,f.preventDefault(),this.isTouchStart(f)&&(this.currentTouchId=f.changedTouches.item(0).identifier);var h=this,u=function(){if(h.activeControl){var m=h.panControlCenter[0]-h.currentEventPoint[0],g=h.panControlCenter[1]-(h.wwd.viewport.height-h.currentEventPoint[1]),_=h.wwd.navigator.lookAtLocation.latitude,y=h.wwd.navigator.lookAtLocation.longitude,v=h.panIncrement*(h.wwd.navigator.range/h.wwd.globe.radiusAt(_,y)),b=h.wwd.navigator.heading+Math.atan2(m,g)*p.RADIANS_TO_DEGREES,R=v*Math.sqrt(m*m+g*g);e.greatCircleLocation(h.wwd.navigator.lookAtLocation,b,-R,h.wwd.navigator.lookAtLocation),h.wwd.redraw(),setTimeout(u,50)}};setTimeout(u,50),c=!0}return c},a.prototype.handleZoom=function(f,o){var c=!1;if(this.isPointerDown(f)||this.isTouchStart(f)){this.activeControl=o,this.activeOperation=this.handleZoom,f.preventDefault(),this.isTouchStart(f)&&(this.currentTouchId=f.changedTouches.item(0).identifier);var d=this,h=function(){d.activeControl&&(d.activeControl===d.zoomInControl?d.wwd.navigator.range*=1-d.zoomIncrement:d.activeControl===d.zoomOutControl&&(d.wwd.navigator.range*=1+d.zoomIncrement),d.wwd.redraw(),setTimeout(h,50))};setTimeout(h,50),c=!0}return c},a.prototype.handleHeading=function(f,o){var c=!1;if(this.isPointerDown(f)||this.isTouchStart(f)){this.activeControl=o,this.activeOperation=this.handleHeading,f.preventDefault(),this.isTouchStart(f)&&(this.currentTouchId=f.changedTouches.item(0).identifier);var d=this,h=function(){d.activeControl&&(d.activeControl===d.headingLeftControl?d.wwd.navigator.heading+=d.headingIncrement:d.activeControl===d.headingRightControl&&(d.wwd.navigator.heading-=d.headingIncrement),d.wwd.redraw(),setTimeout(h,50))};setTimeout(h,50),c=!0}return c},a.prototype.handleTilt=function(f,o){var c=!1;if(this.isPointerDown(f)||this.isTouchStart(f)){this.activeControl=o,this.activeOperation=this.handleTilt,f.preventDefault(),this.isTouchStart(f)&&(this.currentTouchId=f.changedTouches.item(0).identifier);var d=this,h=function(){d.activeControl&&(d.activeControl===d.tiltUpControl?d.wwd.navigator.tilt=Math.max(0,d.wwd.navigator.tilt-d.tiltIncrement):d.activeControl===d.tiltDownControl&&(d.wwd.navigator.tilt=Math.min(90,d.wwd.navigator.tilt+d.tiltIncrement)),d.wwd.redraw(),setTimeout(h,50))};setTimeout(h,50),c=!0}return c},a.prototype.handleExaggeration=function(f,o){var c=!1;if(this.isPointerDown(f)||this.isTouchStart(f)){this.activeControl=o,this.activeOperation=this.handleExaggeration,f.preventDefault(),this.isTouchStart(f)&&(this.currentTouchId=f.changedTouches.item(0).identifier);var d=this,h=function(){d.activeControl&&(d.activeControl===d.exaggerationUpControl?d.wwd.verticalExaggeration+=d.exaggerationIncrement:d.activeControl===d.exaggerationDownControl&&(d.wwd.verticalExaggeration=Math.max(1,d.wwd.verticalExaggeration-d.exaggerationIncrement)),d.wwd.redraw(),setTimeout(h,50))};setTimeout(h,50),c=!0}return c},a.prototype.handleFov=function(f,o){var c=!1;if(this.isPointerDown(f)||this.isTouchStart(f)){this.activeControl=o,this.activeOperation=this.handleFov,f.preventDefault(),this.isTouchStart(f)&&(this.currentTouchId=f.changedTouches.item(0).identifier);var d=this,h=function(){d.activeControl&&(d.activeControl===d.fovWideControl?d.wwd.navigator.fieldOfView=Math.max(90,d.wwd.navigator.fieldOfView+d.fieldOfViewIncrement):d.activeControl===d.fovNarrowControl&&(d.wwd.navigator.fieldOfView=Math.min(0,d.wwd.navigator.fieldOfView-d.fieldOfViewIncrement)),d.wwd.redraw(),setTimeout(h,50))};setTimeout(h,50),c=!0}return c},a.prototype.handleHighlight=function(f,o){this.activeControl?this.highlight(this.activeControl,!0):o&&this.isControl(o)&&this.highlight(o,!0)},a.prototype.highlight=function(f,o){f.opacity=o?this._activeOpacity:this._inactiveOpacity,o?this.highlightedControl=f:this.highlightedControl=null},a}),B("ogc/ows/OwsBoundingBox",["../../error/ArgumentError","../../util/Logger","../../geom/Sector"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsBoundingBox","constructor","missingDomElement"));this.assembleElement(i)};return e.prototype.assembleElement=function(i){this.crs=i.localName==="WGS84BoundingBox"?"WGS84":i.getAttribute("crs"),this.dimensions=i.getAttribute("dimensions");for(var t=i.children||i.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="LowerCorner"?this.lowerCorner=s.textContent:s.localName==="UpperCorner"&&(this.upperCorner=s.textContent)}},e.prototype.getSector=function(){var i,t,r,s,a;return this.crs.indexOf("WGS84")!==-1||this.crs.indexOf("EPSG:4326")!==-1?(a=this.lowerCorner.split(/\s+/),t=a[0],i=a[1],a=this.upperCorner.split(/\s+/),s=a[0],r=a[1],new n(i,r,t,s)):null},e}),B("ogc/ows/OwsKeywords",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsLanguageString"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsKeywords","constructor","missingDomElement"));for(var t=i.children||i.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="keyword"&&(this.keywords=this.keywords||[],this.keywords.push(new n(s)))}};return e}),B("ogc/ows/OwsDatasetSummary",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsBoundingBox","../../ogc/ows/OwsKeywords","../../ogc/ows/OwsLanguageString"],function(p,l,n,e,i){"use strict";var t=function(r){if(!r)throw new p(l.logMessage(l.LEVEL_SEVERE,"OwsDatasetSummary","constructor","missingDomElement"));this.assembleElement(r)};return t.prototype.assembleElement=function(r){for(var s=r.children||r.childNodes,a=0;a<s.length;a++){var f=s[a];f.localName==="Title"?(this.titles=this.titles||[],this.titles.push(new i(f))):f.localName==="Abstract"?(this.abstracts=this.abtracts||[],this.abstracts.push(new i(f))):f.localName==="Keywords"?(this.keywords=this.keywords||[],this.keywords.push(new e(f))):f.localName==="Identifier"?this.identifier=f.textContent:f.localName==="WGS84BoundingBox"?this.wgs84BoundingBox=new n(f):f.localName==="BoundingBox"?(this.boundingBox=this.boundingBox||[],this.boundingBox.push(new n(f))):f.localName==="OutputFormat"?(this.outputFormat=this.outputFormat||[],this.outputFormat.push(f.textContent)):f.localName==="AvailableCRS"&&(this.availableCrs=this.availableCrs||[],this.availableCRS.push(f.textContent))}},t}),B("ogc/wcs/WcsCapabilities",["../../error/ArgumentError","../../util/Logger","../../ogc/ows/OwsDatasetSummary","../../ogc/ows/OwsKeywords","../../ogc/ows/OwsOperationsMetadata","../../ogc/ows/OwsServiceIdentification","../../ogc/ows/OwsServiceProvider"],function(p,l,n,e,i,t,r){"use strict";var s=function(a){if(!a)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsCapabilities","constructor","missingDom"));this.xmlDom=a,this.assembleDocument()};return s.prototype.getCoverageBaseUrl=function(){return this.version==="1.0.0"?this.capability.request.getCoverage.get:this.version==="2.0.1"||this.version==="2.0.0"?this.operationsMetadata.getOperationMetadataByName("GetCoverage").dcp[0].getMethods[0].url:null},s.prototype.assembleDocument=function(){var a=this.xmlDom.documentElement;if(this.version=a.getAttribute("version"),this.updateSequence=a.getAttribute("updateSequence"),this.version==="1.0.0")this.assembleDocument100(a);else if(this.version==="2.0.0"||this.version==="2.0.1")this.assembleDocument20x(a);else throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsCapabilities","assembleDocument","unsupportedVersion"))},s.prototype.assembleDocument100=function(a){for(var f=a.children||a.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Service"?this.service=this.assembleService100(c):c.localName==="Capability"?this.capability=this.assembleCapability100(c):c.localName==="ContentMetadata"&&this.assembleContents100(c)}},s.prototype.assembleDocument20x=function(a){for(var f=a.children||a.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="ServiceIdentification"?this.serviceIdentification=new t(c):c.localName==="ServiceProvider"?this.serviceProvider=new r(c):c.localName==="OperationsMetadata"?this.operationsMetadata=new i(c):c.localName==="ServiceMetadata"?this.serviceMetadata=this.assembleServiceMetadata(c):c.localName==="Contents"&&this.assembleContents20x(c)}},s.prototype.assembleContents100=function(a){for(var f=a.children||a.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="CoverageOfferingBrief"&&(this.coverages=this.coverages||[],this.coverages.push(this.assembleCoverages100(c)))}},s.prototype.assembleContents20x=function(a){for(var f=a.children||a.childNodes,o,c=0;c<f.length;c++){var d=f[c];d.localName==="CoverageSummary"&&(o=new n(d),this.assembleDatasetAugment20x(d,o),this.coverages=this.coverages||[],this.coverages.push(o))}},s.prototype.assembleDatasetAugment20x=function(a,f){for(var o=a.children||a.childNodes,c=0;c<o.length;c++){var d=o[c];d.localName==="CoverageId"?f.coverageId=d.textContent:d.localName==="CoverageSubtype"&&(f.subType=f.subType||[],f.subType.push(d.textContent))}},s.prototype.assembleCoverages100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="name"?o.name=d.textContent:d.localName==="description"?o.description=d.textContent:d.localName==="label"?o.label=d.textContent:d.localName==="Keywords"?(o.keywords=o.keywords||[],o.keywords.push(new e(d))):d.localName==="lonLatEnvelope"&&(o.wgs84BoundingBox=this.assembleLatLonBoundingBox(d))}return o},s.prototype.assembleService100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="description"?o.description=d.textContent:d.localName==="name"?o.name=d.textContent:d.localName==="label"?o.label=d.textContent:d.localName==="fees"?o.fees=d.textContent:d.localName==="accessConstraints"?(o.accessConstraints=o.accessConstraints||[],o.accessConstraints.push(d.textContent)):d.localName==="Keywords"&&(o.keywords=new e(d))}return o},s.prototype.assembleCapability100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="Request"?o.request=this.assembleRequestCapabilities100(d):d.localName==="Exception"&&(d=d.children||d.childNodes,d=d[0],o.exception=o.exception||[],o.exception.push(d.textContent))}return o},s.prototype.assembleRequestCapabilities100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="GetCapabilities"?o.getCapabilities=this.assembleDCPType100(d):d.localName==="DescribeCoverage"?o.describeCoverage=this.assembleDCPType100(d):d.localName==="GetCoverage"&&(o.getCoverage=this.assembleDCPType100(d))}return o},s.prototype.assembleDCPType100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="DCPType"&&this.assembleHttp100(d,o)}return o},s.prototype.assembleHttp100=function(a,f){for(var o=a.children||a.childNodes,c=0;c<o.length;c++){var d=o[c];if(d.localName==="HTTP")return this.assembleMethod100(d,f)}},s.prototype.assembleMethod100=function(a,f){for(var o=a.children||a.childNodes,c=0;c<o.length;c++){var d=o[c];d.localName==="Get"?f.get=this.assembleOnlineResource100(d):d.localName==="Post"&&(f.post=this.assembleOnlineResource100(d))}},s.prototype.assembleOnlineResource100=function(a){for(var f=a.children||a.childNodes,o=0;o<f.length;o++){var c=f[o];if(c.localName==="OnlineResource")return c.getAttribute("xlink:href")}},s.prototype.assembleLatLonBoundingBox=function(a){for(var f=a.children||a.childNodes,o={},c,d,h,u=0;u<f.length;u++){var m=f[u];m.localName==="pos"&&(c?(h=parseFloat(m.textContent.split(/\s+/)[0]),d<h?(o.lowerCorner=c,o.upperCorner=m.textContent):(o.lowerCorner=m.textContent,o.upperCorner=c)):(c=m.textContent,d=parseFloat(c.split(/\s+/)[0])))}return o},s.prototype.assembleServiceMetadata=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="formatSupported"?(o.formatsSupported=o.formatsSupported||[],o.formatsSupported.push(d.textContent)):d.localName==="Extension"&&(o.extension=this.assembleServiceMetadataExtension(d))}return o},s.prototype.assembleServiceMetadataExtension=function(a){for(var f=a.children||a.childNodes,o=f.length,c={},d=0;d<o;d++){var h=f[d];h.localName==="crsSupported"?(c.crsSupported=c.crsSupported||[],c.crsSupported.push(h.textContent)):h.localName==="interpolationSupported"&&(c.interpolationSupported=c.interpolationSupported||[],c.interpolationSupported.push(h.textContent))}return c},s}),B("ogc/wcs/WcsUrlBuilder",["../../error/ArgumentError","../../util/Logger"],function(p,l){"use strict";var n=function(e,i){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsUrlBuilder","constructor","missingId"));if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsUrlBuilder","constructor","missingWebCoverageService"));this.coverageId=e,this.service=i};return n.prototype.urlForTile=function(e,i){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsUrlBuilder","urlForTile","missingTile"));if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsUrlBuilder","urlForTile","The specified format is null or undefined."));var t=this.service.capabilities.version,r=this.fixGetCoverageString(this.service.capabilities.getCoverageBaseUrl());if(r+="SERVICE=WCS",r+="&REQUEST=GetCoverage",t==="1.0.0")return this.buildUrl100(e,i,r);if(t==="2.0.1"||t==="2.0.0")return this.buildUrl20x(e,i,r)},n.prototype.buildUrl100=function(e,i,t){var r=e.sector;return t+="&VERSION=1.0.0",t+="&COVERAGE="+this.coverageId,t+="&CRS=EPSG:4326",t+="&WIDTH="+e.tileWidth,t+="&HEIGHT="+e.tileHeight,t+="&FORMAT="+i,t+="&BBOX="+r.minLongitude+","+r.minLatitude+","+r.maxLongitude+","+r.maxLatitude,encodeURI(t)},n.prototype.buildUrl20x=function(e,i,t){for(var r=e.sector,s,a,f,o,c,d=0,h=this.service.coverageDescriptions.coverages.length;d<h;d++)if(this.coverageId===this.service.coverageDescriptions.coverages[d].coverageId){f=this.service.coverageDescriptions.coverages[d];break}return o=f.domainSet.rectifiedGrid.axisLabels,c=f.boundedBy.envelope.axisLabels,c[0].toLowerCase().indexOf("lat")>=0?(s=c[0],a=c[1]):(s=c[1],a=c[0]),t+="&VERSION="+this.service.capabilities.version,t+="&COVERAGEID="+this.coverageId,t+="&FORMAT="+i,t+="&SCALESIZE="+o[0]+"("+e.tileWidth+"),",t+=o[1]+"("+e.tileHeight+")",t+="&OVERVIEWPOLICY=NEAREST",t+="&SUBSET="+s+"("+r.minLatitude+","+r.maxLatitude+")",t+="&SUBSET="+a+"("+r.minLongitude+","+r.maxLongitude+")",encodeURI(t)},n.prototype.fixGetCoverageString=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"WmsUrlBuilder","fixGetMapString","The specified service address is null or undefined."));var i=e.indexOf("?");return i<0?e=e+"?":i!==e.length-1&&(i=e.search(/&$/),i<0&&(e=e+"&")),e},n}),B("ogc/wcs/WcsCoverage",["../../error/ArgumentError","../../util/Logger","../../ogc/wcs/WcsUrlBuilder"],function(p,l,n){"use strict";var e=function(i,t){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsCoverage","constructor","missingId"));if(!t)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsCoverage","constructor","missingWebCoverageService"));this.coverageId=i,this.service=t,this.sector=this.service.coverageDescriptions.getSector(this.coverageId),this.resolution=this.service.coverageDescriptions.getResolution(this.coverageId),this.elevationConfig=this.createElevationConfig()};return e.PREFERRED_FORMATS={GeoTIFF:!0,"image/tiff":!0,TIFF:!0},e.DEFAULT_FORMAT="image/tiff",e.prototype.createElevationConfig=function(){return{resolution:this.resolution,coverageSector:this.sector,retrievalImageFormat:this.determineFormatFromService(),urlBuilder:new n(this.coverageId,this.service)}},e.prototype.determineFormatFromService=function(){var i=this.service.capabilities.version,t,r,s,a,f;if(i==="1.0.0"){for(a=0,f=this.service.coverageDescriptions.coverages.length;a<f;a++)if(this.coverageId===this.service.coverageDescriptions.coverages[a].name){t=this.service.coverageDescriptions.coverages[a].supportedFormats.formats;break}}else(i==="2.0.1"||i==="2.0.0")&&(t=this.service.capabilities.serviceMetadata.formatsSupported);if(!t)return e.DEFAULT_FORMAT;for(a=0,f=t.length;a<f;a++)if(e.PREFERRED_FORMATS.hasOwnProperty(t[a]))return t[a];return e.DEFAULT_FORMAT},e}),B("ogc/gml/GmlBoundedBy",["../../error/ArgumentError","../../util/Logger"],function(p,l){"use strict";var n=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"GmlAbstractGeometry","constructor","missingDom"));this.assembleElement(e)};return n.prototype.assembleElement=function(e){var i=e.children||e.childNodes;this.nilReason=e.getAttribute("nilReason");for(var t=0;t<i.length;t++){var r=i[t];r.localName==="Envelope"&&(this.envelope=this.assembleEnvelope(r))}},n.prototype.assembleEnvelope=function(e){var i=e.children||e.childNodes,t={};t.srsName=e.getAttribute("srsName"),t.srsDimension=parseInt(e.getAttribute("srsDimension")),t.axisLabels=e.getAttribute("axisLabels"),t.axisLabels&&(t.axisLabels=t.axisLabels.split(/\s+/)),t.uomLabels=e.getAttribute("uomLabels"),t.uomLabels&&(t.uomLabels=t.uomLabels.split(/\s+/));for(var r=0;r<i.length;r++){var s=i[r];if(s.localName==="lowerCorner"){t.lower=s.textContent.split(/\s+/);for(var a=0;a<t.lower.length;a++)t.lower[a]=parseFloat(t.lower[a])}else if(s.localName==="upperCorner"){t.upper=s.textContent.split(/\s+/);for(var a=0;a<t.upper.length;a++)t.upper[a]=parseFloat(t.upper[a])}}return t},n}),B("ogc/gml/GmlRectifiedGrid",["../../error/ArgumentError","../../util/Logger"],function(p,l){"use strict";var n=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"GmlRectifiedGrid","constructor","missingDom"));this.assembleElement(e)};return n.prototype.assembleElement=function(e){var i=e.children||e.childNodes;this.captureAttributes(e);for(var t=0;t<i.length;t++){var r=i[t];r.localName==="description"?this.description=r.textContent:r.localName==="descriptionReference"?this.descriptionReference=r.getAttribute("xlink:href"):r.localName==="identifier"?this.identifier=r.textContent:r.localName==="name"?(this.names=this.names||[],this.names.push(r.textContent)):r.localName==="limits"?this.limits=this.assembleLimits(r):r.localName==="axisLabels"?this.axisLabels=r.textContent.split(/\s+/):r.localName==="axisName"?(this.axisNames=this.axisNames||[],this.axisNames.push(r.textContent)):r.localName==="origin"?this.origin=this.assembleOrigin(r):r.localName==="offsetVector"&&(this.offsetVector=this.offsetVector||[],this.offsetVector.push(this.assembleOffsetVector(r)))}},n.prototype.captureAttributes=function(e){this.id=e.getAttribute("gml:id"),this.srsName=e.getAttribute("srsName"),this.srsDimension=e.getAttribute("srsDimension"),this.axisLabels=e.getAttribute("axisLabels"),this.axisLabels&&(this.axisLabels=this.axisLabels.split(/\s+/)),this.uomLabels=e.getAttribute("uomLabels"),this.uomLabels&&(this.uomLabels=this.uomLabels.split(/\s+/)),this.dimension=parseInt(e.getAttribute("dimension"))},n.prototype.assembleLimits=function(e){for(var i=e.children||e.childNodes,t=0;t<i.length;t++){var r=i[t];if(r.localName==="GridEnvelope")return this.assembleGridEnvelope(r)}},n.prototype.assembleGridEnvelope=function(e){for(var i=e.children||e.childNodes,t={},r=0;r<i.length;r++){var s=i[r];t[s.localName]=s.textContent.split(/\s+/)}return t},n.prototype.assembleOrigin=function(e){var i={};i.type=e.getAttribute("xlink:type"),i.href=e.getAttribute("xlink:href"),i.role=e.getAttribute("xlink:role"),i.arcrole=e.getAttribute("xlink:arcrole"),i.title=e.getAttribute("xlink:title"),i.show=e.getAttribute("xlink:show"),i.actuate=e.getAttribute("xlink:actuate"),i.nilReason=e.getAttribute("nilReason"),i.remoteSchema=e.getAttribute("gml:remoteSchema"),i.owns=e.getAttribute("owns");for(var t=e.children||e.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="Point"?i.point=this.assemblePoint(s):s.localName==="pos"&&(i.pos=this.assemblePos(s))}return i},n.prototype.assemblePoint=function(e){var i={},t={};i.id=e.getAttribute("gml:id"),i.srsName=e.getAttribute("srsName"),i.srsDimension=e.getAttribute("srsDimension"),i.axisLabels=e.getAttribute("axisLabels"),i.axisLabels&&(i.axisLabels=i.axisLabels.split(/\s+/)),i.uomLabels=e.getAttribute("uomLabels"),i.uomLabels&&(i.uomLabels=i.uomLabels.split(/\s+/));for(var r=e.children||e.childNodes,s=0;s<r.length;s++){var a=r[s];a.localName==="description"?i.description=a.textContent:a.localName==="descriptionReference"?i.descriptionReference=this.assembleOrigin(a):a.localName==="identifier"?i.identifier=a.textContent:a.localName==="name"?i.name=a.textContent:a.localName==="pos"&&(i.pos=this.assemblePos(a))}return i},n.prototype.assemblePos=function(e){var i={};if(i.srsName=e.getAttribute("srsName"),i.srsDimension=parseInt(e.getAttribute("srsDimension")),i.axisLabels=e.getAttribute("axisLabels"),i.axisLabels&&(i.axisLabels=i.axisLabels.split(/\s+/)),i.uomLabels=e.getAttribute("uomLabels"),i.uomLabels&&(i.uomLabels=i.uomLabels.split(/\s+/)),i.pos=e.textContent,i.pos){i.pos=i.pos.split(/\s+/);for(var t=0;t<i.pos.length;t++)i.pos[t]=parseFloat(i.pos[t])}return i},n.prototype.assembleOffsetVector=function(e){var i=e.children||e.childNodes,t={},r;t.srsName=e.getAttribute("srsName"),t.srsDimension=parseInt(e.getAttribute("srsDimension")),t.axisLabels=e.getAttribute("axisLabels"),t.axisLabels&&(t.axisLabels=t.axisLabels.split(/\s+/)),t.uomLabels=e.getAttribute("uomLabels"),t.uomLabels&&(t.uomLabels=t.uomLabels.split(/\s+/)),r=e.textContent.split(/\s+/),t.values=[];for(var s=0;s<r.length;s++)t.values.push(parseFloat(r[s]));return t},n}),B("ogc/gml/GmlDomainSet",["../../error/ArgumentError","../../ogc/gml/GmlRectifiedGrid","../../util/Logger"],function(p,l,n){"use strict";var e=function(i){if(!i)throw new p(n.logMessage(n.LEVEL_SEVERE,"GmlAbstractGeometry","constructor","missingDom"));this.assembleElement(i)};return e.prototype.assembleElement=function(i){for(var t=i.children||i.childNodes,r=0;r<t.length;r++){var s=t[r];s.localName==="RectifiedGrid"&&(this.rectifiedGrid=new l(s))}},e}),B("ogc/wcs/WcsCoverageDescriptions",["../../error/ArgumentError","../../ogc/gml/GmlBoundedBy","../../ogc/gml/GmlDomainSet","../../ogc/gml/GmlRectifiedGrid","../../util/Logger","../../ogc/ows/OwsKeywords","../../geom/Sector"],function(p,l,n,e,i,t,r){"use strict";var s=function(a){if(!a)throw new p(i.logMessage(i.LEVEL_SEVERE,"WcsCoverageDescriptions","constructor","missingDom"));this.xmlDom=a,this.assembleDocument()};return s.prototype.getSector=function(a){if(!a)throw new p(i.logMessage(i.LEVEL_SEVERE,"WcsCoverageDescriptions","getSector","missingId"));var f=this.getCoverage(a),o;return f?this.version==="1.0.0"?(o=f.lonLatEnvelope.pos,new r(o[0][1],o[1][1],o[0][0],o[1][0])):this.version==="2.0.1"||this.version==="2.0.0"?(o=f.boundedBy.envelope,new r(o.lower[0],o.upper[0],o.lower[1],o.upper[1])):null:null},s.prototype.getResolution=function(a){if(!a)throw new p(i.logMessage(i.LEVEL_SEVERE,"WcsCoverageDescriptions","getResolution","missingId"));var f=this.getCoverage(a),o=this.getSector(a),c,d,h,u,m,g;return f?(this.version==="1.0.0"?(c=f.domainSet.spatialDomain.rectifiedGrid.limits.low[0],d=f.domainSet.spatialDomain.rectifiedGrid.limits.low[1],h=f.domainSet.spatialDomain.rectifiedGrid.limits.high[0],u=f.domainSet.spatialDomain.rectifiedGrid.limits.high[1]):(this.version==="2.0.1"||this.version==="2.0.0")&&(c=f.domainSet.rectifiedGrid.limits.low[0],d=f.domainSet.rectifiedGrid.limits.low[1],h=f.domainSet.rectifiedGrid.limits.high[0],u=f.domainSet.rectifiedGrid.limits.high[1]),m=o.deltaLongitude()/(h-c),g=o.deltaLatitude()/(u-d),Math.max(m,g)):null},s.prototype.getSupportedCrs=function(a){if(!a)throw new p(i.logMessage(i.LEVEL_SEVERE,"WcsCoverageDescriptions","getSupportedCrs","missingId"));var f=this.getCoverage(a),o=[];return f?this.version==="1.0.0"?f.supportedCrs.requests:this.version==="2.0.1"||this.version==="2.0.0"?(o.push(f.boundedBy.envelope.srsName),o):null:null},s.prototype.getCoverage=function(a){for(var f=0,o=this.coverages.length;f<o;f++)if(a===(this.coverages[f].coverageId||this.coverages[f].name))return this.coverages[f];return null},s.prototype.assembleDocument=function(){var a=this.xmlDom.documentElement;if(a.localName==="CoverageDescription")this.assembleDocument100(a),this.version="1.0.0";else if(a.localName==="CoverageDescriptions")this.assembleDocument20x(a),this.version=a.getAttribute("version")||"2.0.1";else throw new p(i.logMessage(i.LEVEL_SEVERE,"WcsCapabilities","assembleDocument","unsupportedVersion"))},s.prototype.assembleDocument100=function(a){this.version=a.getAttribute("version");for(var f=a.children||a.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="CoverageOffering"&&(this.coverages=this.coverages||[],this.coverages.push(this.assembleCoverages100(c)))}},s.prototype.assembleDocument20x=function(a){for(var f=a.children||a.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="CoverageDescription"&&(this.coverages=this.coverages||[],this.coverages.push(this.assembleCoverages20x(c)))}},s.prototype.assembleCoverages100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="name"?o.name=d.textContent:d.localName==="description"?o.description=d.textContent:d.localName==="label"?o.label=d.textContent:d.localName==="keywords"?o.keywords=new t(d).keywords:d.localName==="lonLatEnvelope"?o.lonLatEnvelope=this.assembleLonLatEnvelope100(d):d.localName==="supportedCRSs"?o.supportedCrs=this.assembleSupportedCrs100(d):d.localName==="supportedFormats"?o.supportedFormats=this.assembleSupportedFormats100(d):d.localName==="supportedInterpolations"?o.supportedInterpolations=this.assembleSupportedInterpolations100(d):d.localName==="domainSet"?o.domainSet=this.assembleDomainSet100(d):d.localName==="rangeSet"&&(o.rangeSet=this.assembleRangeSet100(d))}return o},s.prototype.assembleCoverages20x=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="CoverageId"?o.coverageId=d.textContent:d.localName==="domainSet"?o.domainSet=new n(d):d.localName==="boundedBy"?o.boundedBy=new l(d):d.localName==="ServiceParameters"?o.serviceParameters=this.assembleServiceParameters20x(d):d.localName==="rangeType"&&(o.rangeType=d)}return o},s.prototype.assembleServiceParameters20x=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="nativeFormat"?o.nativeFormat=d.textContent:d.localName==="CoverageSubtype"&&(o.coverageSubtype=d.textContent)}return o},s.prototype.assembleLonLatEnvelope100=function(a){var f=a.children||a.childNodes,o={};o.srsName=a.getAttribute("srsName");for(var c=0;c<f.length;c++){var d=f[c];d.localName==="pos"&&(o.pos=o.pos||[],o.pos.push(s.parseSpacedFloatArray(d.textContent)))}return o},s.prototype.assembleSupportedCrs100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="requestResponseCRSs"?(o.requests=o.requests||[],o.requests.push(d.textContent),o.responses=o.responses||[],o.responses.push(d.textContent)):d.localName==="requestCRSs"?(o.requests=o.requests||[],o.push(d.textContent)):d.localName==="responseCRSs"?(o.responses=o.responses||[],o.push(d.textContent)):d.localName==="NativeCRSs"&&(o.nativeCrs=o.nativeCrs||[],o.push(d.textContent))}return o},s.prototype.assembleSupportedFormats100=function(a){var f=a.children||a.childNodes,o={};o.nativeFormat=a.getAttribute("nativeFormat");for(var c=0;c<f.length;c++){var d=f[c];d.localName==="formats"&&(o.formats=o.formats||[],o.formats.push(d.textContent))}return o},s.prototype.assembleSupportedInterpolations100=function(a){var f=a.children||a.childNodes,o={};o.default=a.getAttribute("default");for(var c=0;c<f.length;c++){var d=f[c];d.localName==="interpolationMethod"&&(o.methods=o.methods||[],o.methods.push(d.textContent))}return o},s.prototype.assembleDomainSet100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="spatialDomain"&&(o.spatialDomain=this.assembleSpatialDomain100(d))}return o},s.prototype.assembleSpatialDomain100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="Envelope"?o.envelope=this.assembleLonLatEnvelope100(d):d.localName==="RectifiedGrid"&&(o.rectifiedGrid=new e(d))}return o},s.prototype.assembleRangeSet100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];if(d.localName==="RangeSet")return this.assembleRangeSetElement100(d)}},s.prototype.assembleRangeSetElement100=function(a){var f=a.children||a.childNodes,o={};o.semantic=a.getAttribute("semantic"),o.refSys=a.getAttribute("refSys"),o.refSysLable=a.getAttribute("refSysLabel");for(var c=0;c<f.length;c++){var d=f[c];d.localName==="name"?o.name=d.textContent:d.localName==="label"?o.label=d.textContent:d.localName==="axisDescription"&&(o.axisDescriptions=this.assembleRangeSetAxisDescription100(d))}return o},s.prototype.assembleRangeSetAxisDescription100=function(a){for(var f=a.children||a.childNodes,o=[],c=0;c<f.length;c++){var d=f[c];d.localName==="AxisDescription"&&o.push(this.assembleRangeSetAxisDescriptionElement100(d))}return o},s.prototype.assembleRangeSetAxisDescriptionElement100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="name"?o.name=d.textContent:d.localName==="label"?o.label=d.textContent:d.localName==="values"&&(o.values=this.assembleRangeSetValues100(d))}return o},s.prototype.assembleRangeSetValues100=function(a){for(var f=a.children||a.childNodes,o={},c=0;c<f.length;c++){var d=f[c];d.localName==="singleValue"&&(o.singleValue=d.textContent)}return o},s.parseSpacedFloatArray=function(a){for(var f=[],o=a.split(/\s+/),c=0;c<o.length;c++)f.push(parseFloat(o[c]));return f},s}),B("util/WcsTileUrlBuilder",["../error/ArgumentError","../util/Logger"],function(p,l){"use strict";var n=function(e,i,t){if(!e||e.length===0)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsTileUrlBuilder","constructor","The WCS service address is missing."));if(!i||i.length===0)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsTileUrlBuilder","constructor","The WCS coverage name is missing."));this.serviceAddress=e,this.coverageName=i,this.wcsVersion=t&&t.length>0?t:"1.0.0",this.crs="EPSG:4326"};return n.prototype.urlForTile=function(e,i){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsUrlBuilder","urlForTile","missingTile"));if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsUrlBuilder","urlForTile","The coverage format is null or undefined."));var t=e.sector,r=n.fixGetCoverageString(this.serviceAddress);return r.search(/service=wcs/i)<0&&(r=r+"service=WCS"),r=r+"&request=GetCoverage",r=r+"&version="+this.wcsVersion,r=r+"&coverage="+this.coverageName,r=r+"&format="+i,r=r+"&width="+e.tileWidth,r=r+"&height="+e.tileHeight,r=r+"&crs="+this.crs,r=r+"&bbox=",r=r+t.minLongitude+","+t.minLatitude+",",r=r+t.maxLongitude+","+t.maxLatitude,r=r.replace(" ","%20"),r},n.fixGetCoverageString=function(e){if(!e)throw new p(l.logMessage(l.LEVEL_SEVERE,"WcsTileUrlBuilder","fixGetCoverageString","The specified service address is null or undefined."));var i=e.indexOf("?");return i<0?e=e+"?":i!==e.length-1&&(i=e.search(/&$/),i<0&&(e=e+"&")),e},n}),B("globe/WcsEarthElevationCoverage",["../geom/Location","../geom/Sector","../globe/TiledElevationCoverage","../util/WcsTileUrlBuilder"],function(p,l,n,e){"use strict";var i=function(){n.call(this,{coverageSector:l.FULL_SPHERE,resolution:.008333333333333,retrievalImageFormat:"image/tiff",minElevation:-11e3,maxElevation:8850,urlBuilder:new e("worldwind26.arc.nasa.gov/wms2","NASA_SRTM30_900m_Tiled","1.0.0")}),this.displayName="WCS Earth Elevation Coverage"};return i.prototype=Object.create(n.prototype),i}),B("ogc/wcs/WebCoverageService",["../../error/ArgumentError","../../util/Logger","../../util/Promise","../../ogc/wcs/WcsCapabilities","../../ogc/wcs/WcsCoverage","../../ogc/wcs/WcsCoverageDescriptions"],function(p,l,n,e,i,t){"use strict";var r=function(){this.serviceAddress=null,this.coverages=[],this.capabilities=null,this.coverageDescriptions=null};return r.WCS_XLMNS="http://www.opengis.net/wcs",r.WCS_2_XLMNS="http://www.opengis.net/wcs/2.0",r.create=function(s){if(!s)throw new p(l.logMessage(l.LEVEL_SEVERE,"WebCoverageService","constructor","missingUrl"));var a=new r;return a.serviceAddress=s,a.retrieveCapabilities().then(function(f){return a.capabilities=f,a.retrieveCoverageDescriptions(f)}).then(function(f){return a.parseCoverages(f),a})},r.prototype.getCoverage=function(s){},r.prototype.retrieveCapabilities=function(){var s=this,a;return s.retrieveXml(s.buildCapabilitiesXmlRequest("2.0.1")).then(function(f){return a=f.documentElement.getAttribute("version"),a==="2.0.1"||a==="2.0.0"?f:s.retrieveXml(s.buildCapabilitiesXmlRequest("1.0.0"))}).then(function(f){return new e(f)})},r.prototype.retrieveCoverageDescriptions=function(){return this.retrieveXml(this.buildDescribeCoverageXmlRequest())},r.prototype.parseCoverages=function(s){this.coverageDescriptions=new t(s);for(var a=this.coverageDescriptions.coverages.length,f,o,c=0;c<a;c++)f=this.coverageDescriptions.coverages[c].coverageId||this.coverageDescriptions.coverages[c].name,o=new i(f,this),this.coverages.push(o)},r.prototype.retrieveXml=function(s){return new n(function(a,f){var o=new XMLHttpRequest;o.open("POST",s.url),o.onreadystatechange=function(){o.readyState===4&&(o.status===200?a(o.responseXML):f(new Error(l.logMessage(l.LEVEL_WARNING,"XML retrieval failed ("+o.statusText+"): "+s.url))))},o.onerror=function(){f(new Error(l.logMessage(l.LEVEL_WARNING,"XML retrieval failed: "+s.url)))},o.ontimeout=function(){f(new Error(l.logMessage(l.LEVEL_WARNING,"XML retrieval timed out: "+s.url)))},o.send(s.body)})},r.prototype.buildCapabilitiesXmlRequest=function(s){var a=this.createBaseWcsElement("GetCapabilities",s);return{url:this.serviceAddress,body:new XMLSerializer().serializeToString(a)}},r.prototype.buildDescribeCoverageXmlRequest=function(){var s=this.capabilities.version,a,f,o,c=this.capabilities.coverages.length;a=this.createBaseWcsElement("DescribeCoverage",s),s==="1.0.0"?o=this.capabilities.capability.request.describeCoverage.get:(s==="2.0.1"||s==="2.0.0")&&(o=this.capabilities.operationsMetadata.getOperationMetadataByName("DescribeCoverage").dcp[0].getMethods[0].url);for(var d=0;d<c;d++)s==="1.0.0"?(f=document.createElementNS(r.WCS_XLMNS,"Coverage"),f.appendChild(document.createTextNode(this.capabilities.coverages[d].name))):(s==="2.0.1"||s==="2.0.0")&&(f=document.createElementNS(r.WCS_2_XLMNS,"CoverageId"),f.appendChild(document.createTextNode(this.capabilities.coverages[d].coverageId))),a.appendChild(f);return{url:o,body:new XMLSerializer().serializeToString(a)}},r.prototype.createBaseWcsElement=function(s,a){var f;return a==="1.0.0"?(f=document.createElementNS(r.WCS_XLMNS,s),f.setAttribute("version","1.0.0")):(a==="2.0.1"||a==="2.0.0")&&(f=document.createElementNS(r.WCS_2_XLMNS,s),f.setAttribute("version",a)),f.setAttribute("service","WCS"),f},r}),B("ogc/WfsCapabilities",["../error/ArgumentError","../util/Logger","../ogc/ows/OwsLanguageString","../ogc/ows/OwsOperationsMetadata","../ogc/ows/OwsServiceIdentification","../ogc/ows/OwsServiceProvider"],function(p,l,n,e,i,t){"use strict";var r=function(s){if(!s)throw new p(l.logMessage(l.LEVEL_SEVERE,"WfsCapabilities","constructor","No XML DOM specified."));this.assembleDocument(s)};return r.prototype.assembleDocument=function(s){var a=s.documentElement;this.version=a.getAttribute("version"),this.updateSequence=a.getAttribute("updateSequence");for(var f=a.children||a.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="ServiceIdentification"?this.serviceIdentification=new i(c):c.localName==="ServiceProvider"?this.serviceProvider=new t(c):c.localName==="OperationsMetadata"?this.operationsMetadata=new e(c):c.localName==="FeatureTypeList"?this.featureTypeList=this.assembleFeatureTypeList(c):c.localName==="Filter_Capabilities"&&(this.filterCapabilities=this.assembleFilterCapabilities(c))}},r.prototype.assembleFeatureTypeList=function(s){for(var a={},f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];if(c.localName=="Operations"){a.operations=a.operations||[];try{a.operations=r.assembleOperations(c)}catch(d){l.logMessage(l.LEVEL_SEVERE,"WfsCapabilities","constructor","Exception reading WFS operations description: "+d.message)}}else if(c.localName=="FeatureType"){a.featureType=a.featureType||[];try{a.featureType.push(r.assembleFeatureType(c))}catch(d){l.logMessage(l.LEVEL_SEVERE,"WfsCapabilities","constructor","Exception reading WFS operations description: "+d.message)}}}return a},r.prototype.assembleFilterCapabilities=function(s){for(var a={},f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Conformance"?a.conformance=r.assembleConformance(c):c.localName==="Id_Capabilities"?a.idCapabilities=r.assembleIdCapabilities(c):c.localName==="Scalar_Capabilities"?a.scalarCapabilities=r.assembleScalarCapabilities(c):c.localName==="Spatial_Capabilities"?a.spatialCapabilities=r.assembleSpatialCapabilities(c):c.localName==="Functions"&&(a.functions=r.assembleFunctions(c))}return a},r.assembleOperations=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName=="Operation"&&a.push(c.textContent)}return a},r.assembleFeatureType=function(s){for(var a={},f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName=="Name"?a.name=c.textContent:c.localName=="Title"?a.title=c.textContent:c.localName=="Abstract"?a.abstract=c.textContent:c.localName=="Keywords"?(a.keywords=a.keywords||[],a.keywords=r.assembleKeywords(c)):c.localName=="DefaultSRS"?a.defaultSRS=c.textContent:c.localName=="OtherSRS"?(a.otherSRS=a.otherSRS||[],a.otherSRS.push(c.textContent)):c.localName=="WGS84BoundingBox"?a.wgs84BoundingBox=r.assembleBoundingBox(c):c.localName=="DefaultCRS"?a.defaultCRS=c.textContent:c.localName=="OtherCRS"?(a.otherCRS=a.otherCRS||[],a.otherCRS.push(c.textContent)):c.localName=="OutputFormats"?a.outputFormats=r.assembleOutputFormats(c):c.localName=="MetadataURL"&&(a.metadataUrl=r.assembleMetadataUrl(c))}return a},r.assembleBoundingBox=function(s){var a={},f=s.getAttribute("crs");f&&(a.crs=f);for(var o=s.children||s.childNodes,c=0;c<o.length;c++){var d=o[c];if(d.localName==="LowerCorner"){var h=d.textContent.split(" ");a.lowerCorner=[parseFloat(h[0]),parseFloat(h[1])]}else if(d.localName==="UpperCorner"){var u=d.textContent.split(" ");a.upperCorner=[parseFloat(u[0]),parseFloat(u[1])]}}return a},r.assembleOutputFormats=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Format"&&a.push(c.textContent)}return a},r.assembleMetadataUrl=function(s){for(var a={},f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="MetadataURL"&&(a.format=c.getAttribute("format"),a.type=c.getAttribute("type"))}return outputFormats},r.assembleKeywords=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Keyword"&&a.push(c.textContent)}return a},r.assembleConformance=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];if(c.localName==="Constraint"){var d;d=r.assembleConstraint(c),d.name=c.getAttribute("name"),a.push(d)}}return a},r.assembleConstraint=function(s){for(var a={},f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="DefaultValue"&&(a.defaultValue=c.textContent)}return a},r.assembleIdCapabilities=function(s){for(var a={},f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="ResourceIdentifier"&&(a.resourceIdentifier=c.getAttribute("name"))}return a},r.assembleScalarCapabilities=function(s){for(var a={},f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="ComparisonOperators"?a.comparisonOperators=r.assembleComparisonOperators(c):c.localName==="ArithmeticOperators"&&(a.arithmeticOperators=r.assembleArithmeticOperators(c))}return a},r.assembleComparisonOperators=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="ComparisonOperator"&&a.push(c.textContent)}return a},r.assembleArithmeticOperators=function(s){for(var a={},f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Functions"&&(a.functions=r.assembleArithmeticFunctions(c))}return a},r.assembleArithmeticFunctions=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="FunctionNames"&&(a=r.assembleFunctionNames(c))}return a},r.assembleFunctionNames=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];if(c.localName==="FunctionName"){var d={name:c.textContent,nArgs:c.getAttribute("nArgs")};a.push(d)}}return a},r.assembleSpatialCapabilities=function(s){for(var a={},f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="GeometryOperands"?a.geometryOperands=r.assembleGeometryOperands(c):c.localName==="SpatialOperators"&&(a.spatialOperators=r.assembleSpatialOperators(c))}return a},r.assembleGeometryOperands=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="GeometryOperand"&&a.push(c.getAttribute("name"))}return a},r.assembleSpatialOperators=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="SpatialOperator"&&a.push(c.getAttribute("name"))}return a},r.assembleFunctions=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Function"&&a.push(r.assembleFunction(c))}return a},r.assembleFunction=function(s){var a={};a.name=s.getAttribute("name");for(var f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Returns"?a.returns=c.textContent:c.localName==="Arguments"&&(a.arguments=r.assembleArguments(c))}return a},r.assembleArguments=function(s){for(var a=[],f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Argument"&&a.push(r.assembleArgument(c))}return a},r.assembleArgument=function(s){var a={};a.name=s.getAttribute("name");for(var f=s.children||s.childNodes,o=0;o<f.length;o++){var c=f[o];c.localName==="Type"&&(a.type=c.textContent)}return a},r}),B("formats/wkt/WktElements",[],function(){var p={};return p}),B("formats/wkt/WktType",[],function(){var p=function(){};return p.SupportedGeometries={LINE_STRING:"LINESTRING",MULTI_LINE_STRING:"MULTILINESTRING",POLYGON:"POLYGON",MULTI_POLYGON:"MULTIPOLYGON",POINT:"POINT",MULTI_POINT:"MULTIPOINT",TRIANGLE:"TRIANGLE",GEOMETRY_COLLECTION:"GEOMETRYCOLLECTION"},p.TokenType={LEFT_PARENTHESIS:0,COMMA:1,RIGHT_PARENTHESIS:2,NUMBER:3,TEXT:4},p}),B("formats/wkt/geom/WktObject",["../../../geom/Location","../../../geom/Position","../WktElements","../WktType"],function(p,l,n,e){var i=function(t){this.type=t,this._is3d=!1,this._isLrs=!1,this.coordinates=[],this.options={coordinates:[],leftParenthesis:0,rightParenthesis:0,tokens:[]}};return i.prototype.set3d=function(){this._is3d=!0},i.prototype.setLrs=function(){this._isLrs=!0},i.prototype.addCoordinates=function(t){this._is3d?this.coordinates.push(new l(t[1],t[0],t[2]||0)):this.coordinates.push(new p(t[1],t[0]))},i.prototype.shapes=function(){return[]},i.prototype.handleToken=function(t){var r=t.value,s=this.options;t.type===e.TokenType.TEXT?this.text(s,r):t.type===e.TokenType.LEFT_PARENTHESIS?this.leftParenthesis(s):t.type===e.TokenType.RIGHT_PARENTHESIS?this.rightParenthesis(s):t.type===e.TokenType.NUMBER?this.number(s,r):t.type===e.TokenType.COMMA&&this.comma(s),s.tokens.push(t)},i.prototype.text=function(t,r){r=r.toUpperCase();var s=null;if(r.length<=2)this.setOptions(r,this);else if(r.indexOf("EMPTY")===0)t.leftParenthesis=1,t.rightParenthesis=1;else{var a=r.match("[M]?[Z]?$");a&&a.length>0&&a[0]!=""&&this.setOptions(a,s);var f=n[r]&&new n[r];f||(f=new i),a&&a.length>0&&a[0]!=""&&f.setOptions(a[0],f),this.add(f)}},i.prototype.rightParenthesis=function(t){t.rightParenthesis++,t.coordinates&&(this.addCoordinates(t.coordinates),t.coordinates=null)},i.prototype.leftParenthesis=function(t){t.leftParenthesis++},i.prototype.comma=function(t){t.coordinates?(this.addCoordinates(t.coordinates),t.coordinates=null):this.commaWithoutCoordinates(t)},i.prototype.commaWithoutCoordinates=function(t){},i.prototype.number=function(t,r){t.coordinates=t.coordinates||[],t.coordinates.push(r)},i.prototype.setOptions=function(t,r){t=="Z"?r.set3d():t=="M"?r.setLrs():t=="MZ"&&(r.set3d(),r.setLrs())},i.prototype.isFinished=function(){return this.options.leftParenthesis===this.options.rightParenthesis&&this.options.leftParenthesis>0},i}),B("formats/wkt/WktTokens",["./WktElements","./geom/WktObject","./WktType"],function(p,l,n){var e=function(i){this.sourceText=i};return e.prototype.objects=function(){var i,t=[];return this.tokenize(this.sourceText).forEach(function(r){if(i&&i.isFinished()||!i){var s=r.value,a=s.match("[M]?[Z]?$");a&&a.length>0&&a[0]!=""&&(s=s.substring(0,s.length-a.length)),i=p[s]&&new p[s],i||(i=new l),a&&a.length>0&&a[0]!=""&&i.setOptions(a[0],i),t.push(i)}else i.handleToken(r)}),t},e.prototype.tokenize=function(i){this.currentPosition=0;for(var t=[];this.currentPosition<i.length;this.currentPosition++){var r=i.charAt(this.currentPosition);if(r=="(")t.push({type:n.TokenType.LEFT_PARENTHESIS});else if(r==",")t.push({type:n.TokenType.COMMA});else if(r==")")t.push({type:n.TokenType.RIGHT_PARENTHESIS});else if(this.isAlpha(r)){var s=this.readText(i);t.push({type:n.TokenType.TEXT,value:s})}else if(this.isNumeric(r)){var a=this.readNumeric(i);t.push({type:n.TokenType.NUMBER,value:a})}else{if(this.isWhiteSpace(r))continue;throw new Error("Invalid character: {{",r,"}}")}}return t},e.prototype.isAlpha=function(i){return i>="a"&&i<="z"||i>="A"&&i<="Z"},e.prototype.isNumeric=function(i){return i>="0"&&i<="9"||i=="."||i=="-"},e.prototype.isWhiteSpace=function(i){return i==" "||i=="	"||i=="\r"||i=="\n"},e.prototype.readText=function(i){for(var t="";this.isAlpha(i.charAt(this.currentPosition));)t+=i.charAt(this.currentPosition),this.currentPosition++;return this.currentPosition--,t},e.prototype.readNumeric=function(i){for(var t="";this.isNumeric(i.charAt(this.currentPosition));)t+=i.charAt(this.currentPosition),this.currentPosition++;return this.currentPosition--,Number(t)},e}),B("formats/wkt/Wkt",["../../error/ArgumentError","../../util/Logger","./WktTokens"],function(p,l,n){var e=function(i){this.textRepresentation=i,this._parserCompletionCallback=this.defaultParserCompletionCallback,this._shapeConfigurationCallback=this.defaultShapeConfigurationCallback,this._layer=null};return Object.defineProperties(e.prototype,{parserCompletionCallback:{get:function(){return this._parserCompletionCallback}},shapeConfigurationCallback:{get:function(){return this._shapeConfigurationCallback}},layer:{get:function(){return this._layer}}}),e.prototype.load=function(i,t,r){r&&(this._layer=r),i&&(this._parserCompletionCallback=i),t&&(this._shapeConfigurationCallback=t),this.parserCompletionCallback(this,new n(this.textRepresentation).objects())},e.prototype.defaultShapeConfigurationCallback=function(i){},e.prototype.defaultParserCompletionCallback=function(i,t){var r=i.shapeConfigurationCallback,s=[];t.forEach(function(a){a.shapes().forEach(function(f){var o=r(a);o&&o.attributes&&(f.attributes=o.attributes),o&&o.highlightAttributes&&(f.highlightAttributes=o.highlightAttributes),o&&o.pickDelegate&&(f.pickDelegate=o.pickDelegate),o&&o.userProperties&&(f.userProperties=o.userProperties),s.push(f)})}),i.layer&&i.layer.addRenderables(s)},e}),B("formats/wkt/WktExporter",["../../error/ArgumentError","../../util/Logger","./WktType"],function(p,l,n){"use strict";var e={exportRenderable:function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportRenderable","missingRenderable"));return i instanceof WorldWind.Placemark?this.exportPlacemark(i):i instanceof WorldWind.Path?this.exportPath(i):i instanceof WorldWind.Polygon?this.exportPolygon(i):i instanceof WorldWind.SurfacePolyline?this.exportSurfacePolyline(i):i instanceof WorldWind.SurfacePolygon?this.exportSurfacePolygon(i):i instanceof WorldWind.SurfaceEllipse?this.exportSurfaceEllipse(i):i instanceof WorldWind.SurfaceCircle?this.exportSurfaceCircle(i):i instanceof WorldWind.SurfaceRectangle?this.exportSurfaceRectangle(i):i instanceof WorldWind.SurfaceSector?this.exportSurfaceSector(i):(l.log(l.LEVEL_WARNING,"Export renderable not implemented: "+i),null)},exportRenderables:function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportRenderables","missingRenderables"));if(i.length!=0)if(i.length>1){for(var t=n.SupportedGeometries.GEOMETRY_COLLECTION+"(",r=0;r<i.length;r++){var s=this.exportRenderable(i[r]);s&&(t=t+s,t=t+",")}return t=t.substring(0,t.length-1),t=t+")",t}else return this.exportRenderable(i[0])},exportLayer:function(i){if(!i)throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportLayer","missingLayer"));return this.exportRenderables(i.renderables)},exportPlacemark:function(i){if(!(i instanceof WorldWind.Placemark))throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportPlacemark","invalidTypeOfRenderable"));var t=n.SupportedGeometries.POINT+"(";return t=t+i.position.longitude+" "+i.position.latitude,t=t+")",t},exportPath:function(i){if(!(i instanceof WorldWind.Path))throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportPath","invalidTypeOfRenderable"));for(var t=n.SupportedGeometries.LINE_STRING+"(",r=0;r<i.positions.length;r++)t=t+i.positions[r].longitude+" "+i.positions[r].latitude;return t=t.substring(0,t.length-2),t=t+")",t},exportPolygon:function(i){if(!(i instanceof WorldWind.Polygon))throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportPolygon","invalidTypeOfRenderable"));var t=n.SupportedGeometries.POLYGON+"(";if(i.boundaries.length>0&&i.boundaries[0].length>2){for(var r=0;r<i.boundaries.length;r++){t=t+"(";for(var s=0;s<i.boundaries[r].length;s++)t=t+i.boundaries[r][s].longitude+" "+i.boundaries[r][s].latitude,t=t+", ";t=t.substring(0,t.length-2),t=t+")",t=t+", "}t=t.substring(0,t.length-2)}else{t=t+"(";for(var r=0;r<i.boundaries.length;r++)t=t+i.boundaries[r].longitude+" "+i.boundaries[r].latitude,t=t+", ";t=t.substring(0,t.length-2),t=t+")"}return t=t+")",t},exportSurfacePolyline:function(i){if(!(i instanceof WorldWind.SurfacePolyline))throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportSurfacePolyline","invalidTypeOfRenderable"));for(var t=n.SupportedGeometries.LINE_STRING+"(",r=0;r<i.boundaries.length;r++)t=t+i.boundaries[r].longitude+" "+i.boundaries[r].latitude,t=t+", ";return t=t.substring(0,t.length-2),t=t+")",t},exportSurfacePolygon:function(i){if(!(i instanceof WorldWind.SurfacePolygon))throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportSurfacePolygon","invalidTypeOfRenderable"));var t=n.SupportedGeometries.POLYGON+"(";if(i.boundaries.length>0&&i.boundaries[0].length>2){for(var r=0;r<i.boundaries.length;r++){t=t+"(";for(var s=0;s<i.boundaries[r].length;s++)t=t+i.boundaries[r][s].longitude+" "+i.boundaries[r][s].latitude,t=t+", ";t=t.substring(0,t.length-2),t=t+")",t=t+", "}t=t.substring(0,t.length-2)}else{t=t+"(";for(var r=0;r<i.boundaries.length;r++)t=t+i.boundaries[r].longitude+" "+i.boundaries[r].latitude,t=t+", ";t=t.substring(0,t.length-2),t=t+")"}return t=t+")",t},exportSurfaceEllipse:function(i){if(!(i instanceof WorldWind.SurfaceEllipse))throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportSurfaceEllipse","invalidTypeOfRenderable"));var t=n.SupportedGeometries.POLYGON+"(";t=t+"(";for(var r=0;r<i._boundaries.length;r++)t=t+i._boundaries[r].longitude+" "+i._boundaries[r].latitude,t=t+", ";return t=t.substring(0,t.length-2),t=t+")",t=t+")",t},exportSurfaceCircle:function(i){if(!(i instanceof WorldWind.SurfaceCircle))throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportSurfaceCircle","invalidTypeOfRenderable"));var t=n.SupportedGeometries.POLYGON+"(";t=t+"(";for(var r=0;r<i._boundaries.length;r++)t=t+i._boundaries[r].longitude+" "+i._boundaries[r].latitude,t=t+", ";return t=t.substring(0,t.length-2),t=t+")",t=t+")",t},exportSurfaceRectangle:function(i){if(!(i instanceof WorldWind.SurfaceRectangle))throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportSurfaceRectangle","invalidTypeOfRenderable"));var t=n.SupportedGeometries.POLYGON+"(";t=t+"(";for(var r=0;r<i._boundaries.length;r++)t=t+i._boundaries[r].longitude+" "+i._boundaries[r].latitude,t=t+", ";return t=t.substring(0,t.length-2),t=t+")",t=t+")",t},exportSurfaceSector:function(i){if(!(i instanceof WorldWind.SurfaceSector))throw new p(l.logMessage(l.LEVEL_SEVERE,"WktExporter","exportSurfaceSector","invalidTypeOfRenderable"));var t=n.SupportedGeometries.POLYGON+"(";t=t+"(";for(var r=0;r<i._boundaries.length;r++)t=t+i._boundaries[r].longitude+" "+i._boundaries[r].latitude,t=t+", ";return t=t.substring(0,t.length-2),t=t+")",t=t+")",t}};return e}),B("formats/wkt/geom/WktGeometryCollection",["../../../geom/Location","../../../geom/Position","../WktElements","./WktObject","../WktType"],function(p,l,n,e,i){var t=function(){e.call(this,i.SupportedGeometries.GEOMETRY_COLLECTION),this.objects=[]};return t.prototype=Object.create(e.prototype),t.prototype.add=function(r){this.objects.push(r)},t.prototype.addCoordinates=function(r){var s=this.objects[this.objects.length-1];this._is3d?s.coordinates.push(new l(r[0],r[1],r[2]||0)):s.coordinates.push(new p(r[0],r[1]))},t.prototype.shapes=function(){var r=[];return this.objects.forEach(function(s){s.shapes().forEach(function(a){r.push(a)})}),r},n.GEOMETRYCOLLECTION=t,t}),B("formats/wkt/geom/WktLineString",["../../../shapes/Path","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolyline","../WktElements","./WktObject","../WktType"],function(p,l,n,e,i,t){var r=function(){i.call(this,t.SupportedGeometries.LINE_STRING)};return r.prototype=Object.create(i.prototype),r.prototype.shapes=function(){return this._is3d?[new p(this.coordinates,new l(null))]:[new n(this.coordinates,new l(null))]},e.LINESTRING=r,r}),B("formats/wkt/geom/WktMultiLineString",["../../../shapes/Path","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolyline","../WktElements","./WktObject","../WktType"],function(p,l,n,e,i,t){var r=function(){i.call(this,t.SupportedGeometries.MULTI_LINE_STRING),this.objectBoundaries=[]};return r.prototype=Object.create(i.prototype),r.prototype.commaWithoutCoordinates=function(){this.objectBoundaries.push(this.coordinates.slice()),this.coordinates=[]},r.prototype.shapes=function(){return this.commaWithoutCoordinates(),this._is3d?this.objectBoundaries.map((function(s){return new p(s,new l(null))}).bind(this)):this.objectBoundaries.map((function(s){return new n(s,new l(null))}).bind(this))},e.MULTILINESTRING=r,r}),B("formats/wkt/geom/WktPoint",["../../../shapes/Placemark","../../../shapes/PlacemarkAttributes","../WktElements","./WktObject","../WktType"],function(p,l,n,e,i){var t=function(){e.call(this,i.SupportedGeometries.POINT)};return t.prototype=Object.create(e.prototype),t.prototype.shapes=function(){return[t.placemark(this.coordinates[0])]},t.placemark=function(r){var s=new l(null);s.imageScale=1,s.imageOffset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.3,WorldWind.OFFSET_FRACTION,0),s.imageColor=WorldWind.Color.WHITE,s.labelAttributes.offset=new WorldWind.Offset(WorldWind.OFFSET_FRACTION,.5,WorldWind.OFFSET_FRACTION,1),s.labelAttributes.color=WorldWind.Color.YELLOW,s.drawLeaderLine=!0,s.leaderLineAttributes.outlineColor=WorldWind.Color.RED,s.imageSource=WorldWind.configuration.baseUrl+"images/pushpins/castshadow-purple.png";var a=new p(r,!0,s);return a.altitudeMode=WorldWind.RELATIVE_TO_GROUND,a},n.POINT=t,t}),B("formats/wkt/geom/WktMultiPoint",["../../../shapes/Placemark","../../../shapes/PlacemarkAttributes","../WktElements","./WktObject","./WktPoint","../WktType"],function(p,l,n,e,i,t){var r=function(){e.call(this,t.SupportedGeometries.MULTI_POINT)};return r.prototype=Object.create(e.prototype),r.prototype.commaWithoutCoordinates=function(){},r.prototype.shapes=function(){return this.coordinates.map((function(s){return i.placemark(s)}).bind(this))},n.MULTIPOINT=r,r}),B("formats/wkt/geom/WktMultiPolygon",["../../../shapes/Polygon","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolygon","../WktElements","./WktObject","../WktType"],function(p,l,n,e,i,t){var r=function(){i.call(this,t.SupportedGeometries.MULTI_POLYGON),this.objectBoundaries=[],this.currentIndex=0};return r.prototype=Object.create(i.prototype),r.prototype.rightParenthesis=function(s){i.prototype.rightParenthesis.call(this,s),s.tokens[s.tokens.length-1].type!=t.TokenType.RIGHT_PARENTHESIS?this.addBoundaries():s.tokens[s.tokens.length-1].type==t.TokenType.RIGHT_PARENTHESIS&&s.tokens[s.tokens.length-2].type!=t.TokenType.RIGHT_PARENTHESIS&&this.addObject()},r.prototype.addBoundaries=function(){this.objectBoundaries[this.currentIndex]||(this.objectBoundaries[this.currentIndex]=[]),this.objectBoundaries[this.currentIndex].push(this.coordinates.slice()),this.coordinates=[]},r.prototype.addObject=function(){this.currentIndex++},r.prototype.shapes=function(){return this._is3d?this.objectBoundaries.map((function(s){return new p(s,new l(null))}).bind(this)):this.objectBoundaries.map((function(s){return new n(s,new l(null))}).bind(this))},e.MULTIPOLYGON=r,r}),B("formats/wkt/geom/WktPolygon",["../../../shapes/Polygon","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolygon","../WktElements","./WktObject","../WktType"],function(p,l,n,e,i,t){var r=function(){i.call(this,t.SupportedGeometries.POLYGON),this._renderable=null};return r.prototype=Object.create(i.prototype),r.prototype.commaWithoutCoordinates=function(){this.outerBoundaries=this.coordinates.slice(),this.coordinates=[]},r.prototype.shapes=function(){return this._is3d?this.outerBoundaries?[new p([this.outerBoundaries,this.coordinates],new l(null))]:[new p(this.coordinates,new l(null))]:this.outerBoundaries?[new n([this.outerBoundaries,this.coordinates],new l(null))]:[new n(this.coordinates,new l(null))]},e.POLYGON=r,r}),B("formats/wkt/geom/WktTriangle",["../../../shapes/Polygon","../../../shapes/ShapeAttributes","../../../shapes/SurfacePolygon","../WktElements","./WktObject","../WktType"],function(p,l,n,e,i,t){var r=function(){i.call(this,t.SupportedGeometries.TRIANGLE),this._renderable=null};return r.prototype=Object.create(i.prototype),r.prototype.shapes=function(){return this._is3d?[new p(this.coordinates,new l(null))]:[new n(this.coordinates,new l(null))]},e.TRIANGLE=r,r}),B("layer/WmsLayer",["../error/ArgumentError","../geom/Location","../util/Logger","../util/PeriodicTimeSequence","../geom/Sector","../layer/TiledImageLayer","../util/WmsUrlBuilder"],function(p,l,n,e,i,t,r){"use strict";var s=function(a,f){if(!a)throw new p(n.logMessage(n.LEVEL_SEVERE,"WmsLayer","constructor","No configuration specified."));var o=a.service+a.layerNames+a.styleNames;f&&(o=o+f),t.call(this,a.sector,a.levelZeroDelta,a.numLevels,a.format,o,a.size,a.size),this.displayName=a.title,this.pickEnabled=!1,this.urlBuilder=new r(a.service,a.layerNames,a.styleNames,a.version,f),a.coordinateSystem&&(this.urlBuilder.crs=a.coordinateSystem),this.timeString=f};return s.prototype=Object.create(t.prototype),s.formLayerConfiguration=function(a){var f={title:a.title,version:a.capability.capsDoc.version},o=a.geographicBoundingBox||a.latLonBoundingBox;o&&o.westBoundLongitude?f.sector=new i(o.southBoundLatitude,o.northBoundLatitude,o.westBoundLongitude,o.eastBoundLongitude):o&&o.minx?f.sector=new i(o.miny,o.maxy,o.minx,o.maxx):f.sector=i.FULL_SPHERE,f.levelZeroDelta=new l(36,36),f.numLevels=19,f.size=256,f.layerNames=a.name;var c=a.capability.request.getMap,d=c.formats;d.indexOf("image/png")>=0?f.format="image/png":d.indexOf("image/jpeg")>=0?f.format="image/jpeg":d.indexOf("image/tiff")>=0?f.format="image/tiff":d.indexOf("image/gif")>=0&&(f.format="image/gif"),f.service=c.getUrl;var h=a.crses;h||(h=a.srses),h&&(h.indexOf("EPSG:4326")>=0||h.indexOf("epsg:4326")>=0?f.coordinateSystem="EPSG:4326":(h.indexOf("CRS84")>=0||h.indexOf("CRS:84")>=0)&&(f.coordinateSystem="CRS:84"));var u=s.parseTimeDimensions(a);return u&&u.length>0&&(f.timeSequences=u),f},s.parseTimeDimensions=function(a){var f=a.extents||a.dimensions,o=null;if(f){o=[];for(var c=0;c<f.length;c++){var d=f[c];if(d.name.toLowerCase()==="time"&&(!d.units||d.units.toLowerCase()==="iso8601"))for(var h=d.content.split(","),u=0;u<h.length;u++){var m=h[u],g=m.split("/");g.length===1?o.push(new Date(m)):g.length===3&&o.push(new e(m))}}}return o},s}),B("layer/WmsTimeDimensionedLayer",["../error/ArgumentError","../layer/Layer","../util/Logger","../layer/WmsLayer"],function(p,l,n,e){"use strict";var i=function(t){if(!t)throw new p(n.logMessage(n.LEVEL_SEVERE,"WmsTimeDimensionedLayer","constructor","No configuration specified."));l.call(this,"WMS Time Dimensioned Layer"),this.config=t,this.displayName=t.title,this.pickEnabled=!1,this.layers={}};return i.prototype=Object.create(l.prototype),i.prototype.doRender=function(t){if(this.time){var r=this.time.toISOString(),s=this.layers[r];s||(s=new e(this.config,r),this.layers[r]=s),s.opacity=this.opacity,s.doRender(t),this.inCurrentFrame=s.inCurrentFrame}},i}),B("WorldWindow",["./error/ArgumentError","./BasicWorldWindowController","./render/DrawContext","./globe/EarthElevationModel","./util/FrameStatistics","./geom/Frustum","./globe/Globe","./globe/Globe2D","./util/GoToAnimator","./cache/GpuResourceCache","./geom/Line","./util/Logger","./navigate/LookAtNavigator","./geom/Matrix","./pick/PickedObjectList","./geom/Position","./geom/Rectangle","./geom/Sector","./shapes/SurfaceShape","./shapes/SurfaceShapeTileBuilder","./globe/Terrain","./geom/Vec2","./geom/Vec3","./util/WWMath"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m,g,_,y,v,b,R,M,P){"use strict";var T=function(E,x){if(!window.WebGLRenderingContext)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","constructor","webglNotSupported"));var S;if(E instanceof HTMLCanvasElement)S=E;else if(S=document.getElementById(E),!S)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","constructor","The specified canvas ID is not in the document."));var L=this.createContext(S);if(!L)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","constructor","webglNotSupported"));this.drawContext=new n(L),this.eventListeners={},this.redrawRequested=!0,this.redrawRequestId=null,this.scratchModelview=h.fromIdentity(),this.scratchProjection=h.fromIdentity(),this.hasStencilBuffer=L.getContextAttributes().stencil,this.canvas=S,this.depthBits=L.getParameter(L.DEPTH_BITS),this.viewport=new g(0,0,L.drawingBufferWidth,L.drawingBufferHeight),this.globe=new r(x||new e),this.layers=[],this.navigator=new d,this.worldWindowController=new l(this),this.verticalExaggeration=1,this.deepPicking=!1,this.subsurfaceMode=!1,this.surfaceOpacity=1,this.frameStatistics=new i,this.goToAnimator=new a(this),this._redrawCallbacks=[],this._orderedRenderingFilters=[function(_t){F.declutter(_t,1)},function(_t){F.declutter(_t,2)}],this.pixelScale=1;function C(_t){_t.preventDefault()}this.addEventListener("mousedown",C),this.addEventListener("touchstart",C),this.addEventListener("contextmenu",C),this.addEventListener("wheel",C);var F=this;function q(_t){F.onGestureEvent(_t)}window.PointerEvent?(this.canvas.style.setProperty("touch-action","none"),this.addEventListener("pointerdown",q,!1),window.addEventListener("pointermove",q,!1),window.addEventListener("pointercancel",q,!1),window.addEventListener("pointerup",q,!1)):(this.addEventListener("mousedown",q,!1),window.addEventListener("mousemove",q,!1),window.addEventListener("mouseup",q,!1),this.addEventListener("touchstart",q,!1),this.addEventListener("touchmove",q,!1),this.addEventListener("touchend",q,!1),this.addEventListener("touchcancel",q,!1)),this.addEventListener("wheel",function(_t){q(_t)});function it(_t){F.handleContextLost(_t)}this.canvas.addEventListener("webglcontextlost",it,!1);function st(_t){F.handleContextRestored(_t)}this.canvas.addEventListener("webglcontextrestored",st,!1);function pt(_t){F.handleRedrawEvent(_t)}this.canvas.addEventListener(WorldWind.REDRAW_EVENT_TYPE,pt,!1),window.addEventListener(WorldWind.REDRAW_EVENT_TYPE,pt,!1),this.animationFrameLoop()};return Object.defineProperties(T.prototype,{orderedRenderingFilters:{get:function(){return this._orderedRenderingFilters}},redrawCallbacks:{get:function(){return this._redrawCallbacks}}}),T.prototype.canvasCoordinates=function(E,x){var S=this.canvas.getBoundingClientRect(),L=E-(S.left+this.canvas.clientLeft),C=x-(S.top+this.canvas.clientTop);return new R(L,C)},T.prototype.onGestureEvent=function(E){this.worldWindowController.onGestureEvent(E)},T.prototype.addEventListener=function(E,x){if(!E)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","addEventListener","missingType"));if(!x)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","addEventListener","missingListener"));var S=this,L=this.eventListeners[E];L||(L={listeners:[],callback:function(F){F.worldWindow=S;for(var q=0,it=L.listeners.length;q<it;q++)L.listeners[q](F)}},this.eventListeners[E]=L);var C=L.listeners.indexOf(x);C==-1&&(L.listeners.splice(0,0,x),L.listeners.length==1&&this.canvas.addEventListener(E,L.callback,!1))},T.prototype.removeEventListener=function(E,x){if(!E)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingType"));if(!x)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","removeEventListener","missingListener"));var S=this.eventListeners[E];if(S){var L=S.listeners.indexOf(x);L!=-1&&(S.listeners.splice(L,1),S.listeners.length==0&&this.canvas.removeEventListener(E,S.callback,!1))}},T.prototype.redraw=function(){this.redrawRequested=!0},T.prototype.pick=function(E){if(!E)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","pick","missingPoint"));return this.drawContext.currentGlContext.isContextLost()?new u:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.pickPoint=E,this.drawContext.pickRay=this.rayThroughScreenPoint(E),this.drawFrame(),this.drawContext.objectsAtPickPoint)},T.prototype.pickTerrain=function(E){if(!E)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","pickTerrain","missingPoint"));return this.drawContext.currentGlContext.isContextLost()?new u:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.pickTerrainOnly=!0,this.drawContext.pickPoint=E,this.drawContext.pickRay=this.rayThroughScreenPoint(E),this.drawFrame(),this.drawContext.objectsAtPickPoint)},T.prototype.pickShapesInRegion=function(E){if(!E)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","pickShapesInRegion","missingRectangle"));return this.drawContext.currentGlContext.isContextLost()?new u:(this.resize(),this.resetDrawContext(),this.drawContext.pickingMode=!0,this.drawContext.regionPicking=!0,this.drawContext.pickRectangle=new g(E.x,this.canvas.height-E.y,E.width,E.height),this.drawFrame(),this.drawContext.objectsAtPickPoint)},T.prototype.createContext=function(E){var x={antialias:!1,stencil:!0},S=E.getContext("webgl",x);return S||(S=E.getContext("experimental-webgl",x)),S},T.prototype.handleContextLost=function(E){c.log(c.LEVEL_INFO,"WebGL context event: "+E.statusMessage),E.preventDefault(),this.drawContext.contextLost(),window.cancelAnimationFrame(this.redrawRequestId)},T.prototype.handleContextRestored=function(E){c.log(c.LEVEL_INFO,"WebGL context event: "+E.statusMessage),this.drawContext.contextRestored(),this.redraw(),this.animationFrameLoop()},T.prototype.handleRedrawEvent=function(E){this.redraw()},T.prototype.animationFrameLoop=function(){this.redrawIfNeeded();var E=this;function x(){E.animationFrameLoop()}this.redrawRequestId=window.requestAnimationFrame(x)},T.prototype.redrawIfNeeded=function(){if(this.resize(),!!this.redrawRequested)try{this.redrawRequested=!1,this.drawContext.previousRedrawTimestamp=this.drawContext.timestamp,this.callRedrawCallbacks(WorldWind.BEFORE_REDRAW),this.resetDrawContext(),this.drawFrame()}catch(E){c.logMessage(c.LEVEL_SEVERE,"WorldWindow","redrawIfNeeded","Exception occurred during redrawing.\n"+E.toString())}finally{this.callRedrawCallbacks(WorldWind.AFTER_REDRAW),this.drawContext.redrawRequested&&(this.redrawRequested=!0)}},T.prototype.resize=function(){var E=this.drawContext.currentGlContext,x=E.canvas.clientWidth*this.pixelScale,S=E.canvas.clientHeight*this.pixelScale;(E.canvas.width!=x||E.canvas.height!=S)&&(E.canvas.width=x,E.canvas.height=S,E.viewport(0,0,E.drawingBufferWidth,E.drawingBufferHeight),this.viewport=new g(0,0,E.drawingBufferWidth,E.drawingBufferHeight),this.redrawRequested=!0)},T.prototype.computeViewingTransform=function(E,x){if(!x)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","computeViewingTransform","missingModelview"));x.setToIdentity(),this.worldWindowController.applyLimits();var S=this.globe,L=this.navigator,C=new m(L.lookAtLocation.latitude,L.lookAtLocation.longitude,0);if(x.multiplyByLookAtModelview(C,L.range,L.heading,L.tilt,L.roll,S),E){E.setToIdentity();var F=P.max(S.equatorialRadius,S.polarRadius),q=x.extractEyePoint(new M(0,0,0)),it=S.computePositionFromPoint(q[0],q[1],q[2],new m(0,0,0)),st=P.horizonDistanceForGlobeRadius(F,it.altitude),pt=P.horizonDistanceForGlobeRadius(F,16e4),_t=this.viewport,X=st+pt;X<1e3&&(X=1e3);var ot=P.perspectiveNearDistanceForFarDistance(X,10,this.depthBits),Tt=it.altitude-S.elevationAtLocation(it.latitude,it.longitude);if(Tt>0){var Vt=P.perspectiveNearDistance(_t.width,_t.height,Tt);ot>Vt&&(ot=Vt)}ot<1&&(ot=1),E.setToPerspectiveProjection(_t.width,_t.height,ot,X)}},T.prototype.computePixelMetrics=function(E){var x=h.fromIdentity();x.invertMatrix(E);var S=new M(-1,-1,-1),L=new M(1,1,-1),C=new M(-1,-1,1),F=new M(1,1,1);S.multiplyByMatrix(x),L.multiplyByMatrix(x),C.multiplyByMatrix(x),F.multiplyByMatrix(x);var q=P.fabs(L[0]-S[0]),it=P.fabs(F[0]-C[0]),st=-S[2],pt=-C[2],_t=(it-q)/(pt-st),X=q-_t*st;return{pixelSizeFactor:_t/this.viewport.width,pixelSizeOffset:X/this.viewport.height}},T.prototype.pixelSizeAtDistance=function(E){this.computeViewingTransform(this.scratchProjection,this.scratchModelview);var x=this.computePixelMetrics(this.scratchProjection);return x.pixelSizeFactor*E+x.pixelSizeOffset},T.prototype.computeDrawContext=function(){var E=this.drawContext;this.computeViewingTransform(E.projection,E.modelview),E.viewport=this.viewport,E.eyePoint=E.modelview.extractEyePoint(new M(0,0,0)),E.modelviewProjection.setToIdentity(),E.modelviewProjection.setToMultiply(E.projection,E.modelview);var x=this.computePixelMetrics(E.projection);E.pixelSizeFactor=x.pixelSizeFactor,E.pixelSizeOffset=x.pixelSizeOffset;var S=h.fromIdentity();S.invertOrthonormalMatrix(E.modelview),E.modelviewNormalTransform=h.fromIdentity().setToTransposeOfMatrix(S.upper3By3());var L=h.fromIdentity();L.setToTransposeOfMatrix(E.modelview),E.frustumInModelCoordinates=t.fromProjectionMatrix(E.projection),E.frustumInModelCoordinates.transformByMatrix(L),E.frustumInModelCoordinates.normalize()},T.prototype.resetDrawContext=function(){this.globe.offset=0;var E=this.drawContext;E.reset(),E.globe=this.globe,E.navigator=this.navigator,E.layers=this.layers.slice(),E.layers.push(E.screenCreditController),this.computeDrawContext(),E.verticalExaggeration=this.verticalExaggeration,E.surfaceOpacity=this.surfaceOpacity,E.deepPicking=this.deepPicking,E.frameStatistics=this.frameStatistics,E.pixelScale=this.pixelScale,E.update()},T.prototype.drawFrame=function(){try{this.drawContext.frameStatistics.beginFrame(),this.beginFrame(),this.drawContext.globe.is2D()&&this.drawContext.globe.continuous?this.do2DContiguousRepaint():this.doNormalRepaint()}finally{this.endFrame(),this.drawContext.frameStatistics.endFrame()}},T.prototype.doNormalRepaint=function(){this.createTerrain(),this.clearFrame(),this.deferOrderedRendering=!1,this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.doPick(),this.resolvePick()):(this.doDraw(),this.subsurfaceMode&&this.hasStencilBuffer&&(this.redrawSurface(),this.drawScreenRenderables()))},T.prototype.do2DContiguousRepaint=function(){this.createTerrain2DContiguous(),this.clearFrame(),this.drawContext.pickingMode?this.drawContext.makePickFrustum()&&(this.pick2DContiguous(),this.resolvePick()):this.draw2DContiguous()},T.prototype.resolvePick=function(){this.drawContext.pickTerrainOnly?this.resolveTerrainPick():this.drawContext.regionPicking?this.resolveRegionPick():this.resolveTopPick()},T.prototype.beginFrame=function(){var E=this.drawContext.currentGlContext;E.enable(E.BLEND),E.enable(E.CULL_FACE),E.enable(E.DEPTH_TEST),E.blendFunc(E.ONE,E.ONE_MINUS_SRC_ALPHA),E.depthFunc(E.LEQUAL),this.drawContext.pickingMode&&(this.drawContext.makePickFramebuffer(),this.drawContext.bindFramebuffer(this.drawContext.pickFramebuffer))},T.prototype.endFrame=function(){var E=this.drawContext.currentGlContext;E.disable(E.BLEND),E.disable(E.CULL_FACE),E.disable(E.DEPTH_TEST),E.blendFunc(E.ONE,E.ZERO),E.depthFunc(E.LESS),E.clearColor(0,0,0,1),this.drawContext.bindFramebuffer(null),this.drawContext.bindProgram(null)},T.prototype.clearFrame=function(){var E=this.drawContext,x=E.currentGlContext;x.clearColor(E.clearColor.red,E.clearColor.green,E.clearColor.blue,E.clearColor.alpha),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT)},T.prototype.doDraw=function(){this.drawContext.renderShapes=!0,this.subsurfaceMode&&this.hasStencilBuffer?(this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables())):(this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables()))},T.prototype.redrawSurface=function(){this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.EQUAL,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.KEEP,this.drawContext.currentGlContext.KEEP,this.drawContext.currentGlContext.KEEP),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!1),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST)},T.prototype.doPick=function(){this.drawContext.terrain&&this.drawContext.terrain.pick(this.drawContext),this.drawContext.pickTerrainOnly||(this.subsurfaceMode&&this.hasStencilBuffer?(this.drawContext.currentGlContext.disable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawContext.currentGlContext.clear(this.drawContext.currentGlContext.DEPTH_BUFFER_BIT|this.drawContext.currentGlContext.STENCIL_BUFFER_BIT),this.drawContext.currentGlContext.enable(this.drawContext.currentGlContext.STENCIL_TEST),this.drawContext.currentGlContext.stencilFunc(this.drawContext.currentGlContext.ALWAYS,1,1),this.drawContext.currentGlContext.stencilOp(this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE,this.drawContext.currentGlContext.REPLACE),this.drawOrderedRenderables(),this.drawContext.terrain.pick(this.drawContext),this.drawScreenRenderables())):(this.drawContext.surfaceShapeTileBuilder.clear(),this.drawLayers(!0),this.drawSurfaceRenderables(),this.drawContext.surfaceShapeTileBuilder.doRender(this.drawContext),this.deferOrderedRendering||(this.drawOrderedRenderables(),this.drawScreenRenderables())))},T.prototype.createTerrain=function(){var E=this.drawContext;E.terrain=this.globe.tessellator.tessellate(E),E.frameStatistics.setTerrainTileCount(E.terrain?E.terrain.surfaceGeometry.length:0)},T.prototype.makeCurrent=function(E){var x=this.drawContext;switch(x.globe.offset=E,x.globeStateKey=x.globe.stateKey,E){case-1:x.terrain=this.terrainLeft;break;case 0:x.terrain=this.terrainCenter;break;case 1:x.terrain=this.terrainRight;break}},T.prototype.createTerrain2DContiguous=function(){var E=this.drawContext;this.terrainCenter=null,E.globe.offset=0,E.globeStateKey=E.globe.stateKey,E.globe.intersectsFrustum(E.frustumInModelCoordinates)&&(this.terrainCenter=E.globe.tessellator.tessellate(E)),this.terrainRight=null,E.globe.offset=1,E.globeStateKey=E.globe.stateKey,E.globe.intersectsFrustum(E.frustumInModelCoordinates)&&(this.terrainRight=E.globe.tessellator.tessellate(E)),this.terrainLeft=null,E.globe.offset=-1,E.globeStateKey=E.globe.stateKey,E.globe.intersectsFrustum(E.frustumInModelCoordinates)&&(this.terrainLeft=E.globe.tessellator.tessellate(E))},T.prototype.draw2DContiguous=function(){var E="";this.terrainCenter&&(E+=" 0 ",this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doDraw()),this.terrainRight&&(E+=" 1 ",this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doDraw()),this.deferOrderedRendering=!1,this.terrainLeft&&(E+=" -1 ",this.makeCurrent(-1),this.doDraw()),this.subsurfaceMode&&this.hasStencilBuffer&&(this.deferOrderedRendering=!0,this.terrainCenter&&(E+=" 0 ",this.makeCurrent(0),this.redrawSurface()),this.terrainRight&&(E+=" 1 ",this.makeCurrent(1),this.redrawSurface()),this.terrainLeft&&(E+=" -1 ",this.makeCurrent(-1),this.redrawSurface())),this.drawScreenRenderables()},T.prototype.pick2DContiguous=function(){this.terrainCenter&&(this.makeCurrent(0),this.deferOrderedRendering=this.terrainLeft||this.terrainRight,this.doPick()),this.terrainRight&&(this.makeCurrent(1),this.deferOrderedRendering=this.terrainLeft||this.terrainLeft,this.doPick()),this.deferOrderedRendering=!1,this.terrainLeft&&(this.makeCurrent(-1),this.doPick())},T.prototype.drawLayers=function(E){var x=Date.now(),S=this.drawContext,L=S.layers,C;S.accumulateOrderedRenderables=E;for(var F=0,q=L.length;F<q;F++)if(C=L[F],C){S.currentLayer=C;try{C.render(S)}catch(st){c.log(c.LEVEL_SEVERE,"Error while rendering layer "+C.displayName+".\n"+st.toString())}}S.currentLayer=null;var it=Date.now();S.frameStatistics.layerRenderingTime=it-x},T.prototype.addLayer=function(E){E&&this.layers.push(E)},T.prototype.removeLayer=function(E){var x=this.indexOfLayer(E);x>=0&&this.layers.splice(x,1)},T.prototype.insertLayer=function(E,x){x&&this.layers.splice(E,0,x)},T.prototype.indexOfLayer=function(E){return this.layers.indexOf(E)},T.prototype.drawSurfaceRenderables=function(){var E=this.drawContext,x;for(E.reverseSurfaceRenderables();x=E.popSurfaceRenderable();)try{x.renderSurface(E)}catch(S){c.logMessage(c.LEVEL_WARNING,"WorldWindow","drawSurfaceRenderables","Error while rendering a surface renderable.\n"+S.message)}},T.prototype.drawOrderedRenderables=function(){var E=Date.now(),x=this.drawContext,S;if(x.sortOrderedRenderables(),this._orderedRenderingFilters)for(var L=0;L<this._orderedRenderingFilters.length;L++)this._orderedRenderingFilters[L](this.drawContext);for(x.orderedRenderingMode=!0;S=x.popOrderedRenderable();)try{S.renderOrdered(x)}catch(C){c.logMessage(c.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering an ordered renderable.\n"+C.message)}x.orderedRenderingMode=!1,x.frameStatistics.orderedRenderingTime=Date.now()-E},T.prototype.drawScreenRenderables=function(){for(var E=this.drawContext,x;x=E.nextScreenRenderable();)try{x.renderOrdered(E)}catch(S){c.logMessage(c.LEVEL_WARNING,"WorldWindow","drawOrderedRenderables","Error while rendering a screen renderable.\n"+S.message)}},T.prototype.resolveTopPick=function(){if(this.drawContext.objectsAtPickPoint.objects.length!=0){var E=this.drawContext.objectsAtPickPoint,x=this.drawContext.readPickColor(this.drawContext.pickPoint),S=null,L=null;if(x){for(var C=0,F=E.objects.length;C<F;C++){var q=E.objects[C];if(q.isTerrain&&(L=q),q.color.equals(x)&&(q.isOnTop=!0,S=q,L))break}this.drawContext.deepPicking||(E.clear(),S&&E.add(S),L&&L!=S&&E.add(L))}else E.clear()}},T.prototype.resolveTerrainPick=function(){for(var E=this.drawContext.objectsAtPickPoint,x,S=0,L=E.objects.length;S<L;S++)if(x=E.objects[S],x.isTerrain){x.isOnTop=!0;break}},T.prototype.resolveRegionPick=function(){if(this.drawContext.objectsAtPickPoint.objects.length!=0){for(var E=this.drawContext.objectsAtPickPoint,x=this.drawContext.readPickColors(this.drawContext.pickRectangle),S,L,C=0,F=E.objects.length;C<F;C++)if(S=E.objects[C],!!S){var q=S.color.toByteString();L=x[q],L?S.isOnTop=!0:S.userObject instanceof y&&(E.objects.splice(C,1),C-=1)}}},T.prototype.callRedrawCallbacks=function(E){for(var x=0,S=this._redrawCallbacks.length;x<S;x++)try{this._redrawCallbacks[x](this,E)}catch(L){c.log(c.LEVEL_SEVERE,"Exception calling redraw callback.\n"+L.toString())}},T.prototype.goTo=function(E,x){this.goToAnimator.goTo(E,x)},T.prototype.declutter=function(E,x){if(!x)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","declutter","Group ID is null, undefined or 0."));for(var S=[],L=0;L<E.orderedRenderables.length;L++){var C=E.orderedRenderables[L].orderedRenderable;C.declutterGroup===x&&S.push(C)}for(var F=[],q=0;q<S.length;q++){var it=S[q],st=it.screenBounds;st&&st.intersectsRectangles(F)?it.targetVisibility=0:(it.targetVisibility=1,st&&F.push(st))}},T.prototype.rayThroughScreenPoint=function(E){if(!E)throw new p(c.logMessage(c.LEVEL_SEVERE,"WorldWindow","rayThroughScreenPoint","missingPoint"));var x=new M(E[0],this.viewport.height-E[1],0),S=new M(0,0,0),L=new M(0,0,0);this.computeViewingTransform(this.scratchProjection,this.scratchModelview);var C=h.fromIdentity();C.setToMultiply(this.scratchProjection,this.scratchModelview);var F=h.fromIdentity();if(F.invertMatrix(C),!F.unProject(x,this.viewport,S)||(x[2]=1,!F.unProject(x,this.viewport,L)))return null;var q=this.scratchModelview.extractEyePoint(new M(0,0,0)),it=new M(q[0],q[1],q[2]),st=new M(L[0],L[1],L[2]);return st.subtract(S),st.normalize(),new o(it,st)},T}),B("util/WWMessage",[],function(){"use strict";var p=function(l,n){this.type=l,this.source=n};return p}),B("WorldWind",["./formats/aaigrid/AAIGridConstants","./formats/aaigrid/AAIGridMetadata","./formats/aaigrid/AAIGridReader","./error/AbstractError","./geom/Angle","./shapes/Annotation","./shapes/AnnotationAttributes","./util/measure/AreaMeasurer","./error/ArgumentError","./globe/AsterV2ElevationCoverage","./layer/AtmosphereLayer","./shaders/AtmosphereProgram","./shaders/BasicProgram","./shaders/BasicTextureProgram","./util/BasicTimeSequence","./BasicWorldWindowController","./layer/BingAerialLayer","./layer/BingAerialWithLabelsLayer","./layer/BingRoadsLayer","./layer/BingWMSLayer","./layer/BMNGLandsatLayer","./layer/BMNGLayer","./layer/BMNGOneImageLayer","./layer/BMNGRestLayer","./geom/BoundingBox","./gesture/ClickRecognizer","./formats/collada/ColladaLoader","./util/Color","./shapes/Compass","./layer/CompassLayer","./layer/CoordinatesDisplayLayer","./util/Date","./layer/DigitalGlobeTiledImageLayer","./gesture/DragRecognizer","./render/DrawContext","./globe/EarthElevationModel","./globe/EarthRestElevationCoverage","./globe/ElevationCoverage","./globe/ElevationModel","./util/Font","./util/FrameStatistics","./layer/FrameStatisticsLayer","./render/FramebufferTexture","./render/FramebufferTile","./render/FramebufferTileController","./geom/Frustum","./globe/GebcoElevationCoverage","./shapes/GeographicMesh","./projections/GeographicProjection","./shapes/GeographicText","./formats/geojson/GeoJSONExporter","./formats/geojson/GeoJSONGeometry","./formats/geojson/GeoJSONGeometryCollection","./formats/geojson/GeoJSONGeometryLineString","./formats/geojson/GeoJSONGeometryMultiLineString","./formats/geojson/GeoJSONGeometryMultiPoint","./formats/geojson/GeoJSONGeometryMultiPolygon","./formats/geojson/GeoJSONGeometryPoint","./formats/geojson/GeoJSONGeometryPolygon","./formats/geojson/GeoJSONParser","./formats/geotiff/GeoTiffReader","./gesture/GestureRecognizer","./globe/Globe","./globe/Globe2D","./util/GoToAnimator","./shaders/GpuProgram","./cache/GpuResourceCache","./shaders/GpuShader","./shaders/GroundProgram","./util/HashMap","./layer/heatmap/HeatMapColoredTile","./layer/heatmap/HeatMapIntervalType","./layer/heatmap/HeatMapLayer","./layer/heatmap/HeatMapTile","./util/HighlightController","./util/ImageSource","./render/ImageTile","./util/Insets","./formats/kml/KmlAbstractView","./formats/kml/util/KmlAttribute","./formats/kml/styles/KmlBalloonStyle","./formats/kml/KmlCamera","./formats/kml/util/KmlChange","./formats/kml/styles/KmlColorStyle","./formats/kml/features/KmlContainer","./formats/kml/controls/KmlControls","./formats/kml/util/KmlCreate","./formats/kml/util/KmlDelete","./formats/kml/features/KmlDocument","./formats/kml/KmlElements","./formats/kml/util/KmlElementsFactory","./formats/kml/util/KmlElementsFactoryCached","./formats/kml/features/KmlFeature","./formats/kml/KmlFile","./formats/kml/KmlFileCache","./formats/kml/features/KmlFolder","./formats/kml/geom/KmlGeometry","./formats/kml/features/KmlGroundOverlay","./formats/kml/util/KmlHrefResolver","./formats/kml/KmlIcon","./formats/kml/styles/KmlIconStyle","./formats/kml/util/KmlImagePyramid","./formats/kml/util/KmlItemIcon","./formats/kml/styles/KmlLabelStyle","./formats/kml/KmlLatLonAltBox","./formats/kml/KmlLatLonBox","./formats/kml/KmlLatLonQuad","./formats/kml/geom/KmlLinearRing","./formats/kml/geom/KmlLineString","./formats/kml/styles/KmlLineStyle","./formats/kml/KmlLink","./formats/kml/styles/KmlListStyle","./formats/kml/KmlLocation","./formats/kml/KmlLod","./formats/kml/KmlLookAt","./formats/kml/geom/KmlMultiGeometry","./formats/kml/geom/KmlMultiTrack","./formats/kml/features/KmlNetworkLink","./formats/kml/util/KmlNetworkLinkControl","./formats/kml/util/KmlNodeTransformers","./formats/kml/KmlObject","./formats/kml/KmlOrientation","./formats/kml/features/KmlOverlay","./formats/kml/util/KmlPair","./formats/kml/features/KmlPhotoOverlay","./formats/kml/features/KmlPlacemark","./formats/kml/geom/KmlPoint","./formats/kml/geom/KmlPolygon","./formats/kml/styles/KmlPolyStyle","./formats/kml/util/KmlRefreshListener","./formats/kml/KmlRegion","./formats/kml/util/KmlRemoteFile","./formats/kml/util/KmlScale","./formats/kml/util/KmlSchema","./formats/kml/features/KmlScreenOverlay","./formats/kml/styles/KmlStyle","./formats/kml/styles/KmlStyleMap","./formats/kml/util/KmlStyleResolver","./formats/kml/styles/KmlStyleSelector","./formats/kml/styles/KmlSubStyle","./formats/kml/KmlTimePrimitive","./formats/kml/KmlTimeSpan","./formats/kml/KmlTimeStamp","./formats/kml/features/KmlTour","./formats/kml/geom/KmlTrack","./formats/kml/util/KmlTreeKeyValueCache","./formats/kml/controls/KmlTreeVisibility","./formats/kml/util/KmlUpdate","./formats/kml/util/KmlViewVolume","./formats/kml/KmzFile","./layer/LandsatRestLayer","./layer/Layer","./util/measure/LengthMeasurer","./util/Level","./util/LevelRowColumnUrlBuilder","./util/LevelSet","./geom/Line","./geom/Location","./util/Logger","./navigate/LookAtNavigator","./geom/Matrix","./geom/MeasuredLocation","./util/measure/MeasurerUtils","./cache/MemoryCache","./cache/MemoryCacheListener","./layer/MercatorTiledImageLayer","./navigate/Navigator","./util/NominatimGeocoder","./error/NotYetImplementedError","./util/Offset","./layer/OpenStreetMapImageLayer","./gesture/PanRecognizer","./shapes/Path","./util/PeriodicTimeSequence","./pick/PickedObject","./pick/PickedObjectList","./gesture/PinchRecognizer","./shapes/Placemark","./shapes/PlacemarkAttributes","./geom/Plane","./shapes/Polygon","./util/PolygonSplitter","./geom/Position","./projections/ProjectionEquirectangular","./projections/ProjectionGnomonic","./projections/ProjectionMercator","./projections/ProjectionPolarEquidistant","./projections/ProjectionUPS","./projections/ProjectionWgs84","./geom/Rectangle","./render/Renderable","./layer/RenderableLayer","./layer/RestTiledImageLayer","./gesture/RotationRecognizer","./shapes/ScreenImage","./shapes/ScreenText","./geom/Sector","./shapes/ShapeAttributes","./formats/shapefile/Shapefile","./layer/ShowTessellationLayer","./shaders/SkyProgram","./layer/StarFieldLayer","./shaders/StarFieldProgram","./util/SunPosition","./shapes/SurfaceImage","./shapes/SurfaceCircle","./shapes/SurfaceEllipse","./shapes/SurfacePolygon","./shapes/SurfacePolyline","./shapes/SurfaceRectangle","./render/SurfaceRenderable","./shapes/SurfaceSector","./shapes/SurfaceShape","./shapes/SurfaceShapeTile","./shapes/SurfaceShapeTileBuilder","./render/SurfaceTile","./render/SurfaceTileRenderer","./shaders/SurfaceTileRendererProgram","./gesture/TapRecognizer","./layer/TectonicPlatesLayer","./globe/Terrain","./globe/TerrainTile","./globe/TerrainTileList","./globe/Tessellator","./shapes/Text","./shapes/TextAttributes","./render/TextRenderer","./render/Texture","./render/TextureTile","./util/Tile","./globe/TiledElevationCoverage","./layer/TiledImageLayer","./util/TileFactory","./gesture/TiltRecognizer","./gesture/Touch","./shapes/TriangleMesh","./error/UnsupportedOperationError","./globe/UsgsNedElevationCoverage","./globe/UsgsNedHiElevationCoverage","./util/UrlBuilder","./geom/Vec2","./geom/Vec3","./layer/ViewControlsLayer","./ogc/wcs/WcsCapabilities","./ogc/wcs/WcsCoverage","./ogc/wcs/WcsCoverageDescriptions","./globe/WcsEarthElevationCoverage","./util/WcsTileUrlBuilder","./ogc/wcs/WebCoverageService","./ogc/WfsCapabilities","./formats/wkt/Wkt","./formats/wkt/WktElements","./formats/wkt/WktExporter","./formats/wkt/geom/WktGeometryCollection","./formats/wkt/geom/WktLineString","./formats/wkt/geom/WktMultiLineString","./formats/wkt/geom/WktMultiPoint","./formats/wkt/geom/WktMultiPolygon","./formats/wkt/geom/WktObject","./formats/wkt/geom/WktPoint","./formats/wkt/geom/WktPolygon","./formats/wkt/WktTokens","./formats/wkt/geom/WktTriangle","./formats/wkt/WktType","./ogc/wms/WmsCapabilities","./layer/WmsLayer","./ogc/wms/WmsLayerCapabilities","./layer/WmsTimeDimensionedLayer","./util/WmsUrlBuilder","./ogc/wmts/WmtsCapabilities","./layer/WmtsLayer","./ogc/wmts/WmtsLayerCapabilities","./WorldWindow","./WorldWindowController","./util/WWMath","./util/WWMessage","./util/WWUtil","./util/XmlDocument"],function(p,l,n,e,i,t,r,s,a,f,o,c,d,h,u,m,g,_,y,v,b,R,M,P,T,E,x,S,L,C,F,q,it,st,pt,_t,X,ot,Tt,Vt,Gt,qt,Qt,ne,j,J,at,xt,Rt,Lt,te,zt,ee,$,N,K,k,Y,ht,wt,Et,Mt,Dt,At,Xt,ie,le,W,ct,z,nt,Ht,Kt,fe,Ft,he,Bt,$t,Ue,Ee,pe,Ie,Qe,Oe,$e,Fe,ii,ni,_i,Ge,Je,ze,ri,je,He,li,ai,si,yi,gi,ki,vi,et,Z,O,I,V,H,G,Q,tt,ut,dt,Pt,bt,Ct,kt,Ot,Wt,Ut,Nt,Yt,Zt,se,oe,ue,ce,ge,_e,Pe,Se,We,Ve,me,Le,de,ke,Ne,Re,xe,Me,Te,hi,Ze,ci,Ri,Mi,ir,or,lr,hr,ur,qi,fr,cr,dr,pr,mr,Zi,gr,_r,yr,vr,Er,Qi,wr,br,Tr,Sr,Ji,xr,Rr,Mr,Pr,Cr,Lr,Ar,Or,Ir,Nr,Dr,kr,Fr,Vr,Gr,Wr,Br,Ur,Kr,zr,jr,qr,Yr,Hr,Xr,$r,di,Fi,Vi,Gi,Wi,Ai,Oi,Yi,Zr,Qr,Jr,tn,en,Ti,rn,nn,sn,an,on,ln,hn,un,fn,cn,dn,pn,mn,gn,_n,yn,vn,Si,En,wn,bn,Tn,Sn,xn,Rn,Mn,Pn,Cn,Ln,An,On,In,Nn,Dn,kn,Fn,Vn,Gn,Wn,Bn,rr,Un,Kn,zn,jn,qn,Yn,Hn,Xn,$n,Zn,Qn,Jn,ts,es,is,rs,ns,ss,as,os,ls,hs,us,fs,cs,tr,As){"use strict";var St={VERSION:"0.9.0",ABSOLUTE:"absolute",AFTER_REDRAW:"afterRedraw",BEFORE_REDRAW:"beforeRedraw",BEGAN:"began",CANCELLED:"cancelled",CHANGED:"changed",CLAMP_TO_GROUND:"clampToGround",EARTH_RADIUS:6371e3,EAST:"east",ENDED:"ended",FAILED:"failed",FILTER_LINEAR:"filter_linear",FILTER_NEAREST:"filter_nearest",GREAT_CIRCLE:"greatCircle",LINEAR:"linear",MULTI_POINT:"multiPoint",NORTH:"north",NULL:"null",OFFSET_FRACTION:"fraction",OFFSET_INSET_PIXELS:"insetPixels",OFFSET_PIXELS:"pixels",POINT:"point",POLYLINE:"polyline",POLYGON:"polygon",POSSIBLE:"possible",RECOGNIZED:"recognized",REDRAW_EVENT_TYPE:"WorldWindRedraw",RELATIVE_TO_GLOBE:"relativeToGlobe",RELATIVE_TO_GROUND:"relativeToGround",RELATIVE_TO_SCREEN:"relativeToScreen",RHUMB_LINE:"rhumbLine",SOUTH:"south",WEST:"west",WGS84_SEMI_MAJOR_AXIS:6378137,WGS84_INVERSE_FLATTENING:298.257223563};return St.AAIGridConstants=p,St.AAIGridMetadata=l,St.AAIGridReader=n,St.AbstractError=e,St.Angle=i,St.Annotation=t,St.AnnotationAttributes=r,St.AreaMeasurer=s,St.ArgumentError=a,St.AsterV2ElevationCoverage=f,St.AtmosphereLayer=o,St.AtmosphereProgram=c,St.BasicProgram=d,St.BasicTextureProgram=h,St.BasicTimeSequence=u,St.BasicWorldWindowController=m,St.BingAerialLayer=g,St.BingAerialWithLabelsLayer=_,St.BingRoadsLayer=y,St.BingWMSLayer=v,St.BMNGLandsatLayer=b,St.BMNGLayer=R,St.BMNGOneImageLayer=M,St.BMNGRestLayer=P,St.BoundingBox=T,St.ClickRecognizer=E,St.ColladaLoader=x,St.Color=S,St.Compass=L,St.CompassLayer=C,St.CoordinatesDisplayLayer=F,St.DateWW=q,St.DigitalGlobeTiledImageLayer=it,St.DragRecognizer=st,St.DrawContext=pt,St.EarthElevationModel=_t,St.EarthRestElevationCoverage=X,St.ElevationCoverage=ot,St.ElevationModel=Tt,St.Font=Vt,St.FrameStatistics=Gt,St.FrameStatisticsLayer=qt,St.FramebufferTexture=Qt,St.FramebufferTile=ne,St.FramebufferTileController=j,St.Frustum=J,St.GebcoElevationCoverage=at,St.GeographicMesh=xt,St.GeographicProjection=Rt,St.GeographicText=Lt,St.GeoJSONExporter=te,St.GeoJSONGeometry=zt,St.GeoJSONGeometryCollection=ee,St.GeoJSONGeometryLineString=$,St.GeoJSONGeometryMultiLineString=N,St.GeoJSONGeometryMultiPoint=K,St.GeoJSONGeometryMultiPolygon=k,St.GeoJSONGeometryPoint=Y,St.GeoJSONGeometryPolygon=ht,St.GeoJSONParser=wt,St.GeoTiffReader=Et,St.GestureRecognizer=Mt,St.Globe=Dt,St.Globe2D=At,St.GoToAnimator=Xt,St.GpuProgram=ie,St.GpuResourceCache=le,St.GpuShader=W,St.GroundProgram=ct,St.HashMap=z,St.HeatMapColoredTile=nt,St.HeatMapIntervalType=Ht,St.HeatMapLayer=Kt,St.HeatMapTile=fe,St.HighlightController=Ft,St.ImageSource=he,St.ImageTile=Bt,St.Insets=$t,St.KmlAbstractView=Ue,St.KmlAttribute=Ee,St.KmlBalloonStyle=pe,St.KmlCamera=Ie,St.KmlChange=Qe,St.KmlColorStyle=Oe,St.KmlContainer=$e,St.KmlControls=Fe,St.KmlCreate=ii,St.KmlDelete=ni,St.KmlDocument=_i,St.KmlElements=Ge,St.KmlElementsFactory=Je,St.KmlElementsFactoryCached=ze,St.KmlFeature=ri,St.KmlFile=je,St.KmlFileCache=He,St.KmlFolder=li,St.KmlGeometry=ai,St.KmlGroundOverlay=si,St.KmlHrefResolver=yi,St.KmlIcon=gi,St.KmlIconStyle=ki,St.KmlImagePyramid=vi,St.KmlItemIcon=et,St.KmlLabelStyle=Z,St.KmlLatLonAltBox=O,St.KmlLatLonBox=I,St.KmlLatLonQuad=V,St.KmlLinearRing=H,St.KmlLineString=G,St.KmlLineStyle=Q,St.KmlListStyle=ut,St.KmlLink=tt,St.KmlLocation=dt,St.KmlLod=Pt,St.KmlLookAt=bt,St.KmlMultiGeometry=Ct,St.KmlMultiTrack=kt,St.KmlNetworkLink=Ot,St.KmlNetworkLinkControl=Wt,St.KmlNodeTransformers=Ut,St.KmlObject=Nt,St.KmlOrientation=Yt,St.KmlOverlay=Zt,St.KmlPair=se,St.KmlPhotoOverlay=oe,St.KmlPlacemark=ue,St.KmlPoint=ce,St.KmlPolygon=ge,St.KmlPolyStyle=_e,St.KmlRefreshListener=Pe,St.KmlRegion=Se,St.KmlRemoteFile=We,St.KmlScale=Ve,St.KmlSchema=me,St.KmlScreenOverlay=Le,St.KmlStyle=de,St.KmlStyleMap=ke,St.KmlStyleResolver=Ne,St.KmlStyleSelector=Re,St.KmlSubStyle=xe,St.KmlTimePrimitive=Me,St.KmlTimeSpan=Te,St.KmlTimeStamp=hi,St.KmlTour=Ze,St.KmlTrack=ci,St.KmlTreeKeyValueCache=Ri,St.KmlTreeVisibility=Mi,St.KmlUpdate=ir,St.KmlViewVolume=or,St.KmzFile=lr,St.LandsatRestLayer=hr,St.Layer=ur,St.LengthMeasurer=qi,St.Level=fr,St.LevelRowColumnUrlBuilder=cr,St.LevelSet=dr,St.Line=pr,St.Location=mr,St.Logger=Zi,St.LookAtNavigator=gr,St.Matrix=_r,St.MeasuredLocation=yr,St.MeasurerUtils=vr,St.MemoryCache=Er,St.MemoryCacheListener=Qi,St.MercatorTiledImageLayer=wr,St.Navigator=br,St.NominatimGeocoder=Tr,St.NotYetImplementedError=Sr,St.Offset=Ji,St.OpenStreetMapImageLayer=xr,St.PanRecognizer=Rr,St.Path=Mr,St.PeriodicTimeSequence=Pr,St.PickedObject=Cr,St.PickedObjectList=Lr,St.PinchRecognizer=Ar,St.Placemark=Or,St.PlacemarkAttributes=Ir,St.Plane=Nr,St.Polygon=Dr,St.PolygonSplitter=kr,St.Position=Fr,St.ProjectionEquirectangular=Vr,St.ProjectionGnomonic=Gr,St.ProjectionMercator=Wr,St.ProjectionPolarEquidistant=Br,St.ProjectionUPS=Ur,St.ProjectionWgs84=Kr,St.Rectangle=zr,St.Renderable=jr,St.RenderableLayer=qr,St.RestTiledImageLayer=Yr,St.RotationRecognizer=Hr,St.ScreenText=$r,St.ScreenImage=Xr,St.Sector=di,St.ShapeAttributes=Fi,St.Shapefile=Vi,St.ShowTessellationLayer=Gi,St.SkyProgram=Wi,St.StarFieldLayer=Ai,St.StarFieldProgram=Oi,St.SunPosition=Yi,St.SurfaceImage=Zr,St.SurfaceCircle=Qr,St.SurfaceEllipse=Jr,St.SurfacePolygon=tn,St.SurfacePolyline=en,St.SurfaceRectangle=Ti,St.SurfaceRenderable=rn,St.SurfaceSector=nn,St.SurfaceShape=sn,St.SurfaceShapeTile=an,St.SurfaceShapeTileBuilder=on,St.SurfaceTile=ln,St.SurfaceTileRenderer=hn,St.SurfaceTileRendererProgram=un,St.TapRecognizer=fn,St.TectonicPlatesLayer=cn,St.Terrain=dn,St.TerrainTile=pn,St.TerrainTileList=mn,St.Tessellator=gn,St.Text=_n,St.TextAttributes=yn,St.TextRenderer=vn,St.Texture=Si,St.TextureTile=En,St.Tile=wn,St.TiledElevationCoverage=bn,St.TiledImageLayer=Tn,St.TileFactory=Sn,St.TiltRecognizer=xn,St.Touch=Rn,St.TriangleMesh=Mn,St.UsgsNedElevationCoverage=Pn,St.UsgsNedHiElevationCoverage=Cn,St.UnsupportedOperationError=Ln,St.UrlBuilder=An,St.Vec2=On,St.Vec3=In,St.ViewControlsLayer=Nn,St.WcsCapabilities=Dn,St.WcsCoverage=kn,St.WcsCoverageDescriptions=Fn,St.WcsEarthElevationCoverage=Vn,St.WcsTileUrlBuilder=Gn,St.WebCoverageService=Wn,St.WfsCapabilities=Bn,St.Wkt=rr,St.WktElements=Un,St.WktExporter=Kn,St.WktGeometryCollection=zn,St.WktLineString=jn,St.WktMultiLineString=qn,St.WktMultiPoint=Yn,St.WktMultiPolygon=Hn,St.WktObject=Xn,St.WktPoint=$n,St.WktPolygon=Zn,St.WktTokens=Qn,St.WktTriangle=Jn,St.WktType=ts,St.WmsCapabilities=es,St.WmsLayer=is,St.WmsLayerCapabilities=rs,St.WmsTimeDimensionedLayer=ns,St.WmsUrlBuilder=ss,St.WmtsCapabilities=as,St.WmtsLayer=os,St.WmtsLayerCapabilities=ls,St.WWMath=fs,St.WWMessage=cs,St.WWUtil=tr,St.WorldWindow=hs,St.WorldWindowController=us,St.configuration={gpuCacheSize:25e7,baseUrl:tr.worldwindlibLocation()||tr.currentUrlSansFilePart()+"/../",layerRetrievalQueueSize:16,coverageRetrievalQueueSize:16,bingLogoPlacement:new Ji(St.OFFSET_INSET_PIXELS,7,St.OFFSET_PIXELS,7),bingLogoAlignment:new Ji(St.OFFSET_FRACTION,1,St.OFFSET_FRACTION,0)},St.BingMapsKey=null,window.WorldWind=St,St}),vt("WorldWind")})});var xs=Ii((Ss,oa)=>{(function(rt,vt){typeof define=="function"&&define.amd?define(vt):typeof Ss=="object"?oa.exports=vt():rt.ScrollMagic=vt()})(Ss,function(){"use strict";var rt=function(){p.log(2,"(COMPATIBILITY NOTICE) -> As of ScrollMagic 2.0.0 you need to use 'new ScrollMagic.Controller()' to create a new controller instance. Use 'new ScrollMagic.Scene()' to instance a scene.")};rt.version="2.0.6",window.addEventListener("mousewheel",function(){});var vt="data-scrollmagic-pin-spacer";rt.Controller=function(l){var n="ScrollMagic.Controller",e="FORWARD",i="REVERSE",t="PAUSED",r=B.defaults,s=this,a=p.extend({},r,l),f=[],o=!1,c=0,d=t,h=!0,u=0,m=!0,g,_,y=function(){for(var C in a)r.hasOwnProperty(C)||(S(2,'WARNING: Unknown option "'+C+'"'),delete a[C]);if(a.container=p.get.elements(a.container)[0],!a.container)throw S(1,"ERROR creating object "+n+": No valid scroll container supplied"),n+" init failed.";h=a.container===window||a.container===document.body||!document.body.contains(a.container),h&&(a.container=window),u=R(),a.container.addEventListener("resize",E),a.container.addEventListener("scroll",E);var F=parseInt(a.refreshInterval,10);a.refreshInterval=p.type.Number(F)?F:r.refreshInterval,v(),S(3,"added new "+n+" controller (v"+rt.version+")")},v=function(){a.refreshInterval>0&&(_=window.setTimeout(x,a.refreshInterval))},b=function(){return a.vertical?p.get.scrollTop(a.container):p.get.scrollLeft(a.container)},R=function(){return a.vertical?p.get.height(a.container):p.get.width(a.container)},M=this._setScrollPos=function(C){a.vertical?h?window.scrollTo(p.get.scrollLeft(),C):a.container.scrollTop=C:h?window.scrollTo(C,p.get.scrollTop()):a.container.scrollLeft=C},P=function(){if(m&&o){var C=p.type.Array(o)?o:f.slice(0);o=!1;var F=c;c=s.scrollPos();var q=c-F;q!==0&&(d=q>0?e:i),d===i&&C.reverse(),C.forEach(function(it,st){S(3,"updating Scene "+(st+1)+"/"+C.length+" ("+f.length+" total)"),it.update(!0)}),C.length===0&&a.loglevel>=3&&S(3,"updating 0 Scenes (nothing added to controller)")}},T=function(){g=p.rAF(P)},E=function(C){S(3,"event fired causing an update:",C.type),C.type=="resize"&&(u=R(),d=t),o!==!0&&(o=!0,T())},x=function(){if(!h&&u!=R()){var C;try{C=new Event("resize",{bubbles:!1,cancelable:!1})}catch(F){C=document.createEvent("Event"),C.initEvent("resize",!1,!1)}a.container.dispatchEvent(C)}f.forEach(function(F,q){F.refresh()}),v()},S=this._log=function(C,F){a.loglevel>=C&&(Array.prototype.splice.call(arguments,1,0,"("+n+") ->"),p.log.apply(window,arguments))};this._options=a;var L=function(C){if(C.length<=1)return C;var F=C.slice(0);return F.sort(function(q,it){return q.scrollOffset()>it.scrollOffset()?1:-1}),F};return this.addScene=function(C){if(p.type.Array(C))C.forEach(function(q,it){s.addScene(q)});else if(C instanceof rt.Scene){if(C.controller()!==s)C.addTo(s);else if(f.indexOf(C)<0){f.push(C),f=L(f),C.on("shift.controller_sort",function(){f=L(f)});for(var F in a.globalSceneOptions)C[F]&&C[F].call(C,a.globalSceneOptions[F]);S(3,"adding Scene (now "+f.length+" total)")}}else S(1,"ERROR: invalid argument supplied for '.addScene()'");return s},this.removeScene=function(C){if(p.type.Array(C))C.forEach(function(q,it){s.removeScene(q)});else{var F=f.indexOf(C);F>-1&&(C.off("shift.controller_sort"),f.splice(F,1),S(3,"removing Scene (now "+f.length+" left)"),C.remove())}return s},this.updateScene=function(C,F){return p.type.Array(C)?C.forEach(function(q,it){s.updateScene(q,F)}):F?C.update(!0):o!==!0&&C instanceof rt.Scene&&(o=o||[],o.indexOf(C)==-1&&o.push(C),o=L(o),T()),s},this.update=function(C){return E({type:"resize"}),C&&P(),s},this.scrollTo=function(C,F){if(p.type.Number(C))M.call(a.container,C,F);else if(C instanceof rt.Scene)C.controller()===s?s.scrollTo(C.scrollOffset(),F):S(2,"scrollTo(): The supplied scene does not belong to this controller. Scroll cancelled.",C);else if(p.type.Function(C))M=C;else{var q=p.get.elements(C)[0];if(q){for(;q.parentNode.hasAttribute(vt);)q=q.parentNode;var it=a.vertical?"top":"left",st=p.get.offset(a.container),pt=p.get.offset(q);h||(st[it]-=s.scrollPos()),s.scrollTo(pt[it]-st[it],F)}else S(2,"scrollTo(): The supplied argument is invalid. Scroll cancelled.",C)}return s},this.scrollPos=function(C){if(arguments.length)p.type.Function(C)?b=C:S(2,"Provided value for method 'scrollPos' is not a function. To change the current scroll position use 'scrollTo()'.");else return b.call(s);return s},this.info=function(C){var F={size:u,vertical:a.vertical,scrollPos:c,scrollDirection:d,container:a.container,isDocument:h};if(arguments.length){if(F[C]!==void 0)return F[C];S(1,'ERROR: option "'+C+'" is not available');return}else return F},this.loglevel=function(C){if(arguments.length)a.loglevel!=C&&(a.loglevel=C);else return a.loglevel;return s},this.enabled=function(C){if(arguments.length)m!=C&&(m=!!C,s.updateScene(f,!0));else return m;return s},this.destroy=function(C){window.clearTimeout(_);for(var F=f.length;F--;)f[F].destroy(C);return a.container.removeEventListener("resize",E),a.container.removeEventListener("scroll",E),p.cAF(g),S(3,"destroyed "+n+" (reset: "+(C?"true":"false")+")"),null},y(),s};var B={defaults:{container:window,vertical:!0,globalSceneOptions:{},loglevel:2,refreshInterval:100}};rt.Controller.addOption=function(l,n){B.defaults[l]=n},rt.Controller.extend=function(l){var n=this;rt.Controller=function(){return n.apply(this,arguments),this.$super=p.extend({},this),l.apply(this,arguments)||this},p.extend(rt.Controller,n),rt.Controller.prototype=n.prototype,rt.Controller.prototype.constructor=rt.Controller},rt.Scene=function(l){var n="ScrollMagic.Scene",e="BEFORE",i="DURING",t="AFTER",r=D.defaults,s=this,a=p.extend({},r,l),f=e,o=0,c={start:0,end:0},d=0,h=!0,u,m,g=function(){for(var X in a)r.hasOwnProperty(X)||(y(2,'WARNING: Unknown option "'+X+'"'),delete a[X]);for(var ot in r)x(ot);T()},_={};this.on=function(X,ot){return p.type.Function(ot)?(X=X.trim().split(" "),X.forEach(function(Tt){var Vt=Tt.split("."),Gt=Vt[0],qt=Vt[1];Gt!="*"&&(_[Gt]||(_[Gt]=[]),_[Gt].push({namespace:qt||"",callback:ot}))})):y(1,"ERROR when calling '.on()': Supplied callback for '"+X+"' is not a valid function!"),s},this.off=function(X,ot){return X?(X=X.trim().split(" "),X.forEach(function(Tt,Vt){var Gt=Tt.split("."),qt=Gt[0],Qt=Gt[1]||"",ne=qt==="*"?Object.keys(_):[qt];ne.forEach(function(j){for(var J=_[j]||[],at=J.length;at--;){var xt=J[at];xt&&(Qt===xt.namespace||Qt==="*")&&(!ot||ot==xt.callback)&&J.splice(at,1)}J.length||delete _[j]})}),s):(y(1,"ERROR: Invalid event name supplied."),s)},this.trigger=function(X,ot){if(X){var Tt=X.trim().split("."),Vt=Tt[0],Gt=Tt[1],qt=_[Vt];y(3,"event fired:",Vt,ot?"->":"",ot||""),qt&&qt.forEach(function(Qt,ne){(!Gt||Gt===Qt.namespace)&&Qt.callback.call(s,new rt.Event(Vt,Qt.namespace,s,ot))})}else y(1,"ERROR: Invalid event name supplied.");return s},s.on("change.internal",function(X){X.what!=="loglevel"&&X.what!=="tweenChanges"&&(X.what==="triggerElement"?R():X.what==="reverse"&&s.update())}).on("shift.internal",function(X){v(),s.update()});var y=this._log=function(X,ot){a.loglevel>=X&&(Array.prototype.splice.call(arguments,1,0,"("+n+") ->"),p.log.apply(window,arguments))};this.addTo=function(X){return X instanceof rt.Controller?m!=X&&(m&&m.removeScene(s),m=X,T(),b(!0),R(!0),v(),m.info("container").addEventListener("resize",M),X.addScene(s),s.trigger("add",{controller:m}),y(3,"added "+n+" to controller"),s.update()):y(1,"ERROR: supplied argument of 'addTo()' is not a valid ScrollMagic Controller"),s},this.enabled=function(X){if(arguments.length)h!=X&&(h=!!X,s.update(!0));else return h;return s},this.remove=function(){if(m){m.info("container").removeEventListener("resize",M);var X=m;m=void 0,X.removeScene(s),s.trigger("remove"),y(3,"removed "+n+" from controller")}return s},this.destroy=function(X){return s.trigger("destroy",{reset:X}),s.remove(),s.off("*.*"),y(3,"destroyed "+n+" (reset: "+(X?"true":"false")+")"),null},this.update=function(X){if(m)if(X)if(m.enabled()&&h){var ot=m.info("scrollPos"),Tt;a.duration>0?Tt=(ot-c.start)/(c.end-c.start):Tt=ot>=c.start?1:0,s.trigger("update",{startPos:c.start,endPos:c.end,scrollPos:ot}),s.progress(Tt)}else S&&f===i&&C(!0);else m.updateScene(s,!1);return s},this.refresh=function(){return b(),R(),s},this.progress=function(X){if(arguments.length){var ot=!1,Tt=f,Vt=m?m.info("scrollDirection"):"PAUSED",Gt=a.reverse||X>=o;if(a.duration===0?(ot=o!=X,o=X<1&&Gt?0:1,f=o===0?e:i):X<0&&f!==e&&Gt?(o=0,f=e,ot=!0):X>=0&&X<1&&Gt?(o=X,f=i,ot=!0):X>=1&&f!==t?(o=1,f=t,ot=!0):f===i&&!Gt&&C(),ot){var qt={progress:o,state:f,scrollDirection:Vt},Qt=f!=Tt,ne=function(j){s.trigger(j,qt)};Qt&&Tt!==i&&(ne("enter"),ne(Tt===e?"start":"end")),ne("progress"),Qt&&f!==i&&(ne(f===e?"start":"end"),ne("leave"))}return s}else return o};var v=function(){c={start:d+a.offset},m&&a.triggerElement&&(c.start-=m.info("size")*a.triggerHook),c.end=c.start+a.duration},b=function(X){if(u){var ot="duration";E(ot,u.call(s))&&!X&&(s.trigger("change",{what:ot,newval:a[ot]}),s.trigger("shift",{reason:ot}))}},R=function(X){var ot=0,Tt=a.triggerElement;if(m&&(Tt||d>0)){if(Tt)if(Tt.parentNode){for(var Vt=m.info(),Gt=p.get.offset(Vt.container),qt=Vt.vertical?"top":"left";Tt.parentNode.hasAttribute(vt);)Tt=Tt.parentNode;var Qt=p.get.offset(Tt);Vt.isDocument||(Gt[qt]-=m.scrollPos()),ot=Qt[qt]-Gt[qt]}else y(2,"WARNING: triggerElement was removed from DOM and will be reset to",void 0),s.triggerElement(void 0);var ne=ot!=d;d=ot,ne&&!X&&s.trigger("shift",{reason:"triggerElementPosition"})}},M=function(X){a.triggerHook>0&&s.trigger("shift",{reason:"containerResize"})},P=p.extend(D.validate,{duration:function(X){if(p.type.String(X)&&X.match(/^(\.|\d)*\d+%$/)){var ot=parseFloat(X)/100;X=function(){return m?m.info("size")*ot:0}}if(p.type.Function(X)){u=X;try{X=parseFloat(u())}catch(Tt){X=-1}}if(X=parseFloat(X),!p.type.Number(X)||X<0)throw u?(u=void 0,['Invalid return value of supplied function for option "duration":',X]):['Invalid value for option "duration":',X];return X}}),T=function(X){X=arguments.length?[X]:Object.keys(P),X.forEach(function(ot,Tt){var Vt;if(P[ot])try{Vt=P[ot](a[ot])}catch(qt){Vt=r[ot];var Gt=p.type.String(qt)?[qt]:qt;p.type.Array(Gt)?(Gt[0]="ERROR: "+Gt[0],Gt.unshift(1),y.apply(this,Gt)):y(1,"ERROR: Problem executing validation callback for option '"+ot+"':",qt.message)}finally{a[ot]=Vt}})},E=function(X,ot){var Tt=!1,Vt=a[X];return a[X]!=ot&&(a[X]=ot,T(X),Tt=Vt!=a[X]),Tt},x=function(X){s[X]||(s[X]=function(ot){if(arguments.length)X==="duration"&&(u=void 0),E(X,ot)&&(s.trigger("change",{what:X,newval:a[X]}),D.shifts.indexOf(X)>-1&&s.trigger("shift",{reason:X}));else return a[X];return s})};this.controller=function(){return m},this.state=function(){return f},this.scrollOffset=function(){return c.start},this.triggerPosition=function(){var X=a.offset;return m&&(a.triggerElement?X+=d:X+=m.info("size")*s.triggerHook()),X};var S,L;s.on("shift.internal",function(X){var ot=X.reason==="duration";(f===t&&ot||f===i&&a.duration===0)&&C(),ot&&F()}).on("progress.internal",function(X){C()}).on("add.internal",function(X){F()}).on("destroy.internal",function(X){s.removePin(X.reset)});var C=function(X){if(S&&m){var ot=m.info(),Tt=L.spacer.firstChild;if(!X&&f===i){p.css(Tt,"position")!="fixed"&&(p.css(Tt,{position:"fixed"}),F());var Vt=p.get.offset(L.spacer,!0),Gt=a.reverse||a.duration===0?ot.scrollPos-c.start:Math.round(o*a.duration*10)/10;Vt[ot.vertical?"top":"left"]+=Gt,p.css(L.spacer.firstChild,{top:Vt.top,left:Vt.left})}else{var qt={position:L.inFlow?"relative":"absolute",top:0,left:0},Qt=p.css(Tt,"position")!=qt.position;L.pushFollowers?a.duration>0&&(f===t&&parseFloat(p.css(L.spacer,"padding-top"))===0||f===e&&parseFloat(p.css(L.spacer,"padding-bottom"))===0)&&(Qt=!0):qt[ot.vertical?"top":"left"]=a.duration*o,p.css(Tt,qt),Qt&&F()}}},F=function(){if(S&&m&&L.inFlow){var X=f===t,ot=f===e,Tt=f===i,Vt=m.info("vertical"),Gt=L.spacer.firstChild,qt=p.isMarginCollapseType(p.css(L.spacer,"display")),Qt={};L.relSize.width||L.relSize.autoFullWidth?Tt?p.css(S,{width:p.get.width(L.spacer)}):p.css(S,{width:"100%"}):(Qt["min-width"]=p.get.width(Vt?S:Gt,!0,!0),Qt.width=Tt?Qt["min-width"]:"auto"),L.relSize.height?Tt?p.css(S,{height:p.get.height(L.spacer)-(L.pushFollowers?a.duration:0)}):p.css(S,{height:"100%"}):(Qt["min-height"]=p.get.height(Vt?Gt:S,!0,!qt),Qt.height=Tt?Qt["min-height"]:"auto"),L.pushFollowers&&(Qt["padding"+(Vt?"Top":"Left")]=a.duration*o,Qt["padding"+(Vt?"Bottom":"Right")]=a.duration*(1-o)),p.css(L.spacer,Qt)}},q=function(){m&&S&&f===i&&!m.info("isDocument")&&C()},it=function(){m&&S&&f===i&&((L.relSize.width||L.relSize.autoFullWidth)&&p.get.width(window)!=p.get.width(L.spacer.parentNode)||L.relSize.height&&p.get.height(window)!=p.get.height(L.spacer.parentNode))&&F()},st=function(X){m&&S&&f===i&&!m.info("isDocument")&&(X.preventDefault(),m._setScrollPos(m.info("scrollPos")-((X.wheelDelta||X[m.info("vertical")?"wheelDeltaY":"wheelDeltaX"])/3||-X.detail*30)))};this.setPin=function(X,ot){var Tt={pushFollowers:!0,spacerClass:"scrollmagic-pin-spacer"};if(ot=p.extend({},Tt,ot),X=p.get.elements(X)[0],X){if(p.css(X,"position")==="fixed")return y(1,"ERROR calling method 'setPin()': Pin does not work with elements that are positioned 'fixed'."),s}else return y(1,"ERROR calling method 'setPin()': Invalid pin element supplied."),s;if(S){if(S===X)return s;s.removePin()}S=X;var Vt=S.parentNode.style.display,Gt=["top","left","bottom","right","margin","marginLeft","marginRight","marginTop","marginBottom"];S.parentNode.style.display="none";var qt=p.css(S,"position")!="absolute",Qt=p.css(S,Gt.concat(["display"])),ne=p.css(S,["width","height"]);S.parentNode.style.display=Vt,!qt&&ot.pushFollowers&&(y(2,"WARNING: If the pinned element is positioned absolutely pushFollowers will be disabled."),ot.pushFollowers=!1),window.setTimeout(function(){S&&a.duration===0&&ot.pushFollowers&&y(2,"WARNING: pushFollowers =",!0,"has no effect, when scene duration is 0.")},0);var j=S.parentNode.insertBefore(document.createElement("div"),S),J=p.extend(Qt,{position:qt?"relative":"absolute",boxSizing:"content-box",mozBoxSizing:"content-box",webkitBoxSizing:"content-box"});if(qt||p.extend(J,p.css(S,["width","height"])),p.css(j,J),j.setAttribute(vt,""),p.addClass(j,ot.spacerClass),L={spacer:j,relSize:{width:ne.width.slice(-1)==="%",height:ne.height.slice(-1)==="%",autoFullWidth:ne.width==="auto"&&qt&&p.isMarginCollapseType(Qt.display)},pushFollowers:ot.pushFollowers,inFlow:qt},!S.___origStyle){S.___origStyle={};var at=S.style,xt=Gt.concat(["width","height","position","boxSizing","mozBoxSizing","webkitBoxSizing"]);xt.forEach(function(Rt){S.___origStyle[Rt]=at[Rt]||""})}return L.relSize.width&&p.css(j,{width:ne.width}),L.relSize.height&&p.css(j,{height:ne.height}),j.appendChild(S),p.css(S,{position:qt?"relative":"absolute",margin:"auto",top:"auto",left:"auto",bottom:"auto",right:"auto"}),(L.relSize.width||L.relSize.autoFullWidth)&&p.css(S,{boxSizing:"border-box",mozBoxSizing:"border-box",webkitBoxSizing:"border-box"}),window.addEventListener("scroll",q),window.addEventListener("resize",q),window.addEventListener("resize",it),S.addEventListener("mousewheel",st),S.addEventListener("DOMMouseScroll",st),y(3,"added pin"),C(),s},this.removePin=function(X){if(S){if(f===i&&C(!0),X||!m){var ot=L.spacer.firstChild;if(ot.hasAttribute(vt)){var Tt=L.spacer.style,Vt=["margin","marginLeft","marginRight","marginTop","marginBottom"],Gt={};Vt.forEach(function(qt){Gt[qt]=Tt[qt]||""}),p.css(ot,Gt)}L.spacer.parentNode.insertBefore(ot,L.spacer),L.spacer.parentNode.removeChild(L.spacer),S.parentNode.hasAttribute(vt)||(p.css(S,S.___origStyle),delete S.___origStyle)}window.removeEventListener("scroll",q),window.removeEventListener("resize",q),window.removeEventListener("resize",it),S.removeEventListener("mousewheel",st),S.removeEventListener("DOMMouseScroll",st),S=void 0,y(3,"removed pin (reset: "+(X?"true":"false")+")")}return s};var pt,_t=[];return s.on("destroy.internal",function(X){s.removeClassToggle(X.reset)}),this.setClassToggle=function(X,ot){var Tt=p.get.elements(X);return Tt.length===0||!p.type.String(ot)?(y(1,"ERROR calling method 'setClassToggle()': Invalid "+(Tt.length===0?"element":"classes")+" supplied."),s):(_t.length>0&&s.removeClassToggle(),pt=ot,_t=Tt,s.on("enter.internal_class leave.internal_class",function(Vt){var Gt=Vt.type==="enter"?p.addClass:p.removeClass;_t.forEach(function(qt,Qt){Gt(qt,pt)})}),s)},this.removeClassToggle=function(X){return X&&_t.forEach(function(ot,Tt){p.removeClass(ot,pt)}),s.off("start.internal_class end.internal_class"),pt=void 0,_t=[],s},g(),s};var D={defaults:{duration:0,offset:0,triggerElement:void 0,triggerHook:.5,reverse:!0,loglevel:2},validate:{offset:function(l){if(l=parseFloat(l),!p.type.Number(l))throw['Invalid value for option "offset":',l];return l},triggerElement:function(l){if(l=l||void 0,l){var n=p.get.elements(l)[0];if(n&&n.parentNode)l=n;else throw['Element defined in option "triggerElement" was not found:',l]}return l},triggerHook:function(l){var n={onCenter:.5,onEnter:1,onLeave:0};if(p.type.Number(l))l=Math.max(0,Math.min(parseFloat(l),1));else if(l in n)l=n[l];else throw['Invalid value for option "triggerHook": ',l];return l},reverse:function(l){return!!l},loglevel:function(l){if(l=parseInt(l),!p.type.Number(l)||l<0||l>3)throw['Invalid value for option "loglevel":',l];return l}},shifts:["duration","offset","triggerHook"]};rt.Scene.addOption=function(l,n,e,i){l in D.defaults?rt._util.log(1,"[static] ScrollMagic.Scene -> Cannot add Scene option '"+l+"', because it already exists."):(D.defaults[l]=n,D.validate[l]=e,i&&D.shifts.push(l))},rt.Scene.extend=function(l){var n=this;rt.Scene=function(){return n.apply(this,arguments),this.$super=p.extend({},this),l.apply(this,arguments)||this},p.extend(rt.Scene,n),rt.Scene.prototype=n.prototype,rt.Scene.prototype.constructor=rt.Scene},rt.Event=function(l,n,e,i){i=i||{};for(var t in i)this[t]=i[t];return this.type=l,this.target=this.currentTarget=e,this.namespace=n||"",this.timeStamp=this.timestamp=Date.now(),this};var p=rt._util=function(l){var n={},e,i=function(_){return parseFloat(_)||0},t=function(_){return _.currentStyle?_.currentStyle:l.getComputedStyle(_)},r=function(_,y,v,b){if(y=y===document?l:y,y===l)b=!1;else if(!m.DomElement(y))return 0;_=_.charAt(0).toUpperCase()+_.substr(1).toLowerCase();var R=(v?y["offset"+_]||y["outer"+_]:y["client"+_]||y["inner"+_])||0;if(v&&b){var M=t(y);R+=_==="Height"?i(M.marginTop)+i(M.marginBottom):i(M.marginLeft)+i(M.marginRight)}return R},s=function(_){return _.replace(/^[^a-z]+([a-z])/g,"$1").replace(/-([a-z])/g,function(y){return y[1].toUpperCase()})};n.extend=function(_){for(_=_||{},e=1;e<arguments.length;e++)if(arguments[e])for(var y in arguments[e])arguments[e].hasOwnProperty(y)&&(_[y]=arguments[e][y]);return _},n.isMarginCollapseType=function(_){return["block","flex","list-item","table","-webkit-box"].indexOf(_)>-1};var a=0,f=["ms","moz","webkit","o"],o=l.requestAnimationFrame,c=l.cancelAnimationFrame;for(e=0;!o&&e<f.length;++e)o=l[f[e]+"RequestAnimationFrame"],c=l[f[e]+"CancelAnimationFrame"]||l[f[e]+"CancelRequestAnimationFrame"];o||(o=function(_){var y=new Date().getTime(),v=Math.max(0,16-(y-a)),b=l.setTimeout(function(){_(y+v)},v);return a=y+v,b}),c||(c=function(_){l.clearTimeout(_)}),n.rAF=o.bind(l),n.cAF=c.bind(l);var d=["error","warn","log"],h=l.console||{};for(h.log=h.log||function(){},e=0;e<d.length;e++){var u=d[e];h[u]||(h[u]=h.log)}n.log=function(_){(_>d.length||_<=0)&&(_=d.length);var y=new Date,v=("0"+y.getHours()).slice(-2)+":"+("0"+y.getMinutes()).slice(-2)+":"+("0"+y.getSeconds()).slice(-2)+":"+("00"+y.getMilliseconds()).slice(-3),b=d[_-1],R=Array.prototype.splice.call(arguments,1),M=Function.prototype.bind.call(h[b],h);R.unshift(v),M.apply(h,R)};var m=n.type=function(_){return Object.prototype.toString.call(_).replace(/^\[object (.+)\]$/,"$1").toLowerCase()};m.String=function(_){return m(_)==="string"},m.Function=function(_){return m(_)==="function"},m.Array=function(_){return Array.isArray(_)},m.Number=function(_){return!m.Array(_)&&_-parseFloat(_)+1>=0},m.DomElement=function(_){return typeof HTMLElement=="object"?_ instanceof HTMLElement:_&&typeof _=="object"&&_!==null&&_.nodeType===1&&typeof _.nodeName=="string"};var g=n.get={};return g.elements=function(_){var y=[];if(m.String(_))try{_=document.querySelectorAll(_)}catch(M){return y}if(m(_)==="nodelist"||m.Array(_))for(var v=0,b=y.length=_.length;v<b;v++){var R=_[v];y[v]=m.DomElement(R)?R:g.elements(R)}else(m.DomElement(_)||_===document||_===l)&&(y=[_]);return y},g.scrollTop=function(_){return _&&typeof _.scrollTop=="number"?_.scrollTop:l.pageYOffset||0},g.scrollLeft=function(_){return _&&typeof _.scrollLeft=="number"?_.scrollLeft:l.pageXOffset||0},g.width=function(_,y,v){return r("width",_,y,v)},g.height=function(_,y,v){return r("height",_,y,v)},g.offset=function(_,y){var v={top:0,left:0};if(_&&_.getBoundingClientRect){var b=_.getBoundingClientRect();v.top=b.top,v.left=b.left,y||(v.top+=g.scrollTop(),v.left+=g.scrollLeft())}return v},n.addClass=function(_,y){y&&(_.classList?_.classList.add(y):_.className+=" "+y)},n.removeClass=function(_,y){y&&(_.classList?_.classList.remove(y):_.className=_.className.replace(new RegExp("(^|\\b)"+y.split(" ").join("|")+"(\\b|$)","gi")," "))},n.css=function(_,y){if(m.String(y))return t(_)[s(y)];if(m.Array(y)){var v={},b=t(_);return y.forEach(function(P,T){v[P]=b[s(P)]}),v}else for(var R in y){var M=y[R];M==parseFloat(M)&&(M+="px"),_.style[s(R)]=M}},n}(window||{});return rt.Scene.prototype.addIndicators=function(){return rt._util.log(1,"(ScrollMagic.Scene) -> ERROR calling addIndicators() due to missing Plugin 'debug.addIndicators'. Please make sure to include plugins/debug.addIndicators.js"),this},rt.Scene.prototype.removeIndicators=function(){return rt._util.log(1,"(ScrollMagic.Scene) -> ERROR calling removeIndicators() due to missing Plugin 'debug.addIndicators'. Please make sure to include plugins/debug.addIndicators.js"),this},rt.Scene.prototype.setTween=function(){return rt._util.log(1,"(ScrollMagic.Scene) -> ERROR calling setTween() due to missing Plugin 'animation.gsap'. Please make sure to include plugins/animation.gsap.js"),this},rt.Scene.prototype.removeTween=function(){return rt._util.log(1,"(ScrollMagic.Scene) -> ERROR calling removeTween() due to missing Plugin 'animation.gsap'. Please make sure to include plugins/animation.gsap.js"),this},rt.Scene.prototype.setVelocity=function(){return rt._util.log(1,"(ScrollMagic.Scene) -> ERROR calling setVelocity() due to missing Plugin 'animation.velocity'. Please make sure to include plugins/animation.velocity.js"),this},rt.Scene.prototype.removeVelocity=function(){return rt._util.log(1,"(ScrollMagic.Scene) -> ERROR calling removeVelocity() due to missing Plugin 'animation.velocity'. Please make sure to include plugins/animation.velocity.js"),this},rt})});var la=Ii((Rs,bi)=>{var ei=typeof bi<"u"&&bi.exports&&typeof global<"u"?global:Rs||window;(ei._gsQueue||(ei._gsQueue=[])).push(function(){"use strict";ei._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(rt,vt,B){var D=function(c){var d=[],h=c.length,u;for(u=0;u!==h;d.push(c[u++]));return d},p=function(c,d,h){var u=c.cycle,m,g;for(m in u)g=u[m],c[m]=typeof g=="function"?g(h,d[h]):g[h%g.length];delete c.cycle},l=function(c,d,h){B.call(this,c,d,h),this._cycle=0,this._yoyo=this.vars.yoyo===!0||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._repeat&&this._uncache(!0),this.render=l.prototype.render},n=1e-10,e=B._internals,i=e.isSelector,t=e.isArray,r=l.prototype=B.to({},.1,{}),s=[];l.version="2.0.2",r.constructor=l,r.kill()._gc=!1,l.killTweensOf=l.killDelayedCallsTo=B.killTweensOf,l.getTweensOf=B.getTweensOf,l.lagSmoothing=B.lagSmoothing,l.ticker=B.ticker,l.render=B.render,r.invalidate=function(){return this._yoyo=this.vars.yoyo===!0||!!this.vars.yoyoEase,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._yoyoEase=null,this._uncache(!0),B.prototype.invalidate.call(this)},r.updateTo=function(c,d){var h=this.ratio,u=this.vars.immediateRender||c.immediateRender,m;d&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(m in c)this.vars[m]=c[m];if(this._initted||u){if(d)this._initted=!1,u&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&B._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var g=this._totalTime;this.render(0,!0,!1),this._initted=!1,this.render(g,!0,!1)}else if(this._initted=!1,this._init(),this._time>0||u)for(var _=1/(1-h),y=this._firstPT,v;y;)v=y.s+y.c,y.c*=_,y.s=v-y.c,y=y._next}return this},r.render=function(c,d,h){this._initted||this._duration===0&&this.vars.repeat&&this.invalidate();var u=this._dirty?this.totalDuration():this._totalDuration,m=this._time,g=this._totalTime,_=this._cycle,y=this._duration,v=this._rawPrevTime,b,R,M,P,T,E,x,S,L;if(c>=u-1e-7&&c>=0?(this._totalTime=u,this._cycle=this._repeat,this._yoyo&&this._cycle&1?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=y,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(b=!0,R="onComplete",h=h||this._timeline.autoRemoveChildren),y===0&&(this._initted||!this.vars.lazy||h)&&(this._startTime===this._timeline._duration&&(c=0),(v<0||c<=0&&c>=-1e-7||v===n&&this.data!=="isPause")&&v!==c&&(h=!0,v>n&&(R="onReverseComplete")),this._rawPrevTime=S=!d||c||v===c?c:n)):c<1e-7?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(g!==0||y===0&&v>0)&&(R="onReverseComplete",b=this._reversed),c<0&&(this._active=!1,y===0&&(this._initted||!this.vars.lazy||h)&&(v>=0&&(h=!0),this._rawPrevTime=S=!d||c||v===c?c:n)),this._initted||(h=!0)):(this._totalTime=this._time=c,this._repeat!==0&&(P=y+this._repeatDelay,this._cycle=this._totalTime/P>>0,this._cycle!==0&&this._cycle===this._totalTime/P&&g<=c&&this._cycle--,this._time=this._totalTime-this._cycle*P,this._yoyo&&this._cycle&1&&(this._time=y-this._time,L=this._yoyoEase||this.vars.yoyoEase,L&&(this._yoyoEase||(L===!0&&!this._initted?(L=this.vars.ease,this._yoyoEase=L=L?L instanceof Ease?L:typeof L=="function"?new Ease(L,this.vars.easeParams):Ease.map[L]||B.defaultEase:B.defaultEase):this._yoyoEase=L=L===!0?this._ease:L instanceof Ease?L:Ease.map[L]),this.ratio=L?1-L.getRatio((y-this._time)/y):0)),this._time>y?this._time=y:this._time<0&&(this._time=0)),this._easeType&&!L?(T=this._time/y,E=this._easeType,x=this._easePower,(E===1||E===3&&T>=.5)&&(T=1-T),E===3&&(T*=2),x===1?T*=T:x===2?T*=T*T:x===3?T*=T*T*T:x===4&&(T*=T*T*T*T),E===1?this.ratio=1-T:E===2?this.ratio=T:this._time/y<.5?this.ratio=T/2:this.ratio=1-T/2):L||(this.ratio=this._ease.getRatio(this._time/y))),m===this._time&&!h&&_===this._cycle){g!==this._totalTime&&this._onUpdate&&(d||this._callback("onUpdate"));return}else if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!h&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)){this._time=m,this._totalTime=g,this._rawPrevTime=v,this._cycle=_,e.lazyTweens.push(this),this._lazy=[c,d];return}this._time&&!b&&!L?this.ratio=this._ease.getRatio(this._time/y):b&&this._ease._calcEnd&&!L&&(this.ratio=this._ease.getRatio(this._time===0?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==m&&c>=0&&(this._active=!0),g===0&&(this._initted===2&&c>0&&this._init(),this._startAt&&(c>=0?this._startAt.render(c,!0,h):R||(R="_dummyGS")),this.vars.onStart&&(this._totalTime!==0||y===0)&&(d||this._callback("onStart"))),M=this._firstPT;M;)M.f?M.t[M.p](M.c*this.ratio+M.s):M.t[M.p]=M.c*this.ratio+M.s,M=M._next;this._onUpdate&&(c<0&&this._startAt&&this._startTime&&this._startAt.render(c,!0,h),d||(this._totalTime!==g||R)&&this._callback("onUpdate")),this._cycle!==_&&(d||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),R&&(!this._gc||h)&&(c<0&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(c,!0,h),b&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!d&&this.vars[R]&&this._callback(R),y===0&&this._rawPrevTime===n&&S!==n&&(this._rawPrevTime=0))},l.to=function(c,d,h){return new l(c,d,h)},l.from=function(c,d,h){return h.runBackwards=!0,h.immediateRender=h.immediateRender!=!1,new l(c,d,h)},l.fromTo=function(c,d,h,u){return u.startAt=h,u.immediateRender=u.immediateRender!=!1&&h.immediateRender!=!1,new l(c,d,u)},l.staggerTo=l.allTo=function(c,d,h,u,m,g,_){u=u||0;var y=0,v=[],b=function(){h.onComplete&&h.onComplete.apply(h.onCompleteScope||this,arguments),m.apply(_||h.callbackScope||this,g||s)},R=h.cycle,M=h.startAt&&h.startAt.cycle,P,T,E,x;for(t(c)||(typeof c=="string"&&(c=B.selector(c)||c),i(c)&&(c=D(c))),c=c||[],u<0&&(c=D(c),c.reverse(),u*=-1),P=c.length-1,E=0;E<=P;E++){T={};for(x in h)T[x]=h[x];if(R&&(p(T,c,E),T.duration!=null&&(d=T.duration,delete T.duration)),M){M=T.startAt={};for(x in h.startAt)M[x]=h.startAt[x];p(T.startAt,c,E)}T.delay=y+(T.delay||0),E===P&&m&&(T.onComplete=b),v[E]=new l(c[E],d,T),y+=u}return v},l.staggerFrom=l.allFrom=function(c,d,h,u,m,g,_){return h.runBackwards=!0,h.immediateRender=h.immediateRender!=!1,l.staggerTo(c,d,h,u,m,g,_)},l.staggerFromTo=l.allFromTo=function(c,d,h,u,m,g,_,y){return u.startAt=h,u.immediateRender=u.immediateRender!=!1&&h.immediateRender!=!1,l.staggerTo(c,d,u,m,g,_,y)},l.delayedCall=function(c,d,h,u,m){return new l(d,0,{delay:c,onComplete:d,onCompleteParams:h,callbackScope:u,onReverseComplete:d,onReverseCompleteParams:h,immediateRender:!1,useFrames:m,overwrite:0})},l.set=function(c,d){return new l(c,0,d)},l.isTweening=function(c){return B.getTweensOf(c,!0).length>0};var a=function(c,d){for(var h=[],u=0,m=c._first;m;)m instanceof B?h[u++]=m:(d&&(h[u++]=m),h=h.concat(a(m,d)),u=h.length),m=m._next;return h},f=l.getAllTweens=function(c){return a(rt._rootTimeline,c).concat(a(rt._rootFramesTimeline,c))};l.killAll=function(c,d,h,u){d==null&&(d=!0),h==null&&(h=!0);var m=f(u!=!1),g=m.length,_=d&&h&&u,y,v,b;for(b=0;b<g;b++)v=m[b],(_||v instanceof vt||(y=v.target===v.vars.onComplete)&&h||d&&!y)&&(c?v.totalTime(v._reversed?0:v.totalDuration()):v._enabled(!1,!1))},l.killChildTweensOf=function(c,d){if(c!=null){var h=e.tweenLookup,u,m,g,_,y;if(typeof c=="string"&&(c=B.selector(c)||c),i(c)&&(c=D(c)),t(c)){for(_=c.length;--_>-1;)l.killChildTweensOf(c[_],d);return}u=[];for(g in h)for(m=h[g].target.parentNode;m;)m===c&&(u=u.concat(h[g].tweens)),m=m.parentNode;for(y=u.length,_=0;_<y;_++)d&&u[_].totalTime(u[_].totalDuration()),u[_]._enabled(!1,!1)}};var o=function(c,d,h,u){d=d!==!1,h=h!==!1,u=u!==!1;for(var m=f(u),g=d&&h&&u,_=m.length,y,v;--_>-1;)v=m[_],(g||v instanceof vt||(y=v.target===v.vars.onComplete)&&h||d&&!y)&&v.paused(c)};return l.pauseAll=function(c,d,h){o(!0,c,d,h)},l.resumeAll=function(c,d,h){o(!1,c,d,h)},l.globalTimeScale=function(c){var d=rt._rootTimeline,h=B.ticker.time;return arguments.length?(c=c||n,d._startTime=h-(h-d._startTime)*d._timeScale/c,d=rt._rootFramesTimeline,h=B.ticker.frame,d._startTime=h-(h-d._startTime)*d._timeScale/c,d._timeScale=rt._rootTimeline._timeScale=c,c):d._timeScale},r.progress=function(c,d){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&this._cycle&1?1-c:c)+this._cycle*(this._duration+this._repeatDelay),d):this._time/this.duration()},r.totalProgress=function(c,d){return arguments.length?this.totalTime(this.totalDuration()*c,d):this._totalTime/this.totalDuration()},r.time=function(c,d){return arguments.length?(this._dirty&&this.totalDuration(),c>this._duration&&(c=this._duration),this._yoyo&&this._cycle&1?c=this._duration-c+this._cycle*(this._duration+this._repeatDelay):this._repeat!==0&&(c+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(c,d)):this._time},r.duration=function(c){return arguments.length?rt.prototype.duration.call(this,c):this._duration},r.totalDuration=function(c){return arguments.length?this._repeat===-1?this:this.duration((c-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},r.repeat=function(c){return arguments.length?(this._repeat=c,this._uncache(!0)):this._repeat},r.repeatDelay=function(c){return arguments.length?(this._repeatDelay=c,this._uncache(!0)):this._repeatDelay},r.yoyo=function(c){return arguments.length?(this._yoyo=c,this):this._yoyo},l},!0),ei._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(rt,vt,B){var D=function(h){vt.call(this,h),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var u=this.vars,m,g;for(g in u)m=u[g],i(m)&&m.join("").indexOf("{self}")!==-1&&(u[g]=this._swapSelfInParams(m));i(u.tweens)&&this.add(u.tweens,0,u.align,u.stagger)},p=1e-10,l=B._internals,n=D._internals={},e=l.isSelector,i=l.isArray,t=l.lazyTweens,r=l.lazyRender,s=ei._gsDefine.globals,a=function(h){var u={},m;for(m in h)u[m]=h[m];return u},f=function(h,u,m){var g=h.cycle,_,y;for(_ in g)y=g[_],h[_]=typeof y=="function"?y(m,u[m]):y[m%y.length];delete h.cycle},o=n.pauseCallback=function(){},c=function(h){var u=[],m=h.length,g;for(g=0;g!==m;u.push(h[g++]));return u},d=D.prototype=new vt;return D.version="2.0.2",d.constructor=D,d.kill()._gc=d._forcingPlayhead=d._hasPause=!1,d.to=function(h,u,m,g){var _=m.repeat&&s.TweenMax||B;return u?this.add(new _(h,u,m),g):this.set(h,m,g)},d.from=function(h,u,m,g){return this.add((m.repeat&&s.TweenMax||B).from(h,u,m),g)},d.fromTo=function(h,u,m,g,_){var y=g.repeat&&s.TweenMax||B;return u?this.add(y.fromTo(h,u,m,g),_):this.set(h,g,_)},d.staggerTo=function(h,u,m,g,_,y,v,b){var R=new D({onComplete:y,onCompleteParams:v,callbackScope:b,smoothChildTiming:this.smoothChildTiming}),M=m.cycle,P,T;for(typeof h=="string"&&(h=B.selector(h)||h),h=h||[],e(h)&&(h=c(h)),g=g||0,g<0&&(h=c(h),h.reverse(),g*=-1),T=0;T<h.length;T++)P=a(m),P.startAt&&(P.startAt=a(P.startAt),P.startAt.cycle&&f(P.startAt,h,T)),M&&(f(P,h,T),P.duration!=null&&(u=P.duration,delete P.duration)),R.to(h[T],u,P,T*g);return this.add(R,_)},d.staggerFrom=function(h,u,m,g,_,y,v,b){return m.immediateRender=m.immediateRender!=!1,m.runBackwards=!0,this.staggerTo(h,u,m,g,_,y,v,b)},d.staggerFromTo=function(h,u,m,g,_,y,v,b,R){return g.startAt=m,g.immediateRender=g.immediateRender!=!1&&m.immediateRender!=!1,this.staggerTo(h,u,g,_,y,v,b,R)},d.call=function(h,u,m,g){return this.add(B.delayedCall(0,h,u,m),g)},d.set=function(h,u,m){return m=this._parseTimeOrLabel(m,0,!0),u.immediateRender==null&&(u.immediateRender=m===this._time&&!this._paused),this.add(new B(h,0,u),m)},D.exportRoot=function(h,u){h=h||{},h.smoothChildTiming==null&&(h.smoothChildTiming=!0);var m=new D(h),g=m._timeline,_,y,v,b;for(u==null&&(u=!0),g._remove(m,!0),m._startTime=0,m._rawPrevTime=m._time=m._totalTime=g._time,v=g._first;v;)b=v._next,(!u||!(v instanceof B&&v.target===v.vars.onComplete))&&(y=v._startTime-v._delay,y<0&&(_=1),m.add(v,y)),v=b;return g.add(m,0),_&&m.totalDuration(),m},d.add=function(h,u,m,g){var _,y,v,b,R,M;if(typeof u!="number"&&(u=this._parseTimeOrLabel(u,0,!0,h)),!(h instanceof rt))if(h instanceof Array||h&&h.push&&i(h)){for(m=m||"normal",g=g||0,_=u,y=h.length,v=0;v<y;v++)i(b=h[v])&&(b=new D({tweens:b})),this.add(b,_),typeof b!="string"&&typeof b!="function"&&(m==="sequence"?_=b._startTime+b.totalDuration()/b._timeScale:m==="start"&&(b._startTime-=b.delay())),_+=g;return this._uncache(!0)}else{if(typeof h=="string")return this.addLabel(h,u);if(typeof h=="function")h=B.delayedCall(0,h);else throw"Cannot add "+h+" into the timeline; it is not a tween, timeline, function, or string."}if(vt.prototype.add.call(this,h,u),h._time&&(_=Math.max(0,Math.min(h.totalDuration(),(this.rawTime()-h._startTime)*h._timeScale)),Math.abs(_-h._totalTime)>1e-5&&h.render(_,!1,!1)),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(R=this,M=R.rawTime()>h._startTime;R._timeline;)M&&R._timeline.smoothChildTiming?R.totalTime(R._totalTime,!0):R._gc&&R._enabled(!0,!1),R=R._timeline;return this},d.remove=function(h){if(h instanceof rt){this._remove(h,!1);var u=h._timeline=h.vars.useFrames?rt._rootFramesTimeline:rt._rootTimeline;return h._startTime=(h._paused?h._pauseTime:u._time)-(h._reversed?h.totalDuration()-h._totalTime:h._totalTime)/h._timeScale,this}else if(h instanceof Array||h&&h.push&&i(h)){for(var m=h.length;--m>-1;)this.remove(h[m]);return this}else if(typeof h=="string")return this.removeLabel(h);return this.kill(null,h)},d._remove=function(h,u){vt.prototype._remove.call(this,h,u);var m=this._last;return m?this._time>this.duration()&&(this._time=this._duration,this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},d.append=function(h,u){return this.add(h,this._parseTimeOrLabel(null,u,!0,h))},d.insert=d.insertMultiple=function(h,u,m,g){return this.add(h,u||0,m,g)},d.appendMultiple=function(h,u,m,g){return this.add(h,this._parseTimeOrLabel(null,u,!0,h),m,g)},d.addLabel=function(h,u){return this._labels[h]=this._parseTimeOrLabel(u),this},d.addPause=function(h,u,m,g){var _=B.delayedCall(0,o,m,g||this);return _.vars.onComplete=_.vars.onReverseComplete=u,_.data="isPause",this._hasPause=!0,this.add(_,h)},d.removeLabel=function(h){return delete this._labels[h],this},d.getLabelTime=function(h){return this._labels[h]!=null?this._labels[h]:-1},d._parseTimeOrLabel=function(h,u,m,g){var _,y;if(g instanceof rt&&g.timeline===this)this.remove(g);else if(g&&(g instanceof Array||g.push&&i(g)))for(y=g.length;--y>-1;)g[y]instanceof rt&&g[y].timeline===this&&this.remove(g[y]);if(_=typeof h=="number"&&!u?0:this.duration()>99999999999?this.recent().endTime(!1):this._duration,typeof u=="string")return this._parseTimeOrLabel(u,m&&typeof h=="number"&&this._labels[u]==null?h-_:0,m);if(u=u||0,typeof h=="string"&&(isNaN(h)||this._labels[h]!=null)){if(y=h.indexOf("="),y===-1)return this._labels[h]==null?m?this._labels[h]=_+u:u:this._labels[h]+u;u=parseInt(h.charAt(y-1)+"1",10)*Number(h.substr(y+1)),h=y>1?this._parseTimeOrLabel(h.substr(0,y-1),0,m):_}else h==null&&(h=_);return Number(h)+u},d.seek=function(h,u){return this.totalTime(typeof h=="number"?h:this._parseTimeOrLabel(h),u!==!1)},d.stop=function(){return this.paused(!0)},d.gotoAndPlay=function(h,u){return this.play(h,u)},d.gotoAndStop=function(h,u){return this.pause(h,u)},d.render=function(h,u,m){this._gc&&this._enabled(!0,!1);var g=this._time,_=this._dirty?this.totalDuration():this._totalDuration,y=this._startTime,v=this._timeScale,b=this._paused,R,M,P,T,E,x,S;if(g!==this._time&&(h+=this._time-g),h>=_-1e-7&&h>=0)this._totalTime=this._time=_,this._reversed||this._hasPausedChild()||(M=!0,T="onComplete",E=!!this._timeline.autoRemoveChildren,this._duration===0&&(h<=0&&h>=-1e-7||this._rawPrevTime<0||this._rawPrevTime===p)&&this._rawPrevTime!==h&&this._first&&(E=!0,this._rawPrevTime>p&&(T="onReverseComplete"))),this._rawPrevTime=this._duration||!u||h||this._rawPrevTime===h?h:p,h=_+1e-4;else if(h<1e-7)if(this._totalTime=this._time=0,(g!==0||this._duration===0&&this._rawPrevTime!==p&&(this._rawPrevTime>0||h<0&&this._rawPrevTime>=0))&&(T="onReverseComplete",M=this._reversed),h<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(E=M=!0,T="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(E=!0),this._rawPrevTime=h;else{if(this._rawPrevTime=this._duration||!u||h||this._rawPrevTime===h?h:p,h===0&&M)for(R=this._first;R&&R._startTime===0;)R._duration||(M=!1),R=R._next;h=0,this._initted||(E=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!u){if(h>=g)for(R=this._first;R&&R._startTime<=h&&!x;)R._duration||R.data==="isPause"&&!R.ratio&&!(R._startTime===0&&this._rawPrevTime===0)&&(x=R),R=R._next;else for(R=this._last;R&&R._startTime>=h&&!x;)R._duration||R.data==="isPause"&&R._rawPrevTime>0&&(x=R),R=R._prev;x&&(this._time=h=x._startTime,this._totalTime=h+this._cycle*(this._totalDuration+this._repeatDelay))}this._totalTime=this._time=this._rawPrevTime=h}if(!((this._time===g||!this._first)&&!m&&!E&&!x)){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==g&&h>0&&(this._active=!0),g===0&&this.vars.onStart&&(this._time!==0||!this._duration)&&(u||this._callback("onStart")),S=this._time,S>=g)for(R=this._first;R&&(P=R._next,!(S!==this._time||this._paused&&!b));)(R._active||R._startTime<=S&&!R._paused&&!R._gc)&&(x===R&&this.pause(),R._reversed?R.render((R._dirty?R.totalDuration():R._totalDuration)-(h-R._startTime)*R._timeScale,u,m):R.render((h-R._startTime)*R._timeScale,u,m)),R=P;else for(R=this._last;R&&(P=R._prev,!(S!==this._time||this._paused&&!b));){if(R._active||R._startTime<=g&&!R._paused&&!R._gc){if(x===R){for(x=R._prev;x&&x.endTime()>this._time;)x.render(x._reversed?x.totalDuration()-(h-x._startTime)*x._timeScale:(h-x._startTime)*x._timeScale,u,m),x=x._prev;x=null,this.pause()}R._reversed?R.render((R._dirty?R.totalDuration():R._totalDuration)-(h-R._startTime)*R._timeScale,u,m):R.render((h-R._startTime)*R._timeScale,u,m)}R=P}this._onUpdate&&(u||(t.length&&r(),this._callback("onUpdate"))),T&&(this._gc||(y===this._startTime||v!==this._timeScale)&&(this._time===0||_>=this.totalDuration())&&(M&&(t.length&&r(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!u&&this.vars[T]&&this._callback(T)))}},d._hasPausedChild=function(){for(var h=this._first;h;){if(h._paused||h instanceof D&&h._hasPausedChild())return!0;h=h._next}return!1},d.getChildren=function(h,u,m,g){g=g||-9999999999;for(var _=[],y=this._first,v=0;y;)y._startTime<g||(y instanceof B?u!==!1&&(_[v++]=y):(m!==!1&&(_[v++]=y),h!==!1&&(_=_.concat(y.getChildren(!0,u,m)),v=_.length))),y=y._next;return _},d.getTweensOf=function(h,u){var m=this._gc,g=[],_=0,y,v;for(m&&this._enabled(!0,!0),y=B.getTweensOf(h),v=y.length;--v>-1;)(y[v].timeline===this||u&&this._contains(y[v]))&&(g[_++]=y[v]);return m&&this._enabled(!1,!0),g},d.recent=function(){return this._recent},d._contains=function(h){for(var u=h.timeline;u;){if(u===this)return!0;u=u.timeline}return!1},d.shiftChildren=function(h,u,m){m=m||0;for(var g=this._first,_=this._labels,y;g;)g._startTime>=m&&(g._startTime+=h),g=g._next;if(u)for(y in _)_[y]>=m&&(_[y]+=h);return this._uncache(!0)},d._kill=function(h,u){if(!h&&!u)return this._enabled(!1,!1);for(var m=u?this.getTweensOf(u):this.getChildren(!0,!0,!1),g=m.length,_=!1;--g>-1;)m[g]._kill(h,u)&&(_=!0);return _},d.clear=function(h){var u=this.getChildren(!1,!0,!0),m=u.length;for(this._time=this._totalTime=0;--m>-1;)u[m]._enabled(!1,!1);return h!==!1&&(this._labels={}),this._uncache(!0)},d.invalidate=function(){for(var h=this._first;h;)h.invalidate(),h=h._next;return rt.prototype.invalidate.call(this)},d._enabled=function(h,u){if(h===this._gc)for(var m=this._first;m;)m._enabled(h,!0),m=m._next;return vt.prototype._enabled.call(this,h,u)},d.totalTime=function(h,u,m){this._forcingPlayhead=!0;var g=rt.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,g},d.duration=function(h){return arguments.length?(this.duration()!==0&&h!==0&&this.timeScale(this._duration/h),this):(this._dirty&&this.totalDuration(),this._duration)},d.totalDuration=function(h){if(!arguments.length){if(this._dirty){for(var u=0,m=this._last,g=999999999999,_,y;m;)_=m._prev,m._dirty&&m.totalDuration(),m._startTime>g&&this._sortChildren&&!m._paused&&!this._calculatingDuration?(this._calculatingDuration=1,this.add(m,m._startTime-m._delay),this._calculatingDuration=0):g=m._startTime,m._startTime<0&&!m._paused&&(u-=m._startTime,this._timeline.smoothChildTiming&&(this._startTime+=m._startTime/this._timeScale,this._time-=m._startTime,this._totalTime-=m._startTime,this._rawPrevTime-=m._startTime),this.shiftChildren(-m._startTime,!1,-9999999999),g=0),y=m._startTime+m._totalDuration/m._timeScale,y>u&&(u=y),m=_;this._duration=this._totalDuration=u,this._dirty=!1}return this._totalDuration}return h&&this.totalDuration()?this.timeScale(this._totalDuration/h):this},d.paused=function(h){if(!h)for(var u=this._first,m=this._time;u;)u._startTime===m&&u.data==="isPause"&&(u._rawPrevTime=0),u=u._next;return rt.prototype.paused.apply(this,arguments)},d.usesFrames=function(){for(var h=this._timeline;h._timeline;)h=h._timeline;return h===rt._rootFramesTimeline},d.rawTime=function(h){return h&&(this._paused||this._repeat&&this.time()>0&&this.totalProgress()<1)?this._totalTime%(this._duration+this._repeatDelay):this._paused?this._totalTime:(this._timeline.rawTime(h)-this._startTime)*this._timeScale},D},!0),ei._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(rt,vt,B){var D=function(s){rt.call(this,s),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},p=1e-10,l=vt._internals,n=l.lazyTweens,e=l.lazyRender,i=ei._gsDefine.globals,t=new B(null,null,1,0),r=D.prototype=new rt;return r.constructor=D,r.kill()._gc=!1,D.version="2.0.2",r.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),rt.prototype.invalidate.call(this)},r.addCallback=function(s,a,f,o){return this.add(vt.delayedCall(0,s,f,o),a)},r.removeCallback=function(s,a){if(s)if(a==null)this._kill(null,s);else for(var f=this.getTweensOf(s,!1),o=f.length,c=this._parseTimeOrLabel(a);--o>-1;)f[o]._startTime===c&&f[o]._enabled(!1,!1);return this},r.removePause=function(s){return this.removeCallback(rt._internals.pauseCallback,s)},r.tweenTo=function(s,a){a=a||{};var f={ease:t,useFrames:this.usesFrames(),immediateRender:!1,lazy:!1},o=a.repeat&&i.TweenMax||vt,c,d,h;for(d in a)f[d]=a[d];return f.time=this._parseTimeOrLabel(s),c=Math.abs(Number(f.time)-this._time)/this._timeScale||.001,h=new o(this,c,f),f.onStart=function(){h.target.paused(!0),h.vars.time!==h.target.time()&&c===h.duration()&&!h.isFromTo&&h.duration(Math.abs(h.vars.time-h.target.time())/h.target._timeScale).render(h.time(),!0,!0),a.onStart&&a.onStart.apply(a.onStartScope||a.callbackScope||h,a.onStartParams||[])},h},r.tweenFromTo=function(s,a,f){f=f||{},s=this._parseTimeOrLabel(s),f.startAt={onComplete:this.seek,onCompleteParams:[s],callbackScope:this},f.immediateRender=f.immediateRender!==!1;var o=this.tweenTo(a,f);return o.isFromTo=1,o.duration(Math.abs(o.vars.time-s)/this._timeScale||.001)},r.render=function(s,a,f){this._gc&&this._enabled(!0,!1);var o=this._time,c=this._dirty?this.totalDuration():this._totalDuration,d=this._duration,h=this._totalTime,u=this._startTime,m=this._timeScale,g=this._rawPrevTime,_=this._paused,y=this._cycle,v,b,R,M,P,T,E,x;if(o!==this._time&&(s+=this._time-o),s>=c-1e-7&&s>=0)this._locked||(this._totalTime=c,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(b=!0,M="onComplete",P=!!this._timeline.autoRemoveChildren,this._duration===0&&(s<=0&&s>=-1e-7||g<0||g===p)&&g!==s&&this._first&&(P=!0,g>p&&(M="onReverseComplete"))),this._rawPrevTime=this._duration||!a||s||this._rawPrevTime===s?s:p,this._yoyo&&this._cycle&1?this._time=s=0:(this._time=d,s=d+1e-4);else if(s<1e-7)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(o!==0||d===0&&g!==p&&(g>0||s<0&&g>=0)&&!this._locked)&&(M="onReverseComplete",b=this._reversed),s<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(P=b=!0,M="onReverseComplete"):g>=0&&this._first&&(P=!0),this._rawPrevTime=s;else{if(this._rawPrevTime=d||!a||s||this._rawPrevTime===s?s:p,s===0&&b)for(v=this._first;v&&v._startTime===0;)v._duration||(b=!1),v=v._next;s=0,this._initted||(P=!0)}else if(d===0&&g<0&&(P=!0),this._time=this._rawPrevTime=s,this._locked||(this._totalTime=s,this._repeat!==0&&(T=d+this._repeatDelay,this._cycle=this._totalTime/T>>0,this._cycle!==0&&this._cycle===this._totalTime/T&&h<=s&&this._cycle--,this._time=this._totalTime-this._cycle*T,this._yoyo&&this._cycle&1&&(this._time=d-this._time),this._time>d?(this._time=d,s=d+1e-4):this._time<0?this._time=s=0:s=this._time)),this._hasPause&&!this._forcingPlayhead&&!a){if(s=this._time,s>=o||this._repeat&&y!==this._cycle)for(v=this._first;v&&v._startTime<=s&&!E;)v._duration||v.data==="isPause"&&!v.ratio&&!(v._startTime===0&&this._rawPrevTime===0)&&(E=v),v=v._next;else for(v=this._last;v&&v._startTime>=s&&!E;)v._duration||v.data==="isPause"&&v._rawPrevTime>0&&(E=v),v=v._prev;E&&E._startTime<d&&(this._time=s=E._startTime,this._totalTime=s+this._cycle*(this._totalDuration+this._repeatDelay))}if(this._cycle!==y&&!this._locked){var S=this._yoyo&&(y&1)!==0,L=S===(this._yoyo&&(this._cycle&1)!==0),C=this._totalTime,F=this._cycle,q=this._rawPrevTime,it=this._time;if(this._totalTime=y*d,this._cycle<y?S=!S:this._totalTime+=d,this._time=o,this._rawPrevTime=d===0?g-1e-4:g,this._cycle=y,this._locked=!0,o=S?0:d,this.render(o,a,d===0),a||this._gc||this.vars.onRepeat&&(this._cycle=F,this._locked=!1,this._callback("onRepeat")),o!==this._time||(L&&(this._cycle=y,this._locked=!0,o=S?d+1e-4:-1e-4,this.render(o,!0,!1)),this._locked=!1,this._paused&&!_))return;this._time=it,this._totalTime=C,this._cycle=F,this._rawPrevTime=q}if((this._time===o||!this._first)&&!f&&!P&&!E){h!==this._totalTime&&this._onUpdate&&(a||this._callback("onUpdate"));return}else this._initted||(this._initted=!0);if(this._active||!this._paused&&this._totalTime!==h&&s>0&&(this._active=!0),h===0&&this.vars.onStart&&(this._totalTime!==0||!this._totalDuration)&&(a||this._callback("onStart")),x=this._time,x>=o)for(v=this._first;v&&(R=v._next,!(x!==this._time||this._paused&&!_));)(v._active||v._startTime<=this._time&&!v._paused&&!v._gc)&&(E===v&&this.pause(),v._reversed?v.render((v._dirty?v.totalDuration():v._totalDuration)-(s-v._startTime)*v._timeScale,a,f):v.render((s-v._startTime)*v._timeScale,a,f)),v=R;else for(v=this._last;v&&(R=v._prev,!(x!==this._time||this._paused&&!_));){if(v._active||v._startTime<=o&&!v._paused&&!v._gc){if(E===v){for(E=v._prev;E&&E.endTime()>this._time;)E.render(E._reversed?E.totalDuration()-(s-E._startTime)*E._timeScale:(s-E._startTime)*E._timeScale,a,f),E=E._prev;E=null,this.pause()}v._reversed?v.render((v._dirty?v.totalDuration():v._totalDuration)-(s-v._startTime)*v._timeScale,a,f):v.render((s-v._startTime)*v._timeScale,a,f)}v=R}this._onUpdate&&(a||(n.length&&e(),this._callback("onUpdate"))),M&&(this._locked||this._gc||(u===this._startTime||m!==this._timeScale)&&(this._time===0||c>=this.totalDuration())&&(b&&(n.length&&e(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!a&&this.vars[M]&&this._callback(M)))},r.getActive=function(s,a,f){s==null&&(s=!0),a==null&&(a=!0),f==null&&(f=!1);var o=[],c=this.getChildren(s,a,f),d=0,h=c.length,u,m;for(u=0;u<h;u++)m=c[u],m.isActive()&&(o[d++]=m);return o},r.getLabelAfter=function(s){s||s!==0&&(s=this._time);var a=this.getLabelsArray(),f=a.length,o;for(o=0;o<f;o++)if(a[o].time>s)return a[o].name;return null},r.getLabelBefore=function(s){s==null&&(s=this._time);for(var a=this.getLabelsArray(),f=a.length;--f>-1;)if(a[f].time<s)return a[f].name;return null},r.getLabelsArray=function(){var s=[],a=0,f;for(f in this._labels)s[a++]={time:this._labels[f],name:f};return s.sort(function(o,c){return o.time-c.time}),s},r.invalidate=function(){return this._locked=!1,rt.prototype.invalidate.call(this)},r.progress=function(s,a){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&this._cycle&1?1-s:s)+this._cycle*(this._duration+this._repeatDelay),a):this._time/this.duration()||0},r.totalProgress=function(s,a){return arguments.length?this.totalTime(this.totalDuration()*s,a):this._totalTime/this.totalDuration()||0},r.totalDuration=function(s){return arguments.length?this._repeat===-1||!s?this:this.timeScale(this.totalDuration()/s):(this._dirty&&(rt.prototype.totalDuration.call(this),this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},r.time=function(s,a){return arguments.length?(this._dirty&&this.totalDuration(),s>this._duration&&(s=this._duration),this._yoyo&&this._cycle&1?s=this._duration-s+this._cycle*(this._duration+this._repeatDelay):this._repeat!==0&&(s+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(s,a)):this._time},r.repeat=function(s){return arguments.length?(this._repeat=s,this._uncache(!0)):this._repeat},r.repeatDelay=function(s){return arguments.length?(this._repeatDelay=s,this._uncache(!0)):this._repeatDelay},r.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},r.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.getLabelBefore(this._time+1e-8)},D},!0),function(){var rt=180/Math.PI,vt=[],B=[],D=[],p={},l=ei._gsDefine.globals,n=function(h,u,m,g){m===g&&(m=g-(g-u)/1e6),h===u&&(u=h+(m-h)/1e6),this.a=h,this.b=u,this.c=m,this.d=g,this.da=g-h,this.ca=m-h,this.ba=u-h},e=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",i=function(h,u,m,g){var _={a:h},y={},v={},b={c:g},R=(h+u)/2,M=(u+m)/2,P=(m+g)/2,T=(R+M)/2,E=(M+P)/2,x=(E-T)/8;return _.b=R+(h-R)/4,y.b=T+x,_.c=y.a=(_.b+y.b)/2,y.c=v.a=(T+E)/2,v.b=E-x,b.b=P+(g-P)/4,v.c=b.a=(v.b+b.b)/2,[_,y,v,b]},t=function(h,u,m,g,_){var y=h.length-1,v=0,b=h[0].a,R,M,P,T,E,x,S,L,C,F,q,it,st;for(R=0;R<y;R++)E=h[v],M=E.a,P=E.d,T=h[v+1].d,_?(q=vt[R],it=B[R],st=(it+q)*u*.25/(g?.5:D[R]||.5),x=P-(P-M)*(g?u*.5:q!==0?st/q:0),S=P+(T-P)*(g?u*.5:it!==0?st/it:0),L=P-(x+((S-x)*(q*3/(q+it)+.5)/4||0))):(x=P-(P-M)*u*.5,S=P+(T-P)*u*.5,L=P-(x+S)/2),x+=L,S+=L,E.c=C=x,R!==0?E.b=b:E.b=b=E.a+(E.c-E.a)*.6,E.da=P-M,E.ca=C-M,E.ba=b-M,m?(F=i(M,b,C,P),h.splice(v,1,F[0],F[1],F[2],F[3]),v+=4):v++,b=S;E=h[v],E.b=b,E.c=b+(E.d-b)*.4,E.da=E.d-E.a,E.ca=E.c-E.a,E.ba=b-E.a,m&&(F=i(E.a,b,E.c,E.d),h.splice(v,1,F[0],F[1],F[2],F[3]))},r=function(h,u,m,g){var _=[],y,v,b,R,M,P;if(g)for(h=[g].concat(h),v=h.length;--v>-1;)typeof(P=h[v][u])=="string"&&P.charAt(1)==="="&&(h[v][u]=g[u]+Number(P.charAt(0)+P.substr(2)));if(y=h.length-2,y<0)return _[0]=new n(h[0][u],0,0,h[0][u]),_;for(v=0;v<y;v++)b=h[v][u],R=h[v+1][u],_[v]=new n(b,0,0,R),m&&(M=h[v+2][u],vt[v]=(vt[v]||0)+(R-b)*(R-b),B[v]=(B[v]||0)+(M-R)*(M-R));return _[v]=new n(h[v][u],0,0,h[v+1][u]),_},s=function(h,u,m,g,_,y){var v={},b=[],R=y||h[0],M,P,T,E,x,S,L,C;_=typeof _=="string"?","+_+",":e,u==null&&(u=1);for(P in h[0])b.push(P);if(h.length>1){for(C=h[h.length-1],L=!0,M=b.length;--M>-1;)if(P=b[M],Math.abs(R[P]-C[P])>.05){L=!1;break}L&&(h=h.concat(),y&&h.unshift(y),h.push(h[1]),y=h[h.length-3])}for(vt.length=B.length=D.length=0,M=b.length;--M>-1;)P=b[M],p[P]=_.indexOf(","+P+",")!==-1,v[P]=r(h,P,p[P],y);for(M=vt.length;--M>-1;)vt[M]=Math.sqrt(vt[M]),B[M]=Math.sqrt(B[M]);if(!g){for(M=b.length;--M>-1;)if(p[P])for(T=v[b[M]],S=T.length-1,E=0;E<S;E++)x=T[E+1].da/B[E]+T[E].da/vt[E]||0,D[E]=(D[E]||0)+x*x;for(M=D.length;--M>-1;)D[M]=Math.sqrt(D[M])}for(M=b.length,E=m?4:1;--M>-1;)P=b[M],T=v[P],t(T,u,m,g,p[P]),L&&(T.splice(0,E),T.splice(T.length-E,E));return v},a=function(h,u,m){u=u||"soft";var g={},_=u==="cubic"?3:2,y=u==="soft",v=[],b,R,M,P,T,E,x,S,L,C,F;if(y&&m&&(h=[m].concat(h)),h==null||h.length<_+1)throw"invalid Bezier data";for(L in h[0])v.push(L);for(E=v.length;--E>-1;){for(L=v[E],g[L]=T=[],C=0,S=h.length,x=0;x<S;x++)b=m==null?h[x][L]:typeof(F=h[x][L])=="string"&&F.charAt(1)==="="?m[L]+Number(F.charAt(0)+F.substr(2)):Number(F),y&&x>1&&x<S-1&&(T[C++]=(b+T[C-2])/2),T[C++]=b;for(S=C-_+1,C=0,x=0;x<S;x+=_)b=T[x],R=T[x+1],M=T[x+2],P=_===2?0:T[x+3],T[C++]=F=_===3?new n(b,R,M,P):new n(b,(2*R+b)/3,(2*R+M)/3,M);T.length=C}return g},f=function(h,u,m){for(var g=1/m,_=h.length,y,v,b,R,M,P,T,E,x,S,L;--_>-1;)for(S=h[_],b=S.a,R=S.d-b,M=S.c-b,P=S.b-b,y=v=0,E=1;E<=m;E++)T=g*E,x=1-T,y=v-(v=(T*T*R+3*x*(T*M+x*P))*T),L=_*m+E-1,u[L]=(u[L]||0)+y*y},o=function(h,u){u=u>>0||6;var m=[],g=[],_=0,y=0,v=u-1,b=[],R=[],M,P,T,E;for(M in h)f(h[M],m,u);for(T=m.length,P=0;P<T;P++)_+=Math.sqrt(m[P]),E=P%u,R[E]=_,E===v&&(y+=_,E=P/u>>0,b[E]=R,g[E]=y,_=0,R=[]);return{length:y,lengths:g,segments:b}},c=ei._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.8",API:2,global:!0,init:function(h,u,m){this._target=h,u instanceof Array&&(u={values:u}),this._func={},this._mod={},this._props=[],this._timeRes=u.timeResolution==null?6:parseInt(u.timeResolution,10);var g=u.values||[],_={},y=g[0],v=u.autoRotate||m.vars.orientToBezier,b,R,M,P,T;this._autoRotate=v?v instanceof Array?v:[["x","y","rotation",v===!0?0:Number(v)||0]]:null;for(b in y)this._props.push(b);for(M=this._props.length;--M>-1;)b=this._props[M],this._overwriteProps.push(b),R=this._func[b]=typeof h[b]=="function",_[b]=R?h[b.indexOf("set")||typeof h["get"+b.substr(3)]!="function"?b:"get"+b.substr(3)]():parseFloat(h[b]),T||_[b]!==g[0][b]&&(T=_);if(this._beziers=u.type!=="cubic"&&u.type!=="quadratic"&&u.type!=="soft"?s(g,isNaN(u.curviness)?1:u.curviness,!1,u.type==="thruBasic",u.correlate,T):a(g,u.type,_),this._segCount=this._beziers[b].length,this._timeRes){var E=o(this._beziers,this._timeRes);this._length=E.length,this._lengths=E.lengths,this._segments=E.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(v=this._autoRotate)for(this._initialRotations=[],v[0]instanceof Array||(this._autoRotate=v=[v]),M=v.length;--M>-1;){for(P=0;P<3;P++)b=v[M][P],this._func[b]=typeof h[b]=="function"?h[b.indexOf("set")||typeof h["get"+b.substr(3)]!="function"?b:"get"+b.substr(3)]:!1;b=v[M][2],this._initialRotations[M]=(this._func[b]?this._func[b].call(this._target):this._target[b])||0,this._overwriteProps.push(b)}return this._startRatio=m.vars.runBackwards?1:0,!0},set:function(h){var u=this._segCount,m=this._func,g=this._target,_=h!==this._startRatio,y,v,b,R,M,P,T,E,x,S;if(!this._timeRes)y=h<0?0:h>=1?u-1:u*h>>0,P=(h-y*(1/u))*u;else{if(x=this._lengths,S=this._curSeg,h*=this._length,b=this._li,h>this._l2&&b<u-1){for(E=u-1;b<E&&(this._l2=x[++b])<=h;);this._l1=x[b-1],this._li=b,this._curSeg=S=this._segments[b],this._s2=S[this._s1=this._si=0]}else if(h<this._l1&&b>0){for(;b>0&&(this._l1=x[--b])>=h;);b===0&&h<this._l1?this._l1=0:b++,this._l2=x[b],this._li=b,this._curSeg=S=this._segments[b],this._s1=S[(this._si=S.length-1)-1]||0,this._s2=S[this._si]}if(y=b,h-=this._l1,b=this._si,h>this._s2&&b<S.length-1){for(E=S.length-1;b<E&&(this._s2=S[++b])<=h;);this._s1=S[b-1],this._si=b}else if(h<this._s1&&b>0){for(;b>0&&(this._s1=S[--b])>=h;);b===0&&h<this._s1?this._s1=0:b++,this._s2=S[b],this._si=b}P=(b+(h-this._s1)/(this._s2-this._s1))*this._prec||0}for(v=1-P,b=this._props.length;--b>-1;)R=this._props[b],M=this._beziers[R][y],T=(P*P*M.da+3*v*(P*M.ca+v*M.ba))*P+M.a,this._mod[R]&&(T=this._mod[R](T,g)),m[R]?g[R](T):g[R]=T;if(this._autoRotate){var L=this._autoRotate,C,F,q,it,st,pt,_t;for(b=L.length;--b>-1;)R=L[b][2],pt=L[b][3]||0,_t=L[b][4]===!0?1:rt,M=this._beziers[L[b][0]],C=this._beziers[L[b][1]],M&&C&&(M=M[y],C=C[y],F=M.a+(M.b-M.a)*P,it=M.b+(M.c-M.b)*P,F+=(it-F)*P,it+=(M.c+(M.d-M.c)*P-it)*P,q=C.a+(C.b-C.a)*P,st=C.b+(C.c-C.b)*P,q+=(st-q)*P,st+=(C.c+(C.d-C.c)*P-st)*P,T=_?Math.atan2(st-q,it-F)*_t+pt:this._initialRotations[b],this._mod[R]&&(T=this._mod[R](T,g)),m[R]?g[R](T):g[R]=T)}}}),d=c.prototype;c.bezierThrough=s,c.cubicToQuadratic=i,c._autoCSS=!0,c.quadraticToCubic=function(h,u,m){return new n(h,(2*u+h)/3,(2*u+m)/3,m)},c._cssRegister=function(){var h=l.CSSPlugin;if(h){var u=h._internals,m=u._parseToProxy,g=u._setPluginRatio,_=u.CSSPropTween;u._registerComplexSpecialProp("bezier",{parser:function(y,v,b,R,M,P){v instanceof Array&&(v={values:v}),P=new c;var T=v.values,E=T.length-1,x=[],S={},L,C,F;if(E<0)return M;for(L=0;L<=E;L++)F=m(y,T[L],R,M,P,E!==L),x[L]=F.end;for(C in v)S[C]=v[C];return S.values=x,M=new _(y,"bezier",0,0,F.pt,2),M.data=F,M.plugin=P,M.setRatio=g,S.autoRotate===0&&(S.autoRotate=!0),S.autoRotate&&!(S.autoRotate instanceof Array)&&(L=S.autoRotate===!0?0:Number(S.autoRotate),S.autoRotate=F.end.left!=null?[["left","top","rotation",L,!1]]:F.end.x!=null?[["x","y","rotation",L,!1]]:!1),S.autoRotate&&(R._transform||R._enableTransforms(!1),F.autoRotate=R._target._gsTransform,F.proxy.rotation=F.autoRotate.rotation||0,R._overwriteProps.push("rotation")),P._onInitTween(F.proxy,S,R._tween),M}})}},d._mod=function(h){for(var u=this._overwriteProps,m=u.length,g;--m>-1;)g=h[u[m]],g&&typeof g=="function"&&(this._mod[u[m]]=g)},d._kill=function(h){var u=this._props,m,g;for(m in this._beziers)if(m in h)for(delete this._beziers[m],delete this._func[m],g=u.length;--g>-1;)u[g]===m&&u.splice(g,1);if(u=this._autoRotate,u)for(g=u.length;--g>-1;)h[u[g][2]]&&u.splice(g,1);return this._super._kill.call(this,h)}}(),ei._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(rt,vt){var B=function(){rt.call(this,"css"),this._overwriteProps.length=0,this.setRatio=B.prototype.setRatio},D=ei._gsDefine.globals,p,l,n,e,i={},t=B.prototype=new rt("css");t.constructor=B,B.version="2.0.2",B.API=2,B.defaultTransformPerspective=0,B.defaultSkewType="compensated",B.defaultSmoothOrigin=!0,t="px",B.suffixMap={top:t,right:t,bottom:t,left:t,width:t,height:t,fontSize:t,padding:t,margin:t,perspective:t,lineHeight:""};var r=/(?:\-|\.|\b)(\d|\.|e\-)+/g,s=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,a=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,f=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,o=/(?:\d|\-|\+|=|#|\.)*/g,c=/opacity *= *([^)]*)/i,d=/opacity:([^;]*)/i,h=/alpha\(opacity *=.+?\)/i,u=/^(rgb|hsl)/,m=/([A-Z])/g,g=/-([a-z])/gi,_=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,y=function(O,I){return I.toUpperCase()},v=/(?:Left|Right|Width)/i,b=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,R=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,M=/,(?=[^\)]*(?:\(|$))/gi,P=/[\s,\(]/i,T=Math.PI/180,E=180/Math.PI,x={},S={style:{}},L=ei.document||{createElement:function(){return S}},C=function(O,I){return L.createElementNS?L.createElementNS(I||"http://www.w3.org/1999/xhtml",O):L.createElement(O)},F=C("div"),q=C("img"),it=B._internals={_specialProps:i},st=(ei.navigator||{}).userAgent||"",pt,_t,X,ot,Tt,Vt,Gt=function(){var O=st.indexOf("Android"),I=C("a");return X=st.indexOf("Safari")!==-1&&st.indexOf("Chrome")===-1&&(O===-1||parseFloat(st.substr(O+8,2))>3),Tt=X&&parseFloat(st.substr(st.indexOf("Version/")+8,2))<6,ot=st.indexOf("Firefox")!==-1,(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(st)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(st))&&(Vt=parseFloat(RegExp.$1)),I?(I.style.cssText="top:1px;opacity:.55;",/^0.55/.test(I.style.opacity)):!1}(),qt=function(O){return c.test(typeof O=="string"?O:(O.currentStyle?O.currentStyle.filter:O.style.filter)||"")?parseFloat(RegExp.$1)/100:1},Qt=function(O){ei.console&&console.log(O)},ne,j,J="",at="",xt=function(O,I){I=I||F;var V=I.style,H,G;if(V[O]!==void 0)return O;for(O=O.charAt(0).toUpperCase()+O.substr(1),H=["O","Moz","ms","Ms","Webkit"],G=5;--G>-1&&V[H[G]+O]===void 0;);return G>=0?(at=G===3?"ms":H[G],J="-"+at.toLowerCase()+"-",at+O):null},Rt=(typeof window<"u"?window:L.defaultView||{getComputedStyle:function(){}}).getComputedStyle,Lt=B.getStyle=function(O,I,V,H,G){var Q;return!Gt&&I==="opacity"?qt(O):(!H&&O.style[I]?Q=O.style[I]:(V=V||Rt(O))?Q=V[I]||V.getPropertyValue(I)||V.getPropertyValue(I.replace(m,"-$1").toLowerCase()):O.currentStyle&&(Q=O.currentStyle[I]),G!=null&&(!Q||Q==="none"||Q==="auto"||Q==="auto auto")?G:Q)},te=it.convertToPixels=function(O,I,V,H,G){if(H==="px"||!H&&I!=="lineHeight")return V;if(H==="auto"||!V)return 0;var Q=v.test(I),tt=O,ut=F.style,dt=V<0,Pt=V===1,bt,Ct,kt;if(dt&&(V=-V),Pt&&(V*=100),I==="lineHeight"&&!H)Ct=Rt(O).lineHeight,O.style.lineHeight=V,bt=parseFloat(Rt(O).lineHeight),O.style.lineHeight=Ct;else if(H==="%"&&I.indexOf("border")!==-1)bt=V/100*(Q?O.clientWidth:O.clientHeight);else{if(ut.cssText="border:0 solid red;position:"+Lt(O,"position")+";line-height:0;",H==="%"||!tt.appendChild||H.charAt(0)==="v"||H==="rem"){if(tt=O.parentNode||L.body,Lt(tt,"display").indexOf("flex")!==-1&&(ut.position="absolute"),Ct=tt._gsCache,kt=vt.ticker.frame,Ct&&Q&&Ct.time===kt)return Ct.width*V/100;ut[Q?"width":"height"]=V+H}else ut[Q?"borderLeftWidth":"borderTopWidth"]=V+H;tt.appendChild(F),bt=parseFloat(F[Q?"offsetWidth":"offsetHeight"]),tt.removeChild(F),Q&&H==="%"&&B.cacheWidths!==!1&&(Ct=tt._gsCache=tt._gsCache||{},Ct.time=kt,Ct.width=bt/V*100),bt===0&&!G&&(bt=te(O,I,V,H,!0))}return Pt&&(bt/=100),dt?-bt:bt},zt=it.calculateOffset=function(O,I,V){if(Lt(O,"position",V)!=="absolute")return 0;var H=I==="left"?"Left":"Top",G=Lt(O,"margin"+H,V);return O["offset"+H]-(te(O,I,parseFloat(G),G.replace(o,""))||0)},ee=function(O,I){var V={},H,G,Q;if(I=I||Rt(O,null))if(H=I.length)for(;--H>-1;)Q=I[H],(Q.indexOf("-transform")===-1||pe===Q)&&(V[Q.replace(g,y)]=I.getPropertyValue(Q));else for(H in I)(H.indexOf("Transform")===-1||Ee===H)&&(V[H]=I[H]);else if(I=O.currentStyle||O.style)for(H in I)typeof H=="string"&&V[H]===void 0&&(V[H.replace(g,y)]=I[H]);return Gt||(V.opacity=qt(O)),G=li(O,I,!1),V.rotation=G.rotation,V.skewX=G.skewX,V.scaleX=G.scaleX,V.scaleY=G.scaleY,V.x=G.x,V.y=G.y,Qe&&(V.z=G.z,V.rotationX=G.rotationX,V.rotationY=G.rotationY,V.scaleZ=G.scaleZ),V.filters&&delete V.filters,V},$=function(O,I,V,H,G){var Q={},tt=O.style,ut,dt,Pt;for(dt in V)dt!=="cssText"&&dt!=="length"&&isNaN(dt)&&(I[dt]!==(ut=V[dt])||G&&G[dt])&&dt.indexOf("Origin")===-1&&(typeof ut=="number"||typeof ut=="string")&&(Q[dt]=ut==="auto"&&(dt==="left"||dt==="top")?zt(O,dt):(ut===""||ut==="auto"||ut==="none")&&typeof I[dt]=="string"&&I[dt].replace(f,"")!==""?0:ut,tt[dt]!==void 0&&(Pt=new z(tt,dt,tt[dt],Pt)));if(H)for(dt in H)dt!=="className"&&(Q[dt]=H[dt]);return{difs:Q,firstMPT:Pt}},N={width:["Left","Right"],height:["Top","Bottom"]},K=["marginLeft","marginRight","marginTop","marginBottom"],k=function(O,I,V){if((O.nodeName+"").toLowerCase()==="svg")return(V||Rt(O))[I]||0;if(O.getCTM&&ri(O))return O.getBBox()[I]||0;var H=parseFloat(I==="width"?O.offsetWidth:O.offsetHeight),G=N[I],Q=G.length;for(V=V||Rt(O,null);--Q>-1;)H-=parseFloat(Lt(O,"padding"+G[Q],V,!0))||0,H-=parseFloat(Lt(O,"border"+G[Q]+"Width",V,!0))||0;return H},Y=function(O,I){if(O==="contain"||O==="auto"||O==="auto auto")return O+" ";(O==null||O==="")&&(O="0 0");var V=O.split(" "),H=O.indexOf("left")!==-1?"0%":O.indexOf("right")!==-1?"100%":V[0],G=O.indexOf("top")!==-1?"0%":O.indexOf("bottom")!==-1?"100%":V[1],Q;if(V.length>3&&!I){for(V=O.split(", ").join(",").split(","),O=[],Q=0;Q<V.length;Q++)O.push(Y(V[Q]));return O.join(",")}return G==null?G=H==="center"?"50%":"0":G==="center"&&(G="50%"),(H==="center"||isNaN(parseFloat(H))&&(H+"").indexOf("=")===-1)&&(H="50%"),O=H+" "+G+(V.length>2?" "+V[2]:""),I&&(I.oxp=H.indexOf("%")!==-1,I.oyp=G.indexOf("%")!==-1,I.oxr=H.charAt(1)==="=",I.oyr=G.charAt(1)==="=",I.ox=parseFloat(H.replace(f,"")),I.oy=parseFloat(G.replace(f,"")),I.v=O),I||O},ht=function(O,I){return typeof O=="function"&&(O=O(j,ne)),typeof O=="string"&&O.charAt(1)==="="?parseInt(O.charAt(0)+"1",10)*parseFloat(O.substr(2)):parseFloat(O)-parseFloat(I)||0},wt=function(O,I){typeof O=="function"&&(O=O(j,ne));var V=typeof O=="string"&&O.charAt(1)==="=";return typeof O=="string"&&O.charAt(O.length-2)==="v"&&(O=(V?O.substr(0,2):0)+window["inner"+(O.substr(-2)==="vh"?"Height":"Width")]*(parseFloat(V?O.substr(2):O)/100)),O==null?I:V?parseInt(O.charAt(0)+"1",10)*parseFloat(O.substr(2))+I:parseFloat(O)||0},Et=function(O,I,V,H){var G=1e-6,Q,tt,ut,dt,Pt;return typeof O=="function"&&(O=O(j,ne)),O==null?dt=I:typeof O=="number"?dt=O:(Q=360,tt=O.split("_"),Pt=O.charAt(1)==="=",ut=(Pt?parseInt(O.charAt(0)+"1",10)*parseFloat(tt[0].substr(2)):parseFloat(tt[0]))*(O.indexOf("rad")===-1?1:E)-(Pt?0:I),tt.length&&(H&&(H[V]=I+ut),O.indexOf("short")!==-1&&(ut=ut%Q,ut!==ut%(Q/2)&&(ut=ut<0?ut+Q:ut-Q)),O.indexOf("_cw")!==-1&&ut<0?ut=(ut+Q*9999999999)%Q-(ut/Q|0)*Q:O.indexOf("ccw")!==-1&&ut>0&&(ut=(ut-Q*9999999999)%Q-(ut/Q|0)*Q)),dt=I+ut),dt<G&&dt>-G&&(dt=0),dt},Mt={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},Dt=function(O,I,V){return O=O<0?O+1:O>1?O-1:O,(O*6<1?I+(V-I)*O*6:O<.5?V:O*3<2?I+(V-I)*(2/3-O)*6:I)*255+.5|0},At=B.parseColor=function(O,I){var V,H,G,Q,tt,ut,dt,Pt,bt,Ct,kt;if(!O)V=Mt.black;else if(typeof O=="number")V=[O>>16,O>>8&255,O&255];else{if(O.charAt(O.length-1)===","&&(O=O.substr(0,O.length-1)),Mt[O])V=Mt[O];else if(O.charAt(0)==="#")O.length===4&&(H=O.charAt(1),G=O.charAt(2),Q=O.charAt(3),O="#"+H+H+G+G+Q+Q),O=parseInt(O.substr(1),16),V=[O>>16,O>>8&255,O&255];else if(O.substr(0,3)==="hsl"){if(V=kt=O.match(r),!I)tt=Number(V[0])%360/360,ut=Number(V[1])/100,dt=Number(V[2])/100,G=dt<=.5?dt*(ut+1):dt+ut-dt*ut,H=dt*2-G,V.length>3&&(V[3]=Number(V[3])),V[0]=Dt(tt+1/3,H,G),V[1]=Dt(tt,H,G),V[2]=Dt(tt-1/3,H,G);else if(O.indexOf("=")!==-1)return O.match(s)}else V=O.match(r)||Mt.transparent;V[0]=Number(V[0]),V[1]=Number(V[1]),V[2]=Number(V[2]),V.length>3&&(V[3]=Number(V[3]))}return I&&!kt&&(H=V[0]/255,G=V[1]/255,Q=V[2]/255,Pt=Math.max(H,G,Q),bt=Math.min(H,G,Q),dt=(Pt+bt)/2,Pt===bt?tt=ut=0:(Ct=Pt-bt,ut=dt>.5?Ct/(2-Pt-bt):Ct/(Pt+bt),tt=Pt===H?(G-Q)/Ct+(G<Q?6:0):Pt===G?(Q-H)/Ct+2:(H-G)/Ct+4,tt*=60),V[0]=tt+.5|0,V[1]=ut*100+.5|0,V[2]=dt*100+.5|0),V},Xt=function(O,I){var V=O.match(ie)||[],H=0,G="",Q,tt,ut;if(!V.length)return O;for(Q=0;Q<V.length;Q++)tt=V[Q],ut=O.substr(H,O.indexOf(tt,H)-H),H+=ut.length+tt.length,tt=At(tt,I),tt.length===3&&tt.push(1),G+=ut+(I?"hsla("+tt[0]+","+tt[1]+"%,"+tt[2]+"%,"+tt[3]:"rgba("+tt.join(","))+")";return G+O.substr(H)},ie="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(t in Mt)ie+="|"+t+"\\b";ie=new RegExp(ie+")","gi"),B.colorStringFilter=function(O){var I=O[0]+" "+O[1],V;ie.test(I)&&(V=I.indexOf("hsl(")!==-1||I.indexOf("hsla(")!==-1,O[0]=Xt(O[0],V),O[1]=Xt(O[1],V)),ie.lastIndex=0},vt.defaultStringFilter||(vt.defaultStringFilter=B.colorStringFilter);var le=function(O,I,V,H){if(O==null)return function(kt){return kt};var G=I?(O.match(ie)||[""])[0]:"",Q=O.split(G).join("").match(a)||[],tt=O.substr(0,O.indexOf(Q[0])),ut=O.charAt(O.length-1)===")"?")":"",dt=O.indexOf(" ")!==-1?" ":",",Pt=Q.length,bt=Pt>0?Q[0].replace(r,""):"",Ct;return Pt?I?(Ct=function(kt){var Ot,Wt,Ut,Nt;if(typeof kt=="number")kt+=bt;else if(H&&M.test(kt)){for(Nt=kt.replace(M,"|").split("|"),Ut=0;Ut<Nt.length;Ut++)Nt[Ut]=Ct(Nt[Ut]);return Nt.join(",")}if(Ot=(kt.match(ie)||[G])[0],Wt=kt.split(Ot).join("").match(a)||[],Ut=Wt.length,Pt>Ut--)for(;++Ut<Pt;)Wt[Ut]=V?Wt[(Ut-1)/2|0]:Q[Ut];return tt+Wt.join(dt)+dt+Ot+ut+(kt.indexOf("inset")!==-1?" inset":"")},Ct):(Ct=function(kt){var Ot,Wt,Ut;if(typeof kt=="number")kt+=bt;else if(H&&M.test(kt)){for(Wt=kt.replace(M,"|").split("|"),Ut=0;Ut<Wt.length;Ut++)Wt[Ut]=Ct(Wt[Ut]);return Wt.join(",")}if(Ot=kt.match(a)||[],Ut=Ot.length,Pt>Ut--)for(;++Ut<Pt;)Ot[Ut]=V?Ot[(Ut-1)/2|0]:Q[Ut];return tt+Ot.join(dt)+ut},Ct):function(kt){return kt}},W=function(O){return O=O.split(","),function(I,V,H,G,Q,tt,ut){var dt=(V+"").split(" "),Pt;for(ut={},Pt=0;Pt<4;Pt++)ut[O[Pt]]=dt[Pt]=dt[Pt]||dt[(Pt-1)/2>>0];return G.parse(I,ut,Q,tt)}},ct=it._setPluginRatio=function(O){this.plugin.setRatio(O);for(var I=this.data,V=I.proxy,H=I.firstMPT,G=1e-6,Q,tt,ut,dt,Pt;H;)Q=V[H.v],H.r?Q=H.r(Q):Q<G&&Q>-G&&(Q=0),H.t[H.p]=Q,H=H._next;if(I.autoRotate&&(I.autoRotate.rotation=I.mod?I.mod.call(this._tween,V.rotation,this.t,this._tween):V.rotation),O===1||O===0)for(H=I.firstMPT,Pt=O===1?"e":"b";H;){if(tt=H.t,!tt.type)tt[Pt]=tt.s+tt.xs0;else if(tt.type===1){for(dt=tt.xs0+tt.s+tt.xs1,ut=1;ut<tt.l;ut++)dt+=tt["xn"+ut]+tt["xs"+(ut+1)];tt[Pt]=dt}H=H._next}},z=function(O,I,V,H,G){this.t=O,this.p=I,this.v=V,this.r=G,H&&(H._prev=this,this._next=H)},nt=it._parseToProxy=function(O,I,V,H,G,Q){var tt=H,ut={},dt={},Pt=V._transform,bt=x,Ct,kt,Ot,Wt,Ut;for(V._transform=null,x=I,H=Ut=V.parse(O,I,H,G),x=bt,Q&&(V._transform=Pt,tt&&(tt._prev=null,tt._prev&&(tt._prev._next=null)));H&&H!==tt;){if(H.type<=1&&(kt=H.p,dt[kt]=H.s+H.c,ut[kt]=H.s,Q||(Wt=new z(H,"s",kt,Wt,H.r),H.c=0),H.type===1))for(Ct=H.l;--Ct>0;)Ot="xn"+Ct,kt=H.p+"_"+Ot,dt[kt]=H.data[Ot],ut[kt]=H[Ot],Q||(Wt=new z(H,Ot,kt,Wt,H.rxp[Ot]));H=H._next}return{proxy:ut,end:dt,firstMPT:Wt,pt:Ut}},Ht=it.CSSPropTween=function(O,I,V,H,G,Q,tt,ut,dt,Pt,bt){this.t=O,this.p=I,this.s=V,this.c=H,this.n=tt||I,O instanceof Ht||e.push(this.n),this.r=ut&&(typeof ut=="function"?ut:Math.round),this.type=Q||0,dt&&(this.pr=dt,p=!0),this.b=Pt===void 0?V:Pt,this.e=bt===void 0?V+H:bt,G&&(this._next=G,G._prev=this)},Kt=function(O,I,V,H,G,Q){var tt=new Ht(O,I,V,H-V,G,-1,Q);return tt.b=V,tt.e=tt.xs0=H,tt},fe=B.parseComplex=function(O,I,V,H,G,Q,tt,ut,dt,Pt){V=V||Q||"",typeof H=="function"&&(H=H(j,ne)),tt=new Ht(O,I,0,0,tt,Pt?2:1,null,!1,ut,V,H),H+="",G&&ie.test(H+V)&&(H=[V,H],B.colorStringFilter(H),V=H[0],H=H[1]);var bt=V.split(", ").join(",").split(" "),Ct=H.split(", ").join(",").split(" "),kt=bt.length,Ot=pt!==!1,Wt,Ut,Nt,Yt,Zt,se,oe,ue,ce,ge,_e,Pe,Se;for((H.indexOf(",")!==-1||V.indexOf(",")!==-1)&&((H+V).indexOf("rgb")!==-1||(H+V).indexOf("hsl")!==-1?(bt=bt.join(" ").replace(M,", ").split(" "),Ct=Ct.join(" ").replace(M,", ").split(" ")):(bt=bt.join(" ").split(",").join(", ").split(" "),Ct=Ct.join(" ").split(",").join(", ").split(" ")),kt=bt.length),kt!==Ct.length&&(bt=(Q||"").split(" "),kt=bt.length),tt.plugin=dt,tt.setRatio=Pt,ie.lastIndex=0,Wt=0;Wt<kt;Wt++)if(Yt=bt[Wt],Zt=Ct[Wt]+"",ue=parseFloat(Yt),ue||ue===0)tt.appendXtra("",ue,ht(Zt,ue),Zt.replace(s,""),Ot&&Zt.indexOf("px")!==-1?Math.round:!1,!0);else if(G&&ie.test(Yt))Pe=Zt.indexOf(")")+1,Pe=")"+(Pe?Zt.substr(Pe):""),Se=Zt.indexOf("hsl")!==-1&&Gt,ge=Zt,Yt=At(Yt,Se),Zt=At(Zt,Se),ce=Yt.length+Zt.length>6,ce&&!Gt&&Zt[3]===0?(tt["xs"+tt.l]+=tt.l?" transparent":"transparent",tt.e=tt.e.split(Ct[Wt]).join("transparent")):(Gt||(ce=!1),Se?tt.appendXtra(ge.substr(0,ge.indexOf("hsl"))+(ce?"hsla(":"hsl("),Yt[0],ht(Zt[0],Yt[0]),",",!1,!0).appendXtra("",Yt[1],ht(Zt[1],Yt[1]),"%,",!1).appendXtra("",Yt[2],ht(Zt[2],Yt[2]),ce?"%,":"%"+Pe,!1):tt.appendXtra(ge.substr(0,ge.indexOf("rgb"))+(ce?"rgba(":"rgb("),Yt[0],Zt[0]-Yt[0],",",Math.round,!0).appendXtra("",Yt[1],Zt[1]-Yt[1],",",Math.round).appendXtra("",Yt[2],Zt[2]-Yt[2],ce?",":Pe,Math.round),ce&&(Yt=Yt.length<4?1:Yt[3],tt.appendXtra("",Yt,(Zt.length<4?1:Zt[3])-Yt,Pe,!1))),ie.lastIndex=0;else if(se=Yt.match(r),!se)tt["xs"+tt.l]+=tt.l||tt["xs"+tt.l]?" "+Zt:Zt;else{if(oe=Zt.match(s),!oe||oe.length!==se.length)return tt;for(Nt=0,Ut=0;Ut<se.length;Ut++)_e=se[Ut],ge=Yt.indexOf(_e,Nt),tt.appendXtra(Yt.substr(Nt,ge-Nt),Number(_e),ht(oe[Ut],_e),"",Ot&&Yt.substr(ge+_e.length,2)==="px"?Math.round:!1,Ut===0),Nt=ge+_e.length;tt["xs"+tt.l]+=Yt.substr(Nt)}if(H.indexOf("=")!==-1&&tt.data){for(Pe=tt.xs0+tt.data.s,Wt=1;Wt<tt.l;Wt++)Pe+=tt["xs"+Wt]+tt.data["xn"+Wt];tt.e=Pe+tt["xs"+Wt]}return tt.l||(tt.type=-1,tt.xs0=tt.e),tt.xfirst||tt},Ft=9;for(t=Ht.prototype,t.l=t.pr=0;--Ft>0;)t["xn"+Ft]=0,t["xs"+Ft]="";t.xs0="",t._next=t._prev=t.xfirst=t.data=t.plugin=t.setRatio=t.rxp=null,t.appendXtra=function(O,I,V,H,G,Q){var tt=this,ut=tt.l;return tt["xs"+ut]+=Q&&(ut||tt["xs"+ut])?" "+O:O||"",!V&&ut!==0&&!tt.plugin?(tt["xs"+ut]+=I+(H||""),tt):(tt.l++,tt.type=tt.setRatio?2:1,tt["xs"+tt.l]=H||"",ut>0?(tt.data["xn"+ut]=I+V,tt.rxp["xn"+ut]=G,tt["xn"+ut]=I,tt.plugin||(tt.xfirst=new Ht(tt,"xn"+ut,I,V,tt.xfirst||tt,0,tt.n,G,tt.pr),tt.xfirst.xs0=0),tt):(tt.data={s:I+V},tt.rxp={},tt.s=I,tt.c=V,tt.r=G,tt))};var he=function(O,I){I=I||{},this.p=I.prefix&&xt(O)||O,i[O]=i[this.p]=this,this.format=I.formatter||le(I.defaultValue,I.color,I.collapsible,I.multi),I.parser&&(this.parse=I.parser),this.clrs=I.color,this.multi=I.multi,this.keyword=I.keyword,this.dflt=I.defaultValue,this.pr=I.priority||0},Bt=it._registerComplexSpecialProp=function(O,I,V){typeof I!="object"&&(I={parser:V});var H=O.split(","),G=I.defaultValue,Q,tt;for(V=V||[G],Q=0;Q<H.length;Q++)I.prefix=Q===0&&I.prefix,I.defaultValue=V[Q]||G,tt=new he(H[Q],I)},$t=it._registerPluginProp=function(O){if(!i[O]){var I=O.charAt(0).toUpperCase()+O.substr(1)+"Plugin";Bt(O,{parser:function(V,H,G,Q,tt,ut,dt){var Pt=D.com.greensock.plugins[I];return Pt?(Pt._cssRegister(),i[G].parse(V,H,G,Q,tt,ut,dt)):(Qt("Error: "+I+" js file not loaded."),tt)}})}};t=he.prototype,t.parseComplex=function(O,I,V,H,G,Q){var tt=this.keyword,ut,dt,Pt,bt,Ct,kt;if(this.multi&&(M.test(V)||M.test(I)?(dt=I.replace(M,"|").split("|"),Pt=V.replace(M,"|").split("|")):tt&&(dt=[I],Pt=[V])),Pt){for(bt=Pt.length>dt.length?Pt.length:dt.length,ut=0;ut<bt;ut++)I=dt[ut]=dt[ut]||this.dflt,V=Pt[ut]=Pt[ut]||this.dflt,tt&&(Ct=I.indexOf(tt),kt=V.indexOf(tt),Ct!==kt&&(kt===-1?dt[ut]=dt[ut].split(tt).join(""):Ct===-1&&(dt[ut]+=" "+tt)));I=dt.join(", "),V=Pt.join(", ")}return fe(O,this.p,I,V,this.clrs,this.dflt,H,this.pr,G,Q)},t.parse=function(O,I,V,H,G,Q,tt){return this.parseComplex(O.style,this.format(Lt(O,this.p,n,!1,this.dflt)),this.format(I),G,Q)},B.registerSpecialProp=function(O,I,V){Bt(O,{parser:function(H,G,Q,tt,ut,dt,Pt){var bt=new Ht(H,Q,0,0,ut,2,Q,!1,V);return bt.plugin=dt,bt.setRatio=I(H,G,tt._tween,Q),bt},priority:V})},B.useSVGTransformAttr=!0;var Ue="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),Ee=xt("transform"),pe=J+"transform",Ie=xt("transformOrigin"),Qe=xt("perspective")!==null,Oe=it.Transform=function(){this.perspective=parseFloat(B.defaultTransformPerspective)||0,this.force3D=B.defaultForce3D===!1||!Qe?!1:B.defaultForce3D||"auto"},$e=ei.SVGElement,Fe,ii=function(O,I,V){var H=L.createElementNS("http://www.w3.org/2000/svg",O),G=/([a-z])([A-Z])/g,Q;for(Q in V)H.setAttributeNS(null,Q.replace(G,"$1-$2").toLowerCase(),V[Q]);return I.appendChild(H),H},ni=L.documentElement||{},_i=function(){var O=Vt||/Android/i.test(st)&&!ei.chrome,I,V,H;return L.createElementNS&&!O&&(I=ii("svg",ni),V=ii("rect",I,{width:100,height:50,x:100}),H=V.getBoundingClientRect().width,V.style[Ie]="50% 50%",V.style[Ee]="scaleX(0.5)",O=H===V.getBoundingClientRect().width&&!(ot&&Qe),ni.removeChild(I)),O}(),Ge=function(O,I,V,H,G,Q){var tt=O._gsTransform,ut=He(O,!0),dt,Pt,bt,Ct,kt,Ot,Wt,Ut,Nt,Yt,Zt,se,oe,ue;tt&&(oe=tt.xOrigin,ue=tt.yOrigin),(!H||(dt=H.split(" ")).length<2)&&(Wt=O.getBBox(),Wt.x===0&&Wt.y===0&&Wt.width+Wt.height===0&&(Wt={x:parseFloat(O.hasAttribute("x")?O.getAttribute("x"):O.hasAttribute("cx")?O.getAttribute("cx"):0)||0,y:parseFloat(O.hasAttribute("y")?O.getAttribute("y"):O.hasAttribute("cy")?O.getAttribute("cy"):0)||0,width:0,height:0}),I=Y(I).split(" "),dt=[(I[0].indexOf("%")!==-1?parseFloat(I[0])/100*Wt.width:parseFloat(I[0]))+Wt.x,(I[1].indexOf("%")!==-1?parseFloat(I[1])/100*Wt.height:parseFloat(I[1]))+Wt.y]),V.xOrigin=Ct=parseFloat(dt[0]),V.yOrigin=kt=parseFloat(dt[1]),H&&ut!==je&&(Ot=ut[0],Wt=ut[1],Ut=ut[2],Nt=ut[3],Yt=ut[4],Zt=ut[5],se=Ot*Nt-Wt*Ut,se&&(Pt=Ct*(Nt/se)+kt*(-Ut/se)+(Ut*Zt-Nt*Yt)/se,bt=Ct*(-Wt/se)+kt*(Ot/se)-(Ot*Zt-Wt*Yt)/se,Ct=V.xOrigin=dt[0]=Pt,kt=V.yOrigin=dt[1]=bt)),tt&&(Q&&(V.xOffset=tt.xOffset,V.yOffset=tt.yOffset,tt=V),G||G!==!1&&B.defaultSmoothOrigin!==!1?(Pt=Ct-oe,bt=kt-ue,tt.xOffset+=Pt*ut[0]+bt*ut[2]-Pt,tt.yOffset+=Pt*ut[1]+bt*ut[3]-bt):tt.xOffset=tt.yOffset=0),Q||O.setAttribute("data-svg-origin",dt.join(" "))},Je=function(O){var I=C("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),V=this.parentNode,H=this.nextSibling,G=this.style.cssText,Q;if(ni.appendChild(I),I.appendChild(this),this.style.display="block",O)try{Q=this.getBBox(),this._originalGetBBox=this.getBBox,this.getBBox=Je}catch(tt){}else this._originalGetBBox&&(Q=this._originalGetBBox());return H?V.insertBefore(this,H):V.appendChild(this),ni.removeChild(I),this.style.cssText=G,Q},ze=function(O){try{return O.getBBox()}catch(I){return Je.call(O,!0)}},ri=function(O){return!!($e&&O.getCTM&&(!O.parentNode||O.ownerSVGElement)&&ze(O))},je=[1,0,0,1,0,0],He=function(O,I){var V=O._gsTransform||new Oe,H=1e5,G=O.style,Q,tt,ut,dt,Pt,bt;if(Ee?tt=Lt(O,pe,null,!0):O.currentStyle&&(tt=O.currentStyle.filter.match(b),tt=tt&&tt.length===4?[tt[0].substr(4),Number(tt[2].substr(4)),Number(tt[1].substr(4)),tt[3].substr(4),V.x||0,V.y||0].join(","):""),Q=!tt||tt==="none"||tt==="matrix(1, 0, 0, 1, 0, 0)",Ee&&((bt=!Rt(O)||Rt(O).display==="none")||!O.parentNode)&&(bt&&(dt=G.display,G.display="block"),O.parentNode||(Pt=1,ni.appendChild(O)),tt=Lt(O,pe,null,!0),Q=!tt||tt==="none"||tt==="matrix(1, 0, 0, 1, 0, 0)",dt?G.display=dt:bt&&gi(G,"display"),Pt&&ni.removeChild(O)),(V.svg||O.getCTM&&ri(O))&&(Q&&(G[Ee]+"").indexOf("matrix")!==-1&&(tt=G[Ee],Q=0),ut=O.getAttribute("transform"),Q&&ut&&(ut=O.transform.baseVal.consolidate().matrix,tt="matrix("+ut.a+","+ut.b+","+ut.c+","+ut.d+","+ut.e+","+ut.f+")",Q=0)),Q)return je;for(ut=(tt||"").match(r)||[],Ft=ut.length;--Ft>-1;)dt=Number(ut[Ft]),ut[Ft]=(Pt=dt-(dt|=0))?(Pt*H+(Pt<0?-.5:.5)|0)/H+dt:dt;return I&&ut.length>6?[ut[0],ut[1],ut[4],ut[5],ut[12],ut[13]]:ut},li=it.getTransform=function(O,I,V,H){if(O._gsTransform&&V&&!H)return O._gsTransform;var G=V?O._gsTransform||new Oe:new Oe,Q=G.scaleX<0,tt=2e-5,ut=1e5,dt=Qe&&(parseFloat(Lt(O,Ie,I,!1,"0 0 0").split(" ")[2])||G.zOrigin)||0,Pt=parseFloat(B.defaultTransformPerspective)||0,bt,Ct,kt,Ot,Wt,Ut;if(G.svg=!!(O.getCTM&&ri(O)),G.svg&&(Ge(O,Lt(O,Ie,I,!1,"50% 50%")+"",G,O.getAttribute("data-svg-origin")),Fe=B.useSVGTransformAttr||_i),bt=He(O),bt!==je){if(bt.length===16){var Nt=bt[0],Yt=bt[1],Zt=bt[2],se=bt[3],oe=bt[4],ue=bt[5],ce=bt[6],ge=bt[7],_e=bt[8],Pe=bt[9],Se=bt[10],We=bt[12],Ve=bt[13],me=bt[14],Le=bt[11],de=Math.atan2(ce,Se),ke,Ne,Re,xe,Me,Te;G.zOrigin&&(me=-G.zOrigin,We=_e*me-bt[12],Ve=Pe*me-bt[13],me=Se*me+G.zOrigin-bt[14]),G.rotationX=de*E,de&&(Me=Math.cos(-de),Te=Math.sin(-de),ke=oe*Me+_e*Te,Ne=ue*Me+Pe*Te,Re=ce*Me+Se*Te,_e=oe*-Te+_e*Me,Pe=ue*-Te+Pe*Me,Se=ce*-Te+Se*Me,Le=ge*-Te+Le*Me,oe=ke,ue=Ne,ce=Re),de=Math.atan2(-Zt,Se),G.rotationY=de*E,de&&(Me=Math.cos(-de),Te=Math.sin(-de),ke=Nt*Me-_e*Te,Ne=Yt*Me-Pe*Te,Re=Zt*Me-Se*Te,Pe=Yt*Te+Pe*Me,Se=Zt*Te+Se*Me,Le=se*Te+Le*Me,Nt=ke,Yt=Ne,Zt=Re),de=Math.atan2(Yt,Nt),G.rotation=de*E,de&&(Me=Math.cos(de),Te=Math.sin(de),ke=Nt*Me+Yt*Te,Ne=oe*Me+ue*Te,Re=_e*Me+Pe*Te,Yt=Yt*Me-Nt*Te,ue=ue*Me-oe*Te,Pe=Pe*Me-_e*Te,Nt=ke,oe=Ne,_e=Re),G.rotationX&&Math.abs(G.rotationX)+Math.abs(G.rotation)>359.9&&(G.rotationX=G.rotation=0,G.rotationY=180-G.rotationY),de=Math.atan2(oe,ue),G.scaleX=(Math.sqrt(Nt*Nt+Yt*Yt+Zt*Zt)*ut+.5|0)/ut,G.scaleY=(Math.sqrt(ue*ue+ce*ce)*ut+.5|0)/ut,G.scaleZ=(Math.sqrt(_e*_e+Pe*Pe+Se*Se)*ut+.5|0)/ut,Nt/=G.scaleX,oe/=G.scaleY,Yt/=G.scaleX,ue/=G.scaleY,Math.abs(de)>tt?(G.skewX=de*E,oe=0,G.skewType!=="simple"&&(G.scaleY*=1/Math.cos(de))):G.skewX=0,G.perspective=Le?1/(Le<0?-Le:Le):0,G.x=We,G.y=Ve,G.z=me,G.svg&&(G.x-=G.xOrigin-(G.xOrigin*Nt-G.yOrigin*oe),G.y-=G.yOrigin-(G.yOrigin*Yt-G.xOrigin*ue))}else if(!Qe||H||!bt.length||G.x!==bt[4]||G.y!==bt[5]||!G.rotationX&&!G.rotationY){var hi=bt.length>=6,Ze=hi?bt[0]:1,ci=bt[1]||0,Ri=bt[2]||0,Mi=hi?bt[3]:1;G.x=bt[4]||0,G.y=bt[5]||0,kt=Math.sqrt(Ze*Ze+ci*ci),Ot=Math.sqrt(Mi*Mi+Ri*Ri),Wt=Ze||ci?Math.atan2(ci,Ze)*E:G.rotation||0,Ut=Ri||Mi?Math.atan2(Ri,Mi)*E+Wt:G.skewX||0,G.scaleX=kt,G.scaleY=Ot,G.rotation=Wt,G.skewX=Ut,Qe&&(G.rotationX=G.rotationY=G.z=0,G.perspective=Pt,G.scaleZ=1),G.svg&&(G.x-=G.xOrigin-(G.xOrigin*Ze+G.yOrigin*Ri),G.y-=G.yOrigin-(G.xOrigin*ci+G.yOrigin*Mi))}Math.abs(G.skewX)>90&&Math.abs(G.skewX)<270&&(Q?(G.scaleX*=-1,G.skewX+=G.rotation<=0?180:-180,G.rotation+=G.rotation<=0?180:-180):(G.scaleY*=-1,G.skewX+=G.skewX<=0?180:-180)),G.zOrigin=dt;for(Ct in G)G[Ct]<tt&&G[Ct]>-tt&&(G[Ct]=0)}return V&&(O._gsTransform=G,G.svg&&(Fe&&O.style[Ee]?vt.delayedCall(.001,function(){gi(O.style,Ee)}):!Fe&&O.getAttribute("transform")&&vt.delayedCall(.001,function(){O.removeAttribute("transform")}))),G},ai=function(O){var I=this.data,V=-I.rotation*T,H=V+I.skewX*T,G=1e5,Q=(Math.cos(V)*I.scaleX*G|0)/G,tt=(Math.sin(V)*I.scaleX*G|0)/G,ut=(Math.sin(H)*-I.scaleY*G|0)/G,dt=(Math.cos(H)*I.scaleY*G|0)/G,Pt=this.t.style,bt=this.t.currentStyle,Ct,kt;if(bt){kt=tt,tt=-ut,ut=-kt,Ct=bt.filter,Pt.filter="";var Ot=this.t.offsetWidth,Wt=this.t.offsetHeight,Ut=bt.position!=="absolute",Nt="progid:DXImageTransform.Microsoft.Matrix(M11="+Q+", M12="+tt+", M21="+ut+", M22="+dt,Yt=I.x+Ot*I.xPercent/100,Zt=I.y+Wt*I.yPercent/100,se,oe;if(I.ox!=null&&(se=(I.oxp?Ot*I.ox*.01:I.ox)-Ot/2,oe=(I.oyp?Wt*I.oy*.01:I.oy)-Wt/2,Yt+=se-(se*Q+oe*tt),Zt+=oe-(se*ut+oe*dt)),Ut?(se=Ot/2,oe=Wt/2,Nt+=", Dx="+(se-(se*Q+oe*tt)+Yt)+", Dy="+(oe-(se*ut+oe*dt)+Zt)+")"):Nt+=", sizingMethod='auto expand')",Ct.indexOf("DXImageTransform.Microsoft.Matrix(")!==-1?Pt.filter=Ct.replace(R,Nt):Pt.filter=Nt+" "+Ct,(O===0||O===1)&&Q===1&&tt===0&&ut===0&&dt===1&&(!Ut||Nt.indexOf("Dx=0, Dy=0")!==-1)&&(!c.test(Ct)||parseFloat(RegExp.$1)===100)&&Ct.indexOf(Ct.indexOf("Alpha"))===-1&&Pt.removeAttribute("filter"),!Ut){var ue=Vt<8?1:-1,ce,ge,_e;for(se=I.ieOffsetX||0,oe=I.ieOffsetY||0,I.ieOffsetX=Math.round((Ot-((Q<0?-Q:Q)*Ot+(tt<0?-tt:tt)*Wt))/2+Yt),I.ieOffsetY=Math.round((Wt-((dt<0?-dt:dt)*Wt+(ut<0?-ut:ut)*Ot))/2+Zt),Ft=0;Ft<4;Ft++)ge=K[Ft],ce=bt[ge],kt=ce.indexOf("px")!==-1?parseFloat(ce):te(this.t,ge,parseFloat(ce),ce.replace(o,""))||0,kt!==I[ge]?_e=Ft<2?-I.ieOffsetX:-I.ieOffsetY:_e=Ft<2?se-I.ieOffsetX:oe-I.ieOffsetY,Pt[ge]=(I[ge]=Math.round(kt-_e*(Ft===0||Ft===2?1:ue)))+"px"}}},si=it.set3DTransformRatio=it.setTransformRatio=function(O){var I=this.data,V=this.t.style,H=I.rotation,G=I.rotationX,Q=I.rotationY,tt=I.scaleX,ut=I.scaleY,dt=I.scaleZ,Pt=I.x,bt=I.y,Ct=I.z,kt=I.svg,Ot=I.perspective,Wt=I.force3D,Ut=I.skewY,Nt=I.skewX,Yt,Zt,se,oe,ue,ce,ge,_e,Pe,Se,We,Ve,me,Le,de,ke,Ne,Re,xe,Me,Te,hi,Ze;if(Ut&&(Nt+=Ut,H+=Ut),((O===1||O===0)&&Wt==="auto"&&(this.tween._totalTime===this.tween._totalDuration||!this.tween._totalTime)||!Wt)&&!Ct&&!Ot&&!Q&&!G&&dt===1||Fe&&kt||!Qe){H||Nt||kt?(H*=T,hi=Nt*T,Ze=1e5,Zt=Math.cos(H)*tt,ue=Math.sin(H)*tt,se=Math.sin(H-hi)*-ut,ce=Math.cos(H-hi)*ut,hi&&I.skewType==="simple"&&(Yt=Math.tan(hi-Ut*T),Yt=Math.sqrt(1+Yt*Yt),se*=Yt,ce*=Yt,Ut&&(Yt=Math.tan(Ut*T),Yt=Math.sqrt(1+Yt*Yt),Zt*=Yt,ue*=Yt)),kt&&(Pt+=I.xOrigin-(I.xOrigin*Zt+I.yOrigin*se)+I.xOffset,bt+=I.yOrigin-(I.xOrigin*ue+I.yOrigin*ce)+I.yOffset,Fe&&(I.xPercent||I.yPercent)&&(de=this.t.getBBox(),Pt+=I.xPercent*.01*de.width,bt+=I.yPercent*.01*de.height),de=1e-6,Pt<de&&Pt>-de&&(Pt=0),bt<de&&bt>-de&&(bt=0)),xe=(Zt*Ze|0)/Ze+","+(ue*Ze|0)/Ze+","+(se*Ze|0)/Ze+","+(ce*Ze|0)/Ze+","+Pt+","+bt+")",kt&&Fe?this.t.setAttribute("transform","matrix("+xe):V[Ee]=(I.xPercent||I.yPercent?"translate("+I.xPercent+"%,"+I.yPercent+"%) matrix(":"matrix(")+xe):V[Ee]=(I.xPercent||I.yPercent?"translate("+I.xPercent+"%,"+I.yPercent+"%) matrix(":"matrix(")+tt+",0,0,"+ut+","+Pt+","+bt+")";return}if(ot&&(de=1e-4,tt<de&&tt>-de&&(tt=dt=2e-5),ut<de&&ut>-de&&(ut=dt=2e-5),Ot&&!I.z&&!I.rotationX&&!I.rotationY&&(Ot=0)),H||Nt)H*=T,ke=Zt=Math.cos(H),Ne=ue=Math.sin(H),Nt&&(H-=Nt*T,ke=Math.cos(H),Ne=Math.sin(H),I.skewType==="simple"&&(Yt=Math.tan((Nt-Ut)*T),Yt=Math.sqrt(1+Yt*Yt),ke*=Yt,Ne*=Yt,I.skewY&&(Yt=Math.tan(Ut*T),Yt=Math.sqrt(1+Yt*Yt),Zt*=Yt,ue*=Yt))),se=-Ne,ce=ke;else if(!Q&&!G&&dt===1&&!Ot&&!kt){V[Ee]=(I.xPercent||I.yPercent?"translate("+I.xPercent+"%,"+I.yPercent+"%) translate3d(":"translate3d(")+Pt+"px,"+bt+"px,"+Ct+"px)"+(tt!==1||ut!==1?" scale("+tt+","+ut+")":"");return}else Zt=ce=1,se=ue=0;Se=1,oe=ge=_e=Pe=We=Ve=0,me=Ot?-1/Ot:0,Le=I.zOrigin,de=1e-6,Me=",",Te="0",H=Q*T,H&&(ke=Math.cos(H),Ne=Math.sin(H),_e=-Ne,We=me*-Ne,oe=Zt*Ne,ge=ue*Ne,Se=ke,me*=ke,Zt*=ke,ue*=ke),H=G*T,H&&(ke=Math.cos(H),Ne=Math.sin(H),Yt=se*ke+oe*Ne,Re=ce*ke+ge*Ne,Pe=Se*Ne,Ve=me*Ne,oe=se*-Ne+oe*ke,ge=ce*-Ne+ge*ke,Se=Se*ke,me=me*ke,se=Yt,ce=Re),dt!==1&&(oe*=dt,ge*=dt,Se*=dt,me*=dt),ut!==1&&(se*=ut,ce*=ut,Pe*=ut,Ve*=ut),tt!==1&&(Zt*=tt,ue*=tt,_e*=tt,We*=tt),(Le||kt)&&(Le&&(Pt+=oe*-Le,bt+=ge*-Le,Ct+=Se*-Le+Le),kt&&(Pt+=I.xOrigin-(I.xOrigin*Zt+I.yOrigin*se)+I.xOffset,bt+=I.yOrigin-(I.xOrigin*ue+I.yOrigin*ce)+I.yOffset),Pt<de&&Pt>-de&&(Pt=Te),bt<de&&bt>-de&&(bt=Te),Ct<de&&Ct>-de&&(Ct=0)),xe=I.xPercent||I.yPercent?"translate("+I.xPercent+"%,"+I.yPercent+"%) matrix3d(":"matrix3d(",xe+=(Zt<de&&Zt>-de?Te:Zt)+Me+(ue<de&&ue>-de?Te:ue)+Me+(_e<de&&_e>-de?Te:_e),xe+=Me+(We<de&&We>-de?Te:We)+Me+(se<de&&se>-de?Te:se)+Me+(ce<de&&ce>-de?Te:ce),G||Q||dt!==1?(xe+=Me+(Pe<de&&Pe>-de?Te:Pe)+Me+(Ve<de&&Ve>-de?Te:Ve)+Me+(oe<de&&oe>-de?Te:oe),xe+=Me+(ge<de&&ge>-de?Te:ge)+Me+(Se<de&&Se>-de?Te:Se)+Me+(me<de&&me>-de?Te:me)+Me):xe+=",0,0,0,0,1,0,",xe+=Pt+Me+bt+Me+Ct+Me+(Ot?1+-Ct/Ot:1)+")",V[Ee]=xe};t=Oe.prototype,t.x=t.y=t.z=t.skewX=t.skewY=t.rotation=t.rotationX=t.rotationY=t.zOrigin=t.xPercent=t.yPercent=t.xOffset=t.yOffset=0,t.scaleX=t.scaleY=t.scaleZ=1,Bt("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(O,I,V,H,G,Q,tt){if(H._lastParsedTransform===tt)return G;H._lastParsedTransform=tt;var ut=tt.scale&&typeof tt.scale=="function"?tt.scale:0,dt;typeof tt[V]=="function"&&(dt=tt[V],tt[V]=I),ut&&(tt.scale=ut(j,O));var Pt=O._gsTransform,bt=O.style,Ct=1e-6,kt=Ue.length,Ot=tt,Wt={},Ut="transformOrigin",Nt=li(O,n,!0,Ot.parseTransform),Yt=Ot.transform&&(typeof Ot.transform=="function"?Ot.transform(j,ne):Ot.transform),Zt,se,oe,ue,ce,ge,_e,Pe,Se;if(Nt.skewType=Ot.skewType||Nt.skewType||B.defaultSkewType,H._transform=Nt,"rotationZ"in Ot&&(Ot.rotation=Ot.rotationZ),Yt&&typeof Yt=="string"&&Ee)se=F.style,se[Ee]=Yt,se.display="block",se.position="absolute",Yt.indexOf("%")!==-1&&(se.width=Lt(O,"width"),se.height=Lt(O,"height")),L.body.appendChild(F),Zt=li(F,null,!1),Nt.skewType==="simple"&&(Zt.scaleY*=Math.cos(Zt.skewX*T)),Nt.svg&&(ge=Nt.xOrigin,_e=Nt.yOrigin,Zt.x-=Nt.xOffset,Zt.y-=Nt.yOffset,(Ot.transformOrigin||Ot.svgOrigin)&&(Yt={},Ge(O,Y(Ot.transformOrigin),Yt,Ot.svgOrigin,Ot.smoothOrigin,!0),ge=Yt.xOrigin,_e=Yt.yOrigin,Zt.x-=Yt.xOffset-Nt.xOffset,Zt.y-=Yt.yOffset-Nt.yOffset),(ge||_e)&&(Pe=He(F,!0),Zt.x-=ge-(ge*Pe[0]+_e*Pe[2]),Zt.y-=_e-(ge*Pe[1]+_e*Pe[3]))),L.body.removeChild(F),Zt.perspective||(Zt.perspective=Nt.perspective),Ot.xPercent!=null&&(Zt.xPercent=wt(Ot.xPercent,Nt.xPercent)),Ot.yPercent!=null&&(Zt.yPercent=wt(Ot.yPercent,Nt.yPercent));else if(typeof Ot=="object"){if(Zt={scaleX:wt(Ot.scaleX!=null?Ot.scaleX:Ot.scale,Nt.scaleX),scaleY:wt(Ot.scaleY!=null?Ot.scaleY:Ot.scale,Nt.scaleY),scaleZ:wt(Ot.scaleZ,Nt.scaleZ),x:wt(Ot.x,Nt.x),y:wt(Ot.y,Nt.y),z:wt(Ot.z,Nt.z),xPercent:wt(Ot.xPercent,Nt.xPercent),yPercent:wt(Ot.yPercent,Nt.yPercent),perspective:wt(Ot.transformPerspective,Nt.perspective)},ce=Ot.directionalRotation,ce!=null)if(typeof ce=="object")for(se in ce)Ot[se]=ce[se];else Ot.rotation=ce;typeof Ot.x=="string"&&Ot.x.indexOf("%")!==-1&&(Zt.x=0,Zt.xPercent=wt(Ot.x,Nt.xPercent)),typeof Ot.y=="string"&&Ot.y.indexOf("%")!==-1&&(Zt.y=0,Zt.yPercent=wt(Ot.y,Nt.yPercent)),Zt.rotation=Et("rotation"in Ot?Ot.rotation:"shortRotation"in Ot?Ot.shortRotation+"_short":Nt.rotation,Nt.rotation,"rotation",Wt),Qe&&(Zt.rotationX=Et("rotationX"in Ot?Ot.rotationX:"shortRotationX"in Ot?Ot.shortRotationX+"_short":Nt.rotationX||0,Nt.rotationX,"rotationX",Wt),Zt.rotationY=Et("rotationY"in Ot?Ot.rotationY:"shortRotationY"in Ot?Ot.shortRotationY+"_short":Nt.rotationY||0,Nt.rotationY,"rotationY",Wt)),Zt.skewX=Et(Ot.skewX,Nt.skewX),Zt.skewY=Et(Ot.skewY,Nt.skewY)}for(Qe&&Ot.force3D!=null&&(Nt.force3D=Ot.force3D,ue=!0),oe=Nt.force3D||Nt.z||Nt.rotationX||Nt.rotationY||Zt.z||Zt.rotationX||Zt.rotationY||Zt.perspective,!oe&&Ot.scale!=null&&(Zt.scaleZ=1);--kt>-1;)Se=Ue[kt],Yt=Zt[Se]-Nt[Se],(Yt>Ct||Yt<-Ct||Ot[Se]!=null||x[Se]!=null)&&(ue=!0,G=new Ht(Nt,Se,Nt[Se],Yt,G),Se in Wt&&(G.e=Wt[Se]),G.xs0=0,G.plugin=Q,H._overwriteProps.push(G.n));return Yt=Ot.transformOrigin,Nt.svg&&(Yt||Ot.svgOrigin)&&(ge=Nt.xOffset,_e=Nt.yOffset,Ge(O,Y(Yt),Zt,Ot.svgOrigin,Ot.smoothOrigin),G=Kt(Nt,"xOrigin",(Pt?Nt:Zt).xOrigin,Zt.xOrigin,G,Ut),G=Kt(Nt,"yOrigin",(Pt?Nt:Zt).yOrigin,Zt.yOrigin,G,Ut),(ge!==Nt.xOffset||_e!==Nt.yOffset)&&(G=Kt(Nt,"xOffset",Pt?ge:Nt.xOffset,Nt.xOffset,G,Ut),G=Kt(Nt,"yOffset",Pt?_e:Nt.yOffset,Nt.yOffset,G,Ut)),Yt="0px 0px"),(Yt||Qe&&oe&&Nt.zOrigin)&&(Ee?(ue=!0,Se=Ie,Yt=(Yt||Lt(O,Se,n,!1,"50% 50%"))+"",G=new Ht(bt,Se,0,0,G,-1,Ut),G.b=bt[Se],G.plugin=Q,Qe?(se=Nt.zOrigin,Yt=Yt.split(" "),Nt.zOrigin=(Yt.length>2&&!(se!==0&&Yt[2]==="0px")?parseFloat(Yt[2]):se)||0,G.xs0=G.e=Yt[0]+" "+(Yt[1]||"50%")+" 0px",G=new Ht(Nt,"zOrigin",0,0,G,-1,G.n),G.b=se,G.xs0=G.e=Nt.zOrigin):G.xs0=G.e=Yt):Y(Yt+"",Nt)),ue&&(H._transformType=!(Nt.svg&&Fe)&&(oe||this._transformType===3)?3:2),dt&&(tt[V]=dt),ut&&(tt.scale=ut),G},prefix:!0}),Bt("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),Bt("borderRadius",{defaultValue:"0px",parser:function(O,I,V,H,G,Q){I=this.format(I);var tt=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],ut=O.style,dt,Pt,bt,Ct,kt,Ot,Wt,Ut,Nt,Yt,Zt,se,oe,ue,ce,ge;for(Nt=parseFloat(O.offsetWidth),Yt=parseFloat(O.offsetHeight),dt=I.split(" "),Pt=0;Pt<tt.length;Pt++)this.p.indexOf("border")&&(tt[Pt]=xt(tt[Pt])),kt=Ct=Lt(O,tt[Pt],n,!1,"0px"),kt.indexOf(" ")!==-1&&(Ct=kt.split(" "),kt=Ct[0],Ct=Ct[1]),Ot=bt=dt[Pt],Wt=parseFloat(kt),se=kt.substr((Wt+"").length),oe=Ot.charAt(1)==="=",oe?(Ut=parseInt(Ot.charAt(0)+"1",10),Ot=Ot.substr(2),Ut*=parseFloat(Ot),Zt=Ot.substr((Ut+"").length-(Ut<0?1:0))||""):(Ut=parseFloat(Ot),Zt=Ot.substr((Ut+"").length)),Zt===""&&(Zt=l[V]||se),Zt!==se&&(ue=te(O,"borderLeft",Wt,se),ce=te(O,"borderTop",Wt,se),Zt==="%"?(kt=ue/Nt*100+"%",Ct=ce/Yt*100+"%"):Zt==="em"?(ge=te(O,"borderLeft",1,"em"),kt=ue/ge+"em",Ct=ce/ge+"em"):(kt=ue+"px",Ct=ce+"px"),oe&&(Ot=parseFloat(kt)+Ut+Zt,bt=parseFloat(Ct)+Ut+Zt)),G=fe(ut,tt[Pt],kt+" "+Ct,Ot+" "+bt,!1,"0px",G);return G},prefix:!0,formatter:le("0px 0px 0px 0px",!1,!0)}),Bt("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius",{defaultValue:"0px",parser:function(O,I,V,H,G,Q){return fe(O.style,V,this.format(Lt(O,V,n,!1,"0px 0px")),this.format(I),!1,"0px",G)},prefix:!0,formatter:le("0px 0px",!1,!0)}),Bt("backgroundPosition",{defaultValue:"0 0",parser:function(O,I,V,H,G,Q){var tt="background-position",ut=n||Rt(O,null),dt=this.format((ut?Vt?ut.getPropertyValue(tt+"-x")+" "+ut.getPropertyValue(tt+"-y"):ut.getPropertyValue(tt):O.currentStyle.backgroundPositionX+" "+O.currentStyle.backgroundPositionY)||"0 0"),Pt=this.format(I),bt,Ct,kt,Ot,Wt,Ut;if(dt.indexOf("%")!==-1!=(Pt.indexOf("%")!==-1)&&Pt.split(",").length<2&&(Ut=Lt(O,"backgroundImage").replace(_,""),Ut&&Ut!=="none")){for(bt=dt.split(" "),Ct=Pt.split(" "),q.setAttribute("src",Ut),kt=2;--kt>-1;)dt=bt[kt],Ot=dt.indexOf("%")!==-1,Ot!==(Ct[kt].indexOf("%")!==-1)&&(Wt=kt===0?O.offsetWidth-q.width:O.offsetHeight-q.height,bt[kt]=Ot?parseFloat(dt)/100*Wt+"px":parseFloat(dt)/Wt*100+"%");dt=bt.join(" ")}return this.parseComplex(O.style,dt,Pt,G,Q)},formatter:Y}),Bt("backgroundSize",{defaultValue:"0 0",formatter:function(O){return O+="",O.substr(0,2)==="co"?O:Y(O.indexOf(" ")===-1?O+" "+O:O)}}),Bt("perspective",{defaultValue:"0px",prefix:!0}),Bt("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),Bt("transformStyle",{prefix:!0}),Bt("backfaceVisibility",{prefix:!0}),Bt("userSelect",{prefix:!0}),Bt("margin",{parser:W("marginTop,marginRight,marginBottom,marginLeft")}),Bt("padding",{parser:W("paddingTop,paddingRight,paddingBottom,paddingLeft")}),Bt("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(O,I,V,H,G,Q){var tt,ut,dt;return Vt<9?(ut=O.currentStyle,dt=Vt<8?" ":",",tt="rect("+ut.clipTop+dt+ut.clipRight+dt+ut.clipBottom+dt+ut.clipLeft+")",I=this.format(I).split(",").join(dt)):(tt=this.format(Lt(O,this.p,n,!1,this.dflt)),I=this.format(I)),this.parseComplex(O.style,tt,I,G,Q)}}),Bt("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),Bt("autoRound,strictUnits",{parser:function(O,I,V,H,G){return G}}),Bt("border",{defaultValue:"0px solid #000",parser:function(O,I,V,H,G,Q){var tt=Lt(O,"borderTopWidth",n,!1,"0px"),ut=this.format(I).split(" "),dt=ut[0].replace(o,"");return dt!=="px"&&(tt=parseFloat(tt)/te(O,"borderTopWidth",1,dt)+dt),this.parseComplex(O.style,this.format(tt+" "+Lt(O,"borderTopStyle",n,!1,"solid")+" "+Lt(O,"borderTopColor",n,!1,"#000")),ut.join(" "),G,Q)},color:!0,formatter:function(O){var I=O.split(" ");return I[0]+" "+(I[1]||"solid")+" "+(O.match(ie)||["#000"])[0]}}),Bt("borderWidth",{parser:W("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),Bt("float,cssFloat,styleFloat",{parser:function(O,I,V,H,G,Q){var tt=O.style,ut="cssFloat"in tt?"cssFloat":"styleFloat";return new Ht(tt,ut,0,0,G,-1,V,!1,0,tt[ut],I)}});var yi=function(O){var I=this.t,V=I.filter||Lt(this.data,"filter")||"",H=this.s+this.c*O|0,G;H===100&&(V.indexOf("atrix(")===-1&&V.indexOf("radient(")===-1&&V.indexOf("oader(")===-1?(I.removeAttribute("filter"),G=!Lt(this.data,"filter")):(I.filter=V.replace(h,""),G=!0)),G||(this.xn1&&(I.filter=V=V||"alpha(opacity="+H+")"),V.indexOf("pacity")===-1?(H!==0||!this.xn1)&&(I.filter=V+" alpha(opacity="+H+")"):I.filter=V.replace(c,"opacity="+H))};Bt("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(O,I,V,H,G,Q){var tt=parseFloat(Lt(O,"opacity",n,!1,"1")),ut=O.style,dt=V==="autoAlpha";return typeof I=="string"&&I.charAt(1)==="="&&(I=(I.charAt(0)==="-"?-1:1)*parseFloat(I.substr(2))+tt),dt&&tt===1&&Lt(O,"visibility",n)==="hidden"&&I!==0&&(tt=0),Gt?G=new Ht(ut,"opacity",tt,I-tt,G):(G=new Ht(ut,"opacity",tt*100,(I-tt)*100,G),G.xn1=dt?1:0,ut.zoom=1,G.type=2,G.b="alpha(opacity="+G.s+")",G.e="alpha(opacity="+(G.s+G.c)+")",G.data=O,G.plugin=Q,G.setRatio=yi),dt&&(G=new Ht(ut,"visibility",0,0,G,-1,null,!1,0,tt!==0?"inherit":"hidden",I===0?"hidden":"inherit"),G.xs0="inherit",H._overwriteProps.push(G.n),H._overwriteProps.push(V)),G}});var gi=function(O,I){I&&(O.removeProperty?((I.substr(0,2)==="ms"||I.substr(0,6)==="webkit")&&(I="-"+I),O.removeProperty(I.replace(m,"-$1").toLowerCase())):O.removeAttribute(I))},ki=function(O){if(this.t._gsClassPT=this,O===1||O===0){this.t.setAttribute("class",O===0?this.b:this.e);for(var I=this.data,V=this.t.style;I;)I.v?V[I.p]=I.v:gi(V,I.p),I=I._next;O===1&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};Bt("className",{parser:function(O,I,V,H,G,Q,tt){var ut=O.getAttribute("class")||"",dt=O.style.cssText,Pt,bt,Ct,kt,Ot;if(G=H._classNamePT=new Ht(O,V,0,0,G,2),G.setRatio=ki,G.pr=-11,p=!0,G.b=ut,bt=ee(O,n),Ct=O._gsClassPT,Ct){for(kt={},Ot=Ct.data;Ot;)kt[Ot.p]=1,Ot=Ot._next;Ct.setRatio(1)}return O._gsClassPT=G,G.e=I.charAt(1)!=="="?I:ut.replace(new RegExp("(?:\\s|^)"+I.substr(2)+"(?![\\w-])"),"")+(I.charAt(0)==="+"?" "+I.substr(2):""),O.setAttribute("class",G.e),Pt=$(O,bt,ee(O),tt,kt),O.setAttribute("class",ut),G.data=Pt.firstMPT,O.style.cssText=dt,G=G.xfirst=H.parse(O,Pt.difs,G,Q),G}});var vi=function(O){if((O===1||O===0)&&this.data._totalTime===this.data._totalDuration&&this.data.data!=="isFromStart"){var I=this.t.style,V=i.transform.parse,H,G,Q,tt,ut;if(this.e==="all")I.cssText="",tt=!0;else for(H=this.e.split(" ").join("").split(","),Q=H.length;--Q>-1;)G=H[Q],i[G]&&(i[G].parse===V?tt=!0:G=G==="transformOrigin"?Ie:i[G].p),gi(I,G);tt&&(gi(I,Ee),ut=this.t._gsTransform,ut&&(ut.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(Bt("clearProps",{parser:function(O,I,V,H,G){return G=new Ht(O,V,0,0,G,2),G.setRatio=vi,G.e=I,G.pr=-10,G.data=H._tween,p=!0,G}}),t="bezier,throwProps,physicsProps,physics2D".split(","),Ft=t.length;Ft--;)$t(t[Ft]);t=B.prototype,t._firstPT=t._lastParsedTransform=t._transform=null,t._onInitTween=function(O,I,V,H){if(!O.nodeType)return!1;this._target=ne=O,this._tween=V,this._vars=I,j=H,pt=I.autoRound,p=!1,l=I.suffixMap||B.suffixMap,n=Rt(O,""),e=this._overwriteProps;var G=O.style,Q,tt,ut,dt,Pt,bt,Ct,kt,Ot;if(_t&&G.zIndex===""&&(Q=Lt(O,"zIndex",n),(Q==="auto"||Q==="")&&this._addLazySet(G,"zIndex",0)),typeof I=="string"&&(dt=G.cssText,Q=ee(O,n),G.cssText=dt+";"+I,Q=$(O,Q,ee(O)).difs,!Gt&&d.test(I)&&(Q.opacity=parseFloat(RegExp.$1)),I=Q,G.cssText=dt),I.className?this._firstPT=tt=i.className.parse(O,I.className,"className",this,null,null,I):this._firstPT=tt=this.parse(O,I,null),this._transformType){for(Ot=this._transformType===3,Ee?X&&(_t=!0,G.zIndex===""&&(Ct=Lt(O,"zIndex",n),(Ct==="auto"||Ct==="")&&this._addLazySet(G,"zIndex",0)),Tt&&this._addLazySet(G,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(Ot?"visible":"hidden"))):G.zoom=1,ut=tt;ut&&ut._next;)ut=ut._next;kt=new Ht(O,"transform",0,0,null,2),this._linkCSSP(kt,null,ut),kt.setRatio=Ee?si:ai,kt.data=this._transform||li(O,n,!0),kt.tween=V,kt.pr=-1,e.pop()}if(p){for(;tt;){for(bt=tt._next,ut=dt;ut&&ut.pr>tt.pr;)ut=ut._next;(tt._prev=ut?ut._prev:Pt)?tt._prev._next=tt:dt=tt,(tt._next=ut)?ut._prev=tt:Pt=tt,tt=bt}this._firstPT=dt}return!0},t.parse=function(O,I,V,H){var G=O.style,Q,tt,ut,dt,Pt,bt,Ct,kt,Ot,Wt;for(Q in I){if(bt=I[Q],typeof bt=="function"&&(bt=bt(j,ne)),tt=i[Q],tt)V=tt.parse(O,bt,Q,this,V,H,I);else if(Q.substr(0,2)==="--"){this._tween._propLookup[Q]=this._addTween.call(this._tween,O.style,"setProperty",Rt(O).getPropertyValue(Q)+"",bt+"",Q,!1,Q);continue}else Pt=Lt(O,Q,n)+"",Ot=typeof bt=="string",Q==="color"||Q==="fill"||Q==="stroke"||Q.indexOf("Color")!==-1||Ot&&u.test(bt)?(Ot||(bt=At(bt),bt=(bt.length>3?"rgba(":"rgb(")+bt.join(",")+")"),V=fe(G,Q,Pt,bt,!0,"transparent",V,0,H)):Ot&&P.test(bt)?V=fe(G,Q,Pt,bt,!0,null,V,0,H):(ut=parseFloat(Pt),Ct=ut||ut===0?Pt.substr((ut+"").length):"",(Pt===""||Pt==="auto")&&(Q==="width"||Q==="height"?(ut=k(O,Q,n),Ct="px"):Q==="left"||Q==="top"?(ut=zt(O,Q,n),Ct="px"):(ut=Q!=="opacity"?0:1,Ct="")),Wt=Ot&&bt.charAt(1)==="=",Wt?(dt=parseInt(bt.charAt(0)+"1",10),bt=bt.substr(2),dt*=parseFloat(bt),kt=bt.replace(o,"")):(dt=parseFloat(bt),kt=Ot?bt.replace(o,""):""),kt===""&&(kt=Q in l?l[Q]:Ct),bt=dt||dt===0?(Wt?dt+ut:dt)+kt:I[Q],Ct!==kt&&(kt!==""||Q==="lineHeight")&&(dt||dt===0)&&ut&&(ut=te(O,Q,ut,Ct),kt==="%"?(ut/=te(O,Q,100,"%")/100,I.strictUnits!==!0&&(Pt=ut+"%")):kt==="em"||kt==="rem"||kt==="vw"||kt==="vh"?ut/=te(O,Q,1,kt):kt!=="px"&&(dt=te(O,Q,dt,kt),kt="px"),Wt&&(dt||dt===0)&&(bt=dt+ut+kt)),Wt&&(dt+=ut),(ut||ut===0)&&(dt||dt===0)?(V=new Ht(G,Q,ut,dt-ut,V,0,Q,pt!==!1&&(kt==="px"||Q==="zIndex"),0,Pt,bt),V.xs0=kt):G[Q]===void 0||!bt&&(bt+""=="NaN"||bt==null)?Qt("invalid "+Q+" tween value: "+I[Q]):(V=new Ht(G,Q,dt||ut||0,0,V,-1,Q,!1,0,Pt,bt),V.xs0=bt==="none"&&(Q==="display"||Q.indexOf("Style")!==-1)?Pt:bt));H&&V&&!V.plugin&&(V.plugin=H)}return V},t.setRatio=function(O){var I=this._firstPT,V=1e-6,H,G,Q;if(O===1&&(this._tween._time===this._tween._duration||this._tween._time===0))for(;I;){if(I.type!==2)if(I.r&&I.type!==-1){if(H=I.r(I.s+I.c),!I.type)I.t[I.p]=H+I.xs0;else if(I.type===1){for(Q=I.l,G=I.xs0+H+I.xs1,Q=1;Q<I.l;Q++)G+=I["xn"+Q]+I["xs"+(Q+1)];I.t[I.p]=G}}else I.t[I.p]=I.e;else I.setRatio(O);I=I._next}else if(O||!(this._tween._time===this._tween._duration||this._tween._time===0)||this._tween._rawPrevTime===-1e-6)for(;I;){if(H=I.c*O+I.s,I.r?H=I.r(H):H<V&&H>-V&&(H=0),!I.type)I.t[I.p]=H+I.xs0;else if(I.type===1)if(Q=I.l,Q===2)I.t[I.p]=I.xs0+H+I.xs1+I.xn1+I.xs2;else if(Q===3)I.t[I.p]=I.xs0+H+I.xs1+I.xn1+I.xs2+I.xn2+I.xs3;else if(Q===4)I.t[I.p]=I.xs0+H+I.xs1+I.xn1+I.xs2+I.xn2+I.xs3+I.xn3+I.xs4;else if(Q===5)I.t[I.p]=I.xs0+H+I.xs1+I.xn1+I.xs2+I.xn2+I.xs3+I.xn3+I.xs4+I.xn4+I.xs5;else{for(G=I.xs0+H+I.xs1,Q=1;Q<I.l;Q++)G+=I["xn"+Q]+I["xs"+(Q+1)];I.t[I.p]=G}else I.type===-1?I.t[I.p]=I.xs0:I.setRatio&&I.setRatio(O);I=I._next}else for(;I;)I.type!==2?I.t[I.p]=I.b:I.setRatio(O),I=I._next},t._enableTransforms=function(O){this._transform=this._transform||li(this._target,n,!0),this._transformType=!(this._transform.svg&&Fe)&&(O||this._transformType===3)?3:2};var et=function(O){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};t._addLazySet=function(O,I,V){var H=this._firstPT=new Ht(O,I,0,0,this._firstPT,2);H.e=V,H.setRatio=et,H.data=this},t._linkCSSP=function(O,I,V,H){return O&&(I&&(I._prev=O),O._next&&(O._next._prev=O._prev),O._prev?O._prev._next=O._next:this._firstPT===O&&(this._firstPT=O._next,H=!0),V?V._next=O:!H&&this._firstPT===null&&(this._firstPT=O),O._next=I,O._prev=V),O},t._mod=function(O){for(var I=this._firstPT;I;)typeof O[I.p]=="function"&&(I.r=O[I.p]),I=I._next},t._kill=function(O){var I=O,V,H,G;if(O.autoAlpha||O.alpha){I={};for(H in O)I[H]=O[H];I.opacity=1,I.autoAlpha&&(I.visibility=1)}for(O.className&&(V=this._classNamePT)&&(G=V.xfirst,G&&G._prev?this._linkCSSP(G._prev,V._next,G._prev._prev):G===this._firstPT&&(this._firstPT=V._next),V._next&&this._linkCSSP(V._next,V._next._next,G._prev),this._classNamePT=null),V=this._firstPT;V;)V.plugin&&V.plugin!==H&&V.plugin._kill&&(V.plugin._kill(O),H=V.plugin),V=V._next;return rt.prototype._kill.call(this,I)};var Z=function(O,I,V){var H,G,Q,tt;if(O.slice){for(G=O.length;--G>-1;)Z(O[G],I,V);return}for(H=O.childNodes,G=H.length;--G>-1;)Q=H[G],tt=Q.type,Q.style&&(I.push(ee(Q)),V&&V.push(Q)),(tt===1||tt===9||tt===11)&&Q.childNodes.length&&Z(Q,I,V)};return B.cascadeTo=function(O,I,V){var H=vt.to(O,I,V),G=[H],Q=[],tt=[],ut=[],dt=vt._internals.reservedProps,Pt,bt,Ct,kt;for(O=H._targets||H.target,Z(O,Q,ut),H.render(I,!0,!0),Z(O,tt),H.render(0,!0,!0),H._enabled(!0),Pt=ut.length;--Pt>-1;)if(bt=$(ut[Pt],Q[Pt],tt[Pt]),bt.firstMPT){bt=bt.difs;for(Ct in V)dt[Ct]&&(bt[Ct]=V[Ct]);kt={};for(Ct in bt)kt[Ct]=Q[Pt][Ct];G.push(vt.fromTo(ut[Pt],I,kt,bt))}return G},rt.activate([B]),B},!0),function(){var rt=ei._gsDefine.plugin({propName:"roundProps",version:"1.7.0",priority:-1,API:2,init:function(p,l,n){return this._tween=n,!0}}),vt=function(p){var l=p<1?Math.pow(10,(p+"").length-2):1;return function(n){return(Math.round(n/p)*p*l|0)/l}},B=function(p,l){for(;p;)!p.f&&!p.blob&&(p.m=l||Math.round),p=p._next},D=rt.prototype;D._onInitAllProps=function(){var p=this._tween,l=p.vars.roundProps,n={},e=p._propLookup.roundProps,i,t,r,s;if(typeof l=="object"&&!l.push)for(s in l)n[s]=vt(l[s]);else for(typeof l=="string"&&(l=l.split(",")),r=l.length;--r>-1;)n[l[r]]=Math.round;for(s in n)for(i=p._firstPT;i;)t=i._next,i.pg?i.t._mod(n):i.n===s&&(i.f===2&&i.t?B(i.t._firstPT,n[s]):(this._add(i.t,s,i.s,i.c,n[s]),t&&(t._prev=i._prev),i._prev?i._prev._next=t:p._firstPT===i&&(p._firstPT=t),i._next=i._prev=null,p._propLookup[s]=e)),i=t;return!1},D._add=function(p,l,n,e,i){this._addTween(p,l,n,n+e,l,i||Math.round),this._overwriteProps.push(l)}}(),function(){ei._gsDefine.plugin({propName:"attr",API:2,version:"0.6.1",init:function(rt,vt,B,D){var p,l;if(typeof rt.setAttribute!="function")return!1;for(p in vt)l=vt[p],typeof l=="function"&&(l=l(D,rt)),this._addTween(rt,"setAttribute",rt.getAttribute(p)+"",l+"",p,!1,p),this._overwriteProps.push(p);return!0}})}(),ei._gsDefine.plugin({propName:"directionalRotation",version:"0.3.1",API:2,init:function(rt,vt,B,D){typeof vt!="object"&&(vt={rotation:vt}),this.finals={};var p=vt.useRadians===!0?Math.PI*2:360,l=1e-6,n,e,i,t,r,s;for(n in vt)n!=="useRadians"&&(t=vt[n],typeof t=="function"&&(t=t(D,rt)),s=(t+"").split("_"),e=s[0],i=parseFloat(typeof rt[n]!="function"?rt[n]:rt[n.indexOf("set")||typeof rt["get"+n.substr(3)]!="function"?n:"get"+n.substr(3)]()),t=this.finals[n]=typeof e=="string"&&e.charAt(1)==="="?i+parseInt(e.charAt(0)+"1",10)*Number(e.substr(2)):Number(e)||0,r=t-i,s.length&&(e=s.join("_"),e.indexOf("short")!==-1&&(r=r%p,r!==r%(p/2)&&(r=r<0?r+p:r-p)),e.indexOf("_cw")!==-1&&r<0?r=(r+p*9999999999)%p-(r/p|0)*p:e.indexOf("ccw")!==-1&&r>0&&(r=(r-p*9999999999)%p-(r/p|0)*p)),(r>l||r<-l)&&(this._addTween(rt,n,i,i+r,n),this._overwriteProps.push(n)));return!0},set:function(rt){var vt;if(rt!==1)this._super.setRatio.call(this,rt);else for(vt=this._firstPT;vt;)vt.f?vt.t[vt.p](this.finals[vt.p]):vt.t[vt.p]=this.finals[vt.p],vt=vt._next}})._autoCSS=!0,ei._gsDefine("easing.Back",["easing.Ease"],function(rt){var vt=ei.GreenSockGlobals||ei,B=vt.com.greensock,D=Math.PI*2,p=Math.PI/2,l=B._class,n=function(u,m){var g=l("easing."+u,function(){},!0),_=g.prototype=new rt;return _.constructor=g,_.getRatio=m,g},e=rt.register||function(){},i=function(u,m,g,_,y){var v=l("easing."+u,{easeOut:new m,easeIn:new g,easeInOut:new _},!0);return e(v,u),v},t=function(u,m,g){this.t=u,this.v=m,g&&(this.next=g,g.prev=this,this.c=g.v-m,this.gap=g.t-u)},r=function(u,m){var g=l("easing."+u,function(y){this._p1=y||y===0?y:1.70158,this._p2=this._p1*1.525},!0),_=g.prototype=new rt;return _.constructor=g,_.getRatio=m,_.config=function(y){return new g(y)},g},s=i("Back",r("BackOut",function(u){return(u=u-1)*u*((this._p1+1)*u+this._p1)+1}),r("BackIn",function(u){return u*u*((this._p1+1)*u-this._p1)}),r("BackInOut",function(u){return(u*=2)<1?.5*u*u*((this._p2+1)*u-this._p2):.5*((u-=2)*u*((this._p2+1)*u+this._p2)+2)})),a=l("easing.SlowMo",function(u,m,g){m=m||m===0?m:.7,u==null?u=.7:u>1&&(u=1),this._p=u!==1?m:0,this._p1=(1-u)/2,this._p2=u,this._p3=this._p1+this._p2,this._calcEnd=g===!0},!0),f=a.prototype=new rt,o,c,d,h;return f.constructor=a,f.getRatio=function(u){var m=u+(.5-u)*this._p;return u<this._p1?this._calcEnd?1-(u=1-u/this._p1)*u:m-(u=1-u/this._p1)*u*u*u*m:u>this._p3?this._calcEnd?u===1?0:1-(u=(u-this._p3)/this._p1)*u:m+(u-m)*(u=(u-this._p3)/this._p1)*u*u*u:this._calcEnd?1:m},a.ease=new a(.7,.7),f.config=a.config=function(u,m,g){return new a(u,m,g)},o=l("easing.SteppedEase",function(u,m){u=u||1,this._p1=1/u,this._p2=u+(m?0:1),this._p3=m?1:0},!0),f=o.prototype=new rt,f.constructor=o,f.getRatio=function(u){return u<0?u=0:u>=1&&(u=.999999999),((this._p2*u|0)+this._p3)*this._p1},f.config=o.config=function(u,m){return new o(u,m)},c=l("easing.ExpoScaleEase",function(u,m,g){this._p1=Math.log(m/u),this._p2=m-u,this._p3=u,this._ease=g},!0),f=c.prototype=new rt,f.constructor=c,f.getRatio=function(u){return this._ease&&(u=this._ease.getRatio(u)),(this._p3*Math.exp(this._p1*u)-this._p3)/this._p2},f.config=c.config=function(u,m,g){return new c(u,m,g)},d=l("easing.RoughEase",function(u){u=u||{};for(var m=u.taper||"none",g=[],_=0,y=(u.points||20)|0,v=y,b=u.randomize!==!1,R=u.clamp===!0,M=u.template instanceof rt?u.template:null,P=typeof u.strength=="number"?u.strength*.4:.4,T,E,x,S,L,C;--v>-1;)T=b?Math.random():1/y*v,E=M?M.getRatio(T):T,m==="none"?x=P:m==="out"?(S=1-T,x=S*S*P):m==="in"?x=T*T*P:T<.5?(S=T*2,x=S*S*.5*P):(S=(1-T)*2,x=S*S*.5*P),b?E+=Math.random()*x-x*.5:v%2?E+=x*.5:E-=x*.5,R&&(E>1?E=1:E<0&&(E=0)),g[_++]={x:T,y:E};for(g.sort(function(F,q){return F.x-q.x}),C=new t(1,1,null),v=y;--v>-1;)L=g[v],C=new t(L.x,L.y,C);this._prev=new t(0,0,C.t!==0?C:C.next)},!0),f=d.prototype=new rt,f.constructor=d,f.getRatio=function(u){var m=this._prev;if(u>m.t){for(;m.next&&u>=m.t;)m=m.next;m=m.prev}else for(;m.prev&&u<=m.t;)m=m.prev;return this._prev=m,m.v+(u-m.t)/m.gap*m.c},f.config=function(u){return new d(u)},d.ease=new d,i("Bounce",n("BounceOut",function(u){return u<1/2.75?7.5625*u*u:u<2/2.75?7.5625*(u-=1.5/2.75)*u+.75:u<2.5/2.75?7.5625*(u-=2.25/2.75)*u+.9375:7.5625*(u-=2.625/2.75)*u+.984375}),n("BounceIn",function(u){return(u=1-u)<1/2.75?1-7.5625*u*u:u<2/2.75?1-(7.5625*(u-=1.5/2.75)*u+.75):u<2.5/2.75?1-(7.5625*(u-=2.25/2.75)*u+.9375):1-(7.5625*(u-=2.625/2.75)*u+.984375)}),n("BounceInOut",function(u){var m=u<.5;return m?u=1-u*2:u=u*2-1,u<1/2.75?u=7.5625*u*u:u<2/2.75?u=7.5625*(u-=1.5/2.75)*u+.75:u<2.5/2.75?u=7.5625*(u-=2.25/2.75)*u+.9375:u=7.5625*(u-=2.625/2.75)*u+.984375,m?(1-u)*.5:u*.5+.5})),i("Circ",n("CircOut",function(u){return Math.sqrt(1-(u=u-1)*u)}),n("CircIn",function(u){return-(Math.sqrt(1-u*u)-1)}),n("CircInOut",function(u){return(u*=2)<1?-.5*(Math.sqrt(1-u*u)-1):.5*(Math.sqrt(1-(u-=2)*u)+1)})),h=function(u,m,g){var _=l("easing."+u,function(v,b){this._p1=v>=1?v:1,this._p2=(b||g)/(v<1?v:1),this._p3=this._p2/D*(Math.asin(1/this._p1)||0),this._p2=D/this._p2},!0),y=_.prototype=new rt;return y.constructor=_,y.getRatio=m,y.config=function(v,b){return new _(v,b)},_},i("Elastic",h("ElasticOut",function(u){return this._p1*Math.pow(2,-10*u)*Math.sin((u-this._p3)*this._p2)+1},.3),h("ElasticIn",function(u){return-(this._p1*Math.pow(2,10*(u-=1))*Math.sin((u-this._p3)*this._p2))},.3),h("ElasticInOut",function(u){return(u*=2)<1?-.5*(this._p1*Math.pow(2,10*(u-=1))*Math.sin((u-this._p3)*this._p2)):this._p1*Math.pow(2,-10*(u-=1))*Math.sin((u-this._p3)*this._p2)*.5+1},.45)),i("Expo",n("ExpoOut",function(u){return 1-Math.pow(2,-10*u)}),n("ExpoIn",function(u){return Math.pow(2,10*(u-1))-.001}),n("ExpoInOut",function(u){return(u*=2)<1?.5*Math.pow(2,10*(u-1)):.5*(2-Math.pow(2,-10*(u-1)))})),i("Sine",n("SineOut",function(u){return Math.sin(u*p)}),n("SineIn",function(u){return-Math.cos(u*p)+1}),n("SineInOut",function(u){return-.5*(Math.cos(Math.PI*u)-1)})),l("easing.EaseLookup",{find:function(u){return rt.map[u]}},!0),e(vt.SlowMo,"SlowMo","ease,"),e(d,"RoughEase","ease,"),e(o,"SteppedEase","ease,"),s},!0)});ei._gsDefine&&ei._gsQueue.pop()();(function(rt,vt){"use strict";var B={},D=rt.document,p=rt.GreenSockGlobals=rt.GreenSockGlobals||rt,l=p[vt];if(l)return typeof bi<"u"&&bi.exports&&(bi.exports=l),l;var n=function(N){var K=N.split("."),k=p,Y;for(Y=0;Y<K.length;Y++)k[K[Y]]=k=k[K[Y]]||{};return k},e=n("com.greensock"),i=1e-10,t=function(N){var K=[],k=N.length,Y;for(Y=0;Y!==k;K.push(N[Y++]));return K},r=function(){},s=function(){var N=Object.prototype.toString,K=N.call([]);return function(k){return k!=null&&(k instanceof Array||typeof k=="object"&&!!k.push&&N.call(k)===K)}}(),a,f,o,c,d,h={},u=function(N,K,k,Y){this.sc=h[N]?h[N].sc:[],h[N]=this,this.gsClass=null,this.func=k;var ht=[];this.check=function(wt){for(var Et=K.length,Mt=Et,Dt,At,Xt,ie;--Et>-1;)(Dt=h[K[Et]]||new u(K[Et],[])).gsClass?(ht[Et]=Dt.gsClass,Mt--):wt&&Dt.sc.push(this);if(Mt===0&&k){if(At=("com.greensock."+N).split("."),Xt=At.pop(),ie=n(At.join("."))[Xt]=this.gsClass=k.apply(k,ht),Y)if(p[Xt]=B[Xt]=ie,typeof bi<"u"&&bi.exports)if(N===vt){bi.exports=B[vt]=ie;for(Et in B)ie[Et]=B[Et]}else B[vt]&&(B[vt][Xt]=ie);else typeof define=="function"&&define.amd&&define((rt.GreenSockAMDPath?rt.GreenSockAMDPath+"/":"")+N.split(".").pop(),[],function(){return ie});for(Et=0;Et<this.sc.length;Et++)this.sc[Et].check()}},this.check(!0)},m=rt._gsDefine=function(N,K,k,Y){return new u(N,K,k,Y)},g=e._class=function(N,K,k){return K=K||function(){},m(N,[],function(){return K},k),K};m.globals=p;var _=[0,0,1,1],y=g("easing.Ease",function(N,K,k,Y){this._func=N,this._type=k||0,this._power=Y||0,this._params=K?_.concat(K):_},!0),v=y.map={},b=y.register=function(N,K,k,Y){for(var ht=K.split(","),wt=ht.length,Et=(k||"easeIn,easeOut,easeInOut").split(","),Mt,Dt,At,Xt;--wt>-1;)for(Dt=ht[wt],Mt=Y?g("easing."+Dt,null,!0):e.easing[Dt]||{},At=Et.length;--At>-1;)Xt=Et[At],v[Dt+"."+Xt]=v[Xt+Dt]=Mt[Xt]=N.getRatio?N:N[Xt]||new N};for(o=y.prototype,o._calcEnd=!1,o.getRatio=function(N){if(this._func)return this._params[0]=N,this._func.apply(null,this._params);var K=this._type,k=this._power,Y=K===1?1-N:K===2?N:N<.5?N*2:(1-N)*2;return k===1?Y*=Y:k===2?Y*=Y*Y:k===3?Y*=Y*Y*Y:k===4&&(Y*=Y*Y*Y*Y),K===1?1-Y:K===2?Y:N<.5?Y/2:1-Y/2},a=["Linear","Quad","Cubic","Quart","Quint,Strong"],f=a.length;--f>-1;)o=a[f]+",Power"+f,b(new y(null,null,1,f),o,"easeOut",!0),b(new y(null,null,2,f),o,"easeIn"+(f===0?",easeNone":"")),b(new y(null,null,3,f),o,"easeInOut");v.linear=e.easing.Linear.easeIn,v.swing=e.easing.Quad.easeInOut;var R=g("events.EventDispatcher",function(N){this._listeners={},this._eventTarget=N||this});o=R.prototype,o.addEventListener=function(N,K,k,Y,ht){ht=ht||0;var wt=this._listeners[N],Et=0,Mt,Dt;for(this===c&&!d&&c.wake(),wt==null&&(this._listeners[N]=wt=[]),Dt=wt.length;--Dt>-1;)Mt=wt[Dt],Mt.c===K&&Mt.s===k?wt.splice(Dt,1):Et===0&&Mt.pr<ht&&(Et=Dt+1);wt.splice(Et,0,{c:K,s:k,up:Y,pr:ht})},o.removeEventListener=function(N,K){var k=this._listeners[N],Y;if(k){for(Y=k.length;--Y>-1;)if(k[Y].c===K){k.splice(Y,1);return}}},o.dispatchEvent=function(N){var K=this._listeners[N],k,Y,ht;if(K)for(k=K.length,k>1&&(K=K.slice(0)),Y=this._eventTarget;--k>-1;)ht=K[k],ht&&(ht.up?ht.c.call(ht.s||Y,{type:N,target:Y}):ht.c.call(ht.s||Y))};var M=rt.requestAnimationFrame,P=rt.cancelAnimationFrame,T=Date.now||function(){return new Date().getTime()},E=T();for(a=["ms","moz","webkit","o"],f=a.length;--f>-1&&!M;)M=rt[a[f]+"RequestAnimationFrame"],P=rt[a[f]+"CancelAnimationFrame"]||rt[a[f]+"CancelRequestAnimationFrame"];g("Ticker",function(N,K){var k=this,Y=T(),ht=K!==!1&&M?"auto":!1,wt=500,Et=33,Mt="tick",Dt,At,Xt,ie,le,W=function(ct){var z=T()-E,nt,Ht;z>wt&&(Y+=z-Et),E+=z,k.time=(E-Y)/1e3,nt=k.time-le,(!Dt||nt>0||ct===!0)&&(k.frame++,le+=nt+(nt>=ie?.004:ie-nt),Ht=!0),ct!==!0&&(Xt=At(W)),Ht&&k.dispatchEvent(Mt)};R.call(k),k.time=k.frame=0,k.tick=function(){W(!0)},k.lagSmoothing=function(ct,z){if(!arguments.length)return wt<1/i;wt=ct||1/i,Et=Math.min(z,wt,0)},k.sleep=function(){Xt!=null&&(!ht||!P?clearTimeout(Xt):P(Xt),At=r,Xt=null,k===c&&(d=!1))},k.wake=function(ct){Xt!==null?k.sleep():ct?Y+=-E+(E=T()):k.frame>10&&(E=T()-wt+5),At=Dt===0?r:!ht||!M?function(z){return setTimeout(z,(le-k.time)*1e3+1|0)}:M,k===c&&(d=!0),W(2)},k.fps=function(ct){if(!arguments.length)return Dt;Dt=ct,ie=1/(Dt||60),le=this.time+ie,k.wake()},k.useRAF=function(ct){if(!arguments.length)return ht;k.sleep(),ht=ct,k.fps(Dt)},k.fps(N),setTimeout(function(){ht==="auto"&&k.frame<5&&(D||{}).visibilityState!=="hidden"&&k.useRAF(!1)},1500)}),o=e.Ticker.prototype=new e.events.EventDispatcher,o.constructor=e.Ticker;var x=g("core.Animation",function(N,K){if(this.vars=K=K||{},this._duration=this._totalDuration=N||0,this._delay=Number(K.delay)||0,this._timeScale=1,this._active=K.immediateRender===!0,this.data=K.data,this._reversed=K.reversed===!0,!!at){d||c.wake();var k=this.vars.useFrames?J:at;k.add(this,k._time),this.vars.paused&&this.paused(!0)}});c=x.ticker=new e.Ticker,o=x.prototype,o._dirty=o._gc=o._initted=o._paused=!1,o._totalTime=o._time=0,o._rawPrevTime=-1,o._next=o._last=o._onUpdate=o._timeline=o.timeline=null,o._paused=!1;var S=function(){d&&T()-E>2e3&&((D||{}).visibilityState!=="hidden"||!c.lagSmoothing())&&c.wake();var N=setTimeout(S,2e3);N.unref&&N.unref()};S(),o.play=function(N,K){return N!=null&&this.seek(N,K),this.reversed(!1).paused(!1)},o.pause=function(N,K){return N!=null&&this.seek(N,K),this.paused(!0)},o.resume=function(N,K){return N!=null&&this.seek(N,K),this.paused(!1)},o.seek=function(N,K){return this.totalTime(Number(N),K!==!1)},o.restart=function(N,K){return this.reversed(!1).paused(!1).totalTime(N?-this._delay:0,K!==!1,!0)},o.reverse=function(N,K){return N!=null&&this.seek(N||this.totalDuration(),K),this.reversed(!0).paused(!1)},o.render=function(N,K,k){},o.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,(this._gc||!this.timeline)&&this._enabled(!0),this},o.isActive=function(){var N=this._timeline,K=this._startTime,k;return!N||!this._gc&&!this._paused&&N.isActive()&&(k=N.rawTime(!0))>=K&&k<K+this.totalDuration()/this._timeScale-1e-7},o._enabled=function(N,K){return d||c.wake(),this._gc=!N,this._active=this.isActive(),K!==!0&&(N&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!N&&this.timeline&&this._timeline._remove(this,!0)),!1},o._kill=function(N,K){return this._enabled(!1,!1)},o.kill=function(N,K){return this._kill(N,K),this},o._uncache=function(N){for(var K=N?this:this.timeline;K;)K._dirty=!0,K=K.timeline;return this},o._swapSelfInParams=function(N){for(var K=N.length,k=N.concat();--K>-1;)N[K]==="{self}"&&(k[K]=this);return k},o._callback=function(N){var K=this.vars,k=K[N],Y=K[N+"Params"],ht=K[N+"Scope"]||K.callbackScope||this,wt=Y?Y.length:0;switch(wt){case 0:k.call(ht);break;case 1:k.call(ht,Y[0]);break;case 2:k.call(ht,Y[0],Y[1]);break;default:k.apply(ht,Y)}},o.eventCallback=function(N,K,k,Y){if((N||"").substr(0,2)==="on"){var ht=this.vars;if(arguments.length===1)return ht[N];K==null?delete ht[N]:(ht[N]=K,ht[N+"Params"]=s(k)&&k.join("").indexOf("{self}")!==-1?this._swapSelfInParams(k):k,ht[N+"Scope"]=Y),N==="onUpdate"&&(this._onUpdate=K)}return this},o.delay=function(N){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+N-this._delay),this._delay=N,this):this._delay},o.duration=function(N){return arguments.length?(this._duration=this._totalDuration=N,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&N!==0&&this.totalTime(this._totalTime*(N/this._duration),!0),this):(this._dirty=!1,this._duration)},o.totalDuration=function(N){return this._dirty=!1,arguments.length?this.duration(N):this._totalDuration},o.time=function(N,K){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(N>this._duration?this._duration:N,K)):this._time},o.totalTime=function(N,K,k){if(d||c.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(N<0&&!k&&(N+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var Y=this._totalDuration,ht=this._timeline;if(N>Y&&!k&&(N=Y),this._startTime=(this._paused?this._pauseTime:ht._time)-(this._reversed?Y-N:N)/this._timeScale,ht._dirty||this._uncache(!1),ht._timeline)for(;ht._timeline;)ht._timeline._time!==(ht._startTime+ht._totalTime)/ht._timeScale&&ht.totalTime(ht._totalTime,!0),ht=ht._timeline}this._gc&&this._enabled(!0,!1),(this._totalTime!==N||this._duration===0)&&(it.length&&Rt(),this.render(N,K,!1),it.length&&Rt())}return this},o.progress=o.totalProgress=function(N,K){var k=this.duration();return arguments.length?this.totalTime(k*N,K):k?this._time/k:this.ratio},o.startTime=function(N){return arguments.length?(N!==this._startTime&&(this._startTime=N,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,N-this._delay)),this):this._startTime},o.endTime=function(N){return this._startTime+(N!=!1?this.totalDuration():this.duration())/this._timeScale},o.timeScale=function(N){if(!arguments.length)return this._timeScale;var K,k;for(N=N||i,this._timeline&&this._timeline.smoothChildTiming&&(K=this._pauseTime,k=K||K===0?K:this._timeline.totalTime(),this._startTime=k-(k-this._startTime)*this._timeScale/N),this._timeScale=N,k=this.timeline;k&&k.timeline;)k._dirty=!0,k.totalDuration(),k=k.timeline;return this},o.reversed=function(N){return arguments.length?(N!=this._reversed&&(this._reversed=N,this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},o.paused=function(N){if(!arguments.length)return this._paused;var K=this._timeline,k,Y;return N!=this._paused&&K&&(!d&&!N&&c.wake(),k=K.rawTime(),Y=k-this._pauseTime,!N&&K.smoothChildTiming&&(this._startTime+=Y,this._uncache(!1)),this._pauseTime=N?k:null,this._paused=N,this._active=this.isActive(),!N&&Y!==0&&this._initted&&this.duration()&&(k=K.smoothChildTiming?this._totalTime:(k-this._startTime)/this._timeScale,this.render(k,k===this._totalTime,!0))),this._gc&&!N&&this._enabled(!0,!1),this};var L=g("core.SimpleTimeline",function(N){x.call(this,0,N),this.autoRemoveChildren=this.smoothChildTiming=!0});o=L.prototype=new x,o.constructor=L,o.kill()._gc=!1,o._first=o._last=o._recent=null,o._sortChildren=!1,o.add=o.insert=function(N,K,k,Y){var ht,wt;if(N._startTime=Number(K||0)+N._delay,N._paused&&this!==N._timeline&&(N._pauseTime=this.rawTime()-(N._timeline.rawTime()-N._pauseTime)),N.timeline&&N.timeline._remove(N,!0),N.timeline=N._timeline=this,N._gc&&N._enabled(!0,!0),ht=this._last,this._sortChildren)for(wt=N._startTime;ht&&ht._startTime>wt;)ht=ht._prev;return ht?(N._next=ht._next,ht._next=N):(N._next=this._first,this._first=N),N._next?N._next._prev=N:this._last=N,N._prev=ht,this._recent=N,this._timeline&&this._uncache(!0),this},o._remove=function(N,K){return N.timeline===this&&(K||N._enabled(!1,!0),N._prev?N._prev._next=N._next:this._first===N&&(this._first=N._next),N._next?N._next._prev=N._prev:this._last===N&&(this._last=N._prev),N._next=N._prev=N.timeline=null,N===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},o.render=function(N,K,k){var Y=this._first,ht;for(this._totalTime=this._time=this._rawPrevTime=N;Y;)ht=Y._next,(Y._active||N>=Y._startTime&&!Y._paused&&!Y._gc)&&(Y._reversed?Y.render((Y._dirty?Y.totalDuration():Y._totalDuration)-(N-Y._startTime)*Y._timeScale,K,k):Y.render((N-Y._startTime)*Y._timeScale,K,k)),Y=ht},o.rawTime=function(){return d||c.wake(),this._totalTime};var C=g("TweenLite",function(N,K,k){if(x.call(this,K,k),this.render=C.prototype.render,N==null)throw"Cannot tween a null target.";this.target=N=typeof N!="string"?N:C.selector(N)||N;var Y=N.jquery||N.length&&N!==rt&&N[0]&&(N[0]===rt||N[0].nodeType&&N[0].style&&!N.nodeType),ht=this.vars.overwrite,wt,Et,Mt;if(this._overwrite=ht=ht==null?j[C.defaultOverwrite]:typeof ht=="number"?ht>>0:j[ht],(Y||N instanceof Array||N.push&&s(N))&&typeof N[0]!="number")for(this._targets=Mt=t(N),this._propLookup=[],this._siblings=[],wt=0;wt<Mt.length;wt++){if(Et=Mt[wt],Et){if(typeof Et=="string"){Et=Mt[wt--]=C.selector(Et),typeof Et=="string"&&Mt.splice(wt+1,1);continue}else if(Et.length&&Et!==rt&&Et[0]&&(Et[0]===rt||Et[0].nodeType&&Et[0].style&&!Et.nodeType)){Mt.splice(wt--,1),this._targets=Mt=Mt.concat(t(Et));continue}}else{Mt.splice(wt--,1);continue}this._siblings[wt]=Lt(Et,this,!1),ht===1&&this._siblings[wt].length>1&&zt(Et,this,null,1,this._siblings[wt])}else this._propLookup={},this._siblings=Lt(N,this,!1),ht===1&&this._siblings.length>1&&zt(N,this,null,1,this._siblings);(this.vars.immediateRender||K===0&&this._delay===0&&this.vars.immediateRender!==!1)&&(this._time=-i,this.render(Math.min(0,-this._delay)))},!0),F=function(N){return N&&N.length&&N!==rt&&N[0]&&(N[0]===rt||N[0].nodeType&&N[0].style&&!N.nodeType)},q=function(N,K){var k={},Y;for(Y in N)!ne[Y]&&(!(Y in K)||Y==="transform"||Y==="x"||Y==="y"||Y==="width"||Y==="height"||Y==="className"||Y==="border")&&(!Gt[Y]||Gt[Y]&&Gt[Y]._autoCSS)&&(k[Y]=N[Y],delete N[Y]);N.css=k};o=C.prototype=new x,o.constructor=C,o.kill()._gc=!1,o.ratio=0,o._firstPT=o._targets=o._overwrittenProps=o._startAt=null,o._notifyPluginsOfEnabled=o._lazy=!1,C.version="2.0.2",C.defaultEase=o._ease=new y(null,null,1,1),C.defaultOverwrite="auto",C.ticker=c,C.autoSleep=120,C.lagSmoothing=function(N,K){c.lagSmoothing(N,K)},C.selector=rt.$||rt.jQuery||function(N){var K=rt.$||rt.jQuery;return K?(C.selector=K,K(N)):(D||(D=rt.document),D?D.querySelectorAll?D.querySelectorAll(N):D.getElementById(N.charAt(0)==="#"?N.substr(1):N):N)};var it=[],st={},pt=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/ig,_t=/[\+-]=-?[\.\d]/,X=function(N){for(var K=this._firstPT,k=1e-6,Y;K;)Y=K.blob?N===1&&this.end!=null?this.end:N?this.join(""):this.start:K.c*N+K.s,K.m?Y=K.m.call(this._tween,Y,this._target||K.t,this._tween):Y<k&&Y>-k&&!K.blob&&(Y=0),K.f?K.fp?K.t[K.p](K.fp,Y):K.t[K.p](Y):K.t[K.p]=Y,K=K._next},ot=function(N,K,k,Y){var ht=[],wt=0,Et="",Mt=0,Dt,At,Xt,ie,le,W,ct;for(ht.start=N,ht.end=K,N=ht[0]=N+"",K=ht[1]=K+"",k&&(k(ht),N=ht[0],K=ht[1]),ht.length=0,Dt=N.match(pt)||[],At=K.match(pt)||[],Y&&(Y._next=null,Y.blob=1,ht._firstPT=ht._applyPT=Y),le=At.length,ie=0;ie<le;ie++)ct=At[ie],W=K.substr(wt,K.indexOf(ct,wt)-wt),Et+=W||!ie?W:",",wt+=W.length,Mt?Mt=(Mt+1)%5:W.substr(-5)==="rgba("&&(Mt=1),ct===Dt[ie]||Dt.length<=ie?Et+=ct:(Et&&(ht.push(Et),Et=""),Xt=parseFloat(Dt[ie]),ht.push(Xt),ht._firstPT={_next:ht._firstPT,t:ht,p:ht.length-1,s:Xt,c:(ct.charAt(1)==="="?parseInt(ct.charAt(0)+"1",10)*parseFloat(ct.substr(2)):parseFloat(ct)-Xt)||0,f:0,m:Mt&&Mt<4?Math.round:0}),wt+=ct.length;return Et+=K.substr(wt),Et&&ht.push(Et),ht.setRatio=X,_t.test(K)&&(ht.end=null),ht},Tt=function(N,K,k,Y,ht,wt,Et,Mt,Dt){typeof Y=="function"&&(Y=Y(Dt||0,N));var At=typeof N[K],Xt=At!=="function"?"":K.indexOf("set")||typeof N["get"+K.substr(3)]!="function"?K:"get"+K.substr(3),ie=k!=="get"?k:Xt?Et?N[Xt](Et):N[Xt]():N[K],le=typeof Y=="string"&&Y.charAt(1)==="=",W={t:N,p:K,s:ie,f:At==="function",pg:0,n:ht||K,m:wt?typeof wt=="function"?wt:Math.round:0,pr:0,c:le?parseInt(Y.charAt(0)+"1",10)*parseFloat(Y.substr(2)):parseFloat(Y)-ie||0},ct;if((typeof ie!="number"||typeof Y!="number"&&!le)&&(Et||isNaN(ie)||!le&&isNaN(Y)||typeof ie=="boolean"||typeof Y=="boolean"?(W.fp=Et,ct=ot(ie,le?parseFloat(W.s)+W.c+(W.s+"").replace(/[0-9\-\.]/g,""):Y,Mt||C.defaultStringFilter,W),W={t:ct,p:"setRatio",s:0,c:1,f:2,pg:0,n:ht||K,pr:0,m:0}):(W.s=parseFloat(ie),le||(W.c=parseFloat(Y)-W.s||0))),W.c)return(W._next=this._firstPT)&&(W._next._prev=W),this._firstPT=W,W},Vt=C._internals={isArray:s,isSelector:F,lazyTweens:it,blobDif:ot},Gt=C._plugins={},qt=Vt.tweenLookup={},Qt=0,ne=Vt.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1,yoyoEase:1},j={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,true:1,false:0},J=x._rootFramesTimeline=new L,at=x._rootTimeline=new L,xt=30,Rt=Vt.lazyRender=function(){var N=it.length,K;for(st={};--N>-1;)K=it[N],K&&K._lazy!==!1&&(K.render(K._lazy[0],K._lazy[1],!0),K._lazy=!1);it.length=0};at._startTime=c.time,J._startTime=c.frame,at._active=J._active=!0,setTimeout(Rt,1),x._updateRoot=C.render=function(){var N,K,k;if(it.length&&Rt(),at.render((c.time-at._startTime)*at._timeScale,!1,!1),J.render((c.frame-J._startTime)*J._timeScale,!1,!1),it.length&&Rt(),c.frame>=xt){xt=c.frame+(parseInt(C.autoSleep,10)||120);for(k in qt){for(K=qt[k].tweens,N=K.length;--N>-1;)K[N]._gc&&K.splice(N,1);K.length===0&&delete qt[k]}if(k=at._first,(!k||k._paused)&&C.autoSleep&&!J._first&&c._listeners.tick.length===1){for(;k&&k._paused;)k=k._next;k||c.sleep()}}},c.addEventListener("tick",x._updateRoot);var Lt=function(N,K,k){var Y=N._gsTweenID,ht,wt;if(qt[Y||(N._gsTweenID=Y="t"+Qt++)]||(qt[Y]={target:N,tweens:[]}),K&&(ht=qt[Y].tweens,ht[wt=ht.length]=K,k))for(;--wt>-1;)ht[wt]===K&&ht.splice(wt,1);return qt[Y].tweens},te=function(N,K,k,Y){var ht=N.vars.onOverwrite,wt,Et;return ht&&(wt=ht(N,K,k,Y)),ht=C.onOverwrite,ht&&(Et=ht(N,K,k,Y)),wt!==!1&&Et!==!1},zt=function(N,K,k,Y,ht){var wt,Et,Mt,Dt;if(Y===1||Y>=4){for(Dt=ht.length,wt=0;wt<Dt;wt++)if((Mt=ht[wt])!==K)Mt._gc||Mt._kill(null,N,K)&&(Et=!0);else if(Y===5)break;return Et}var At=K._startTime+i,Xt=[],ie=0,le=K._duration===0,W;for(wt=ht.length;--wt>-1;)(Mt=ht[wt])===K||Mt._gc||Mt._paused||(Mt._timeline!==K._timeline?(W=W||ee(K,0,le),ee(Mt,W,le)===0&&(Xt[ie++]=Mt)):Mt._startTime<=At&&Mt._startTime+Mt.totalDuration()/Mt._timeScale>At&&((le||!Mt._initted)&&At-Mt._startTime<=2e-10||(Xt[ie++]=Mt)));for(wt=ie;--wt>-1;)if(Mt=Xt[wt],Dt=Mt._firstPT,Y===2&&Mt._kill(k,N,K)&&(Et=!0),Y!==2||!Mt._firstPT&&Mt._initted&&Dt){if(Y!==2&&!te(Mt,K))continue;Mt._enabled(!1,!1)&&(Et=!0)}return Et},ee=function(N,K,k){for(var Y=N._timeline,ht=Y._timeScale,wt=N._startTime;Y._timeline;){if(wt+=Y._startTime,ht*=Y._timeScale,Y._paused)return-100;Y=Y._timeline}return wt/=ht,wt>K?wt-K:k&&wt===K||!N._initted&&wt-K<2*i?i:(wt+=N.totalDuration()/N._timeScale/ht)>K+i?0:wt-K-i};o._init=function(){var N=this.vars,K=this._overwrittenProps,k=this._duration,Y=!!N.immediateRender,ht=N.ease,wt,Et,Mt,Dt,At,Xt;if(N.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),At={};for(Dt in N.startAt)At[Dt]=N.startAt[Dt];if(At.data="isStart",At.overwrite=!1,At.immediateRender=!0,At.lazy=Y&&N.lazy!==!1,At.startAt=At.delay=null,At.onUpdate=N.onUpdate,At.onUpdateParams=N.onUpdateParams,At.onUpdateScope=N.onUpdateScope||N.callbackScope||this,this._startAt=C.to(this.target||{},0,At),Y){if(this._time>0)this._startAt=null;else if(k!==0)return}}else if(N.runBackwards&&k!==0)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{this._time!==0&&(Y=!1),Mt={};for(Dt in N)(!ne[Dt]||Dt==="autoCSS")&&(Mt[Dt]=N[Dt]);if(Mt.overwrite=0,Mt.data="isFromStart",Mt.lazy=Y&&N.lazy!==!1,Mt.immediateRender=Y,this._startAt=C.to(this.target,0,Mt),!Y)this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null);else if(this._time===0)return}if(this._ease=ht=ht?ht instanceof y?ht:typeof ht=="function"?new y(ht,N.easeParams):v[ht]||C.defaultEase:C.defaultEase,N.easeParams instanceof Array&&ht.config&&(this._ease=ht.config.apply(ht,N.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(Xt=this._targets.length,wt=0;wt<Xt;wt++)this._initProps(this._targets[wt],this._propLookup[wt]={},this._siblings[wt],K?K[wt]:null,wt)&&(Et=!0);else Et=this._initProps(this.target,this._propLookup,this._siblings,K,0);if(Et&&C._onPluginEvent("_onInitAllProps",this),K&&(this._firstPT||typeof this.target!="function"&&this._enabled(!1,!1)),N.runBackwards)for(Mt=this._firstPT;Mt;)Mt.s+=Mt.c,Mt.c=-Mt.c,Mt=Mt._next;this._onUpdate=N.onUpdate,this._initted=!0},o._initProps=function(N,K,k,Y,ht){var wt,Et,Mt,Dt,At,Xt;if(N==null)return!1;st[N._gsTweenID]&&Rt(),this.vars.css||N.style&&N!==rt&&N.nodeType&&Gt.css&&this.vars.autoCSS!==!1&&q(this.vars,N);for(wt in this.vars)if(Xt=this.vars[wt],ne[wt])Xt&&(Xt instanceof Array||Xt.push&&s(Xt))&&Xt.join("").indexOf("{self}")!==-1&&(this.vars[wt]=Xt=this._swapSelfInParams(Xt,this));else if(Gt[wt]&&(Dt=new Gt[wt])._onInitTween(N,this.vars[wt],this,ht)){for(this._firstPT=At={_next:this._firstPT,t:Dt,p:"setRatio",s:0,c:1,f:1,n:wt,pg:1,pr:Dt._priority,m:0},Et=Dt._overwriteProps.length;--Et>-1;)K[Dt._overwriteProps[Et]]=this._firstPT;(Dt._priority||Dt._onInitAllProps)&&(Mt=!0),(Dt._onDisable||Dt._onEnable)&&(this._notifyPluginsOfEnabled=!0),At._next&&(At._next._prev=At)}else K[wt]=Tt.call(this,N,wt,"get",Xt,wt,0,null,this.vars.stringFilter,ht);return Y&&this._kill(Y,N)?this._initProps(N,K,k,Y,ht):this._overwrite>1&&this._firstPT&&k.length>1&&zt(N,this,K,this._overwrite,k)?(this._kill(K,N),this._initProps(N,K,k,Y,ht)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(st[N._gsTweenID]=!0),Mt)},o.render=function(N,K,k){var Y=this._time,ht=this._duration,wt=this._rawPrevTime,Et,Mt,Dt,At;if(N>=ht-1e-7&&N>=0)this._totalTime=this._time=ht,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(Et=!0,Mt="onComplete",k=k||this._timeline.autoRemoveChildren),ht===0&&(this._initted||!this.vars.lazy||k)&&(this._startTime===this._timeline._duration&&(N=0),(wt<0||N<=0&&N>=-1e-7||wt===i&&this.data!=="isPause")&&wt!==N&&(k=!0,wt>i&&(Mt="onReverseComplete")),this._rawPrevTime=At=!K||N||wt===N?N:i);else if(N<1e-7)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(Y!==0||ht===0&&wt>0)&&(Mt="onReverseComplete",Et=this._reversed),N<0&&(this._active=!1,ht===0&&(this._initted||!this.vars.lazy||k)&&(wt>=0&&!(wt===i&&this.data==="isPause")&&(k=!0),this._rawPrevTime=At=!K||N||wt===N?N:i)),(!this._initted||this._startAt&&this._startAt.progress())&&(k=!0);else if(this._totalTime=this._time=N,this._easeType){var Xt=N/ht,ie=this._easeType,le=this._easePower;(ie===1||ie===3&&Xt>=.5)&&(Xt=1-Xt),ie===3&&(Xt*=2),le===1?Xt*=Xt:le===2?Xt*=Xt*Xt:le===3?Xt*=Xt*Xt*Xt:le===4&&(Xt*=Xt*Xt*Xt*Xt),ie===1?this.ratio=1-Xt:ie===2?this.ratio=Xt:N/ht<.5?this.ratio=Xt/2:this.ratio=1-Xt/2}else this.ratio=this._ease.getRatio(N/ht);if(!(this._time===Y&&!k)){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!k&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)){this._time=this._totalTime=Y,this._rawPrevTime=wt,it.push(this),this._lazy=[N,K];return}this._time&&!Et?this.ratio=this._ease.getRatio(this._time/ht):Et&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(this._time===0?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==Y&&N>=0&&(this._active=!0),Y===0&&(this._startAt&&(N>=0?this._startAt.render(N,!0,k):Mt||(Mt="_dummyGS")),this.vars.onStart&&(this._time!==0||ht===0)&&(K||this._callback("onStart"))),Dt=this._firstPT;Dt;)Dt.f?Dt.t[Dt.p](Dt.c*this.ratio+Dt.s):Dt.t[Dt.p]=Dt.c*this.ratio+Dt.s,Dt=Dt._next;this._onUpdate&&(N<0&&this._startAt&&N!==-1e-4&&this._startAt.render(N,!0,k),K||(this._time!==Y||Et||k)&&this._callback("onUpdate")),Mt&&(!this._gc||k)&&(N<0&&this._startAt&&!this._onUpdate&&N!==-1e-4&&this._startAt.render(N,!0,k),Et&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!K&&this.vars[Mt]&&this._callback(Mt),ht===0&&this._rawPrevTime===i&&At!==i&&(this._rawPrevTime=0))}},o._kill=function(N,K,k){if(N==="all"&&(N=null),N==null&&(K==null||K===this.target))return this._lazy=!1,this._enabled(!1,!1);K=typeof K!="string"?K||this._targets||this.target:C.selector(K)||K;var Y=k&&this._time&&k._startTime===this._startTime&&this._timeline===k._timeline,ht=this._firstPT,wt,Et,Mt,Dt,At,Xt,ie,le,W;if((s(K)||F(K))&&typeof K[0]!="number")for(wt=K.length;--wt>-1;)this._kill(N,K[wt],k)&&(Xt=!0);else{if(this._targets){for(wt=this._targets.length;--wt>-1;)if(K===this._targets[wt]){At=this._propLookup[wt]||{},this._overwrittenProps=this._overwrittenProps||[],Et=this._overwrittenProps[wt]=N?this._overwrittenProps[wt]||{}:"all";break}}else{if(K!==this.target)return!1;At=this._propLookup,Et=this._overwrittenProps=N?this._overwrittenProps||{}:"all"}if(At){if(ie=N||At,le=N!==Et&&Et!=="all"&&N!==At&&(typeof N!="object"||!N._tempKill),k&&(C.onOverwrite||this.vars.onOverwrite)){for(Mt in ie)At[Mt]&&(W||(W=[]),W.push(Mt));if((W||!N)&&!te(this,k,K,W))return!1}for(Mt in ie)(Dt=At[Mt])&&(Y&&(Dt.f?Dt.t[Dt.p](Dt.s):Dt.t[Dt.p]=Dt.s,Xt=!0),Dt.pg&&Dt.t._kill(ie)&&(Xt=!0),(!Dt.pg||Dt.t._overwriteProps.length===0)&&(Dt._prev?Dt._prev._next=Dt._next:Dt===this._firstPT&&(this._firstPT=Dt._next),Dt._next&&(Dt._next._prev=Dt._prev),Dt._next=Dt._prev=null),delete At[Mt]),le&&(Et[Mt]=1);!this._firstPT&&this._initted&&ht&&this._enabled(!1,!1)}}return Xt},o.invalidate=function(){return this._notifyPluginsOfEnabled&&C._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],x.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-i,this.render(Math.min(0,-this._delay))),this},o._enabled=function(N,K){if(d||c.wake(),N&&this._gc){var k=this._targets,Y;if(k)for(Y=k.length;--Y>-1;)this._siblings[Y]=Lt(k[Y],this,!0);else this._siblings=Lt(this.target,this,!0)}return x.prototype._enabled.call(this,N,K),this._notifyPluginsOfEnabled&&this._firstPT?C._onPluginEvent(N?"_onEnable":"_onDisable",this):!1},C.to=function(N,K,k){return new C(N,K,k)},C.from=function(N,K,k){return k.runBackwards=!0,k.immediateRender=k.immediateRender!=!1,new C(N,K,k)},C.fromTo=function(N,K,k,Y){return Y.startAt=k,Y.immediateRender=Y.immediateRender!=!1&&k.immediateRender!=!1,new C(N,K,Y)},C.delayedCall=function(N,K,k,Y,ht){return new C(K,0,{delay:N,onComplete:K,onCompleteParams:k,callbackScope:Y,onReverseComplete:K,onReverseCompleteParams:k,immediateRender:!1,lazy:!1,useFrames:ht,overwrite:0})},C.set=function(N,K){return new C(N,0,K)},C.getTweensOf=function(N,K){if(N==null)return[];N=typeof N!="string"?N:C.selector(N)||N;var k,Y,ht,wt;if((s(N)||F(N))&&typeof N[0]!="number"){for(k=N.length,Y=[];--k>-1;)Y=Y.concat(C.getTweensOf(N[k],K));for(k=Y.length;--k>-1;)for(wt=Y[k],ht=k;--ht>-1;)wt===Y[ht]&&Y.splice(k,1)}else if(N._gsTweenID)for(Y=Lt(N).concat(),k=Y.length;--k>-1;)(Y[k]._gc||K&&!Y[k].isActive())&&Y.splice(k,1);return Y||[]},C.killTweensOf=C.killDelayedCallsTo=function(N,K,k){typeof K=="object"&&(k=K,K=!1);for(var Y=C.getTweensOf(N,K),ht=Y.length;--ht>-1;)Y[ht]._kill(k,N)};var $=g("plugins.TweenPlugin",function(N,K){this._overwriteProps=(N||"").split(","),this._propName=this._overwriteProps[0],this._priority=K||0,this._super=$.prototype},!0);if(o=$.prototype,$.version="1.19.0",$.API=2,o._firstPT=null,o._addTween=Tt,o.setRatio=X,o._kill=function(N){var K=this._overwriteProps,k=this._firstPT,Y;if(N[this._propName]!=null)this._overwriteProps=[];else for(Y=K.length;--Y>-1;)N[K[Y]]!=null&&K.splice(Y,1);for(;k;)N[k.n]!=null&&(k._next&&(k._next._prev=k._prev),k._prev?(k._prev._next=k._next,k._prev=null):this._firstPT===k&&(this._firstPT=k._next)),k=k._next;return!1},o._mod=o._roundProps=function(N){for(var K=this._firstPT,k;K;)k=N[this._propName]||K.n!=null&&N[K.n.split(this._propName+"_").join("")],k&&typeof k=="function"&&(K.f===2?K.t._applyPT.m=k:K.m=k),K=K._next},C._onPluginEvent=function(N,K){var k=K._firstPT,Y,ht,wt,Et,Mt;if(N==="_onInitAllProps"){for(;k;){for(Mt=k._next,ht=wt;ht&&ht.pr>k.pr;)ht=ht._next;(k._prev=ht?ht._prev:Et)?k._prev._next=k:wt=k,(k._next=ht)?ht._prev=k:Et=k,k=Mt}k=K._firstPT=wt}for(;k;)k.pg&&typeof k.t[N]=="function"&&k.t[N]()&&(Y=!0),k=k._next;return Y},$.activate=function(N){for(var K=N.length;--K>-1;)N[K].API===$.API&&(Gt[new N[K]()._propName]=N[K]);return!0},m.plugin=function(N){if(!N||!N.propName||!N.init||!N.API)throw"illegal plugin definition.";var K=N.propName,k=N.priority||0,Y=N.overwriteProps,ht={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},wt=g("plugins."+K.charAt(0).toUpperCase()+K.substr(1)+"Plugin",function(){$.call(this,K,k),this._overwriteProps=Y||[]},N.global===!0),Et=wt.prototype=new $(K),Mt;Et.constructor=wt,wt.API=N.API;for(Mt in ht)typeof N[Mt]=="function"&&(Et[ht[Mt]]=N[Mt]);return wt.version=N.version,$.activate([wt]),wt},a=rt._gsQueue,a){for(f=0;f<a.length;f++)a[f]();for(o in h)h[o].func||rt.console.log("GSAP encountered missing dependency: "+o)}d=!1})(typeof bi<"u"&&bi.exports&&typeof global<"u"?global:Rs||window,"TweenMax")});var ha=Ii(Ms=>{(function(rt,vt){typeof define=="function"&&define.amd?define(["ScrollMagic","TweenMax","TimelineMax"],vt):typeof Ms=="object"?(la(),vt(xs(),TweenMax,TimelineMax)):vt(rt.ScrollMagic||rt.jQuery&&rt.jQuery.ScrollMagic,rt.TweenMax||rt.TweenLite,rt.TimelineMax||rt.TimelineLite)})(Ms,function(rt,vt,B){"use strict";var D="animation.gsap",p=window.console||{},l=Function.prototype.bind.call(p.error||p.log||function(){},p);rt||l("("+D+") -> ERROR: The ScrollMagic main module could not be found. Please make sure it's loaded before this plugin or use an asynchronous loader like requirejs."),vt||l("("+D+") -> ERROR: TweenLite or TweenMax could not be found. Please make sure GSAP is loaded before ScrollMagic or use an asynchronous loader like requirejs."),rt.Scene.addOption("tweenChanges",!1,function(n){return!!n}),rt.Scene.extend(function(){var n=this,e,i=function(){n._log&&(Array.prototype.splice.call(arguments,1,0,"("+D+")","->"),n._log.apply(this,arguments))};n.on("progress.plugin_gsap",function(){t()}),n.on("destroy.plugin_gsap",function(r){n.removeTween(r.reset)});var t=function(){if(e){var r=n.progress(),s=n.state();e.repeat&&e.repeat()===-1?s==="DURING"&&e.paused()?e.play():s!=="DURING"&&!e.paused()&&e.pause():r!=e.progress()&&(n.duration()===0?r>0?e.play():e.reverse():n.tweenChanges()&&e.tweenTo?e.tweenTo(r*e.duration()):e.progress(r).pause())}};n.setTween=function(r,s,a){var f;arguments.length>1&&(arguments.length<3&&(a=s,s=1),r=vt.to(r,s,a));try{B?f=new B({smoothChildTiming:!0}).add(r):f=r,f.pause()}catch(_){return i(1,"ERROR calling method 'setTween()': Supplied argument is not a valid TweenObject"),n}if(e&&n.removeTween(),e=f,r.repeat&&r.repeat()===-1&&(e.repeat(-1),e.yoyo(r.yoyo())),n.tweenChanges()&&!e.tweenTo&&i(2,"WARNING: tweenChanges will only work if the TimelineMax object is available for ScrollMagic."),e&&n.controller()&&n.triggerElement()&&n.loglevel()>=2){var o=vt.getTweensOf(n.triggerElement()),c=n.controller().info("vertical");o.forEach(function(_,y){var v=_.vars.css||_.vars,b=c?v.top!==void 0||v.bottom!==void 0:v.left!==void 0||v.right!==void 0;if(b)return i(2,"WARNING: Tweening the position of the trigger element affects the scene timing and should be avoided!"),!1})}if(parseFloat(TweenLite.version)>=1.14)for(var d=e.getChildren?e.getChildren(!0,!0,!1):[e],h=function(){i(2,"WARNING: tween was overwritten by another. To learn how to avoid this issue see here: https://github.com/janpaepke/ScrollMagic/wiki/WARNING:-tween-was-overwritten-by-another")},u=0,m,g;u<d.length;u++)m=d[u],g!==h&&(g=m.vars.onOverwrite,m.vars.onOverwrite=function(){g&&g.apply(this,arguments),h.apply(this,arguments)});return i(3,"added tween"),t(),n},n.removeTween=function(r){return e&&(r&&e.progress(0).pause(),e.kill(),e=void 0,i(3,"removed tween (reset: "+(r?"true":"false")+")")),n}})})});var fa=Ii((zo,ua)=>{Location=WorldWind.Location;Logger=WorldWind.Logger;Position=WorldWind.Position;Vec3=WorldWind.Vec3;function $i(rt){if(!rt)throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE,"CustomGoToAnimator","constructor","missingWorldWindow"));this.wwd=rt,this.animationFrequency=20,this.travelTime=100,this.cancelled=!1,this.running=!1}$i.prototype.cancel=function(){this.cancelled=!0};$i.prototype.goTo=function(rt,vt,B){if(!rt||!vt)throw new ArgumentError(Logger.logMessage(Logger.LEVEL_SEVERE,"CustomGoToAnimator","goTo","missingPosition"));this.completionCallback=B,this.cancelled=!1,this.running=!1,this.targetPosition=new Position(vt.latitude,vt.longitude,vt.altitude||this.wwd.navigator.range),this.startPosition=new Position(rt.latitude,rt.longitude,rt.altitude);var D=this.travelTime,p=Location.greatCircleDistance(this.startPosition,this.targetPosition),l,n=this.wwd.globe.computePointFromLocation(this.startPosition.latitude,this.startPosition.longitude,new Vec3(0,0,0)),e=this.wwd.globe.computePointFromLocation(this.targetPosition.latitude,this.targetPosition.longitude,new Vec3(0,0,0));this.maxAltitude=n.distanceTo(e);var i=this.wwd.pixelSizeAtDistance(this.startPosition.altitude)*this.wwd.canvas.clientWidth/this.wwd.globe.equatorialRadius;p<=2*i&&(this.maxAltitude=this.startPosition.altitude),this.maxAltitudeReachedTime=this.maxAltitude<=this.startPosition.altitude?0:-1,this.maxAltitude>this.startPosition.altitude?(l=Math.max(0,this.maxAltitude-this.startPosition.altitude),l+=Math.abs(this.targetPosition.altitude-this.maxAltitude)):l=Math.abs(this.targetPosition.altitude-this.startPosition.altitude);var t=Math.max(p,l/this.wwd.globe.equatorialRadius);if(t!==0){t<2*i,D=Math.max(1,D),this.panVelocity=p/D,this.rangeVelocity=l/D;var r=this,s=function(a){if(r.cancelled){r.completionCallback&&r.completionCallback(r);return}r.update(a)||r.completionCallback&&r.completionCallback(r)};return s}};$i.prototype.update=function(rt){this.running||(this.updateRange(this.startPosition,rt),this.updateLocation(this.startPosition,rt),this.running=!0);var vt=new Position(this.wwd.navigator.lookAtLocation.latitude,this.wwd.navigator.lookAtLocation.longitude,this.wwd.navigator.range),B=this.updateRange(vt,rt);return B=this.updateLocation(this.startPosition,rt)||B,this.wwd.redraw(),B};$i.prototype.updateRange=function(rt,vt){var B=!1,D,p;return this.maxAltitudeReachedTime<0&&(this.maxAltitudeReachedTime=(this.maxAltitude-this.startPosition.altitude)/this.rangeVelocity),vt<this.maxAltitudeReachedTime?(p=vt,D=Math.min(this.startPosition.altitude+this.rangeVelocity*p,this.maxAltitude),this.wwd.navigator.range=D,B=!0):(vt=100*(vt-this.maxAltitudeReachedTime)/(100-this.maxAltitudeReachedTime),p=Power1.easeOut.getRatio(vt/100)*100,this.maxAltitude>this.targetPosition.altitude?D=this.maxAltitude-(this.maxAltitude-this.targetPosition.altitude)*p/100:(D=this.maxAltitude+this.rangeVelocity*p,D=Math.min(D,this.targetPosition.altitude)),this.wwd.navigator.range=D,B=Math.abs(this.wwd.navigator.range-this.targetPosition.altitude)>1),B};$i.prototype.updateLocation=function(rt,vt){var B=Power4.easeInOut.getRatio(vt/100)*100,D=Location.greatCircleDistance(this.startPosition,rt),p=Location.greatCircleDistance(rt,this.targetPosition),l=Location.greatCircleAzimuth(rt,this.targetPosition),n=this.panVelocity*B,e=Math.min(n-D,p),i=Location.greatCircleLocation(rt,l,e,new Location(0,0)),t=!1;return this.wwd.navigator.lookAtLocation.latitude=i.latitude,this.wwd.navigator.lookAtLocation.longitude=i.longitude,e<1/this.wwd.globe.equatorialRadius&&(t=!0),!t};ua.exports=$i});var da=Ii((jo,ca)=>{var er=function(){WorldWind.ElevationModel.call(this),this.addCoverage(new WorldWind.AsterV2ElevationCoverage)};er.prototype=Object.create(WorldWind.ElevationModel.prototype);er.prototype.elevationAtLocation=function(rt,vt){return WorldWind.ElevationModel.prototype.elevationAtLocation.call(this,rt,vt)};er.prototype.elevationsForGrid=function(rt,vt,B,D,p){return WorldWind.ElevationModel.prototype.elevationsForGrid.call(this,rt,vt,B,D,p)};er.prototype.bestCoverageAtLocation=function(rt,vt,B){return WorldWind.ElevationModel.prototype.bestCoverageAtLocation.call(this,rt,vt,B)};ca.exports=er});var ma=Ii(()=>{var to={"-1":{latitude:80,longitude:8.55,altitude:7e6,tilt:60,heading:0},0:{latitude:50,longitude:8.55,altitude:1e7,tilt:0,heading:0}},mi={},ar=!1;document.addEventListener("DOMContentLoaded",function(){var rt=window.location.hash?window.location.hash.substr(1):"",vt=/.+\@.+\..+/i,B=rt.match(vt),D=document.querySelector('a[href="//rsvp.dkandck.com"]');B&&(D.href="//rsvp.dkandck.com?email="+B),TweenMax.defaultEase=Linear.easeNone;var p=new ScrollMagic.Controller;let l=new Request("photos/photos.json");fetch(l).then(function(n){if(!n.ok)throw new Error("HTTP error, status = "+n.status);return n.json()}).then(function(n){var e=eo(n);return io(p,e.globePositions),e.photos}).then(function(n){ro(p,n)})});function eo(rt){var vt={},B=to,D=0;return Object.keys(rt).forEach(function(p){var l=rt[p];vt[p]=[],Object.keys(l).forEach(function(n){var e=l[n];typeof e.position=="object"&&(D++,B[D]=e.position,e.position=D),vt[p][n]=e})}),{globePositions:B,photos:vt}}function io(rt,vt){window.globePositions=vt,window.wwd=ao();var B=new WorldWind.KmlControls;B.hook=function(e,i){if(i.isFeature){var t=e.kmlName||e.id||WWUtil.guid(),r=e.enabled&&e.kmlVisibility===!0;r||(console.log(t),console.log(r))}},Object.keys(globePositions).forEach(function(e){var i=globePositions[e].overlay;if(i&&i.kmlFile){var t=new WorldWind.KmlFile(i.kmlFile,[B]);t.then(function(s){mi[e]=new WorldWind.RenderableLayer("Surface Shapes"),mi[e].addRenderable(s),mi[e].enabled=!1,wwd.addLayer(mi[e])})}else if(i&&i.label){i.latitude||(i.latitude=globePositions[e].latitude,i.longitude=globePositions[e].longitude);var r=new WorldWind.Placemark(new WorldWind.Position(i.latitude,i.longitude,100),!0,null);r.label=i.label,r.altitudeMode=WorldWind.CLAMP_TO_GROUND,mi[e]=new WorldWind.RenderableLayer("Placemarks"),mi[e].addRenderable(r),mi[e].enabled=!1,wwd.addLayer(mi[e])}});var D=new TweenMax("#globeContainer",1,{className:"small"}),p="80%";window.matchMedia("only screen and (max-aspect-ratio: 4/3)").matches&&(p="50%");var l=new ScrollMagic.Scene({triggerElement:"#sectionTitle",duration:p,triggerHook:"onLeave"}).setTween(D).addTo(rt).on("progress",function(e){e.progress<.5?Ls(-1,e.progress*2):Ls(0,(e.progress-.5)*2)});ar&&l.addIndicators({name:"sectionTitle "});var n=new ScrollMagic.Scene({triggerElement:"#sectionGoa",duration:"0",triggerHook:"onEnter"}).setClassToggle("#globeContainer","hidden").addTo(rt).on("progress",function(e){console.log(e.progress)});ar&&n.addIndicators({name:"sectionGoa"})}function ro(rt,vt){document.querySelectorAll("div.section.pinned").forEach(function(B,D){if(D>0){var p=new ScrollMagic.Scene({triggerElement:B,duration:"100%",triggerHook:"onEnter"}).addTo(rt).on("progress",function(s){});ar&&p.addIndicators({name:B.id})}if(vt[B.id]){var l=vt[B.id],n=B.querySelector("div.igContainer"),e=n.querySelector("div.igPicture");e.parentElement.removeChild(e),l.forEach(function(s,a){a>0&&(e=e.cloneNode(!0));var f=e.querySelector("div.igFrame"),o=document.createElement("img");a>0&&(o=f.firstChild),o.src="photos/"+s.file,o.style.width="100%",f.appendChild(o);var c=e.querySelector("div.igHeader > p").childNodes[2];c.nodeValue=s.locationText;var d=e.querySelector("div.igFooter > p:first-child").childNodes[1];d.nodeValue=" "+s.text;var h=e.querySelector("div.igFooter > p.date");h.textContent=s.date,n.appendChild(e)}),n.style.display="";var i=window.getComputedStyle(n,null),t=parseInt(i.getPropertyValue("height")),r=new ScrollMagic.Scene({triggerElement:B,triggerHook:"onEnter",duration:t}).addTo(rt).setClassToggle(B.querySelector("div.sectionCard"),"scaleDownIn").on("progress",function(s){var a=s.progress;if(ratioPerPic=1/l.length,pictureIdx=Math.floor(a/ratioPerPic),pictureProg=(a-ratioPerPic*pictureIdx)/ratioPerPic,vt[B.id][pictureIdx]&&vt[B.id][pictureIdx].position){var f=vt[B.id][pictureIdx].position;f>1&&Ls(vt[B.id][pictureIdx].position-1,pictureProg)}});ar&&r.addIndicators({name:"igPicture."+B.id,indent:100})}})}var qo=Date.now(),Ps=null,pa=null;function Ls(rt,vt){var B=parseInt(rt)+1;if(globePositions[rt]&&globePositions[B]){if(pa!=rt){if(pa=rt,Ps=wwd.goToAnimator.goTo(globePositions[rt],globePositions[B]),!Ps)throw"no animator";rt>1?no():so()}var D=.8;vt=Math.max(0,Math.min(1,vt/D-(1-D)/(D*2))),mi[B]&&vt>.5?mi[B].enabled=!0:mi[B]&&vt<.5&&(mi[B].enabled=!1),mi[rt]&&vt>.5?mi[rt].enabled=!1:mi[rt]&&vt<.5&&(mi[rt].enabled=!0),wwd.navigator.heading=globePositions[rt].heading+(globePositions[B].heading-globePositions[rt].heading)*vt,wwd.navigator.tilt=globePositions[rt].tilt+(globePositions[B].tilt-globePositions[rt].tilt)*vt,Ps(vt*100)}}var Di=null;function no(){Di.enabled||(Di.enabled=!0,htmlCanvas=document.getElementById("globeCanvas").style.background="black")}function so(){Di.enabled&&(Di.enabled=!1,htmlCanvas=document.getElementById("globeCanvas").style.background="none")}var Cs=null;function ao(){htmlCanvas=document.getElementById("globeCanvas"),WorldWind.configuration.baseUrl="wwd/";var rt=new WorldWind.WorldWindow("globeCanvas",new CustomEarthElevationModel);WorldWind.Logger.setLoggingLevel(WorldWind.Logger.LEVEL_WARNING),rt.goToAnimator=new CustomGoToAnimator(rt.goToAnimator.wwd),rt.navigator.lookAtLocation.latitude=globePositions[-1].latitude,rt.navigator.lookAtLocation.longitude=globePositions[-1].longitude,rt.navigator.tilt=globePositions[-1].tilt,rt.navigator.range=globePositions[-1].altitude;var vt=new WorldWind.BMNGOneImageLayer;vt.minActiveAltitude=0,rt.addLayer(vt);var B=new WorldWind.BingAerialLayer("Aja97SPGWwU2V3NBlnc_A5n0X8pguk8zIp5Z6SYRnk8cEhCwsBiotct2yyiygtq7");return B.maxActiveAltitude=5e6,B.detailControl=.8,rt.addLayer(B),Cs=new WorldWind.AtmosphereLayer,Cs.minActiveAltitude=5e3,rt.addLayer(Cs),Di=new WorldWind.StarFieldLayer,Di.minActiveAltitude=1e4,Di.enabled=!1,rt.addLayer(Di),rt}});var oo=Ii(()=>{sa();var Zo=Ua(aa());ScrollMagic=xs();ha();CustomGoToAnimator=fa();CustomEarthElevationModel=da();ma()});oo();})();
/**
 * @license almond 0.3.0 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
/*
 * @license
 * Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 * Copyright 2014, Google Inc. All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice including the dates of first publication and
 * either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 * shall be included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 * IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 * Original Code. The Original Code is: OpenGL Sample Implementation,
 * Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 * Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 * Copyright in any portions created by third parties is as indicated
 * elsewhere herein. All Rights Reserved.
 */
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   3.0.2
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/*! Bundled license information:

gsap/TweenLite.js:
  (*!
   * VERSION: 2.0.2
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   *
   * @author: Jack Doyle, jack@greensock.com
   *)

gsap/TweenMaxBase.js:
  (*!
   * VERSION: 2.0.2
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   **)

gsap/CSSPlugin.js:
  (*!
   * VERSION: 2.0.2
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   *)

gsap/AttrPlugin.js:
  (*!
   * VERSION: 0.6.1
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   *)

gsap/RoundPropsPlugin.js:
  (*!
   * VERSION: 1.6.0
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   **)

gsap/DirectionalRotationPlugin.js:
  (*!
   * VERSION: 0.3.1
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   **)

gsap/TimelineLite.js:
  (*!
   * VERSION: 2.0.2
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   *)

gsap/TimelineMax.js:
  (*!
   * VERSION: 2.0.2
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   *)

gsap/BezierPlugin.js:
  (*!
   * VERSION: 1.3.8
   * DATE: 2018-05-30
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   **)

gsap/EasePack.js:
  (*!
   * VERSION: 1.16.1
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   **)

gsap/TweenMax.js:
  (*!
   * VERSION: 2.0.2
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   **)

scrollmagic/scrollmagic/uncompressed/ScrollMagic.js:
  (*!
   * ScrollMagic v2.0.6 (2018-10-08)
   * The javascript library for magical scroll interactions.
   * (c) 2018 Jan Paepke (@janpaepke)
   * Project Website: http://scrollmagic.io
   * 
   * @version 2.0.6
   * @license Dual licensed under MIT license and GPL.
   * @author Jan Paepke - e-mail@janpaepke.de
   *
   * @file ScrollMagic main library.
   *)

gsap/umd/TweenMax.js:
  (*!
   * VERSION: 2.0.2
   * DATE: 2018-08-27
   * UPDATES AND DOCS AT: http://greensock.com
   * 
   * Includes all of the following: TweenLite, TweenMax, TimelineLite, TimelineMax, EasePack, CSSPlugin, RoundPropsPlugin, BezierPlugin, AttrPlugin, DirectionalRotationPlugin
   *
   * @license Copyright (c) 2008-2018, GreenSock. All rights reserved.
   * This work is subject to the terms at http://greensock.com/standard-license or for
   * Club GreenSock members, the software agreement that was issued with your membership.
   * 
   * @author: Jack Doyle, jack@greensock.com
   **)

scrollmagic/scrollmagic/uncompressed/plugins/animation.gsap.js:
  (*!
   * ScrollMagic v2.0.6 (2018-10-08)
   * The javascript library for magical scroll interactions.
   * (c) 2018 Jan Paepke (@janpaepke)
   * Project Website: http://scrollmagic.io
   * 
   * @version 2.0.6
   * @license Dual licensed under MIT license and GPL.
   * @author Jan Paepke - e-mail@janpaepke.de
   *
   * @file ScrollMagic GSAP Animation Plugin.
   *
   * requires: GSAP ~1.14
   * Powered by the Greensock Animation Platform (GSAP): http://www.greensock.com/js
   * Greensock License info at http://www.greensock.com/licensing/
   *)
*/
//# sourceMappingURL=app.min.js.map
